Format=function(t,e){this.editorUi=t,this.container=e},Format.inactiveTabBackgroundColor="#f1f3f4",Format.classicFilledMarkerImage=Graph.createSvgImage(20,22,'<path transform="translate(4,2)" stroke-width="2" d="M 0 8 L 10 2 L 5 8 L 10 14 Z M 0 8 L 24 8" stroke="#404040" fill="#404040"/>',32,20),Format.classicThinFilledMarkerImage=Graph.createSvgImage(20,22,'<path transform="translate(4,2)" stroke-width="2" d="M 0 8 L 8 4 L 3 8 L 8 12 Z M 0 8 L 24 8" stroke="#404040" fill="#404040"/>',32,20),Format.openFilledMarkerImage=Graph.createSvgImage(20,22,'<path transform="translate(4,2)" stroke-width="2" d="M 8 0 L 0 8 L 8 16 M 0 8 L 24 8" stroke="#404040" fill="transparent"/>',32,20),Format.openThinFilledMarkerImage=Graph.createSvgImage(20,22,'<path transform="translate(4,2)" stroke-width="2" d="M 8 4 L 0 8 L 8 12 M 0 8 L 24 8" stroke="#404040" fill="transparent"/>',32,20),Format.openAsyncFilledMarkerImage=Graph.createSvgImage(20,22,'<path transform="translate(4,2)" stroke-width="2" d="M 8 4 L 0 8 L 24 8" stroke="#404040" fill="transparent"/>',32,20),Format.blockFilledMarkerImage=Graph.createSvgImage(20,22,'<path transform="translate(4,2)" stroke-width="2" d="M 0 8 L 8 2 L 8 14 Z M 0 8 L 24 8" stroke="#404040" fill="#404040"/>',32,20),Format.blockThinFilledMarkerImage=Graph.createSvgImage(20,22,'<path transform="translate(4,2)" stroke-width="2" d="M 0 8 L 8 4 L 8 12 Z M 0 8 L 24 8" stroke="#404040" fill="#404040"/>',32,20),Format.asyncFilledMarkerImage=Graph.createSvgImage(20,22,'<path transform="translate(4,2)" stroke-width="2" d="M 6 8 L 6 4 L 0 8 L 24 8" stroke="#404040" fill="#404040"/>',32,20),Format.ovalFilledMarkerImage=Graph.createSvgImage(20,22,'<path transform="translate(4,2)" stroke-width="2" d="M 0 8 A 5 5 0 0 1 5 3 A 5 5 0 0 1 11 8 A 5 5 0 0 1 5 13 A 5 5 0 0 1 0 8 Z M 10 8 L 24 8" stroke="#404040" fill="#404040"/>',32,20),Format.diamondFilledMarkerImage=Graph.createSvgImage(20,22,'<path transform="translate(4,2)" stroke-width="2" d="M 0 8 L 6 2 L 12 8 L 6 14 Z M 0 8 L 24 8" stroke="#404040" fill="#404040"/>',32,20),Format.diamondThinFilledMarkerImage=Graph.createSvgImage(20,22,'<path transform="translate(4,2)" stroke-width="2" d="M 0 8 L 8 3 L 16 8 L 8 13 Z M 0 8 L 24 8" stroke="#404040" fill="#404040"/>',32,20),Format.classicMarkerImage=Graph.createSvgImage(20,22,'<path transform="translate(4,2)" stroke-width="2" d="M 0 8 L 10 2 L 5 8 L 10 14 Z M 5 8 L 24 8" stroke="#404040" fill="transparent"/>',32,20),Format.classicThinMarkerImage=Graph.createSvgImage(20,22,'<path transform="translate(4,2)" stroke-width="2" d="M 0 8 L 8 4 L 5 8 L 8 12 Z M 5 8 L 24 8" stroke="#404040" fill="transparent"/>',32,20),Format.blockMarkerImage=Graph.createSvgImage(20,22,'<path transform="translate(4,2)" stroke-width="2" d="M 0 8 L 8 2 L 8 14 Z M 8 8 L 24 8" stroke="#404040" fill="transparent"/>',32,20),Format.blockThinMarkerImage=Graph.createSvgImage(20,22,'<path transform="translate(4,2)" stroke-width="2" d="M 0 8 L 8 4 L 8 12 Z M 8 8 L 24 8" stroke="#404040" fill="transparent"/>',32,20),Format.asyncMarkerImage=Graph.createSvgImage(20,22,'<path transform="translate(4,2)" stroke-width="2" d="M 6 8 L 6 4 L 0 8 L 24 8" stroke="#404040" fill="transparent"/>',32,20),Format.ovalMarkerImage=Graph.createSvgImage(20,22,'<path transform="translate(4,2)" stroke-width="2" d="M 0 8 A 5 5 0 0 1 5 3 A 5 5 0 0 1 11 8 A 5 5 0 0 1 5 13 A 5 5 0 0 1 0 8 Z M 10 8 L 24 8" stroke="#404040" fill="transparent"/>',32,20),Format.diamondMarkerImage=Graph.createSvgImage(20,22,'<path transform="translate(4,2)" stroke-width="2" d="M 0 8 L 6 2 L 12 8 L 6 14 Z M 12 8 L 24 8" stroke="#404040" fill="transparent"/>',32,20),Format.diamondThinMarkerImage=Graph.createSvgImage(20,22,'<path transform="translate(4,2)" stroke-width="2" d="M 0 8 L 8 3 L 16 8 L 8 13 Z M 16 8 L 24 8" stroke="#404040" fill="transparent"/>',32,20),Format.boxMarkerImage=Graph.createSvgImage(20,22,'<path transform="translate(4,2)" stroke-width="2" d="M 0 3 L 10 3 L 10 13 L 0 13 Z M 10 8 L 24 8" stroke="#404040" fill="transparent"/>',32,20),Format.halfCircleMarkerImage=Graph.createSvgImage(20,22,'<path transform="translate(4,2)" stroke-width="2" d="M 0 3 A 5 5 0 0 1 5 8 A 5 5 0 0 1 0 13 M 5 8 L 24 8" stroke="#404040" fill="transparent"/>',32,20),Format.dashMarkerImage=Graph.createSvgImage(20,22,'<path transform="translate(4,2)" stroke-width="2" d="M 0 2 L 12 14 M 0 8 L 24 8" stroke="#404040" fill="transparent"/>',32,20),Format.crossMarkerImage=Graph.createSvgImage(20,22,'<path transform="translate(4,2)" stroke-width="2" d="M 0 2 L 12 14 M 12 2 L 0 14 M 0 8 L 24 8" stroke="#404040" fill="transparent"/>',32,20),Format.circlePlusMarkerImage=Graph.createSvgImage(20,22,'<path transform="translate(4,2)" stroke-width="2" d="M 0 8 A 6 6 0 0 1 6 2 A 6 6 0 0 1 12 8 A 6 6 0 0 1 6 14 A 6 6 0 0 1 0 8 Z M 6 2 L 6 14 M 0 8 L 24 8" stroke="#404040" fill="transparent"/>',32,20),Format.circleMarkerImage=Graph.createSvgImage(20,22,'<path transform="translate(4,2)" stroke-width="2" d="M 0 8 A 6 6 0 0 1 6 2 A 6 6 0 0 1 12 8 A 6 6 0 0 1 6 14 A 6 6 0 0 1 0 8 Z M 12 8 L 24 8" stroke="#404040" fill="transparent"/>',32,20),Format.ERmandOneMarkerImage=Graph.createSvgImage(20,22,'<path transform="translate(4,2)" stroke-width="2" d="M 6 2 L 6 14 M 9 2 L 9 14 M 0 8 L 24 8" stroke="#404040" fill="transparent"/>',32,20),Format.ERmanyMarkerImage=Graph.createSvgImage(20,22,'<path transform="translate(4,2)" stroke-width="2" d="M 0 2 L 12 8 L 0 14 M 0 8 L 24 8" stroke="#404040" fill="transparent"/>',32,20),Format.ERoneToManyMarkerImage=Graph.createSvgImage(20,22,'<path transform="translate(4,2)" stroke-width="2" d="M 0 2 L 12 8 L 0 14 M 15 2 L 15 14 M 0 8 L 24 8" stroke="#404040" fill="transparent"/>',32,20),Format.ERzeroToOneMarkerImage=Graph.createSvgImage(20,22,'<path transform="translate(4,2)" stroke-width="2" d="M 8 8 A 5 5 0 0 1 13 3 A 5 5 0 0 1 18 8 A 5 5 0 0 1 13 13 A 5 5 0 0 1 8 8 Z M 0 8 L 8 8 M 18 8 L 24 8 M 4 3 L 4 13" stroke="#404040" fill="transparent"/>',32,20),Format.ERzeroToManyMarkerImage=Graph.createSvgImage(20,22,'<path transform="translate(4,2)" stroke-width="2" d="M 8 8 A 5 5 0 0 1 13 3 A 5 5 0 0 1 18 8 A 5 5 0 0 1 13 13 A 5 5 0 0 1 8 8 Z M 0 8 L 8 8 M 18 8 L 24 8 M 0 3 L 8 8 L 0 13" stroke="#404040" fill="transparent"/>',32,20),Format.EROneMarkerImage=Graph.createSvgImage(20,22,'<path transform="translate(4,2)" stroke-width="2" d="M 5 2 L 5 14 M 0 8 L 24 8" stroke="#404040" fill="transparent"/>',32,20),Format.baseDashMarkerImage=Graph.createSvgImage(20,22,'<path transform="translate(4,2)" stroke-width="2" d="M 0 2 L 0 14 M 0 8 L 24 8" stroke="#404040" fill="transparent"/>',32,20),Format.doubleBlockMarkerImage=Graph.createSvgImage(20,22,'<path transform="translate(4,2)" stroke-width="2" d="M 0 8 L 8 2 L 8 14 Z M 8 8 L 16 2 L 16 14 Z M 16 8 L 24 8" stroke="#404040" fill="transparent"/>',32,20),Format.doubleBlockFilledMarkerImage=Graph.createSvgImage(20,22,'<path transform="translate(4,2)" stroke-width="2" d="M 0 8 L 8 2 L 8 14 Z M 8 8 L 16 2 L 16 14 Z M 16 8 L 24 8" stroke="#404040" fill="#404040"/>',32,20),Format.processMenuIcon=function(t,e){var n=t.getElementsByTagName("img");return 0<n.length&&(Editor.isDarkMode()&&(n[0].style.filter="invert(100%)"),n[0].className="geIcon",n[0].style.padding="0px",n[0].style.margin="0 0 0 2px",null!=e&&mxUtils.setPrefixedStyle(n[0].style,"transform",e)),t},Format.prototype.labelIndex=0,Format.prototype.diagramIndex=0,Format.prototype.currentIndex=0,Format.prototype.showCloseButton=!0,Format.prototype.roundableShapes=["label","rectangle","internalStorage","corner","parallelogram","swimlane","triangle","trapezoid","ext","step","tee","process","link","rhombus","offPageConnector","loopLimit","hexagon","manualInput","card","curlyBracket","singleArrow","callout","doubleArrow","flexArrow","umlLifeline"],Format.prototype.init=function(){var t=this.editorUi,e=t.editor,n=e.graph;this.update=mxUtils.bind(this,function(t,e){this.clearSelectionState(),this.refresh()}),n.getSelectionModel().addListener(mxEvent.CHANGE,this.update),n.addListener(mxEvent.EDITING_STARTED,this.update),n.addListener(mxEvent.EDITING_STOPPED,this.update),n.getModel().addListener(mxEvent.CHANGE,this.update),n.getView().addListener("unitChanged",this.update),n.addListener(mxEvent.ROOT,mxUtils.bind(this,function(){this.refresh()})),t.addListener("styleChanged",mxUtils.bind(this,function(t,e){this.refresh()})),e.addListener("autosaveChanged",mxUtils.bind(this,function(){this.refresh()})),this.refresh()},Format.prototype.clearSelectionState=function(){this.selectionState=null},Format.prototype.getSelectionState=function(){return null==this.selectionState&&(this.selectionState=this.createSelectionState()),this.selectionState},Format.prototype.createSelectionState=function(){for(var t=this.editorUi.editor.graph.getSelectionCells(),e=this.initSelectionState(),n=!0,l=0;l<t.length;l++){var s=this.editorUi.editor.graph.getCurrentCellStyle(t[l]);"0"!=mxUtils.getValue(s,mxConstants.STYLE_EDITABLE,"1")&&(this.updateSelectionStateForCell(e,t[l],t,n),n=!1)}return e},Format.prototype.initSelectionState=function(){return{vertices:[],edges:[],cells:[],x:null,y:null,width:null,height:null,style:{},containsImage:!1,containsLabel:!1,fill:!0,glass:!0,rounded:!0,autoSize:!1,image:!0,shadow:!0,lineJumps:!0,resizable:!0,table:!1,cell:!1,row:!1,movable:!0,rotatable:!0,stroke:!0}},Format.prototype.updateSelectionStateForCell=function(t,e,n,l){var s,i,o=this.editorUi.editor.graph;t.cells.push(e),o.getModel().isVertex(e)?(t.resizable=t.resizable&&o.isCellResizable(e),t.rotatable=t.rotatable&&o.isCellRotatable(e),t.movable=t.movable&&o.isCellMovable(e)&&!o.isTableRow(e)&&!o.isTableCell(e),t.table=t.table||o.isTable(e),t.cell=t.cell||o.isTableCell(e),t.row=t.row||o.isTableRow(e),t.vertices.push(e),null!=(s=o.getCellGeometry(e))&&(0<s.width?null==t.width?t.width=s.width:t.width!=s.width&&(t.width=""):t.containsLabel=!0,0<s.height?null==t.height?t.height=s.height:t.height!=s.height&&(t.height=""):t.containsLabel=!0,s.relative&&null==s.offset||(i=(s.relative?s.offset:s).x,a=(s.relative?s.offset:s).y,null==t.x?t.x=i:t.x!=i&&(t.x=""),null==t.y?t.y=a:t.y!=a&&(t.y="")))):o.getModel().isEdge(e)&&(t.edges.push(e),t.resizable=!1,t.rotatable=!1,t.movable=!1);var a=o.view.getState(e);null!=a&&(t.autoSize=t.autoSize||this.isAutoSizeState(a),t.glass=t.glass&&this.isGlassState(a),t.rounded=t.rounded&&this.isRoundedState(a),t.lineJumps=t.lineJumps&&this.isLineJumpState(a),t.image=t.image&&this.isImageState(a),t.shadow=t.shadow&&this.isShadowState(a),t.fill=t.fill&&this.isFillState(a),t.stroke=t.stroke&&this.isStrokeState(a),e=mxUtils.getValue(a.style,mxConstants.STYLE_SHAPE,null),t.containsImage=t.containsImage||"image"==e,o.mergeStyle(a.style,t.style,l))},Format.prototype.isFillState=function(t){return!this.isSpecialColor(t.style[mxConstants.STYLE_FILLCOLOR])&&(t.view.graph.model.isVertex(t.cell)||"arrow"==mxUtils.getValue(t.style,mxConstants.STYLE_SHAPE,null)||"filledEdge"==mxUtils.getValue(t.style,mxConstants.STYLE_SHAPE,null)||"flexArrow"==mxUtils.getValue(t.style,mxConstants.STYLE_SHAPE,null))},Format.prototype.isStrokeState=function(t){return!this.isSpecialColor(t.style[mxConstants.STYLE_STROKECOLOR])},Format.prototype.isSpecialColor=function(t){return 0<=mxUtils.indexOf([mxConstants.STYLE_STROKECOLOR,mxConstants.STYLE_FILLCOLOR,"inherit","swimlane","indicated"],t)},Format.prototype.isGlassState=function(t){t=mxUtils.getValue(t.style,mxConstants.STYLE_SHAPE,null);return"label"==t||"rectangle"==t||"internalStorage"==t||"ext"==t||"umlLifeline"==t||"swimlane"==t||"process"==t},Format.prototype.isRoundedState=function(t){return null!=t.shape?t.shape.isRoundable():0<=mxUtils.indexOf(this.roundableShapes,mxUtils.getValue(t.style,mxConstants.STYLE_SHAPE,null))},Format.prototype.isLineJumpState=function(t){var e=mxUtils.getValue(t.style,mxConstants.STYLE_SHAPE,null);return!mxUtils.getValue(t.style,mxConstants.STYLE_CURVED,!1)&&("connector"==e||"filledEdge"==e)},Format.prototype.isAutoSizeState=function(t){return"1"==mxUtils.getValue(t.style,mxConstants.STYLE_AUTOSIZE,null)},Format.prototype.isImageState=function(t){t=mxUtils.getValue(t.style,mxConstants.STYLE_SHAPE,null);return"label"==t||"image"==t},Format.prototype.isShadowState=function(t){return"image"!=mxUtils.getValue(t.style,mxConstants.STYLE_SHAPE,null)},Format.prototype.clear=function(){if(this.container.innerHTML="",null!=this.panels)for(var t=0;t<this.panels.length;t++)this.panels[t].destroy();this.panels=[]},Format.prototype.refresh=function(){null!=this.pendingRefresh&&(window.clearTimeout(this.pendingRefresh),this.pendingRefresh=null),this.pendingRefresh=window.setTimeout(mxUtils.bind(this,function(){this.immediateRefresh()}))},Format.prototype.immediateRefresh=function(){var t,i,e,n,o,a,r,l,s,d,u,m,c,p;"0px"!=this.container.style.width&&(this.clear(),t=this.editorUi,i=t.editor.graph,(p=document.createElement("div")).style.whiteSpace="nowrap",p.style.color="rgb(112, 112, 112)",p.style.textAlign="left",p.style.cursor="default",(e=document.createElement("div")).className="geFormatSection",e.style.textAlign="center",e.style.fontWeight="bold",e.style.paddingTop="8px",e.style.fontSize="13px",e.style.borderWidth="0px 0px 1px 1px",e.style.borderStyle="solid",e.style.display="inline-block",e.style.height="25px",e.style.overflow="hidden",e.style.width="100%",this.container.appendChild(p),mxEvent.addListener(e,mxClient.IS_POINTER?"pointerdown":"mousedown",mxUtils.bind(this,function(t){t.preventDefault()})),n=this.getSelectionState(),o=n.containsLabel,r=a=null,l=mxUtils.bind(this,function(e,n,l,t){var s=mxUtils.bind(this,function(t){a!=e&&(o?this.labelIndex=l:i.isSelectionEmpty()?this.diagramIndex=l:this.currentIndex=l,null!=a&&(a.style.backgroundColor=Format.inactiveTabBackgroundColor,a.style.borderBottomWidth="1px"),(a=e).style.backgroundColor="",a.style.borderBottomWidth="0px",r!=n&&(null!=r&&(r.style.display="none"),(r=n).style.display=""))});mxEvent.addListener(e,"click",s),mxEvent.addListener(e,mxClient.IS_POINTER?"pointerdown":"mousedown",mxUtils.bind(this,function(t){t.preventDefault()})),(t&&null==a||l==(o?this.labelIndex:i.isSelectionEmpty()?this.diagramIndex:this.currentIndex))&&s()}),s=0,i.isSelectionEmpty()?(mxUtils.write(e,mxResources.get("diagram")),e.style.borderLeftWidth="0px",p.appendChild(e),d=p.cloneNode(!1),this.panels.push(new DiagramFormatPanel(this,t,d)),this.container.appendChild(d),null!=Editor.styles&&(d.style.display="none",e.style.width=this.showCloseButton?"106px":"50%",e.style.cursor="pointer",e.style.backgroundColor=Format.inactiveTabBackgroundColor,(u=e.cloneNode(!1)).style.borderLeftWidth="1px",u.style.borderRightWidth="1px",u.style.backgroundColor=Format.inactiveTabBackgroundColor,l(e,d,s++),(c=p.cloneNode(!1)).style.display="none",mxUtils.write(u,mxResources.get("style")),p.appendChild(u),this.panels.push(new DiagramStylePanel(this,t,c)),this.container.appendChild(c),l(u,c,s++)),this.showCloseButton&&((u=e.cloneNode(!1)).style.borderLeftWidth="1px",u.style.borderRightWidth="1px",u.style.borderBottomWidth="1px",u.style.backgroundColor=Format.inactiveTabBackgroundColor,u.style.position="absolute",u.style.right="0px",u.style.top="0px",u.style.width="25px",(m=document.createElement("img")).setAttribute("border","0"),m.setAttribute("src",Dialog.prototype.closeImage),m.setAttribute("title",mxResources.get("hide")),m.style.position="absolute",m.style.display="block",m.style.right="0px",m.style.top="8px",m.style.cursor="pointer",m.style.marginTop="1px",m.style.marginRight="6px",m.style.border="1px solid transparent",m.style.padding="1px",m.style.opacity=.5,u.appendChild(m),mxEvent.addListener(m,"click",function(){t.actions.get("formatPanel").funct()}),p.appendChild(u))):i.isEditing()?(mxUtils.write(e,mxResources.get("text")),p.appendChild(e),this.panels.push(new TextFormatPanel(this,t,p))):(e.style.backgroundColor=Format.inactiveTabBackgroundColor,e.style.borderLeftWidth="1px",e.style.cursor="pointer",e.style.width=o||0==n.cells.length?"50%":"33.3%",m=(u=e.cloneNode(!1)).cloneNode(!1),u.style.backgroundColor=Format.inactiveTabBackgroundColor,m.style.backgroundColor=Format.inactiveTabBackgroundColor,o?u.style.borderLeftWidth="0px":(e.style.borderLeftWidth="0px",mxUtils.write(e,mxResources.get("style")),p.appendChild(e),(c=p.cloneNode(!1)).style.display="none",this.panels.push(new StyleFormatPanel(this,t,c)),this.container.appendChild(c),l(e,c,s++)),mxUtils.write(u,mxResources.get("text")),p.appendChild(u),(c=p.cloneNode(!1)).style.display="none",this.panels.push(new TextFormatPanel(this,t,c)),this.container.appendChild(c),mxUtils.write(m,mxResources.get("arrange")),p.appendChild(m),(p=p.cloneNode(!1)).style.display="none",this.panels.push(new ArrangePanel(this,t,p)),this.container.appendChild(p),0<n.cells.length?l(u,c,s++):u.style.display="none",l(m,p,s++,!0)))},BaseFormatPanel=function(t,e,n){this.format=t,this.editorUi=e,this.container=n,this.listeners=[]},BaseFormatPanel.prototype.buttonBackgroundColor="white",BaseFormatPanel.prototype.installInputHandler=function(s,i,o,a,r,d,u,m){d=null!=d?d:"",m=null!=m&&m;var c=this.editorUi,p=c.editor.graph;a=null!=a?a:1,r=null!=r?r:999;var g=null,h=!1,t=mxUtils.bind(this,function(t){var e=(m?parseFloat:parseInt)(s.value);if(isNaN(e)||i!=mxConstants.STYLE_ROTATION||(e=mxUtils.mod(Math.round(100*e),36e3)/100),e=Math.min(r,Math.max(a,isNaN(e)?o:e)),p.cellEditor.isContentEditing()&&u)h||(h=!0,null!=g&&(p.cellEditor.restoreSelection(g),g=null),u(e),s.value=e+d,h=!1);else if(e!=mxUtils.getValue(this.format.getSelectionState().style,i,o)){p.isEditing()&&p.stopEditing(!0),p.getModel().beginUpdate();try{var n=this.format.getSelectionState().cells;p.setCellStyles(i,e,n),i==mxConstants.STYLE_FONTSIZE&&p.updateLabelElements(n,function(t){t.style.fontSize=e+"px",t.removeAttribute("size")});for(var l=0;l<n.length;l++)0==p.model.getChildCount(n[l])&&p.autoSizeCell(n[l],!1);c.fireEvent(new mxEventObject("styleChanged","keys",[i],"values",[e],"cells",n))}finally{p.getModel().endUpdate()}}s.value=e+d,mxEvent.consume(t)});return u&&p.cellEditor.isContentEditing()&&(mxEvent.addListener(s,"mousedown",function(){document.activeElement==p.cellEditor.textarea&&(g=p.cellEditor.saveSelection())}),mxEvent.addListener(s,"touchstart",function(){document.activeElement==p.cellEditor.textarea&&(g=p.cellEditor.saveSelection())})),mxEvent.addListener(s,"change",t),mxEvent.addListener(s,"blur",t),t},BaseFormatPanel.prototype.createPanel=function(){var t=document.createElement("div");return t.className="geFormatSection",t.style.padding="12px 0px 12px 14px",t},BaseFormatPanel.prototype.createTitle=function(t){var e=document.createElement("div");return e.style.padding="0px 0px 6px 0px",e.style.whiteSpace="nowrap",e.style.overflow="hidden",e.style.width="200px",e.style.fontWeight="bold",mxUtils.write(e,t),e},BaseFormatPanel.prototype.createStepper=function(n,l,s,t,e,i,o){t=null!=t?t:9;var a=10*(s=null!=s?s:1),r=document.createElement("div");mxUtils.setPrefixedStyle(r.style,"borderRadius","3px"),r.style.border="1px solid rgb(192, 192, 192)",r.style.position="absolute";var d=document.createElement("div");d.style.borderBottom="1px solid rgb(192, 192, 192)",d.style.position="relative",d.style.height=t+"px",d.style.width="10px",d.className="geBtnUp",r.appendChild(d);var u,m=d.cloneNode(!1);return m.style.border="none",m.style.height=t+"px",m.className="geBtnDown",r.appendChild(m),mxEvent.addGestureListeners(m,function(t){mxEvent.consume(t)},null,function(t){""==n.value&&(n.value=i||"2");var e=(o?parseFloat:parseInt)(n.value);isNaN(e)||(n.value=e-(mxEvent.isShiftDown(t)?a:s),null!=l&&l(t)),mxEvent.consume(t)}),mxEvent.addGestureListeners(d,function(t){mxEvent.consume(t)},null,function(t){""==n.value&&(n.value=i||"0");var e=(o?parseFloat:parseInt)(n.value);isNaN(e)||(n.value=e+(mxEvent.isShiftDown(t)?a:s),null!=l&&l(t)),mxEvent.consume(t)}),e?(u=null,mxEvent.addGestureListeners(r,function(t){mxEvent.consume(t)},null,function(t){if(null!=u){try{u.select()}catch(t){}u=null,mxEvent.consume(t)}})):mxEvent.addListener(r,"click",function(t){mxEvent.consume(t)}),r},BaseFormatPanel.prototype.createOption=function(t,e,n,l,s){var i=document.createElement("div");i.style.padding="3px 0px 3px 0px",i.style.whiteSpace="nowrap",i.style.textOverflow="ellipsis",i.style.overflow="hidden",i.style.width="200px",i.style.height="18px";var o=document.createElement("input");o.setAttribute("type","checkbox"),o.style.margin="1px 6px 0px 0px",o.style.verticalAlign="top",i.appendChild(o);var a=document.createElement("span");a.style.verticalAlign="top",mxUtils.write(a,t),i.appendChild(a);function r(t){d||(d=!0,t?(o.setAttribute("checked","checked"),o.defaultChecked=!0,o.checked=!0):(o.removeAttribute("checked"),o.defaultChecked=!1,o.checked=!1),u!=t&&(u=t,e()!=u&&n(u)),d=!1)}var d=!1,u=e();return mxEvent.addListener(i,"click",function(t){"disabled"!=o.getAttribute("disabled")&&((t=mxEvent.getSource(t))!=i&&t!=a||(o.checked=!o.checked),r(o.checked))}),r(u),null!=l&&(l.install(r),this.listeners.push(l)),null!=s&&s(i),i},BaseFormatPanel.prototype.createCellOption=function(t,l,e,s,i,o,a,r,d){var u=this.editorUi,m=u.editor.graph,c=this;s=null!=s?"null"==s?null:s:1,i=null!=i?"null"==i?null:i:0;var n=null!=d?m.getCommonStyle(d):this.format.getSelectionState().style;return this.createOption(t,function(){return mxUtils.getValue(n,l,e)!=i},function(t){if(r&&m.stopEditing(),null!=a)a.funct();else{m.getModel().beginUpdate();try{var e=null!=d?d:c.format.getSelectionState().cells,n=t?s:i;m.setCellStyles(l,n,e),null!=o&&o(e,n),u.fireEvent(new mxEventObject("styleChanged","keys",[l],"values",[n],"cells",e))}finally{m.getModel().endUpdate()}}},{install:function(t){this.listener=function(){t(mxUtils.getValue(n,l,e)!=i)},m.getModel().addListener(mxEvent.CHANGE,this.listener)},destroy:function(){m.getModel().removeListener(this.listener)}})},BaseFormatPanel.prototype.createColorOption=function(t,i,o,a,e,r,d,u){var n=document.createElement("div");n.style.padding="3px 0px 3px 0px",n.style.whiteSpace="nowrap",n.style.overflow="hidden",n.style.width="200px",n.style.height="18px";var m=document.createElement("input");m.setAttribute("type","checkbox"),m.style.margin="1px 6px 0px 0px",m.style.verticalAlign="top",d||n.appendChild(m);var l=document.createElement("span");l.style.verticalAlign="top",mxUtils.write(l,t),n.appendChild(l);function s(t,e,n){var l,s;g||(s="null"==a?null:a,g=!0,l=null!=(t=/(^#?[a-zA-Z0-9]*$)/.test(t)?t:s)&&t!=mxConstants.NONE?t:s,(s=document.createElement("div")).style.width="36px",s.style.height="12px",s.style.margin="3px",s.style.border="1px solid black",s.style.backgroundColor="default"==l?u:l,h.innerHTML="",h.appendChild(s),null!=t&&t!=mxConstants.NONE&&1<t.length&&"string"==typeof t&&(s="#"==t.charAt(0)?t.substring(1).toUpperCase():t,s=ColorDialog.prototype.colorNames[s],h.setAttribute("title",null!=s?s+" ("+c+")":c)),null!=t&&t!=mxConstants.NONE?(m.setAttribute("checked","checked"),m.defaultChecked=!0,m.checked=!0):(m.removeAttribute("checked"),m.defaultChecked=!1,m.checked=!1),h.style.display=m.checked||d?"":"none",null!=r&&r("null"==t?null:t),e||(p=t,(n||d||i()!=p)&&o("null"==p?null:p,p)),g=!1)}var c="Shift+Click for Color Dropper",p=i(),g=!1,h=null,x=document.createElement("input");x.setAttribute("type","color"),x.style.visibility="hidden",x.style.width="0px",x.style.height="0px",x.style.border="none",n.appendChild(x),(h=mxUtils.button("",mxUtils.bind(this,function(t){var e=p;"default"==e&&(e=u),!mxEvent.isShiftDown(t)||mxClient.IS_IE||mxClient.IS_IE11?this.editorUi.pickColor(e,function(t){s(t,null,!0)},u):(x.value=e,x.click(),mxEvent.addListener(x,"input",function(){s(x.value,null,!0)})),mxEvent.consume(t)}))).style.position="absolute",h.style.marginTop="-3px",h.style.left="178px",h.style.height="22px",h.className="geColorBtn",h.style.display=m.checked||d?"":"none",n.appendChild(h);l=null!=p&&"string"==typeof p&&"#"==p.charAt(0)?p.substring(1).toUpperCase():p,l=ColorDialog.prototype.colorNames[l];return h.setAttribute("title",null!=l?l+" ("+c+")":c),mxEvent.addListener(n,"click",function(t){t=mxEvent.getSource(t);t!=m&&"INPUT"==t.nodeName||(t!=m&&(m.checked=!m.checked),m.checked||null==p||p==mxConstants.NONE||a==mxConstants.NONE||(a=p),s(m.checked?a:mxConstants.NONE))}),s(p,!0),null!=e&&(e.install(s),this.listeners.push(e)),n},BaseFormatPanel.prototype.createCellColorOption=function(t,l,e,n,s,i){var o=this.editorUi,a=o.editor.graph,r=this;return this.createColorOption(t,function(){var t=a.view.getState(r.format.getSelectionState().cells[0]);return null!=t?mxUtils.getValue(t.style,l,null):null},function(t,e){a.getModel().beginUpdate();try{var n=r.format.getSelectionState().cells;a.setCellStyles(l,t,n),null!=s&&s(t),o.fireEvent(new mxEventObject("styleChanged","keys",[l],"values",[t],"cells",n))}finally{a.getModel().endUpdate()}},e||mxConstants.NONE,{install:function(e){this.listener=function(){var t=a.view.getState(r.format.getSelectionState().cells[0]);null!=t&&e(mxUtils.getValue(t.style,l,null),!0)},a.getModel().addListener(mxEvent.CHANGE,this.listener)},destroy:function(){a.getModel().removeListener(this.listener)}},n,null,i)},BaseFormatPanel.prototype.addArrow=function(t,e){e=null!=e?e:10;var n=document.createElement("div");n.style.display="inline-block",n.style.paddingRight="4px",n.style.padding="6px";var l=10-e;2==l?n.style.paddingTop="6px":0<l?n.style.paddingTop=6-l+"px":n.style.marginTop="-2px",n.style.height=e+"px",n.style.borderLeft="1px solid #a0a0a0";e=document.createElement("img");e.setAttribute("border","0"),e.setAttribute("valign","middle"),e.setAttribute("src",Toolbar.prototype.dropDownImage),n.appendChild(e),(e=n.getElementsByTagName("img")[0]).style.position="relative",e.style.left="1px",e.style.top=mxClient.IS_FF?"0px":"-4px",mxUtils.setOpacity(n,70);e=t.getElementsByTagName("div")[0];return null!=e&&(e.style.paddingRight="6px",e.style.marginLeft="4px",e.style.marginTop="-1px",e.style.display="inline-block",mxUtils.setOpacity(e,60)),mxUtils.setOpacity(t,100),t.style.border="1px solid #a0a0a0",t.style.backgroundColor=this.buttonBackgroundColor,t.style.backgroundImage="none",t.style.width="auto",t.className+=" geColorBtn",mxUtils.setPrefixedStyle(t.style,"borderRadius","3px"),t.appendChild(n),e},BaseFormatPanel.prototype.addUnitInput=function(t,e,n,l,s,i,o,a,r){o=null!=o?o:0;var d=document.createElement("input");d.style.position="absolute",d.style.textAlign="right",d.style.marginTop="-2px",d.style.left=228-n-l+"px",d.style.width=l+"px",d.style.height="21px",d.style.border="1px solid rgb(160, 160, 160)",d.style.borderRadius="4px",d.style.boxSizing="border-box",t.appendChild(d);r=this.createStepper(d,s,i,null,a,null,r);return r.style.marginTop=o-2+"px",r.style.left=228-n+"px",t.appendChild(r),d},BaseFormatPanel.prototype.createRelativeOption=function(t,l,e,s,n){e=null!=e?e:52;var i=this.editorUi.editor.graph,o=this.createPanel();o.style.paddingTop="10px",o.style.paddingBottom="10px",mxUtils.write(o,t),o.style.fontWeight="bold";var a,t=mxUtils.bind(this,function(t){var e,n;null!=s?s(r):(e=parseInt(r.value),e=Math.min(100,Math.max(0,isNaN(e)?100:e)),null!=(n=i.view.getState(this.format.getSelectionState().cells[0]))&&e!=mxUtils.getValue(n.style,l,100)&&(100==e&&(e=null),n=this.format.getSelectionState().cells,i.setCellStyles(l,e,n),this.editorUi.fireEvent(new mxEventObject("styleChanged","keys",[l],"values",[e],"cells",n))),r.value=(null!=e?e:"100")+" %"),mxEvent.consume(t)}),r=this.addUnitInput(o,"%",16,e,t,10,-15,null!=s);return null!=l&&(a=mxUtils.bind(this,function(t,e,n){!n&&r==document.activeElement||(n=this.format.getSelectionState(),n=parseInt(mxUtils.getValue(n.style,l,100)),r.value=isNaN(n)?"":n+" %")}),mxEvent.addListener(r,"keydown",function(t){13==t.keyCode?(i.container.focus(),mxEvent.consume(t)):27==t.keyCode&&(a(null,null,!0),i.container.focus(),mxEvent.consume(t))}),i.getModel().addListener(mxEvent.CHANGE,a),this.listeners.push({destroy:function(){i.getModel().removeListener(a)}}),a()),mxEvent.addListener(r,"blur",t),mxEvent.addListener(r,"change",t),null!=n&&n(r),o},BaseFormatPanel.prototype.addLabel=function(t,e,n,l){l=null!=l?l:61;var s=document.createElement("div");mxUtils.write(s,e),s.style.position="absolute",s.style.left=240-n-l+"px",s.style.width=l+"px",s.style.marginTop="6px",s.style.textAlign="center",t.appendChild(s)},BaseFormatPanel.prototype.addKeyHandler=function(t,e){mxEvent.addListener(t,"keydown",mxUtils.bind(this,function(t){13==t.keyCode?(this.editorUi.editor.graph.container.focus(),mxEvent.consume(t)):27==t.keyCode&&(null!=e&&e(null,null,!0),this.editorUi.editor.graph.container.focus(),mxEvent.consume(t))}))},BaseFormatPanel.prototype.styleButtons=function(t){for(var e=0;e<t.length;e++)mxUtils.setPrefixedStyle(t[e].style,"borderRadius","3px"),mxUtils.setOpacity(t[e],100),t[e].style.border="1px solid #a0a0a0",t[e].style.padding="4px",t[e].style.paddingTop="3px",t[e].style.paddingRight="1px",t[e].style.margin="1px",t[e].style.marginRight="2px",t[e].style.width="24px",t[e].style.height="20px",t[e].className+=" geColorBtn"},BaseFormatPanel.prototype.destroy=function(){if(null!=this.listeners){for(var t=0;t<this.listeners.length;t++)this.listeners[t].destroy();this.listeners=null}},ArrangePanel=function(t,e,n){BaseFormatPanel.call(this,t,e,n),this.init()},mxUtils.extend(ArrangePanel,BaseFormatPanel),ArrangePanel.prototype.init=function(){this.editorUi.editor.graph;var t=this.format.getSelectionState();0<t.cells.length&&(this.container.appendChild(this.addLayerOps(this.createPanel())),this.addGeometry(this.container),this.addEdgeGeometry(this.container),t.containsLabel&&0!=t.edges.length||this.container.appendChild(this.addAngle(this.createPanel())),t.containsLabel||0!=t.edges.length||"rectangle"==t.style.shape||"label"==t.style.shape||this.container.appendChild(this.addFlip(this.createPanel())),1<t.vertices.length&&(this.container.appendChild(this.addAlign(this.createPanel())),this.container.appendChild(this.addDistribute(this.createPanel()))),this.container.appendChild(this.addTable(this.createPanel()))),this.container.appendChild(this.addGroupOps(this.createPanel())),t.containsLabel&&((t=document.createElement("div")).style.width="100%",t.style.marginTop="0px",t.style.fontWeight="bold",t.style.padding="10px 0 0 14px",mxUtils.write(t,mxResources.get("style")),this.container.appendChild(t),new StyleFormatPanel(this.format,this.editorUi,this.container))},ArrangePanel.prototype.addTable=function(t){var e=this.editorUi,n=e.editor.graph,l=this.format.getSelectionState();t.style.paddingTop="6px",t.style.paddingBottom="10px";var s=document.createElement("div");s.style.marginTop="2px",s.style.marginBottom="8px",s.style.fontWeight="bold",mxUtils.write(s,mxResources.get("table")),t.appendChild(s);var i=document.createElement("div");i.style.position="relative",i.style.paddingLeft="0px",i.style.borderWidth="0px",i.style.width="220px",i.className="geToolbarContainer";var o=n.isTable(l.vertices[0])||n.isTableRow(l.vertices[0])||n.isTableCell(l.vertices[0]),a=n.isStack(l.vertices[0])||n.isStackChild(l.vertices[0]),r=o,s=o,o=[];return(r=a?!(s="0"==(n.isStack(l.vertices[0])?l.style:n.getCellStyle(n.model.getParent(l.vertices[0]))).horizontalStack):r)&&(o=o.concat([e.toolbar.addButton("geSprite-insertcolumnbefore",mxResources.get("insertColumnBefore"),mxUtils.bind(this,function(){try{a?n.insertLane(l.vertices[0],!0):n.insertTableColumn(l.vertices[0],!0)}catch(t){e.handleError(t)}}),i),e.toolbar.addButton("geSprite-insertcolumnafter",mxResources.get("insertColumnAfter"),mxUtils.bind(this,function(){try{a?n.insertLane(l.vertices[0],!1):n.insertTableColumn(l.vertices[0],!1)}catch(t){e.handleError(t)}}),i),e.toolbar.addButton("geSprite-deletecolumn",mxResources.get("deleteColumn"),mxUtils.bind(this,function(){try{a?n.deleteLane(l.vertices[0]):n.deleteTableColumn(l.vertices[0])}catch(t){e.handleError(t)}}),i)])),0<(o=s?o.concat([e.toolbar.addButton("geSprite-insertrowbefore",mxResources.get("insertRowBefore"),mxUtils.bind(this,function(){try{a?n.insertLane(l.vertices[0],!0):n.insertTableRow(l.vertices[0],!0)}catch(t){e.handleError(t)}}),i),e.toolbar.addButton("geSprite-insertrowafter",mxResources.get("insertRowAfter"),mxUtils.bind(this,function(){try{a?n.insertLane(l.vertices[0],!1):n.insertTableRow(l.vertices[0],!1)}catch(t){e.handleError(t)}}),i),e.toolbar.addButton("geSprite-deleterow",mxResources.get("deleteRow"),mxUtils.bind(this,function(){try{a?n.deleteLane(l.vertices[0]):n.deleteTableRow(l.vertices[0])}catch(t){e.handleError(t)}}),i)]):o).length&&(this.styleButtons(o),t.appendChild(i),3<o.length&&(o[2].style.marginRight="10px")),t},ArrangePanel.prototype.addLayerOps=function(t){var e=this.editorUi,n=e.editor.graph,l=mxUtils.button(mxResources.get("toFront"),function(t){e.actions.get("toFront").funct()});return l.setAttribute("title",mxResources.get("toFront")+" ("+this.editorUi.actions.get("toFront").shortcut+")"),l.style.width="104px",l.style.marginRight="2px",t.appendChild(l),(l=mxUtils.button(mxResources.get("toBack"),function(t){e.actions.get("toBack").funct()})).setAttribute("title",mxResources.get("toBack")+" ("+this.editorUi.actions.get("toBack").shortcut+")"),l.style.width="104px",t.appendChild(l),1==n.getSelectionCount()&&(mxUtils.br(t),(l=mxUtils.button(mxResources.get("bringForward"),function(t){e.actions.get("bringForward").funct()})).setAttribute("title",mxResources.get("bringForward")),l.style.width="104px",l.style.marginRight="2px",l.style.marginTop="2px",t.appendChild(l),(l=mxUtils.button(mxResources.get("sendBackward"),function(t){e.actions.get("sendBackward").funct()})).setAttribute("title",mxResources.get("sendBackward")),l.style.width="104px",l.style.marginTop="2px",t.appendChild(l)),t},ArrangePanel.prototype.addGroupOps=function(t){var e,l=this.editorUi,s=l.editor.graph,n=this.format.getSelectionState(),i=n.cells[0],o=0,a=null;return t.style.paddingTop="8px",t.style.paddingBottom="6px",1<s.getSelectionCount()?((a=mxUtils.button(mxResources.get("group"),function(t){l.actions.get("group").funct()})).setAttribute("title",mxResources.get("group")+" ("+this.editorUi.actions.get("group").shortcut+")"),a.style.width="210px",a.style.marginBottom="2px",t.appendChild(a),o++):1!=n.cells.length||s.getModel().isEdge(i)||s.isSwimlane(i)||s.isTable(i)||n.row||n.cell||!(0<s.getModel().getChildCount(i))||((a=mxUtils.button(mxResources.get("ungroup"),function(t){l.actions.get("ungroup").funct()})).setAttribute("title",mxResources.get("ungroup")+" ("+this.editorUi.actions.get("ungroup").shortcut+")"),a.style.width="210px",a.style.marginBottom="2px",t.appendChild(a),o++),s.getModel().isVertex(s.getSelectionCell())&&(0<o&&(mxUtils.br(t),o=0),(a=mxUtils.button(mxResources.get("copySize"),function(t){l.actions.get("copySize").funct(t)})).setAttribute("title",mxResources.get("copySize")+" ("+this.editorUi.actions.get("copySize").shortcut+")"),a.style.width="210px",a.style.marginBottom="2px",t.appendChild(a),o++,null!=l.copiedSize&&0<n.vertices.length&&((e=mxUtils.button(mxResources.get("pasteSize"),function(t){l.actions.get("pasteSize").funct(t)})).setAttribute("title",mxResources.get("pasteSize")+" ("+this.editorUi.actions.get("pasteSize").shortcut+")"),t.appendChild(e),o++,a.style.width="104px",a.style.marginBottom="2px",e.style.width="104px",e.style.marginBottom="2px")),0<s.getSelectionCount()&&(0<o&&(mxUtils.br(t),o=0),(a=mxUtils.button(mxResources.get("copyData"),function(t){var e,n;mxEvent.isShiftDown(t)?(e=s.getDataForCells(s.getSelectionCells()),n=new EmbedDialog(l,JSON.stringify(e,null,2),null,null,function(){console.log(e),l.alert("Written to Console (Dev Tools)")},mxResources.get("copyData"),null,"Console","data.json"),l.showDialog(n.container,450,240,!0,!0),n.init()):l.actions.get("copyData").funct(t)})).setAttribute("title",mxResources.get("copyData")+" ("+this.editorUi.actions.get("copyData").shortcut+") Shift+Click to Extract Data"),a.style.width="210px",a.style.marginBottom="2px",t.appendChild(a),o++,null!=l.copiedValue&&0<n.cells.length&&((e=mxUtils.button(mxResources.get("pasteData"),function(t){l.actions.get("pasteData").funct(t)})).setAttribute("title",mxResources.get("pasteData")+" ("+this.editorUi.actions.get("pasteData").shortcut+")"),t.appendChild(e),o++,a.style.width="104px",a.style.marginBottom="2px",e.style.width="104px",e.style.marginBottom="2px")),1==n.cells.length&&s.getModel().isVertex(i)&&!n.row&&!n.cell&&s.getModel().isVertex(s.getModel().getParent(i))?(0<o&&mxUtils.br(t),(a=mxUtils.button(mxResources.get("removeFromGroup"),function(t){l.actions.get("removeFromGroup").funct()})).setAttribute("title",mxResources.get("removeFromGroup")),a.style.width="210px",a.style.marginBottom="2px",t.appendChild(a),o++):0<n.cells.length&&(0<o&&mxUtils.br(t),(a=mxUtils.button(mxResources.get("clearWaypoints"),mxUtils.bind(this,function(t){this.editorUi.actions.get("clearWaypoints").funct(t)}))).setAttribute("title",mxResources.get("clearWaypoints")+" ("+this.editorUi.actions.get("clearWaypoints").shortcut+")"),a.style.width="210px",a.style.marginBottom="2px",t.appendChild(a),o++),1==n.cells.length&&(0<o&&mxUtils.br(t),(a=mxUtils.button(mxResources.get("editData"),mxUtils.bind(this,function(t){this.editorUi.actions.get("editData").funct()}))).setAttribute("title",mxResources.get("editData")+" ("+this.editorUi.actions.get("editData").shortcut+")"),a.style.width="104px",a.style.marginBottom="2px",t.appendChild(a),o++,"1"!=urlParams.customMenu&&((a=mxUtils.button(mxResources.get("editLink"),mxUtils.bind(this,function(t){this.editorUi.actions.get("editLink").funct()}))).setAttribute("title",mxResources.get("editLink")+" ("+this.editorUi.actions.get("editLink").shortcut+")"),a.style.width="104px",a.style.marginLeft="2px",a.style.marginBottom="2px",t.appendChild(a),o++)),0==o&&(t.style.display="none"),t},ArrangePanel.prototype.addAlign=function(t){var e=this.editorUi.editor.graph;t.style.paddingTop="6px",t.style.paddingBottom="12px",t.appendChild(this.createTitle(mxResources.get("align")));var n=document.createElement("div");n.style.position="relative",n.style.whiteSpace="nowrap",n.style.paddingLeft="0px",n.style.borderWidth="0px",n.style.width="220px",n.className="geToolbarContainer";var l=this.editorUi.toolbar.addButton("geSprite-alignleft",mxResources.get("left"),function(){e.alignCells(mxConstants.ALIGN_LEFT)},n),s=this.editorUi.toolbar.addButton("geSprite-aligncenter",mxResources.get("center"),function(){e.alignCells(mxConstants.ALIGN_CENTER)},n),i=this.editorUi.toolbar.addButton("geSprite-alignright",mxResources.get("right"),function(){e.alignCells(mxConstants.ALIGN_RIGHT)},n),o=this.editorUi.toolbar.addButton("geSprite-aligntop",mxResources.get("top"),function(){e.alignCells(mxConstants.ALIGN_TOP)},n),a=this.editorUi.toolbar.addButton("geSprite-alignmiddle",mxResources.get("middle"),function(){e.alignCells(mxConstants.ALIGN_MIDDLE)},n),r=this.editorUi.toolbar.addButton("geSprite-alignbottom",mxResources.get("bottom"),function(){e.alignCells(mxConstants.ALIGN_BOTTOM)},n);return this.styleButtons([l,s,i,o,a,r]),i.style.marginRight="10px",t.appendChild(n),t},ArrangePanel.prototype.addFlip=function(t){var e=this.editorUi.editor.graph;t.style.paddingTop="6px",t.style.paddingBottom="10px";var n=document.createElement("div");n.style.marginTop="2px",n.style.marginBottom="8px",n.style.fontWeight="bold",mxUtils.write(n,mxResources.get("flip")),t.appendChild(n);var n=mxUtils.button(mxResources.get("horizontal"),function(t){e.toggleCellStyles(mxConstants.STYLE_FLIPH,!1)});return n.setAttribute("title",mxResources.get("horizontal")),n.style.width="104px",n.style.marginRight="2px",t.appendChild(n),(n=mxUtils.button(mxResources.get("vertical"),function(t){e.toggleCellStyles(mxConstants.STYLE_FLIPV,!1)})).setAttribute("title",mxResources.get("vertical")),n.style.width="104px",t.appendChild(n),t},ArrangePanel.prototype.addDistribute=function(t){var e=this.editorUi.editor.graph;t.style.paddingTop="6px",t.style.paddingBottom="12px",t.appendChild(this.createTitle(mxResources.get("distribute")));var n=mxUtils.button(mxResources.get("horizontal"),function(t){e.distributeCells(!0)});return n.setAttribute("title",mxResources.get("horizontal")),n.style.width="104px",n.style.marginRight="2px",t.appendChild(n),(n=mxUtils.button(mxResources.get("vertical"),function(t){e.distributeCells(!1)})).setAttribute("title",mxResources.get("vertical")),n.style.width="104px",t.appendChild(n),t},ArrangePanel.prototype.addAngle=function(t){var e=this.editorUi,n=e.editor.graph,l=this.format.getSelectionState();t.style.paddingBottom="8px";var s=document.createElement("div");s.style.position="absolute",s.style.width="70px",s.style.marginTop="0px",s.style.fontWeight="bold";var i,o=null,a=null,r=null;return!l.rotatable||l.table||l.row||l.cell?t.style.paddingTop="8px":(mxUtils.write(s,mxResources.get("angle")),t.appendChild(s),o=this.addUnitInput(t,"°",16,52,function(){a.apply(this,arguments)}),mxUtils.br(t),t.style.paddingTop="10px"),l.containsLabel||(s=mxResources.get("reverse"),0<l.vertices.length&&0<l.edges.length?s=mxResources.get("turn")+" / "+s:0<l.vertices.length&&(s=mxResources.get("turn")),(r=mxUtils.button(s,function(t){e.actions.get("turn").funct(t)})).setAttribute("title",s+" ("+this.editorUi.actions.get("turn").shortcut+")"),r.style.width="210px",t.appendChild(r),null!=o&&(r.style.marginTop="8px")),null!=o&&(i=mxUtils.bind(this,function(t,e,n){!n&&document.activeElement==o||(l=this.format.getSelectionState(),n=parseFloat(mxUtils.getValue(l.style,mxConstants.STYLE_ROTATION,0)),o.value=isNaN(n)?"":n+"°")}),a=this.installInputHandler(o,mxConstants.STYLE_ROTATION,0,0,360,"°",null,!0),this.addKeyHandler(o,i),n.getModel().addListener(mxEvent.CHANGE,i),this.listeners.push({destroy:function(){n.getModel().removeListener(i)}}),i()),t},BaseFormatPanel.prototype.getUnit=function(){switch(this.editorUi.editor.graph.view.unit){case mxConstants.POINTS:return"pt";case mxConstants.INCHES:return'"';case mxConstants.MILLIMETERS:return"mm";case mxConstants.METERS:return"m"}},BaseFormatPanel.prototype.inUnit=function(t){return this.editorUi.editor.graph.view.formatUnitText(t)},BaseFormatPanel.prototype.fromUnit=function(t){switch(this.editorUi.editor.graph.view.unit){case mxConstants.POINTS:return t;case mxConstants.INCHES:return t*mxConstants.PIXELS_PER_INCH;case mxConstants.MILLIMETERS:return t*mxConstants.PIXELS_PER_MM;case mxConstants.METERS:return t*mxConstants.PIXELS_PER_MM*1e3}},BaseFormatPanel.prototype.isFloatUnit=function(){return this.editorUi.editor.graph.view.unit!=mxConstants.POINTS},BaseFormatPanel.prototype.getUnitStep=function(){switch(this.editorUi.editor.graph.view.unit){case mxConstants.POINTS:return 1;case mxConstants.INCHES:return.1;case mxConstants.MILLIMETERS:return.5;case mxConstants.METERS:return.001}},ArrangePanel.prototype.addGeometry=function(t){var l=this,e=this.editorUi,s=e.editor.graph,n=s.getModel(),i=this.format.getSelectionState(),o=this.createPanel();o.style.paddingBottom="8px";var a,r,d,u,m=document.createElement("div");m.style.position="absolute",m.style.width="50px",m.style.marginTop="0px",m.style.fontWeight="bold",mxUtils.write(m,mxResources.get("size")),o.appendChild(m);var c=this.addUnitInput(o,this.getUnit(),87,52,function(){a.apply(this,arguments)},this.getUnitStep(),null,null,this.isFloatUnit()),p=this.addUnitInput(o,this.getUnit(),16,52,function(){r.apply(this,arguments)},this.getUnitStep(),null,null,this.isFloatUnit()),g=document.createElement("div");g.className="geSprite geSprite-fit",g.setAttribute("title",mxResources.get("autosize")+" ("+this.editorUi.actions.get("autosize").shortcut+")"),g.style.position="relative",g.style.cursor="pointer",g.style.marginTop="-3px",g.style.border="0px",g.style.left="42px",mxUtils.setOpacity(g,50),mxEvent.addListener(g,"mouseenter",function(){mxUtils.setOpacity(g,100)}),mxEvent.addListener(g,"mouseleave",function(){mxUtils.setOpacity(g,50)}),mxEvent.addListener(g,"click",function(){e.actions.get("autosize").funct()}),o.appendChild(g),i.row?(c.style.visibility="hidden",c.nextSibling.style.visibility="hidden"):this.addLabel(o,mxResources.get("width"),87),this.addLabel(o,mxResources.get("height"),16),mxUtils.br(o);var h=document.createElement("div");h.style.paddingTop="8px",h.style.paddingRight="20px",h.style.whiteSpace="nowrap",h.style.textAlign="right";var x=this.createCellOption(mxResources.get("constrainProportions"),mxConstants.STYLE_ASPECT,null,"fixed","null");x.style.width="210px",h.appendChild(x),i.cell||i.row?g.style.visibility="hidden":o.appendChild(h);var y=x.getElementsByTagName("input")[0];this.addKeyHandler(c,void 0),this.addKeyHandler(p,void 0),a=this.addGeometryHandler(c,function(t,e,n){return s.isTableCell(n)?(s.setTableColumnWidth(n,e-t.width,!0),!0):void(0<t.width&&(e=Math.max(1,l.fromUnit(e)),y.checked&&(t.height=Math.round(t.height*e*100/t.width)/100),t.width=e))}),r=this.addGeometryHandler(p,function(t,e,n){return s.isTableCell(n)&&(n=s.model.getParent(n)),s.isTableRow(n)?(s.setTableRowHeight(n,e-t.height),!0):void(0<t.height&&(e=Math.max(1,l.fromUnit(e)),y.checked&&(t.width=Math.round(t.width*e*100/t.height)/100),t.height=e))}),(i.resizable||i.row||i.cell)&&t.appendChild(o);var C=this.createPanel();C.style.paddingBottom="30px",(m=document.createElement("div")).style.position="absolute",m.style.width="70px",m.style.marginTop="0px",m.style.fontWeight="bold",mxUtils.write(m,mxResources.get("position")),C.appendChild(m);var S=this.addUnitInput(C,this.getUnit(),87,52,function(){d.apply(this,arguments)},this.getUnitStep(),null,null,this.isFloatUnit()),E=this.addUnitInput(C,this.getUnit(),16,52,function(){u.apply(this,arguments)},this.getUnitStep(),null,null,this.isFloatUnit());mxUtils.br(C),this.addLabel(C,mxResources.get("left"),87),this.addLabel(C,mxResources.get("top"),16);var f,L=mxUtils.bind(this,function(t,e,n){(i=this.format.getSelectionState()).containsLabel||i.vertices.length!=s.getSelectionCount()||null==i.width||null==i.height?o.style.display="none":(o.style.display="",!n&&document.activeElement==c||(c.value=this.inUnit(i.width)+(""==i.width?"":" "+this.getUnit())),!n&&document.activeElement==p||(p.value=this.inUnit(i.height)+(""==i.height?"":" "+this.getUnit()))),i.vertices.length==s.getSelectionCount()&&null!=i.x&&null!=i.y?(C.style.display="",!n&&document.activeElement==S||(S.value=this.inUnit(i.x)+(""==i.x?"":" "+this.getUnit())),!n&&document.activeElement==E||(E.value=this.inUnit(i.y)+(""==i.y?"":" "+this.getUnit()))):C.style.display="none"});this.addKeyHandler(S,L),this.addKeyHandler(E,L),n.addListener(mxEvent.CHANGE,L),this.listeners.push({destroy:function(){n.removeListener(L)}}),L(),d=this.addGeometryHandler(S,function(t,e){e=l.fromUnit(e),t.relative?t.offset.x=e:t.x=e}),u=this.addGeometryHandler(E,function(t,e){e=l.fromUnit(e),t.relative?t.offset.y=e:t.y=e}),i.movable&&(0!=i.edges.length||1!=i.vertices.length||!n.isEdge(n.getParent(i.vertices[0]))||null!=(f=s.getCellGeometry(i.vertices[0]))&&f.relative&&((m=mxUtils.button(mxResources.get("center"),mxUtils.bind(this,function(t){n.beginUpdate();try{(f=f.clone()).x=0,f.y=0,f.offset=new mxPoint,n.setGeometry(i.vertices[0],f)}finally{n.endUpdate()}}))).setAttribute("title",mxResources.get("center")),m.style.width="210px",m.style.position="absolute",mxUtils.br(C),mxUtils.br(C),C.appendChild(m)),t.appendChild(C))},ArrangePanel.prototype.addGeometryHandler=function(o,a){var r=this.editorUi.editor.graph,d=null,u=this;function t(t){if(""!=o.value){var e=parseFloat(o.value);if(isNaN(e))o.value=d+" "+u.getUnit();else if(e!=d){r.getModel().beginUpdate();try{for(var n,l,s=u.format.getSelectionState().cells,i=0;i<s.length;i++)!r.getModel().isVertex(s[i])||null!=(l=r.getCellGeometry(s[i]))&&(l=l.clone(),a(l,e,s[i])||(null!=(n=r.view.getState(s[i]))&&r.isRecursiveVertexResize(n)&&r.resizeChildCells(s[i],l),r.getModel().setGeometry(s[i],l),r.constrainChildCells(s[i])))}finally{r.getModel().endUpdate()}d=e,o.value=e+" "+u.getUnit()}}mxEvent.consume(t)}return mxEvent.addListener(o,"blur",t),mxEvent.addListener(o,"change",t),mxEvent.addListener(o,"focus",function(){d=o.value}),t},ArrangePanel.prototype.addEdgeGeometryHandler=function(i,o){var a=this.editorUi.editor.graph,r=null,d=this;function t(t){if(""!=i.value){var e=parseFloat(i.value);if(isNaN(e))i.value=r+" pt";else if(e!=r){a.getModel().beginUpdate();try{for(var n,l=d.format.getSelectionState().cells,s=0;s<l.length;s++)!a.getModel().isEdge(l[s])||null!=(n=a.getCellGeometry(l[s]))&&(n=n.clone(),o(n,e),a.getModel().setGeometry(l[s],n))}finally{a.getModel().endUpdate()}r=e,i.value=e+" pt"}}mxEvent.consume(t)}return mxEvent.addListener(i,"blur",t),mxEvent.addListener(i,"change",t),mxEvent.addListener(i,"focus",function(){r=i.value}),t},ArrangePanel.prototype.addEdgeGeometry=function(t){var l=this.editorUi,i=l.editor.graph,o=this.format.getSelectionState(),a=this.createPanel(),e=document.createElement("div");e.style.position="absolute",e.style.width="70px",e.style.marginTop="0px",e.style.fontWeight="bold",mxUtils.write(e,mxResources.get("width")),a.appendChild(e);var r=this.addUnitInput(a,"pt",12,44,function(){n.apply(this,arguments)});mxUtils.br(a),this.addKeyHandler(r,void 0);var n=mxUtils.bind(this,function(t){var e,n=parseInt(r.value);(n=Math.min(999,Math.max(1,isNaN(n)?1:n)))!=mxUtils.getValue(o.style,"width",mxCellRenderer.defaultShapes.flexArrow.prototype.defaultWidth)&&(e=this.format.getSelectionState().cells,i.setCellStyles("width",n,e),l.fireEvent(new mxEventObject("styleChanged","keys",["width"],"values",[n],"cells",e))),r.value=n+" pt",mxEvent.consume(t)});mxEvent.addListener(r,"blur",n),mxEvent.addListener(r,"change",n),t.appendChild(a);var d=this.createPanel();d.style.paddingBottom="30px",(e=document.createElement("div")).style.position="absolute",e.style.width="70px",e.style.marginTop="0px",mxUtils.write(e,mxResources.get("linestart")),d.appendChild(e);var u=this.addUnitInput(d,"pt",87,52,function(){h.apply(this,arguments)}),m=this.addUnitInput(d,"pt",16,52,function(){x.apply(this,arguments)});mxUtils.br(d),this.addLabel(d,mxResources.get("left"),87),this.addLabel(d,mxResources.get("top"),16),t.appendChild(d),this.addKeyHandler(u,void 0),this.addKeyHandler(m,void 0);var c=this.createPanel();c.style.paddingBottom="30px",(e=document.createElement("div")).style.position="absolute",e.style.width="70px",e.style.marginTop="0px",mxUtils.write(e,mxResources.get("lineend")),c.appendChild(e);var p=this.addUnitInput(c,"pt",87,52,function(){y.apply(this,arguments)}),g=this.addUnitInput(c,"pt",16,52,function(){C.apply(this,arguments)});mxUtils.br(c),this.addLabel(c,mxResources.get("left"),87),this.addLabel(c,mxResources.get("top"),16),t.appendChild(c),this.addKeyHandler(p,void 0),this.addKeyHandler(g,void 0);var s=mxUtils.bind(this,function(t,e,n){var l,s=(o=this.format.getSelectionState()).cells[0];"link"==o.style.shape||"flexArrow"==o.style.shape?(a.style.display="",!n&&document.activeElement==r||(l=mxUtils.getValue(o.style,"width",mxCellRenderer.defaultShapes.flexArrow.prototype.defaultWidth),r.value=l+" pt")):a.style.display="none",1==o.cells.length&&i.model.isEdge(s)?(null!=(l=i.model.getGeometry(s)).sourcePoint&&null==i.model.getTerminal(s,!0)?(u.value=l.sourcePoint.x,m.value=l.sourcePoint.y):d.style.display="none",null!=l.targetPoint&&null==i.model.getTerminal(s,!1)?(p.value=l.targetPoint.x,g.value=l.targetPoint.y):c.style.display="none"):(d.style.display="none",c.style.display="none")}),h=this.addEdgeGeometryHandler(u,function(t,e){t.sourcePoint.x=e}),x=this.addEdgeGeometryHandler(m,function(t,e){t.sourcePoint.y=e}),y=this.addEdgeGeometryHandler(p,function(t,e){t.targetPoint.x=e}),C=this.addEdgeGeometryHandler(g,function(t,e){t.targetPoint.y=e});i.getModel().addListener(mxEvent.CHANGE,s),this.listeners.push({destroy:function(){i.getModel().removeListener(s)}}),s()},TextFormatPanel=function(t,e,n){BaseFormatPanel.call(this,t,e,n),this.init()},mxUtils.extend(TextFormatPanel,BaseFormatPanel),TextFormatPanel.prototype.init=function(){this.container.style.borderBottom="none",this.addFont(this.container)},TextFormatPanel.prototype.addFont=function(t){var a=this.editorUi,g=a.editor.graph,h=this.format.getSelectionState(),e=this.createTitle(mxResources.get("font"));e.style.paddingLeft="14px",e.style.paddingTop="10px",e.style.paddingBottom="6px",t.appendChild(e);var n=this.createPanel();n.style.paddingTop="2px",n.style.paddingBottom="2px",n.style.position="relative",n.style.marginLeft="-2px",n.style.borderWidth="0px",n.className="geToolbarContainer",g.cellEditor.isContentEditing()&&(r=n.cloneNode(),(s=this.editorUi.toolbar.addMenu(mxResources.get("style"),mxResources.get("style"),!0,"formatBlock",r,null,!0)).style.color="rgb(112, 112, 112)",s.style.whiteSpace="nowrap",s.style.overflow="hidden",s.style.margin="0px",this.addArrow(s),s.style.width="200px",s.style.height="15px",s.getElementsByTagName("div")[0].style.cssFloat="right",t.appendChild(r)),t.appendChild(n);var l=this.createPanel();l.style.marginTop="8px",l.style.borderTop="1px solid #c0c0c0",l.style.paddingTop="6px",l.style.paddingBottom="6px";var x=this.editorUi.toolbar.addMenu("Helvetica",mxResources.get("fontFamily"),!0,"fontFamily",n,null,!0);x.style.color="rgb(112, 112, 112)",x.style.whiteSpace="nowrap",x.style.overflow="hidden",x.style.margin="0px",this.addArrow(x),x.style.width="200px",x.style.height="15px";e=n.cloneNode(!1);e.style.marginLeft="-3px";var y=this.editorUi.toolbar.addItems(["bold","italic","underline"],e,!0);y[0].setAttribute("title",mxResources.get("bold")+" ("+this.editorUi.actions.get("bold").shortcut+")"),y[1].setAttribute("title",mxResources.get("italic")+" ("+this.editorUi.actions.get("italic").shortcut+")"),y[2].setAttribute("title",mxResources.get("underline")+" ("+this.editorUi.actions.get("underline").shortcut+")");var o=this.editorUi.toolbar.addItems(["vertical"],e,!0)[0];t.appendChild(e),this.styleButtons(y),this.styleButtons([o]);var s=n.cloneNode(!1);s.style.marginLeft="-3px",s.style.paddingBottom="0px";function i(t){return function(){return t()}}var r,C=this.editorUi.toolbar.addButton("geSprite-left",mxResources.get("left"),g.cellEditor.isContentEditing()?function(t){g.cellEditor.alignText(mxConstants.ALIGN_LEFT,t),a.fireEvent(new mxEventObject("styleChanged","keys",[mxConstants.STYLE_ALIGN],"values",[mxConstants.ALIGN_LEFT],"cells",h.cells))}:i(this.editorUi.menus.createStyleChangeFunction([mxConstants.STYLE_ALIGN],[mxConstants.ALIGN_LEFT])),s),S=this.editorUi.toolbar.addButton("geSprite-center",mxResources.get("center"),g.cellEditor.isContentEditing()?function(t){g.cellEditor.alignText(mxConstants.ALIGN_CENTER,t),a.fireEvent(new mxEventObject("styleChanged","keys",[mxConstants.STYLE_ALIGN],"values",[mxConstants.ALIGN_CENTER],"cells",h.cells))}:i(this.editorUi.menus.createStyleChangeFunction([mxConstants.STYLE_ALIGN],[mxConstants.ALIGN_CENTER])),s),E=this.editorUi.toolbar.addButton("geSprite-right",mxResources.get("right"),g.cellEditor.isContentEditing()?function(t){g.cellEditor.alignText(mxConstants.ALIGN_RIGHT,t),a.fireEvent(new mxEventObject("styleChanged","keys",[mxConstants.STYLE_ALIGN],"values",[mxConstants.ALIGN_RIGHT],"cells",h.cells))}:i(this.editorUi.menus.createStyleChangeFunction([mxConstants.STYLE_ALIGN],[mxConstants.ALIGN_RIGHT])),s);this.styleButtons([C,S,E]),g.cellEditor.isContentEditing()&&(r=this.editorUi.toolbar.addButton("geSprite-removeformat",mxResources.get("strikethrough"),function(){document.execCommand("strikeThrough",!1,null)},e),this.styleButtons([r]),r.firstChild.style.background="url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB3aWR0aD0iMjQiIGhlaWdodD0iMjQiIHZpZXdCb3g9IjAgMCAyNCAyNCI+PGRlZnM+PHBhdGggaWQ9ImEiIGQ9Ik0wIDBoMjR2MjRIMFYweiIvPjwvZGVmcz48Y2xpcFBhdGggaWQ9ImIiPjx1c2UgeGxpbms6aHJlZj0iI2EiIG92ZXJmbG93PSJ2aXNpYmxlIi8+PC9jbGlwUGF0aD48cGF0aCBjbGlwLXBhdGg9InVybCgjYikiIGZpbGw9IiMwMTAxMDEiIGQ9Ik03LjI0IDguNzVjLS4yNi0uNDgtLjM5LTEuMDMtLjM5LTEuNjcgMC0uNjEuMTMtMS4xNi40LTEuNjcuMjYtLjUuNjMtLjkzIDEuMTEtMS4yOS40OC0uMzUgMS4wNS0uNjMgMS43LS44My42Ni0uMTkgMS4zOS0uMjkgMi4xOC0uMjkuODEgMCAxLjU0LjExIDIuMjEuMzQuNjYuMjIgMS4yMy41NCAxLjY5Ljk0LjQ3LjQuODMuODggMS4wOCAxLjQzLjI1LjU1LjM4IDEuMTUuMzggMS44MWgtMy4wMWMwLS4zMS0uMDUtLjU5LS4xNS0uODUtLjA5LS4yNy0uMjQtLjQ5LS40NC0uNjgtLjItLjE5LS40NS0uMzMtLjc1LS40NC0uMy0uMS0uNjYtLjE2LTEuMDYtLjE2LS4zOSAwLS43NC4wNC0xLjAzLjEzLS4yOS4wOS0uNTMuMjEtLjcyLjM2LS4xOS4xNi0uMzQuMzQtLjQ0LjU1LS4xLjIxLS4xNS40My0uMTUuNjYgMCAuNDguMjUuODguNzQgMS4yMS4zOC4yNS43Ny40OCAxLjQxLjdINy4zOWMtLjA1LS4wOC0uMTEtLjE3LS4xNS0uMjV6TTIxIDEydi0ySDN2Mmg5LjYyYy4xOC4wNy40LjE0LjU1LjIuMzcuMTcuNjYuMzQuODcuNTEuMjEuMTcuMzUuMzYuNDMuNTcuMDcuMi4xMS40My4xMS42OSAwIC4yMy0uMDUuNDUtLjE0LjY2LS4wOS4yLS4yMy4zOC0uNDIuNTMtLjE5LjE1LS40Mi4yNi0uNzEuMzUtLjI5LjA4LS42My4xMy0xLjAxLjEzLS40MyAwLS44My0uMDQtMS4xOC0uMTNzLS42Ni0uMjMtLjkxLS40MmMtLjI1LS4xOS0uNDUtLjQ0LS41OS0uNzUtLjE0LS4zMS0uMjUtLjc2LS4yNS0xLjIxSDYuNGMwIC41NS4wOCAxLjEzLjI0IDEuNTguMTYuNDUuMzcuODUuNjUgMS4yMS4yOC4zNS42LjY2Ljk4LjkyLjM3LjI2Ljc4LjQ4IDEuMjIuNjUuNDQuMTcuOS4zIDEuMzguMzkuNDguMDguOTYuMTMgMS40NC4xMy44IDAgMS41My0uMDkgMi4xOC0uMjhzMS4yMS0uNDUgMS42Ny0uNzljLjQ2LS4zNC44Mi0uNzcgMS4wNy0xLjI3cy4zOC0xLjA3LjM4LTEuNzFjMC0uNi0uMS0xLjE0LS4zMS0xLjYxLS4wNS0uMTEtLjExLS4yMy0uMTctLjMzSDIxeiIvPjwvc3ZnPg==)",r.firstChild.style.backgroundPosition="2px 2px",r.firstChild.style.backgroundSize="18px 18px",this.styleButtons([r]));var f,L,T,b,v,R,I,d=this.editorUi.toolbar.addButton("geSprite-top",mxResources.get("top"),i(this.editorUi.menus.createStyleChangeFunction([mxConstants.STYLE_VERTICAL_ALIGN],[mxConstants.ALIGN_TOP])),s),u=this.editorUi.toolbar.addButton("geSprite-middle",mxResources.get("middle"),i(this.editorUi.menus.createStyleChangeFunction([mxConstants.STYLE_VERTICAL_ALIGN],[mxConstants.ALIGN_MIDDLE])),s),m=this.editorUi.toolbar.addButton("geSprite-bottom",mxResources.get("bottom"),i(this.editorUi.menus.createStyleChangeFunction([mxConstants.STYLE_VERTICAL_ALIGN],[mxConstants.ALIGN_BOTTOM])),s);this.styleButtons([d,u,m]),t.appendChild(s),g.cellEditor.isContentEditing()?(d.style.display="none",u.style.display="none",m.style.display="none",o.style.display="none",(T=this.editorUi.toolbar.addButton("geSprite-justifyfull",mxResources.get("block"),function(){1==T.style.opacity&&document.execCommand("justifyfull",!1,null)},s)).style.marginRight="9px",T.style.opacity=1,this.styleButtons([T,f=this.editorUi.toolbar.addButton("geSprite-subscript",mxResources.get("subscript")+" ("+Editor.ctrlKey+"+,)",function(){document.execCommand("subscript",!1,null)},s),L=this.editorUi.toolbar.addButton("geSprite-superscript",mxResources.get("superscript")+" ("+Editor.ctrlKey+"+.)",function(){document.execCommand("superscript",!1,null)},s)]),f.style.marginLeft="10px",(M=s.cloneNode(!1)).style.paddingTop="4px",Q=[this.editorUi.toolbar.addButton("geSprite-orderedlist",mxResources.get("numberedList"),function(){document.execCommand("insertorderedlist",!1,null)},M),this.editorUi.toolbar.addButton("geSprite-unorderedlist",mxResources.get("bulletedList"),function(){document.execCommand("insertunorderedlist",!1,null)},M),this.editorUi.toolbar.addButton("geSprite-outdent",mxResources.get("decreaseIndent"),function(){document.execCommand("outdent",!1,null)},M),this.editorUi.toolbar.addButton("geSprite-indent",mxResources.get("increaseIndent"),function(){document.execCommand("indent",!1,null)},M),this.editorUi.toolbar.addButton("geSprite-removeformat",mxResources.get("removeFormat"),function(){document.execCommand("removeformat",!1,null)},M),this.editorUi.toolbar.addButton("geSprite-code",mxResources.get("html"),function(){g.cellEditor.toggleViewMode()},M)],this.styleButtons(Q),Q[Q.length-2].style.marginLeft="10px",t.appendChild(M)):(y[2].style.marginRight="12px",E.style.marginRight="12px");s=n.cloneNode(!1);s.style.marginLeft="0px",s.style.paddingTop="8px",s.style.paddingBottom="4px",s.style.fontWeight="normal",mxUtils.write(s,mxResources.get("position"));var c=document.createElement("select");c.style.position="absolute",c.style.left="126px",c.style.width="98px",c.style.border="1px solid rgb(160, 160, 160)",c.style.borderRadius="4px",c.style.marginTop="-2px";for(var p=["topLeft","top","topRight","left","center","right","bottomLeft","bottom","bottomRight"],U={topLeft:[mxConstants.ALIGN_LEFT,mxConstants.ALIGN_TOP,mxConstants.ALIGN_RIGHT,mxConstants.ALIGN_BOTTOM],top:[mxConstants.ALIGN_CENTER,mxConstants.ALIGN_TOP,mxConstants.ALIGN_CENTER,mxConstants.ALIGN_BOTTOM],topRight:[mxConstants.ALIGN_RIGHT,mxConstants.ALIGN_TOP,mxConstants.ALIGN_LEFT,mxConstants.ALIGN_BOTTOM],left:[mxConstants.ALIGN_LEFT,mxConstants.ALIGN_MIDDLE,mxConstants.ALIGN_RIGHT,mxConstants.ALIGN_MIDDLE],center:[mxConstants.ALIGN_CENTER,mxConstants.ALIGN_MIDDLE,mxConstants.ALIGN_CENTER,mxConstants.ALIGN_MIDDLE],right:[mxConstants.ALIGN_RIGHT,mxConstants.ALIGN_MIDDLE,mxConstants.ALIGN_LEFT,mxConstants.ALIGN_MIDDLE],bottomLeft:[mxConstants.ALIGN_LEFT,mxConstants.ALIGN_BOTTOM,mxConstants.ALIGN_RIGHT,mxConstants.ALIGN_TOP],bottom:[mxConstants.ALIGN_CENTER,mxConstants.ALIGN_BOTTOM,mxConstants.ALIGN_CENTER,mxConstants.ALIGN_TOP],bottomRight:[mxConstants.ALIGN_RIGHT,mxConstants.ALIGN_BOTTOM,mxConstants.ALIGN_LEFT,mxConstants.ALIGN_TOP]},A=0;A<p.length;A++){var N=document.createElement("option");N.setAttribute("value",p[A]),mxUtils.write(N,mxResources.get(p[A])),c.appendChild(N)}s.appendChild(c);var M=n.cloneNode(!1);M.style.marginLeft="0px",M.style.paddingTop="4px",M.style.paddingBottom="4px",M.style.fontWeight="normal",mxUtils.write(M,mxResources.get("writingDirection"));var F=document.createElement("select");F.style.position="absolute",F.style.border="1px solid rgb(160, 160, 160)",F.style.left="126px",F.style.width="98px",F.style.borderRadius="4px",F.style.marginTop="-2px";for(var O=["automatic","leftToRight","rightToLeft"],_={automatic:null,leftToRight:mxConstants.TEXT_DIRECTION_LTR,rightToLeft:mxConstants.TEXT_DIRECTION_RTL},A=0;A<O.length;A++){var w=document.createElement("option");w.setAttribute("value",O[A]),mxUtils.write(w,mxResources.get(O[A])),F.appendChild(w)}M.appendChild(F),g.isEditing()||(t.appendChild(s),mxEvent.addListener(c,"change",function(t){g.getModel().beginUpdate();try{var e=U[c.value];null!=e&&(g.setCellStyles(mxConstants.STYLE_LABEL_POSITION,e[0],h.cells),g.setCellStyles(mxConstants.STYLE_VERTICAL_LABEL_POSITION,e[1],h.cells),g.setCellStyles(mxConstants.STYLE_ALIGN,e[2],h.cells),g.setCellStyles(mxConstants.STYLE_VERTICAL_ALIGN,e[3],h.cells))}finally{g.getModel().endUpdate()}mxEvent.consume(t)}),t.appendChild(M),mxEvent.addListener(F,"change",function(t){g.setCellStyles(mxConstants.STYLE_TEXT_DIRECTION,_[F.value],h.cells),mxEvent.consume(t)}));var k=document.createElement("input");k.style.position="absolute",k.style.border="1px solid rgb(160, 160, 160)",k.style.textAlign="right",k.style.marginTop="4px",k.style.left="161px",k.style.width="53px",k.style.borderRadius="4px",k.style.height="23px",k.style.boxSizing="border-box",e.appendChild(k);var D=null,M=this.installInputHandler(k,mxConstants.STYLE_FONTSIZE,Menus.prototype.defaultFontSize,1,999," pt",function(n){if(!window.getSelection||mxClient.IS_IE||mxClient.IS_IE11){if(window.getSelection||document.selection){var t=null;if(document.selection?t=document.selection.createRange().parentElement():0<(l=window.getSelection()).rangeCount&&(t=l.getRangeAt(0).commonAncestorContainer),null!=t&&function(t,e){for(;null!=e;){if(e===t)return 1;e=e.parentNode}}(g.cellEditor.textarea,t)){D=n,document.execCommand("fontSize",!1,"4");for(s=g.cellEditor.textarea.getElementsByTagName("font"),i=0;i<s.length;i++)if("4"==s[i].getAttribute("size")){s[i].removeAttribute("size"),s[i].style.fontSize=D+"px",window.setTimeout(function(){k.value=D+" pt",D=null},0);break}}}}else{var l,t=0<(l=window.getSelection()).rangeCount?l.getRangeAt(0).commonAncestorContainer:g.cellEditor.textarea;function e(t,e){null!=g.cellEditor.textarea&&t!=g.cellEditor.textarea&&g.cellEditor.textarea.contains(t)&&(e||l.containsNode(t,!0))&&("FONT"==t.nodeName?(t.removeAttribute("size"),t.style.fontSize=n+"px"):mxUtils.getCurrentStyle(t).fontSize!=n+"px"&&(mxUtils.getCurrentStyle(t.parentNode).fontSize!=n+"px"?t.style.fontSize=n+"px":t.style.fontSize="")),a.fireEvent(new mxEventObject("styleChanged","keys",[mxConstants.STYLE_FONTSIZE],"values",[n],"cells",h.cells))}if(t!=g.cellEditor.textarea&&t.nodeType==mxConstants.NODETYPE_ELEMENT||document.execCommand("fontSize",!1,"1"),null!=(t=t!=g.cellEditor.textarea?t.parentNode:t)&&t.nodeType==mxConstants.NODETYPE_ELEMENT){var s=t.getElementsByTagName("*");e(t);for(var i=0;i<s.length;i++)e(s[i])}k.value=n+" pt"}},!0),M=this.createStepper(k,M,1,10,!0,Menus.prototype.defaultFontSize);M.style.display=k.style.display,M.style.marginTop="4px",M.style.left="214px",e.appendChild(M),x.getElementsByTagName("div")[0].style.cssFloat="right";var P=null,G="#ffffff",Y=null,B="#000000",W=g.cellEditor.isContentEditing()?this.createColorOption(mxResources.get("backgroundColor"),function(){return G},function(t){document.execCommand("backcolor",!1,t!=mxConstants.NONE?t:"transparent"),a.fireEvent(new mxEventObject("styleChanged","keys",[mxConstants.STYLE_LABEL_BACKGROUNDCOLOR],"values",[t],"cells",h.cells))},"#ffffff",{install:function(t){P=t},destroy:function(){P=null}},null,!0):this.createCellColorOption(mxResources.get("backgroundColor"),mxConstants.STYLE_LABEL_BACKGROUNDCOLOR,"default",null,function(t){g.updateLabelElements(h.cells,function(t){t.style.backgroundColor=null})},g.defaultPageBackgroundColor);W.style.fontWeight="bold";var H=this.createCellColorOption(mxResources.get("borderColor"),mxConstants.STYLE_LABEL_BORDERCOLOR,"default",null,null,g.defaultForegroundColor);H.style.fontWeight="bold";e=1<=h.vertices.length?g.stylesheet.getDefaultVertexStyle():g.stylesheet.getDefaultEdgeStyle(),M=g.cellEditor.isContentEditing()?this.createColorOption(mxResources.get("fontColor"),function(){return B},function(t){if(mxClient.IS_FF){for(var e=g.cellEditor.textarea.getElementsByTagName("font"),n=[],l=0;l<e.length;l++)n.push({node:e[l],color:e[l].getAttribute("color")});document.execCommand("forecolor",!1,t!=mxConstants.NONE?t:"transparent"),a.fireEvent(new mxEventObject("styleChanged","keys",[mxConstants.STYLE_FONTCOLOR],"values",[t],"cells",h.cells));for(var s=g.cellEditor.textarea.getElementsByTagName("font"),l=0;l<s.length;l++)if(l>=n.length||s[l]!=n[l].node||s[l]==n[l].node&&s[l].getAttribute("color")!=n[l].color){var i=s[l].firstChild;if(null!=i&&"A"==i.nodeName&&null==i.nextSibling&&null!=i.firstChild){s[l].parentNode.insertBefore(i,s[l]);for(e=i.firstChild;null!=e;){var o=e.nextSibling;s[l].appendChild(e),e=o}i.appendChild(s[l])}break}}else document.execCommand("forecolor",!1,t!=mxConstants.NONE?t:"transparent"),a.fireEvent(new mxEventObject("styleChanged","keys",[mxConstants.STYLE_FONTCOLOR],"values",[t],"cells",h.cells))},null!=e[mxConstants.STYLE_FONTCOLOR]?e[mxConstants.STYLE_FONTCOLOR]:"#000000",{install:function(t){Y=t},destroy:function(){Y=null}},null,!0):this.createCellColorOption(mxResources.get("fontColor"),mxConstants.STYLE_FONTCOLOR,"default",function(t){t==mxConstants.NONE?W.style.display="none":W.style.display="",H.style.display=W.style.display},function(t){t==mxConstants.NONE?g.setCellStyles(mxConstants.STYLE_NOLABEL,"1",h.cells):g.setCellStyles(mxConstants.STYLE_NOLABEL,null,h.cells),g.setCellStyles(mxConstants.STYLE_FONTCOLOR,t,h.cells),g.updateLabelElements(h.cells,function(t){t.removeAttribute("color"),t.style.color=null})},Editor.isDarkMode()?"#ffffff":"#000000");M.style.fontWeight="bold",l.appendChild(M),l.appendChild(W),g.cellEditor.isContentEditing()||l.appendChild(H),t.appendChild(l);e=this.createPanel();e.style.paddingTop="2px",e.style.paddingBottom="4px";M=g.filterSelectionCells(mxUtils.bind(this,function(t){var e=g.view.getState(t);return null==e||this.format.isAutoSizeState(e)||g.getModel().isEdge(t)||!g.isTableRow(t)&&!g.isTableCell(t)&&!g.isCellResizable(t)})),l=this.createCellOption(mxResources.get("wordWrap"),mxConstants.STYLE_WHITE_SPACE,null,"wrap","null",null,null,!0,M);l.style.fontWeight="bold",0<M.length&&e.appendChild(l);M=this.createCellOption(mxResources.get("formattedText"),"html",0,null,null,null,a.actions.get("formattedText"));M.style.fontWeight="bold",e.appendChild(M);l=this.createPanel();l.style.paddingTop="10px",l.style.paddingBottom="28px",l.style.fontWeight="normal";M=document.createElement("div");M.style.position="absolute",M.style.width="70px",M.style.marginTop="0px",M.style.fontWeight="bold",mxUtils.write(M,mxResources.get("spacing")),l.appendChild(M);var z=this.addUnitInput(l,"pt",87,52,function(){st.apply(this,arguments)}),V=this.addUnitInput(l,"pt",16,52,function(){lt.apply(this,arguments)});mxUtils.br(l),this.addLabel(l,mxResources.get("top"),87),this.addLabel(l,mxResources.get("global"),16),mxUtils.br(l),mxUtils.br(l);var j,K,Z,X,Q,J=this.addUnitInput(l,"pt",158,52,function(){at.apply(this,arguments)}),$=this.addUnitInput(l,"pt",87,52,function(){ot.apply(this,arguments)}),q=this.addUnitInput(l,"pt",16,52,function(){it.apply(this,arguments)});function tt(t,e){t.style.backgroundImage=e?Editor.isDarkMode()?"linear-gradient(rgb(0 161 241) 0px, rgb(0, 97, 146) 100%)":"linear-gradient(#c5ecff 0px,#87d4fb 100%)":""}mxUtils.br(l),this.addLabel(l,mxResources.get("left"),158),this.addLabel(l,mxResources.get("bottom"),87),this.addLabel(l,mxResources.get("right"),16),g.cellEditor.isContentEditing()?(K=j=null,t.appendChild(this.createRelativeOption(mxResources.get("lineheight"),null,null,function(t){var e=""==t.value?120:parseInt(t.value),e=Math.max(0,isNaN(e)?120:e);null!=j&&(g.cellEditor.restoreSelection(j),j=null);for(var n=g.getSelectedElement();null!=n&&n.nodeType!=mxConstants.NODETYPE_ELEMENT;)n=n.parentNode;null!=n&&n==g.cellEditor.textarea&&null!=g.cellEditor.textarea.firstChild&&("P"!=g.cellEditor.textarea.firstChild.nodeName&&(g.cellEditor.textarea.innerHTML="<p>"+g.cellEditor.textarea.innerHTML+"</p>"),n=g.cellEditor.textarea.firstChild),null!=n&&null!=g.cellEditor.textarea&&n!=g.cellEditor.textarea&&g.cellEditor.textarea.contains(n)&&(n.style.lineHeight=e/100),t.value=e+" %"},function(t){K=t,mxEvent.addListener(t,"mousedown",function(){document.activeElement==g.cellEditor.textarea&&(j=g.cellEditor.saveSelection())}),mxEvent.addListener(t,"touchstart",function(){document.activeElement==g.cellEditor.textarea&&(j=g.cellEditor.saveSelection())}),t.value="120 %"})),"1"!=urlParams.customMenu&&((Z=n.cloneNode(!1)).style.paddingLeft="0px",X=this.editorUi.toolbar.addItems(["link","image"],Z,!0),Q=[this.editorUi.toolbar.addButton("geSprite-horizontalrule",mxResources.get("insertHorizontalRule"),function(){document.execCommand("inserthorizontalrule",!1)},Z),this.editorUi.toolbar.addMenuFunctionInContainer(Z,"geSprite-table",mxResources.get("table"),!1,mxUtils.bind(this,function(t){this.editorUi.menus.addInsertTableItem(t,null,null,!1)}))],this.styleButtons(X),this.styleButtons(Q),(X=this.createPanel()).style.paddingTop="10px",X.style.paddingBottom="10px",X.appendChild(this.createTitle(mxResources.get("insert"))),X.appendChild(Z),t.appendChild(X)),(Z=n.cloneNode(!1)).style.paddingLeft="0px",Q=[this.editorUi.toolbar.addButton("geSprite-insertcolumnbefore",mxResources.get("insertColumnBefore"),mxUtils.bind(this,function(){try{null!=v&&g.insertColumn(v,null!=R?R.cellIndex:0)}catch(t){this.editorUi.handleError(t)}}),Z),this.editorUi.toolbar.addButton("geSprite-insertcolumnafter",mxResources.get("insertColumnAfter"),mxUtils.bind(this,function(){try{null!=v&&g.insertColumn(v,null!=R?R.cellIndex+1:-1)}catch(t){this.editorUi.handleError(t)}}),Z),this.editorUi.toolbar.addButton("geSprite-deletecolumn",mxResources.get("deleteColumn"),mxUtils.bind(this,function(){try{null!=v&&null!=R&&g.deleteColumn(v,R.cellIndex)}catch(t){this.editorUi.handleError(t)}}),Z),this.editorUi.toolbar.addButton("geSprite-insertrowbefore",mxResources.get("insertRowBefore"),mxUtils.bind(this,function(){try{null!=v&&null!=I&&g.insertRow(v,I.sectionRowIndex)}catch(t){this.editorUi.handleError(t)}}),Z),this.editorUi.toolbar.addButton("geSprite-insertrowafter",mxResources.get("insertRowAfter"),mxUtils.bind(this,function(){try{null!=v&&null!=I&&g.insertRow(v,I.sectionRowIndex+1)}catch(t){this.editorUi.handleError(t)}}),Z),this.editorUi.toolbar.addButton("geSprite-deleterow",mxResources.get("deleteRow"),mxUtils.bind(this,function(){try{null!=v&&null!=I&&g.deleteRow(v,I.sectionRowIndex)}catch(t){this.editorUi.handleError(t)}}),Z)],this.styleButtons(Q),Q[2].style.marginRight="10px",(X=this.createPanel()).style.paddingTop="10px",X.style.paddingBottom="10px",X.appendChild(this.createTitle(mxResources.get("table"))),X.appendChild(Z),(n=n.cloneNode(!1)).style.paddingLeft="0px",Q=[this.editorUi.toolbar.addButton("geSprite-strokecolor",mxResources.get("borderColor"),mxUtils.bind(this,function(n){var t;null!=v&&(t=v.style.borderColor.replace(/\brgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/g,function(t,e,n,l){return"#"+("0"+Number(e).toString(16)).substr(-2)+("0"+Number(n).toString(16)).substr(-2)+("0"+Number(l).toString(16)).substr(-2)}),this.editorUi.pickColor(t,function(t){var e=null==R||null!=n&&mxEvent.isShiftDown(n)?v:R;g.processElements(e,function(t){t.style.border=null}),null==t||t==mxConstants.NONE?(e.removeAttribute("border"),e.style.border="",e.style.borderCollapse=""):(e.setAttribute("border","1"),e.style.border="1px solid "+t,e.style.borderCollapse="collapse")}))}),n),this.editorUi.toolbar.addButton("geSprite-fillcolor",mxResources.get("backgroundColor"),mxUtils.bind(this,function(n){var t;null!=v&&(t=v.style.backgroundColor.replace(/\brgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/g,function(t,e,n,l){return"#"+("0"+Number(e).toString(16)).substr(-2)+("0"+Number(n).toString(16)).substr(-2)+("0"+Number(l).toString(16)).substr(-2)}),this.editorUi.pickColor(t,function(t){var e=null==R||null!=n&&mxEvent.isShiftDown(n)?v:R;g.processElements(e,function(t){t.style.backgroundColor=null}),null==t||t==mxConstants.NONE?e.style.backgroundColor="":e.style.backgroundColor=t}))}),n),this.editorUi.toolbar.addButton("geSprite-fit",mxResources.get("spacing"),function(){var t;null!=v&&(t=v.getAttribute("cellPadding")||0,t=new FilenameDialog(a,t,mxResources.get("apply"),mxUtils.bind(this,function(t){null!=t&&0<t.length?v.setAttribute("cellPadding",t):v.removeAttribute("cellPadding")}),mxResources.get("spacing")),a.showDialog(t.container,300,80,!0,!0),t.init())},n),this.editorUi.toolbar.addButton("geSprite-left",mxResources.get("left"),function(){null!=v&&v.setAttribute("align","left")},n),this.editorUi.toolbar.addButton("geSprite-center",mxResources.get("center"),function(){null!=v&&v.setAttribute("align","center")},n),this.editorUi.toolbar.addButton("geSprite-right",mxResources.get("right"),function(){null!=v&&v.setAttribute("align","right")},n)],this.styleButtons(Q),Q[2].style.marginRight="10px",X.appendChild(n),t.appendChild(X),b=X):(t.appendChild(e),t.appendChild(this.createRelativeOption(mxResources.get("opacity"),mxConstants.STYLE_TEXT_OPACITY)),t.appendChild(l));var et,nt=mxUtils.bind(this,function(t,e,n){h=this.format.getSelectionState();var l=mxUtils.getValue(h.style,mxConstants.STYLE_FONTSTYLE,0);tt(y[0],(l&mxConstants.FONT_BOLD)==mxConstants.FONT_BOLD),tt(y[1],(l&mxConstants.FONT_ITALIC)==mxConstants.FONT_ITALIC),tt(y[2],(l&mxConstants.FONT_UNDERLINE)==mxConstants.FONT_UNDERLINE),x.firstChild.nodeValue=mxUtils.getValue(h.style,mxConstants.STYLE_FONTFAMILY,Menus.prototype.defaultFont),tt(o,"0"==mxUtils.getValue(h.style,mxConstants.STYLE_HORIZONTAL,"1")),!n&&document.activeElement==k||(i=parseFloat(mxUtils.getValue(h.style,mxConstants.STYLE_FONTSIZE,Menus.prototype.defaultFontSize)),k.value=isNaN(i)?"":i+" pt");var s=mxUtils.getValue(h.style,mxConstants.STYLE_ALIGN,mxConstants.ALIGN_CENTER);tt(C,s==mxConstants.ALIGN_LEFT),tt(S,s==mxConstants.ALIGN_CENTER),tt(E,s==mxConstants.ALIGN_RIGHT);l=mxUtils.getValue(h.style,mxConstants.STYLE_VERTICAL_ALIGN,mxConstants.ALIGN_MIDDLE);tt(d,l==mxConstants.ALIGN_TOP),tt(u,l==mxConstants.ALIGN_MIDDLE),tt(m,l==mxConstants.ALIGN_BOTTOM);s=mxUtils.getValue(h.style,mxConstants.STYLE_LABEL_POSITION,mxConstants.ALIGN_CENTER),l=mxUtils.getValue(h.style,mxConstants.STYLE_VERTICAL_LABEL_POSITION,mxConstants.ALIGN_MIDDLE);s==mxConstants.ALIGN_LEFT&&l==mxConstants.ALIGN_TOP?c.value="topLeft":s==mxConstants.ALIGN_CENTER&&l==mxConstants.ALIGN_TOP?c.value="top":s==mxConstants.ALIGN_RIGHT&&l==mxConstants.ALIGN_TOP?c.value="topRight":s==mxConstants.ALIGN_LEFT&&l==mxConstants.ALIGN_BOTTOM?c.value="bottomLeft":s==mxConstants.ALIGN_CENTER&&l==mxConstants.ALIGN_BOTTOM?c.value="bottom":s==mxConstants.ALIGN_RIGHT&&l==mxConstants.ALIGN_BOTTOM?c.value="bottomRight":s==mxConstants.ALIGN_LEFT?c.value="left":s==mxConstants.ALIGN_RIGHT?c.value="right":c.value="center";var i,s=mxUtils.getValue(h.style,mxConstants.STYLE_TEXT_DIRECTION,mxConstants.DEFAULT_TEXT_DIRECTION);s==mxConstants.TEXT_DIRECTION_RTL?F.value="rightToLeft":s==mxConstants.TEXT_DIRECTION_LTR?F.value="leftToRight":s==mxConstants.TEXT_DIRECTION_AUTO&&(F.value="automatic"),!n&&document.activeElement==V||(i=parseFloat(mxUtils.getValue(h.style,mxConstants.STYLE_SPACING,2)),V.value=isNaN(i)?"":i+" pt"),!n&&document.activeElement==z||(i=parseFloat(mxUtils.getValue(h.style,mxConstants.STYLE_SPACING_TOP,0)),z.value=isNaN(i)?"":i+" pt"),!n&&document.activeElement==q||(i=parseFloat(mxUtils.getValue(h.style,mxConstants.STYLE_SPACING_RIGHT,0)),q.value=isNaN(i)?"":i+" pt"),!n&&document.activeElement==$||(i=parseFloat(mxUtils.getValue(h.style,mxConstants.STYLE_SPACING_BOTTOM,0)),$.value=isNaN(i)?"":i+" pt"),!n&&document.activeElement==J||(i=parseFloat(mxUtils.getValue(h.style,mxConstants.STYLE_SPACING_LEFT,0)),J.value=isNaN(i)?"":i+" pt")}),lt=this.installInputHandler(V,mxConstants.STYLE_SPACING,2,-999,999," pt"),st=this.installInputHandler(z,mxConstants.STYLE_SPACING_TOP,0,-999,999," pt"),it=this.installInputHandler(q,mxConstants.STYLE_SPACING_RIGHT,0,-999,999," pt"),ot=this.installInputHandler($,mxConstants.STYLE_SPACING_BOTTOM,0,-999,999," pt"),at=this.installInputHandler(J,mxConstants.STYLE_SPACING_LEFT,0,-999,999," pt");return this.addKeyHandler(k,nt),this.addKeyHandler(V,nt),this.addKeyHandler(z,nt),this.addKeyHandler(q,nt),this.addKeyHandler($,nt),this.addKeyHandler(J,nt),g.getModel().addListener(mxEvent.CHANGE,nt),this.listeners.push({destroy:function(){g.getModel().removeListener(nt)}}),nt(),g.cellEditor.isContentEditing()&&(et=!1,l=function(){et||(et=!0,window.setTimeout(function(){var n=g.getSelectedEditingElement();if(null!=n){function t(t,e,n){if(null==n.style||null==e)return"";e=e.lineHeight;return null!=n.style.lineHeight&&"%"==n.style.lineHeight.substring(n.style.lineHeight.length-1)?parseInt(n.style.lineHeight)/100:"px"==e.substring(e.length-2)?parseFloat(e)/t:parseInt(e)}function e(t){t=null!=t?t.fontSize:null;return null!=t&&"px"==t.substring(t.length-2)?parseFloat(t):mxConstants.DEFAULT_FONTSIZE}var l,s,i=mxUtils.getCurrentStyle(n),o=e(i),a=t(o,i,n),r=n.getElementsByTagName("*");if(0<r.length&&window.getSelection&&!mxClient.IS_IE&&!mxClient.IS_IE11)for(var d,u=window.getSelection(),m=0;m<r.length;m++)u.containsNode(r[m],!0)&&(temp=mxUtils.getCurrentStyle(r[m]),(d=t(o=Math.max(e(temp),o),temp,r[m]))==a&&!isNaN(d)||(a=""));function c(t){if(null!=g.getParentByName(n,t,g.cellEditor.textarea))return!0;for(var e=n;null!=e&&1==e.childNodes.length;)if((e=e.childNodes[0]).nodeName==t)return!0;return!1}function p(t,e){if(null!=t&&null!=e){if(t==e)return!0;if(t.length>e.length+1)return t.substring(t.length-e.length-1,t.length)=="-"+e}return!1}null!=i&&(tt(y[0],"bold"==i.fontWeight||400<i.fontWeight||c("B")||c("STRONG")),tt(y[1],"italic"==i.fontStyle||c("I")||c("EM")),tt(y[2],c("U")),tt(L,c("SUP")),tt(f,c("SUB")),g.cellEditor.isTableSelected()?(tt(T,p(i.textAlign,"justify")),tt(C,p(i.textAlign,"left")),tt(S,p(i.textAlign,"center")),tt(E,p(i.textAlign,"right"))):(s=g.cellEditor.align||mxUtils.getValue(h.style,mxConstants.STYLE_ALIGN,mxConstants.ALIGN_CENTER),p(i.textAlign,"justify")?(tt(T,p(i.textAlign,"justify")),tt(C,!1),tt(S,!1),tt(E,!1)):(tt(T,!1),tt(C,s==mxConstants.ALIGN_LEFT),tt(S,s==mxConstants.ALIGN_CENTER),tt(E,s==mxConstants.ALIGN_RIGHT))),v=g.getParentByName(n,"TABLE",g.cellEditor.textarea),I=null==v?null:g.getParentByName(n,"TR",v),R=null==v?null:g.getParentByNames(n,["TD","TH"],v),b.style.display=null!=v?"":"none",document.activeElement!=k&&("FONT"==n.nodeName&&"4"==n.getAttribute("size")&&null!=D?(n.removeAttribute("size"),n.style.fontSize=D+" pt",D=null):k.value=isNaN(o)?"":o+" pt",d=parseFloat(a),isNaN(d)?K.value="100 %":K.value=Math.round(100*d)+" %"),l=i.color.replace(/\brgba?\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d+)\s*)?\)/g,function(t,e,n,l,s){return"#"+("0"+Number(e).toString(16)).substr(-2)+("0"+Number(n).toString(16)).substr(-2)+("0"+Number(l).toString(16)).substr(-2)+(null!=s?("0"+Number(s).toString(16)).substr(-2):"")}),s=i.backgroundColor.replace(/\brgba?\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d+)\s*)?\)/g,function(t,e,n,l,s){return"#"+("0"+Number(e).toString(16)).substr(-2)+("0"+Number(n).toString(16)).substr(-2)+("0"+Number(l).toString(16)).substr(-2)+(null!=s?("0"+Number(s).toString(16)).substr(-2):"")}),null!=Y&&(B="#"==l.charAt(0)?l:"#000000",Y(B,!0)),null!=P&&(G="#"==s.charAt(0)?s:null,P(G,!0)),null!=x.firstChild&&(x.firstChild.nodeValue=Graph.stripQuotes(i.fontFamily)))}et=!1},0))},(mxClient.IS_FF||mxClient.IS_EDGE||mxClient.IS_IE||mxClient.IS_IE11)&&mxEvent.addListener(g.cellEditor.textarea,"DOMSubtreeModified",l),mxEvent.addListener(g.cellEditor.textarea,"input",l),mxEvent.addListener(g.cellEditor.textarea,"touchend",l),mxEvent.addListener(g.cellEditor.textarea,"mouseup",l),mxEvent.addListener(g.cellEditor.textarea,"keyup",l),this.listeners.push({destroy:function(){}}),l()),t},StyleFormatPanel=function(t,e,n){BaseFormatPanel.call(this,t,e,n),this.init()},mxUtils.extend(StyleFormatPanel,BaseFormatPanel),StyleFormatPanel.prototype.defaultStrokeColor="black",StyleFormatPanel.prototype.init=function(){this.editorUi.editor.graph;var t=this.format.getSelectionState();!t.containsLabel&&0<t.cells.length&&(t.containsImage&&1==t.vertices.length&&"image"==t.style.shape&&null!=t.style.image&&"data:image/svg+xml;"==t.style.image.substring(0,19)&&this.container.appendChild(this.addSvgStyles(this.createPanel())),t.containsImage&&"image"!=t.style.shape||this.container.appendChild(this.addFill(this.createPanel())),this.container.appendChild(this.addStroke(this.createPanel())),this.container.appendChild(this.addLineJumps(this.createPanel())),(e=this.createRelativeOption(mxResources.get("opacity"),mxConstants.STYLE_OPACITY)).style.paddingTop="8px",e.style.paddingBottom="8px",this.container.appendChild(e),this.container.appendChild(this.addEffects(this.createPanel())));var e=this.addEditOps(this.createPanel());null!=e.firstChild&&mxUtils.br(e),this.container.appendChild(this.addStyleOps(e))},StyleFormatPanel.prototype.getCssRules=function(t){var e=document.implementation.createHTMLDocument(""),n=document.createElement("style");return mxUtils.setTextContent(n,t),e.body.appendChild(n),n.sheet.cssRules},StyleFormatPanel.prototype.addSvgStyles=function(t){this.editorUi.editor.graph;var e=this.format.getSelectionState();t.style.paddingTop="6px",t.style.paddingBottom="6px",t.style.fontWeight="bold",t.style.display="none";try{var n=e.style.editableCssRules;if(null!=n){var l=new RegExp(n),s=e.style.image.substring(e.style.image.indexOf(",")+1),i=window.atob?atob(s):Base64.decode(s,!0),o=mxUtils.parseXml(i);if(null!=o)for(var a=o.getElementsByTagName("style"),r=0;r<a.length;r++)for(var d=this.getCssRules(mxUtils.getTextContent(a[r])),u=0;u<d.length;u++)this.addSvgRule(t,d[u],o,a[r],d,u,l)}}catch(t){}return t},StyleFormatPanel.prototype.addSvgRule=function(s,t,i,o,a,r,e){var d=this.editorUi.editor.graph;e.test(t.selectorText)&&((e=mxUtils.bind(this,function(t,l,e){var n=mxUtils.trim(t.style[l]);""!=n&&"url("!=n.substring(0,4)&&(t=this.createColorOption(e+" "+t.selectorText,function(){return(t=(t=n).match(/^rgba?[\s+]?\([\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?/i))&&4===t.length?"#"+("0"+parseInt(t[1],10).toString(16)).slice(-2)+("0"+parseInt(t[2],10).toString(16)).slice(-2)+("0"+parseInt(t[3],10).toString(16)).slice(-2):"";var t},mxUtils.bind(this,function(t){a[r].style[l]=t;for(var e="",n=0;n<a.length;n++)e+=a[n].cssText+" ";o.textContent=e;t=mxUtils.getXml(i.documentElement);d.setCellStyles(mxConstants.STYLE_IMAGE,"data:image/svg+xml,"+(window.btoa?btoa(t):Base64.encode(t,!0)),this.format.getSelectionState().cells)}),"#ffffff",{install:function(t){},destroy:function(){}}),s.appendChild(t),s.style.display="")}))(t,"fill",mxResources.get("fill")),e(t,"stroke",mxResources.get("line")),e(t,"stop-color",mxResources.get("gradient")))},StyleFormatPanel.prototype.addEditOps=function(t){var e=this.format.getSelectionState(),n=null;return 1==e.cells.length&&((n=mxUtils.button(mxResources.get("editStyle"),mxUtils.bind(this,function(t){this.editorUi.actions.get("editStyle").funct()}))).setAttribute("title",mxResources.get("editStyle")+" ("+this.editorUi.actions.get("editStyle").shortcut+")"),n.style.width="210px",n.style.marginBottom="2px",t.appendChild(n)),e.image&&0<e.cells.length&&((e=mxUtils.button(mxResources.get("editImage"),mxUtils.bind(this,function(t){"1"!=urlParams.customMenu?this.editorUi.actions.get("image").funct():alert("暂时不支持编辑图片功能")}))).setAttribute("title",mxResources.get("editImage")),e.style.marginBottom="2px",null==n?e.style.width="210px":(n.style.width="104px",e.style.width="104px",e.style.marginLeft="2px"),t.appendChild(e)),t},StyleFormatPanel.prototype.addFill=function(n){var e=this.editorUi,l=e.editor.graph,s=this.format.getSelectionState();n.style.paddingTop="6px",n.style.paddingBottom="6px";var i=document.createElement("select");i.style.position="absolute",i.style.left="104px",i.style.width="70px",i.style.height="22px",i.style.padding="0px",i.style.marginTop="-3px",i.style.borderRadius="4px",i.style.border="1px solid rgb(160, 160, 160)",i.style.boxSizing="border-box";var o=i.cloneNode(!1);mxEvent.addListener(i,"click",function(t){mxEvent.consume(t)}),mxEvent.addListener(o,"click",function(t){mxEvent.consume(t)});var t=1<=s.vertices.length?l.stylesheet.getDefaultVertexStyle():l.stylesheet.getDefaultEdgeStyle(),a=this.createCellColorOption(mxResources.get("gradient"),mxConstants.STYLE_GRADIENTCOLOR,null!=t[mxConstants.STYLE_GRADIENTCOLOR]?t[mxConstants.STYLE_GRADIENTCOLOR]:"#ffffff",function(t){null==t||t==mxConstants.NONE?i.style.display="none":i.style.display=""},function(t){l.updateCellStyles(mxConstants.STYLE_GRADIENTCOLOR,t,l.getSelectionCells())}),r="image"==s.style.shape?mxConstants.STYLE_IMAGE_BACKGROUND:mxConstants.STYLE_FILLCOLOR,d="image"==s.style.shape?mxResources.get("background"):mxResources.get("fill"),t=this.createCellColorOption(d,r,"default",null,mxUtils.bind(this,function(t){l.setCellStyles(r,t,s.cells)}),l.defaultPageBackgroundColor);t.style.fontWeight="bold";d=mxUtils.getValue(s.style,r,null);a.style.display=null!=d&&d!=mxConstants.NONE&&s.fill&&"image"!=s.style.shape?"":"none";for(var u=[mxConstants.DIRECTION_NORTH,mxConstants.DIRECTION_EAST,mxConstants.DIRECTION_SOUTH,mxConstants.DIRECTION_WEST,mxConstants.DIRECTION_RADIAL],m=0;m<u.length;m++){var c=document.createElement("option");c.setAttribute("value",u[m]),mxUtils.write(c,mxResources.get(u[m])),i.appendChild(c)}a.appendChild(i);for(m=0;m<Editor.roughFillStyles.length;m++){var p=document.createElement("option");p.setAttribute("value",Editor.roughFillStyles[m].val),mxUtils.write(p,Editor.roughFillStyles[m].dispName),o.appendChild(p)}t.appendChild(o);var g=mxUtils.bind(this,function(){s=this.format.getSelectionState();var t=mxUtils.getValue(s.style,mxConstants.STYLE_GRADIENT_DIRECTION,mxConstants.DIRECTION_SOUTH),e=mxUtils.getValue(s.style,"fillStyle","auto");""==t&&(t=mxConstants.DIRECTION_SOUTH),i.value=t,o.value=e,n.style.display=s.fill?"":"none";t=mxUtils.getValue(s.style,mxConstants.STYLE_FILLCOLOR,null);!s.fill||s.containsImage||null==t||t==mxConstants.NONE||"filledEdge"==s.style.shape?(o.style.display="none",a.style.display="none"):(o.style.display="1"==s.style.sketch?"":"none",a.style.display="1"!=s.style.sketch||"solid"==e||"auto"==e?"":"none")});l.getModel().addListener(mxEvent.CHANGE,g),this.listeners.push({destroy:function(){l.getModel().removeListener(g)}}),g(),mxEvent.addListener(i,"change",function(t){l.setCellStyles(mxConstants.STYLE_GRADIENT_DIRECTION,i.value,s.cells),e.fireEvent(new mxEventObject("styleChanged","keys",[mxConstants.STYLE_GRADIENT_DIRECTION],"values",[i.value],"cells",s.cells)),mxEvent.consume(t)}),mxEvent.addListener(o,"change",function(t){l.setCellStyles("fillStyle",o.value,s.cells),e.fireEvent(new mxEventObject("styleChanged","keys",["fillStyle"],"values",[o.value],"cells",s.cells)),mxEvent.consume(t)}),n.appendChild(t),n.appendChild(a);for(var h=this.getCustomColors(),m=0;m<h.length;m++)n.appendChild(this.createCellColorOption(h[m].title,h[m].key,h[m].defaultValue));return n},StyleFormatPanel.prototype.getCustomColors=function(){var t=this.format.getSelectionState(),e=[];return"swimlane"!=t.style.shape&&"table"!=t.style.shape||e.push({title:mxResources.get("laneColor"),key:"swimlaneFillColor",defaultValue:"default"}),e},StyleFormatPanel.prototype.addStroke=function(a){var r=this.editorUi,s=r.editor.graph,d=this.format.getSelectionState();a.style.paddingTop="6px",a.style.paddingBottom="4px",a.style.whiteSpace="normal";var t=document.createElement("div");t.style.fontWeight="bold",d.stroke||(t.style.display="none");var u=document.createElement("select");u.style.position="absolute",u.style.height="22px",u.style.padding="0px",u.style.marginTop="-3px",u.style.boxSizing="border-box",u.style.left="94px",u.style.width="80px",u.style.border="1px solid rgb(160, 160, 160)",u.style.borderRadius="4px";for(var e=["sharp","rounded","curved"],n=0;n<e.length;n++){var l=document.createElement("option");l.setAttribute("value",e[n]),mxUtils.write(l,mxResources.get(e[n])),u.appendChild(l)}mxEvent.addListener(u,"change",function(t){s.getModel().beginUpdate();try{var e=[mxConstants.STYLE_ROUNDED,mxConstants.STYLE_CURVED],n=["0",null];"rounded"==u.value?n=["1",null]:"curved"==u.value&&(n=[null,"1"]);for(var l=0;l<e.length;l++)s.setCellStyles(e[l],n[l],d.cells);r.fireEvent(new mxEventObject("styleChanged","keys",e,"values",n,"cells",d.cells))}finally{s.getModel().endUpdate()}mxEvent.consume(t)}),mxEvent.addListener(u,"click",function(t){mxEvent.consume(t)});var m="image"==d.style.shape?mxConstants.STYLE_IMAGE_BORDER:mxConstants.STYLE_STROKECOLOR,i="image"==d.style.shape?mxResources.get("border"):mxResources.get("line"),o=this.createCellColorOption(i,m,"default",null,mxUtils.bind(this,function(t){s.setCellStyles(m,t,d.cells)}),Editor.isDarkMode()?"#ffffff":"#000000");o.appendChild(u),t.appendChild(o);var c=t.cloneNode(!1);c.style.fontWeight="normal",c.style.whiteSpace="nowrap",c.style.position="relative",c.style.paddingLeft="0px",c.style.marginBottom="2px",c.style.overflow="hidden",c.style.marginTop="2px",c.style.width="220px",c.className="geToolbarContainer";var p=mxUtils.bind(this,function(t,e,n,l,s){l=this.editorUi.menus.styleChange(t,"",l,s,"geIcon",null),s=document.createElement("div");return s.style.width=e+"px",s.style.height="1px",s.style.borderBottom="1px "+n+" "+this.defaultStrokeColor,s.style.paddingTop="6px",l.firstChild.firstChild.style.padding="0px 4px 0px 4px",l.firstChild.firstChild.style.width=e+"px",l.firstChild.firstChild.appendChild(s),l}),g=this.editorUi.toolbar.addMenuFunctionInContainer(c,"geSprite-orthogonal",mxResources.get("pattern"),!1,mxUtils.bind(this,function(t){p(t,75,"solid",[mxConstants.STYLE_DASHED,mxConstants.STYLE_DASH_PATTERN],[null,null]).setAttribute("title",mxResources.get("solid")),p(t,75,"dashed",[mxConstants.STYLE_DASHED,mxConstants.STYLE_DASH_PATTERN],["1",null]).setAttribute("title",mxResources.get("dashed")),p(t,75,"dotted",[mxConstants.STYLE_DASHED,mxConstants.STYLE_DASH_PATTERN],["1","1 1"]).setAttribute("title",mxResources.get("dotted")+" (1)"),p(t,75,"dotted",[mxConstants.STYLE_DASHED,mxConstants.STYLE_DASH_PATTERN],["1","1 2"]).setAttribute("title",mxResources.get("dotted")+" (2)"),p(t,75,"dotted",[mxConstants.STYLE_DASHED,mxConstants.STYLE_DASH_PATTERN],["1","1 4"]).setAttribute("title",mxResources.get("dotted")+" (3)")})),h=c.cloneNode(!1),x=this.editorUi.toolbar.addMenuFunctionInContainer(h,"geSprite-connection",mxResources.get("connection"),!1,mxUtils.bind(this,function(t){this.editorUi.menus.styleChange(t,"",[mxConstants.STYLE_SHAPE,mxConstants.STYLE_STARTSIZE,mxConstants.STYLE_ENDSIZE,"width"],[null,null,null,null],"geIcon geSprite geSprite-connection",null,!0).setAttribute("title",mxResources.get("line")),this.editorUi.menus.styleChange(t,"",[mxConstants.STYLE_SHAPE,mxConstants.STYLE_STARTSIZE,mxConstants.STYLE_ENDSIZE,"width"],["link",null,null,null],"geIcon geSprite geSprite-linkedge",null,!0).setAttribute("title",mxResources.get("link")),this.editorUi.menus.styleChange(t,"",[mxConstants.STYLE_SHAPE,mxConstants.STYLE_STARTSIZE,mxConstants.STYLE_ENDSIZE,"width"],["flexArrow",null,null,null],"geIcon geSprite geSprite-arrow",null,!0).setAttribute("title",mxResources.get("arrow")),this.editorUi.menus.styleChange(t,"",[mxConstants.STYLE_SHAPE,mxConstants.STYLE_STARTSIZE,mxConstants.STYLE_ENDSIZE,"width"],["arrow",null,null,null],"geIcon geSprite geSprite-simplearrow",null,!0).setAttribute("title",mxResources.get("simpleArrow"))})),y=this.editorUi.toolbar.addMenuFunctionInContainer(h,"geSprite-orthogonal",mxResources.get("pattern"),!1,mxUtils.bind(this,function(t){p(t,33,"solid",[mxConstants.STYLE_DASHED,mxConstants.STYLE_DASH_PATTERN],[null,null]).setAttribute("title",mxResources.get("solid")),p(t,33,"dashed",[mxConstants.STYLE_DASHED,mxConstants.STYLE_DASH_PATTERN],["1",null]).setAttribute("title",mxResources.get("dashed")),p(t,33,"dotted",[mxConstants.STYLE_DASHED,mxConstants.STYLE_DASH_PATTERN],["1","1 1"]).setAttribute("title",mxResources.get("dotted")+" (1)"),p(t,33,"dotted",[mxConstants.STYLE_DASHED,mxConstants.STYLE_DASH_PATTERN],["1","1 2"]).setAttribute("title",mxResources.get("dotted")+" (2)"),p(t,33,"dotted",[mxConstants.STYLE_DASHED,mxConstants.STYLE_DASH_PATTERN],["1","1 4"]).setAttribute("title",mxResources.get("dotted")+" (3)")})),C=c.cloneNode(!1),S=document.createElement("input");S.style.position="absolute",S.style.textAlign="right",S.style.marginTop="2px",S.style.width="52px",S.style.height="21px",S.style.left="146px",S.style.border="1px solid rgb(160, 160, 160)",S.style.borderRadius="4px",S.style.boxSizing="border-box",S.setAttribute("title",mxResources.get("linewidth")),c.appendChild(S);var E=S.cloneNode(!0);function f(t){var e=parseFloat(S.value);(e=Math.min(999,Math.max(0,isNaN(e)?1:e)))!=mxUtils.getValue(d.style,mxConstants.STYLE_STROKEWIDTH,1)&&(s.setCellStyles(mxConstants.STYLE_STROKEWIDTH,e,d.cells),r.fireEvent(new mxEventObject("styleChanged","keys",[mxConstants.STYLE_STROKEWIDTH],"values",[e],"cells",d.cells))),S.value=e+" pt",mxEvent.consume(t)}function L(t){var e=parseFloat(E.value);(e=Math.min(999,Math.max(0,isNaN(e)?1:e)))!=mxUtils.getValue(d.style,mxConstants.STYLE_STROKEWIDTH,1)&&(s.setCellStyles(mxConstants.STYLE_STROKEWIDTH,e,d.cells),r.fireEvent(new mxEventObject("styleChanged","keys",[mxConstants.STYLE_STROKEWIDTH],"values",[e],"cells",d.cells))),E.value=e+" pt",mxEvent.consume(t)}h.appendChild(E);i=this.createStepper(S,f,1,9);i.style.display=S.style.display,i.style.marginTop="2px",i.style.left="198px",c.appendChild(i);o=this.createStepper(E,L,1,9);o.style.display=E.style.display,o.style.marginTop="2px",E.style.position="absolute",o.style.left="198px",h.appendChild(o),mxEvent.addListener(S,"blur",f),mxEvent.addListener(S,"change",f),mxEvent.addListener(E,"blur",L),mxEvent.addListener(E,"change",L);var T=this.editorUi.toolbar.addMenuFunctionInContainer(C,"geSprite-orthogonal",mxResources.get("waypoints"),!1,mxUtils.bind(this,function(t){"arrow"!=d.style.shape&&(this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_EDGE,mxConstants.STYLE_CURVED,mxConstants.STYLE_NOEDGESTYLE],[null,null,null],"geIcon geSprite geSprite-straight",null,!0).setAttribute("title",mxResources.get("straight")),this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_EDGE,mxConstants.STYLE_CURVED,mxConstants.STYLE_NOEDGESTYLE],["orthogonalEdgeStyle",null,null],"geIcon geSprite geSprite-orthogonal",null,!0).setAttribute("title",mxResources.get("orthogonal")),this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_EDGE,mxConstants.STYLE_ELBOW,mxConstants.STYLE_CURVED,mxConstants.STYLE_NOEDGESTYLE],["elbowEdgeStyle",null,null,null],"geIcon geSprite geSprite-horizontalelbow",null,!0).setAttribute("title",mxResources.get("simple")),this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_EDGE,mxConstants.STYLE_ELBOW,mxConstants.STYLE_CURVED,mxConstants.STYLE_NOEDGESTYLE],["elbowEdgeStyle","vertical",null,null],"geIcon geSprite geSprite-verticalelbow",null,!0).setAttribute("title",mxResources.get("simple")),this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_EDGE,mxConstants.STYLE_ELBOW,mxConstants.STYLE_CURVED,mxConstants.STYLE_NOEDGESTYLE],["isometricEdgeStyle",null,null,null],"geIcon geSprite geSprite-horizontalisometric",null,!0).setAttribute("title",mxResources.get("isometric")),this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_EDGE,mxConstants.STYLE_ELBOW,mxConstants.STYLE_CURVED,mxConstants.STYLE_NOEDGESTYLE],["isometricEdgeStyle","vertical",null,null],"geIcon geSprite geSprite-verticalisometric",null,!0).setAttribute("title",mxResources.get("isometric")),"connector"==d.style.shape&&this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_EDGE,mxConstants.STYLE_CURVED,mxConstants.STYLE_NOEDGESTYLE],["orthogonalEdgeStyle","1",null],"geIcon geSprite geSprite-curved",null,!0).setAttribute("title",mxResources.get("curved")),this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_EDGE,mxConstants.STYLE_CURVED,mxConstants.STYLE_NOEDGESTYLE],["entityRelationEdgeStyle",null,null],"geIcon geSprite geSprite-entity",null,!0).setAttribute("title",mxResources.get("entityRelation")))})),b=this.editorUi.toolbar.addMenuFunctionInContainer(C,"geSprite-startclassic",mxResources.get("linestart"),!1,mxUtils.bind(this,function(t){var e,n;"connector"!=d.style.shape&&"flexArrow"!=d.style.shape&&"filledEdge"!=d.style.shape||((e=this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_STARTARROW,"startFill"],[mxConstants.NONE,0],"geIcon",null,!1)).setAttribute("title",mxResources.get("none")),(n=document.createElement("font")).style.fontSize="10px",mxUtils.write(n,mxResources.get("none")),e.firstChild.firstChild.appendChild(n),"connector"==d.style.shape||"filledEdge"==d.style.shape?(Format.processMenuIcon(this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_STARTARROW,"startFill"],[mxConstants.ARROW_CLASSIC,1],null,null,!1,Format.classicFilledMarkerImage.src)),Format.processMenuIcon(this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_STARTARROW,"startFill"],[mxConstants.ARROW_CLASSIC_THIN,1],null,null,!1,Format.classicThinFilledMarkerImage.src)),Format.processMenuIcon(this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_STARTARROW,"startFill"],[mxConstants.ARROW_OPEN,0],null,null,!1,Format.openFilledMarkerImage.src)),Format.processMenuIcon(this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_STARTARROW,"startFill"],[mxConstants.ARROW_OPEN_THIN,0],null,null,!1,Format.openThinFilledMarkerImage.src)),Format.processMenuIcon(this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_STARTARROW,"startFill"],["openAsync",0],null,null,!1,Format.openAsyncFilledMarkerImage.src)),Format.processMenuIcon(this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_STARTARROW,"startFill"],[mxConstants.ARROW_BLOCK,1],null,null,!1,Format.blockFilledMarkerImage.src)),Format.processMenuIcon(this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_STARTARROW,"startFill"],[mxConstants.ARROW_BLOCK_THIN,1],null,null,!1,Format.blockThinFilledMarkerImage.src)),Format.processMenuIcon(this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_STARTARROW,"startFill"],["async",1],null,null,!1,Format.asyncFilledMarkerImage.src)),Format.processMenuIcon(this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_STARTARROW,"startFill"],[mxConstants.ARROW_OVAL,1],null,null,!1,Format.ovalFilledMarkerImage.src)),Format.processMenuIcon(this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_STARTARROW,"startFill"],[mxConstants.ARROW_DIAMOND,1],null,null,!1,Format.diamondFilledMarkerImage.src)),Format.processMenuIcon(this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_STARTARROW,"startFill"],[mxConstants.ARROW_DIAMOND_THIN,1],null,null,!1,Format.diamondThinFilledMarkerImage.src)),Format.processMenuIcon(this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_STARTARROW,"startFill"],[mxConstants.ARROW_CLASSIC,0],null,null,!1,Format.classicMarkerImage.src)),Format.processMenuIcon(this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_STARTARROW,"startFill"],[mxConstants.ARROW_CLASSIC_THIN,0],null,null,!1,Format.classicThinMarkerImage.src)),Format.processMenuIcon(this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_STARTARROW,"startFill"],[mxConstants.ARROW_BLOCK,0],null,null,!1,Format.blockMarkerImage.src)),Format.processMenuIcon(this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_STARTARROW,"startFill"],[mxConstants.ARROW_BLOCK_THIN,0],null,null,!1,Format.blockThinMarkerImage.src)),Format.processMenuIcon(this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_STARTARROW,"startFill"],["async",0],null,null,!1,Format.asyncMarkerImage.src)),Format.processMenuIcon(this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_STARTARROW,"startFill"],[mxConstants.ARROW_OVAL,0],null,null,!1,Format.ovalMarkerImage.src)),Format.processMenuIcon(this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_STARTARROW,"startFill"],[mxConstants.ARROW_DIAMOND,0],null,null,!1,Format.diamondMarkerImage.src)),Format.processMenuIcon(this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_STARTARROW,"startFill"],[mxConstants.ARROW_DIAMOND_THIN,0],null,null,!1,Format.diamondThinMarkerImage.src)),Format.processMenuIcon(this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_STARTARROW,"startFill"],["box",0],null,null,!1,Format.boxMarkerImage.src)),Format.processMenuIcon(this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_STARTARROW,"startFill"],["halfCircle",0],null,null,!1,Format.halfCircleMarkerImage.src)),Format.processMenuIcon(this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_STARTARROW,"startFill"],["dash",0],null,null,!1,Format.dashMarkerImage.src)),Format.processMenuIcon(this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_STARTARROW,"startFill"],["cross",0],null,null,!1,Format.crossMarkerImage.src)),Format.processMenuIcon(this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_STARTARROW,"startFill"],["circlePlus",0],null,null,!1,Format.circlePlusMarkerImage.src)),Format.processMenuIcon(this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_STARTARROW,"startFill"],["circle",1],null,null,!1,Format.circleMarkerImage.src)),Format.processMenuIcon(this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_STARTARROW,"startFill"],["baseDash",0],null,null,!1,Format.baseDashMarkerImage.src)),Format.processMenuIcon(this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_STARTARROW,"startFill"],["ERone",0],null,null,!1,Format.EROneMarkerImage.src)),Format.processMenuIcon(this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_STARTARROW,"startFill"],["ERmandOne",0],null,null,!1,Format.ERmandOneMarkerImage.src)),Format.processMenuIcon(this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_STARTARROW,"startFill"],["ERmany",0],null,null,!1,Format.ERmanyMarkerImage.src)),Format.processMenuIcon(this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_STARTARROW,"startFill"],["ERoneToMany",0],null,null,!1,Format.ERoneToManyMarkerImage.src)),Format.processMenuIcon(this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_STARTARROW,"startFill"],["ERzeroToOne",0],null,null,!1,Format.ERzeroToOneMarkerImage.src)),Format.processMenuIcon(this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_STARTARROW,"startFill"],["ERzeroToMany",0],null,null,!1,Format.ERzeroToManyMarkerImage.src)),Format.processMenuIcon(this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_STARTARROW,"startFill"],["doubleBlock",0],null,null,!1,Format.doubleBlockMarkerImage.src)),Format.processMenuIcon(this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_STARTARROW,"startFill"],["doubleBlock",1],null,null,!1,Format.doubleBlockFilledMarkerImage.src))):this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_STARTARROW],[mxConstants.ARROW_BLOCK],"geIcon geSprite geSprite-startblocktrans",null,!1).setAttribute("title",mxResources.get("block")),t.div.style.width="40px")})),v=this.editorUi.toolbar.addMenuFunctionInContainer(C,"geSprite-endclassic",mxResources.get("lineend"),!1,mxUtils.bind(this,function(t){var e,n;"connector"!=d.style.shape&&"flexArrow"!=d.style.shape&&"filledEdge"!=d.style.shape||((e=this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_ENDARROW,"endFill"],[mxConstants.NONE,0],"geIcon",null,!1)).setAttribute("title",mxResources.get("none")),(n=document.createElement("font")).style.fontSize="10px",mxUtils.write(n,mxResources.get("none")),e.firstChild.firstChild.appendChild(n),"connector"==d.style.shape||"filledEdge"==d.style.shape?(Format.processMenuIcon(this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_ENDARROW,"endFill"],[mxConstants.ARROW_CLASSIC,1],null,null,!1,Format.classicFilledMarkerImage.src),"scaleX(-1)"),Format.processMenuIcon(this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_ENDARROW,"endFill"],[mxConstants.ARROW_CLASSIC_THIN,1],null,null,!1,Format.classicThinFilledMarkerImage.src),"scaleX(-1)"),Format.processMenuIcon(this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_ENDARROW,"endFill"],[mxConstants.ARROW_OPEN,0],null,null,!1,Format.openFilledMarkerImage.src),"scaleX(-1)"),Format.processMenuIcon(this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_ENDARROW,"endFill"],[mxConstants.ARROW_OPEN_THIN,0],null,null,!1,Format.openThinFilledMarkerImage.src),"scaleX(-1)"),Format.processMenuIcon(this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_ENDARROW,"endFill"],["openAsync",0],null,null,!1,Format.openAsyncFilledMarkerImage.src),"scaleX(-1)"),Format.processMenuIcon(this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_ENDARROW,"endFill"],[mxConstants.ARROW_BLOCK,1],null,null,!1,Format.blockFilledMarkerImage.src),"scaleX(-1)"),Format.processMenuIcon(this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_ENDARROW,"endFill"],[mxConstants.ARROW_BLOCK_THIN,1],null,null,!1,Format.blockThinFilledMarkerImage.src),"scaleX(-1)"),Format.processMenuIcon(this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_ENDARROW,"endFill"],["async",1],null,null,!1,Format.asyncFilledMarkerImage.src),"scaleX(-1)"),Format.processMenuIcon(this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_ENDARROW,"endFill"],[mxConstants.ARROW_OVAL,1],null,null,!1,Format.ovalFilledMarkerImage.src),"scaleX(-1)"),Format.processMenuIcon(this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_ENDARROW,"endFill"],[mxConstants.ARROW_DIAMOND,1],null,null,!1,Format.diamondFilledMarkerImage.src),"scaleX(-1)"),Format.processMenuIcon(this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_ENDARROW,"endFill"],[mxConstants.ARROW_DIAMOND_THIN,1],null,null,!1,Format.diamondThinFilledMarkerImage.src),"scaleX(-1)"),Format.processMenuIcon(this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_ENDARROW,"endFill"],[mxConstants.ARROW_CLASSIC,0],null,null,!1,Format.classicMarkerImage.src),"scaleX(-1)"),Format.processMenuIcon(this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_ENDARROW,"endFill"],[mxConstants.ARROW_CLASSIC_THIN,0],null,null,!1,Format.classicThinMarkerImage.src),"scaleX(-1)"),Format.processMenuIcon(this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_ENDARROW,"endFill"],[mxConstants.ARROW_BLOCK,0],null,null,!1,Format.blockMarkerImage.src),"scaleX(-1)"),Format.processMenuIcon(this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_ENDARROW,"endFill"],[mxConstants.ARROW_BLOCK_THIN,0],null,null,!1,Format.blockThinMarkerImage.src),"scaleX(-1)"),Format.processMenuIcon(this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_ENDARROW,"endFill"],["async",0],null,null,!1,Format.asyncMarkerImage.src),"scaleX(-1)"),Format.processMenuIcon(this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_ENDARROW,"endFill"],[mxConstants.ARROW_OVAL,0],null,null,!1,Format.ovalMarkerImage.src),"scaleX(-1)"),Format.processMenuIcon(this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_ENDARROW,"endFill"],[mxConstants.ARROW_DIAMOND,0],null,null,!1,Format.diamondMarkerImage.src),"scaleX(-1)"),Format.processMenuIcon(this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_ENDARROW,"endFill"],[mxConstants.ARROW_DIAMOND_THIN,0],null,null,!1,Format.diamondThinMarkerImage.src),"scaleX(-1)"),Format.processMenuIcon(this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_ENDARROW,"endFill"],["box",0],null,null,!1,Format.boxMarkerImage.src),"scaleX(-1)"),Format.processMenuIcon(this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_ENDARROW,"endFill"],["halfCircle",0],null,null,!1,Format.halfCircleMarkerImage.src),"scaleX(-1)"),Format.processMenuIcon(this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_ENDARROW,"endFill"],["dash",0],null,null,!1,Format.dashMarkerImage.src),"scaleX(-1)"),Format.processMenuIcon(this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_ENDARROW,"endFill"],["cross",0],null,null,!1,Format.crossMarkerImage.src),"scaleX(-1)"),Format.processMenuIcon(this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_ENDARROW,"endFill"],["circlePlus",0],null,null,!1,Format.circlePlusMarkerImage.src),"scaleX(-1)"),Format.processMenuIcon(this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_ENDARROW,"endFill"],["circle",0],null,null,!1,Format.circleMarkerImage.src),"scaleX(-1)"),Format.processMenuIcon(this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_ENDARROW,"endFill"],["baseDash",0],null,null,!1,Format.baseDashMarkerImage.src),"scaleX(-1)"),Format.processMenuIcon(this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_ENDARROW,"endFill"],["ERone",0],null,null,!1,Format.EROneMarkerImage.src),"scaleX(-1)"),Format.processMenuIcon(this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_ENDARROW,"endFill"],["ERmandOne",0],null,null,!1,Format.ERmandOneMarkerImage.src),"scaleX(-1)"),Format.processMenuIcon(this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_ENDARROW,"endFill"],["ERmany",0],null,null,!1,Format.ERmanyMarkerImage.src),"scaleX(-1)"),Format.processMenuIcon(this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_ENDARROW,"endFill"],["ERoneToMany",0],null,null,!1,Format.ERoneToManyMarkerImage.src),"scaleX(-1)"),Format.processMenuIcon(this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_ENDARROW,"endFill"],["ERzeroToOne",0],null,null,!1,Format.ERzeroToOneMarkerImage.src),"scaleX(-1)"),Format.processMenuIcon(this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_ENDARROW,"endFill"],["ERzeroToMany",0],null,null,!1,Format.ERzeroToManyMarkerImage.src),"scaleX(-1)"),Format.processMenuIcon(this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_ENDARROW,"endFill"],["doubleBlock",0],null,null,!1,Format.doubleBlockMarkerImage.src),"scaleX(-1)"),Format.processMenuIcon(this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_ENDARROW,"endFill"],["doubleBlock",1],null,null,!1,Format.doubleBlockFilledMarkerImage.src),"scaleX(-1)")):this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_ENDARROW],[mxConstants.ARROW_BLOCK],"geIcon geSprite geSprite-endblocktrans",null,!1).setAttribute("title",mxResources.get("block")),t.div.style.width="40px")})),i=this.addArrow(x,8);i.nextSibling.style.position="relative",i.nextSibling.style.top="-2px",(i=this.addArrow(T,10)).nextSibling.style.position="relative",i.nextSibling.style.top="-3px",T.getElementsByTagName("img")[0].style.top="-1px",this.addArrow(b),this.addArrow(v);o=this.addArrow(g,9);o.className="geIcon",o.style.width="auto";i=this.addArrow(y,9);i.className="geIcon",i.style.width="22px";var R=document.createElement("div");R.style.width="84px",R.style.height="1px",R.style.borderBottom="1px solid "+this.defaultStrokeColor,R.style.marginBottom="7px",o.appendChild(R);var I=document.createElement("div");I.style.width="23px",I.style.height="1px",I.style.borderBottom="1px solid "+this.defaultStrokeColor,I.style.marginBottom="7px",i.appendChild(I),g.style.height="15px",g.style.marginLeft="16px",y.style.height="15px",y.style.marginLeft="3px",x.style.marginLeft="10px",x.style.height="15px",T.style.marginLeft="10px",T.style.height="17px",b.style.marginLeft="3px",b.style.height="17px",v.style.marginLeft="3px",v.style.height="17px",a.appendChild(t),a.appendChild(h),a.appendChild(c);i=c.cloneNode(!1);i.style.padding="5px 4px 6px 0px",i.style.fontWeight="normal";var g=document.createElement("div");g.style.position="absolute",g.style.marginLeft="0px",g.style.marginBottom="12px",g.style.marginTop="2px",g.style.fontWeight="normal",g.style.width="76px",mxUtils.write(g,mxResources.get("lineend")),i.appendChild(g);var U=this.addUnitInput(i,"pt",98,52,function(){D.apply(this,arguments)}),A=this.addUnitInput(i,"pt",30,52,function(){k.apply(this,arguments)});mxUtils.br(i);y=document.createElement("div");y.style.height="8px",i.appendChild(y),g=g.cloneNode(!1),mxUtils.write(g,mxResources.get("linestart")),i.appendChild(g);var N=this.addUnitInput(i,"pt",98,52,function(){w.apply(this,arguments)}),M=this.addUnitInput(i,"pt",30,52,function(){_.apply(this,arguments)});mxUtils.br(i),this.addLabel(i,mxResources.get("spacing"),98,52),this.addLabel(i,mxResources.get("size"),30,52),mxUtils.br(i);t=t.cloneNode(!1);t.style.fontWeight="normal",t.style.position="relative",t.style.paddingLeft="16px",t.style.marginBottom="2px",t.style.marginTop="6px",t.style.borderWidth="0px",t.style.paddingBottom="18px",(g=document.createElement("div")).style.position="absolute",g.style.marginLeft="3px",g.style.marginBottom="12px",g.style.marginTop="1px",g.style.fontWeight="normal",g.style.width="120px",mxUtils.write(g,mxResources.get("perimeter")),t.appendChild(g);var F=this.addUnitInput(t,"pt",30,52,function(){P.apply(this,arguments)});d.edges.length==d.cells.length?(a.appendChild(C),a.appendChild(i)):d.vertices.length==d.cells.length&&a.appendChild(t);var O=mxUtils.bind(this,function(t,e,n){d=this.format.getSelectionState();mxUtils.getValue(d.style,m,null);!n&&document.activeElement==S||(i=parseFloat(mxUtils.getValue(d.style,mxConstants.STYLE_STROKEWIDTH,1)),S.value=isNaN(i)?"":i+" pt"),!n&&document.activeElement==E||(i=parseFloat(mxUtils.getValue(d.style,mxConstants.STYLE_STROKEWIDTH,1)),E.value=isNaN(i)?"":i+" pt"),u.style.visibility="connector"==d.style.shape||"filledEdge"==d.style.shape?"":"hidden","1"==mxUtils.getValue(d.style,mxConstants.STYLE_CURVED,null)?u.value="curved":"1"==mxUtils.getValue(d.style,mxConstants.STYLE_ROUNDED,null)&&(u.value="rounded"),"1"==mxUtils.getValue(d.style,mxConstants.STYLE_DASHED,null)?null==mxUtils.getValue(d.style,mxConstants.STYLE_DASH_PATTERN,null)?R.style.borderBottom="1px dashed "+this.defaultStrokeColor:R.style.borderBottom="1px dotted "+this.defaultStrokeColor:R.style.borderBottom="1px solid "+this.defaultStrokeColor,I.style.borderBottom=R.style.borderBottom;var l=T.getElementsByTagName("div")[0];null!=l&&(o=mxUtils.getValue(d.style,mxConstants.STYLE_EDGE,null),"orthogonalEdgeStyle"==(o="1"==mxUtils.getValue(d.style,mxConstants.STYLE_NOEDGESTYLE,null)?null:o)&&"1"==mxUtils.getValue(d.style,mxConstants.STYLE_CURVED,null)?l.className="geSprite geSprite-curved":l.className="straight"==o||"none"==o||null==o?"geSprite geSprite-straight":"entityRelationEdgeStyle"==o?"geSprite geSprite-entity":"elbowEdgeStyle"==o?"geSprite "+("vertical"==mxUtils.getValue(d.style,mxConstants.STYLE_ELBOW,null)?"geSprite-verticalelbow":"geSprite-horizontalelbow"):"isometricEdgeStyle"==o?"geSprite "+("vertical"==mxUtils.getValue(d.style,mxConstants.STYLE_ELBOW,null)?"geSprite-verticalisometric":"geSprite-horizontalisometric"):"geSprite geSprite-orthogonal");l=x.getElementsByTagName("div")[0];function s(t,e,n,l){n=n.getElementsByTagName("div")[0];return null!=n&&(n.className=r.getCssClassForMarker(l,d.style.shape,t,e),n.nextSibling.style.marginLeft="1px",n.nextSibling.style.paddingRight="5px","geSprite geSprite-noarrow"==n.className?(n.innerHTML=mxUtils.htmlEntities(mxResources.get("none")),n.style.backgroundImage="none",n.style.verticalAlign="top",n.style.marginTop="4px",n.style.fontSize="10px",n.style.filter="none",n.style.color=this.defaultStrokeColor,n.nextSibling.style.marginTop="0px"):(n.nextSibling.style.position="relative",n.nextSibling.style.top="-2px")),n}null!=l&&("link"==d.style.shape?l.className="geSprite geSprite-linkedge":"flexArrow"==d.style.shape?l.className="geSprite geSprite-arrow":"arrow"==d.style.shape?l.className="geSprite geSprite-simplearrow":l.className="geSprite geSprite-connection"),d.edges.length==d.cells.length?(h.style.display="",c.style.display="none"):(h.style.display="none",c.style.display=""),Graph.lineJumpsEnabled&&0<d.edges.length&&0==d.vertices.length&&d.lineJumps&&(a.style.borderBottomStyle="none");var i,o=s(mxUtils.getValue(d.style,mxConstants.STYLE_STARTARROW,null),mxUtils.getValue(d.style,"startFill","1"),b,"start"),l=s(mxUtils.getValue(d.style,mxConstants.STYLE_ENDARROW,null),mxUtils.getValue(d.style,"endFill","1"),v,"end");null!=o&&null!=l&&("arrow"==d.style.shape?(o.className="geSprite geSprite-noarrow",l.className="geSprite geSprite-endblocktrans"):"link"==d.style.shape&&(o.className="geSprite geSprite-noarrow",l.className="geSprite geSprite-noarrow")),mxUtils.setOpacity(T,"arrow"==d.style.shape?30:100),"connector"!=d.style.shape&&"flexArrow"!=d.style.shape&&"filledEdge"!=d.style.shape?(mxUtils.setOpacity(b,30),mxUtils.setOpacity(v,30)):(mxUtils.setOpacity(b,100),mxUtils.setOpacity(v,100)),!n&&document.activeElement==M||(i=parseInt(mxUtils.getValue(d.style,mxConstants.STYLE_STARTSIZE,mxConstants.DEFAULT_MARKERSIZE)),M.value=isNaN(i)?"":i+" pt"),!n&&document.activeElement==N||(i=parseInt(mxUtils.getValue(d.style,mxConstants.STYLE_SOURCE_PERIMETER_SPACING,0)),N.value=isNaN(i)?"":i+" pt"),!n&&document.activeElement==A||(i=parseInt(mxUtils.getValue(d.style,mxConstants.STYLE_ENDSIZE,mxConstants.DEFAULT_MARKERSIZE)),A.value=isNaN(i)?"":i+" pt"),!n&&document.activeElement==N||(i=parseInt(mxUtils.getValue(d.style,mxConstants.STYLE_TARGET_PERIMETER_SPACING,0)),U.value=isNaN(i)?"":i+" pt"),!n&&document.activeElement==F||(i=parseInt(mxUtils.getValue(d.style,mxConstants.STYLE_PERIMETER_SPACING,0)),F.value=isNaN(i)?"":i+" pt")}),_=this.installInputHandler(M,mxConstants.STYLE_STARTSIZE,mxConstants.DEFAULT_MARKERSIZE,0,999," pt"),w=this.installInputHandler(N,mxConstants.STYLE_SOURCE_PERIMETER_SPACING,0,-999,999," pt"),k=this.installInputHandler(A,mxConstants.STYLE_ENDSIZE,mxConstants.DEFAULT_MARKERSIZE,0,999," pt"),D=this.installInputHandler(U,mxConstants.STYLE_TARGET_PERIMETER_SPACING,0,-999,999," pt"),P=this.installInputHandler(F,mxConstants.STYLE_PERIMETER_SPACING,0,0,999," pt");return this.addKeyHandler(S,O),this.addKeyHandler(M,O),this.addKeyHandler(N,O),this.addKeyHandler(A,O),this.addKeyHandler(U,O),this.addKeyHandler(F,O),s.getModel().addListener(mxEvent.CHANGE,O),this.listeners.push({destroy:function(){s.getModel().removeListener(O)}}),O(),a},StyleFormatPanel.prototype.addLineJumps=function(t){var l=this.format.getSelectionState();if(Graph.lineJumpsEnabled&&0<l.edges.length&&0==l.vertices.length&&l.lineJumps){t.style.padding="2px 0px 24px 14px";var e=this.editorUi,n=e.editor.graph,s=document.createElement("div");s.style.position="absolute",s.style.maxWidth="82px",s.style.overflow="hidden",s.style.textOverflow="ellipsis",mxUtils.write(s,mxResources.get("lineJumps")),t.appendChild(s);var i=document.createElement("select");i.style.position="absolute",i.style.height="21px",i.style.padding="0px",i.style.marginTop="-2px",i.style.boxSizing="border-box",i.style.right="76px",i.style.width="54px",i.style.border="1px solid rgb(160, 160, 160)",i.style.borderRadius="4px";for(var o=["none","arc","gap","sharp","line"],a=0;a<o.length;a++){var r=document.createElement("option");r.setAttribute("value",o[a]),mxUtils.write(r,mxResources.get(o[a])),i.appendChild(r)}mxEvent.addListener(i,"change",function(t){n.getModel().beginUpdate();try{n.setCellStyles("jumpStyle",i.value,l.cells),e.fireEvent(new mxEventObject("styleChanged","keys",["jumpStyle"],"values",[i.value],"cells",l.cells))}finally{n.getModel().endUpdate()}mxEvent.consume(t)}),mxEvent.addListener(i,"click",function(t){mxEvent.consume(t)}),t.appendChild(i);var d=this.addUnitInput(t,"pt",16,42,function(){u.apply(this,arguments)}),u=this.installInputHandler(d,"jumpSize",Graph.defaultJumpSize,0,999," pt"),m=mxUtils.bind(this,function(t,e,n){l=this.format.getSelectionState(),i.value=mxUtils.getValue(l.style,"jumpStyle","none"),!n&&document.activeElement==d||(n=parseInt(mxUtils.getValue(l.style,"jumpSize",Graph.defaultJumpSize)),d.value=isNaN(n)?"":n+" pt")});this.addKeyHandler(d,m),n.getModel().addListener(mxEvent.CHANGE,m),this.listeners.push({destroy:function(){n.getModel().removeListener(m)}}),m()}else t.style.display="none";return t},StyleFormatPanel.prototype.addEffects=function(t){var l,e=this.editorUi.editor.graph;this.format.getSelectionState();t.style.paddingTop="4px",t.style.paddingBottom="0px";var n=document.createElement("table");n.style.width="210px",n.style.fontWeight="bold",n.style.tableLayout="fixed";var s=document.createElement("tbody"),i=document.createElement("tr");i.style.padding="0px";var o=document.createElement("td");o.style.padding="0px",o.style.width="50%",o.setAttribute("valign","top");var a=o.cloneNode(!0);a.style.paddingLeft="8px",i.appendChild(o),i.appendChild(a),s.appendChild(i),n.appendChild(s),t.appendChild(n);var r=o,d=mxUtils.bind(this,function(t,e,n){n=this.createCellOption(t,e,n);n.style.width="100%",r.appendChild(n),r=r==o?a:o,0}),u=mxUtils.bind(this,function(t,e,n){l=this.format.getSelectionState(),o.innerHTML="",a.innerHTML="",r=o,l.rounded&&d(mxResources.get("rounded"),mxConstants.STYLE_ROUNDED,0),"swimlane"==l.style.shape&&d(mxResources.get("divider"),"swimlaneLine",1),l.containsImage||d(mxResources.get("shadow"),mxConstants.STYLE_SHADOW,0),l.glass&&d(mxResources.get("glass"),mxConstants.STYLE_GLASS,0),d(mxResources.get("sketch"),"sketch",0)});return e.getModel().addListener(mxEvent.CHANGE,u),this.listeners.push({destroy:function(){e.getModel().removeListener(u)}}),u(),t},StyleFormatPanel.prototype.addStyleOps=function(t){t.style.paddingTop="10px",t.style.paddingBottom="10px";var e=mxUtils.button(mxResources.get("setAsDefaultStyle"),mxUtils.bind(this,function(t){this.editorUi.actions.get("setAsDefaultStyle").funct()}));return e.setAttribute("title",mxResources.get("setAsDefaultStyle")+" ("+this.editorUi.actions.get("setAsDefaultStyle").shortcut+")"),e.style.width="210px",t.appendChild(e),t},DiagramStylePanel=function(t,e,n){BaseFormatPanel.call(this,t,e,n),this.init()},mxUtils.extend(DiagramStylePanel,BaseFormatPanel),DiagramStylePanel.prototype.init=function(){var t=this.editorUi;t.editor.graph;this.darkModeChangedListener=mxUtils.bind(this,function(){this.format.cachedStyleEntries=[]}),t.addListener("darkModeChanged",this.darkModeChangedListener),this.container.appendChild(this.addView(this.createPanel()))},DiagramStylePanel.prototype.addView=function(t){var l=this.editorUi,d=l.editor.graph,u=d.getModel();t.style.whiteSpace="normal";var s="1"==d.currentVertexStyle.sketch&&"1"==d.currentEdgeStyle.sketch,m="1"==d.currentVertexStyle.rounded,c="1"==d.currentEdgeStyle.curved,e=document.createElement("div");e.style.paddingBottom="12px",e.style.marginRight="16px",t.style.paddingTop="8px";var n=document.createElement("table");n.style.width="210px",n.style.fontWeight="bold";var i=document.createElement("tbody"),o=document.createElement("tr");o.style.padding="0px",(T=document.createElement("td")).style.padding="0px",T.style.width="50%",T.setAttribute("valign","middle"),(b=T.cloneNode(!0)).style.paddingLeft="8px",o.appendChild(T),o.appendChild(b),i.appendChild(o),n.appendChild(i),T.appendChild(this.createOption(mxResources.get("sketch"),function(){return s},function(t){(s=t)?(d.currentEdgeStyle.sketch="1",d.currentVertexStyle.sketch="1"):(delete d.currentEdgeStyle.sketch,delete d.currentVertexStyle.sketch),d.updateCellStyles("sketch",t?"1":null,d.getVerticesAndEdges())},null,function(t){t.style.width="auto"})),b.appendChild(this.createOption(mxResources.get("rounded"),function(){return m},function(t){(m=t)?(d.currentEdgeStyle.rounded="1",d.currentVertexStyle.rounded="1"):(delete d.currentEdgeStyle.rounded,delete d.currentVertexStyle.rounded),d.updateCellStyles("rounded",t?"1":"0",d.getVerticesAndEdges())},null,function(t){t.style.width="auto"})),T=T.cloneNode(!1),b=b.cloneNode(!1),(o=o.cloneNode(!1)).appendChild(T),o.appendChild(b),i.appendChild(o),T.appendChild(this.createOption(mxResources.get("curved"),function(){return c},function(t){(c=t)?d.currentEdgeStyle.curved="1":delete d.currentEdgeStyle.curved,d.updateCellStyles("curved",t?"1":null,d.getVerticesAndEdges(!1,!0))},null,function(t){t.style.width="auto"})),e.appendChild(n),t.appendChild(e);var p=["fillColor","strokeColor","fontColor","gradientColor"],g=mxUtils.bind(this,function(t,e){var n=d.getVerticesAndEdges();u.beginUpdate();try{for(var l=0;l<n.length;l++){var s=d.getCellStyle(n[l]);null!=s.labelBackgroundColor&&d.updateCellStyles("labelBackgroundColor",null!=e?e.background:null,[n[l]]);for(var i=u.isEdge(n[l]),o=u.getStyle(n[l]),a=i?d.currentEdgeStyle:d.currentVertexStyle,r=0;r<t.length;r++)(null!=s[t[r]]&&s[t[r]]!=mxConstants.NONE||t[r]!=mxConstants.STYLE_FILLCOLOR&&t[r]!=mxConstants.STYLE_STROKECOLOR)&&(o=mxUtils.setStyle(o,t[r],a[t[r]]));u.setStyle(n[l],o)}}finally{u.endUpdate()}}),h=mxUtils.bind(this,function(t,e,n){if(null!=t)for(var l=0;l<e.length;l++)(null!=t[e[l]]&&t[e[l]]!=mxConstants.NONE||e[l]!=mxConstants.STYLE_FILLCOLOR&&e[l]!=mxConstants.STYLE_STROKECOLOR)&&(t[e[l]]=n[e[l]])}),x=mxUtils.bind(this,function(t,e,n,l,s){if(null!=t)for(var i in null!=n&&null!=e.labelBackgroundColor&&(l=null!=l?l.background:null,s=null!=s?s:d,null==(l=null==l?s.background:l)&&(l=s.defaultPageBackgroundColor),e.labelBackgroundColor=l),t)(null==n||null!=e[i]&&e[i]!=mxConstants.NONE||i!=mxConstants.STYLE_FILLCOLOR&&i!=mxConstants.STYLE_STROKECOLOR)&&(e[i]=t[i])}),e=mxUtils.button(mxResources.get("reset"),mxUtils.bind(this,function(t){var e=d.getVerticesAndEdges(!0,!0);if(0<e.length){u.beginUpdate();try{d.updateCellStyles("sketch",null,e),d.updateCellStyles("rounded",null,e),d.updateCellStyles("curved",null,d.getVerticesAndEdges(!1,!0))}finally{u.endUpdate()}}l.clearDefaultStyle()}));e.setAttribute("title",mxResources.get("reset")),e.style.textOverflow="ellipsis",e.style.maxWidth="90px",b.appendChild(e);var y=mxUtils.bind(this,function(s,i,o,a,t){var e=document.createElement("div");e.style.position="absolute",e.style.display="inline-block",e.style.overflow="hidden",e.style.pointerEvents="none",e.style.width="100%",e.style.height="100%",t.appendChild(e);var r=new Graph(e,null,null,d.getStylesheet());r.resetViewOnRootChange=!1,r.foldingEnabled=!1,r.gridEnabled=!1,r.autoScroll=!1,r.setTooltips(!1),r.setConnectable(!1),r.setPanning(!1),r.setEnabled(!1),r.getCellStyle=function(t){var e=mxUtils.clone(Graph.prototype.getCellStyle.apply(this,arguments)),n=d.stylesheet.getDefaultVertexStyle(),l=i;return u.isEdge(t)&&(n=d.stylesheet.getDefaultEdgeStyle(),l=o),h(e,p,n),x(s,e,t,a,r),x(l,e,t,a,r),e=null!=e?this.postProcessCellStyle(e):e},r.model.beginUpdate();try{var n=r.insertVertex(r.getDefaultParent(),null,"Shape",14,8,70,40,"strokeWidth=2;"),l=r.insertEdge(r.getDefaultParent(),null,"Connector",n,n,"edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;endSize=5;strokeWidth=2;");l.geometry.points=[new mxPoint(32,70)],l.geometry.offset=new mxPoint(0,8)}finally{r.model.endUpdate()}}),C=document.createElement("div");C.style.position="relative",t.appendChild(C),null==this.format.cachedStyleEntries&&(this.format.cachedStyleEntries=[]);var a=mxUtils.bind(this,function(i,o,a,r,t){var n=this.format.cachedStyleEntries[t];null==n&&((n=document.createElement("div")).style.display="inline-block",n.style.position="relative",n.style.width="96px",n.style.height="90px",n.style.cursor="pointer",n.style.border="1px solid gray",n.style.borderRadius="8px",n.style.margin="2px",n.style.overflow="hidden",null!=r&&null!=r.background&&(n.style.backgroundColor=r.background),y(i,o,a,r,n),mxEvent.addGestureListeners(n,mxUtils.bind(this,function(t){n.style.opacity=.5}),null,mxUtils.bind(this,function(t){n.style.opacity=1,d.currentVertexStyle=mxUtils.clone(d.defaultVertexStyle),d.currentEdgeStyle=mxUtils.clone(d.defaultEdgeStyle),x(i,d.currentVertexStyle),x(i,d.currentEdgeStyle),x(o,d.currentVertexStyle),x(a,d.currentEdgeStyle),s?(d.currentEdgeStyle.sketch="1",d.currentVertexStyle.sketch="1"):(d.currentEdgeStyle.sketch="0",d.currentVertexStyle.sketch="0"),d.currentVertexStyle.rounded=m?"1":"0",d.currentEdgeStyle.rounded="1",d.currentEdgeStyle.curved=c?"1":"0",u.beginUpdate();try{g(p,r);var e=new ChangePageSetup(l,null!=r?r.background:null);e.ignoreImage=!0,u.execute(e),u.execute(new ChangeGridColor(l,null!=r&&null!=r.gridColor?r.gridColor:d.view.defaultGridColor))}finally{u.endUpdate()}})),mxEvent.addListener(n,"mouseenter",mxUtils.bind(this,function(t){var s=d.getCellStyle,e=d.background,n=d.view.gridColor;d.background=null!=r?r.background:null,d.view.gridColor=null!=r&&null!=r.gridColor?r.gridColor:d.view.defaultGridColor,d.getCellStyle=function(t){var e=mxUtils.clone(s.apply(this,arguments)),n=d.stylesheet.getDefaultVertexStyle(),l=o;return u.isEdge(t)&&(n=d.stylesheet.getDefaultEdgeStyle(),l=a),h(e,p,n),x(i,e,t,r),x(l,e,t,r),e=null!=e?this.postProcessCellStyle(e):e},d.refresh(),d.getCellStyle=s,d.background=e,d.view.gridColor=n})),mxEvent.addListener(n,"mouseleave",mxUtils.bind(this,function(t){d.refresh()})),mxClient.IS_IE||mxClient.IS_IE11||(this.format.cachedStyleEntries[t]=n)),C.appendChild(n)}),r=Math.ceil(Editor.styles.length/10);this.format.currentStylePage=null!=this.format.currentStylePage?this.format.currentStylePage:0;var S=[],E=mxUtils.bind(this,function(){0<S.length&&(S[this.format.currentStylePage].style.background="#84d7ff");for(var t=10*this.format.currentStylePage;t<Math.min(10*(this.format.currentStylePage+1),Editor.styles.length);t++){var e=Editor.styles[t];a(e.commonStyle,e.vertexStyle,e.edgeStyle,e.graph,t)}}),f=mxUtils.bind(this,function(t){0<=t&&t<r&&(S[this.format.currentStylePage].style.background="transparent",C.innerHTML="",this.format.currentStylePage=t,E())});if(1<r){var L=document.createElement("div");L.style.whiteSpace="nowrap",L.style.position="relative",L.style.textAlign="center",L.style.paddingTop="4px",L.style.width="210px",t.style.paddingBottom="8px";for(var T,b,v=0;v<r;v++){var R=document.createElement("div");R.style.display="inline-block",R.style.width="6px",R.style.height="6px",R.style.marginLeft="4px",R.style.marginRight="3px",R.style.borderRadius="3px",R.style.cursor="pointer",R.style.background="transparent",R.style.border="1px solid #b5b6b7",mxUtils.bind(this,function(t,e){mxEvent.addListener(R,"click",mxUtils.bind(this,function(){f(t)}))})(v,R),L.appendChild(R),S.push(R)}function I(t){mxEvent.addListener(t,"mouseenter",function(){t.style.opacity="1"}),mxEvent.addListener(t,"mouseleave",function(){t.style.opacity="0.5"})}t.appendChild(L),E(),r<15&&((T=document.createElement("div")).style.position="absolute",T.style.left="0px",T.style.top="0px",T.style.bottom="0px",T.style.width="24px",T.style.height="24px",T.style.margin="0px",T.style.cursor="pointer",T.style.opacity="0.5",T.style.backgroundRepeat="no-repeat",T.style.backgroundPosition="center center",T.style.backgroundSize="24px 24px",T.style.backgroundImage="url("+Editor.previousImage+")",Editor.isDarkMode()&&(T.style.filter="invert(100%)"),(b=T.cloneNode(!1)).style.backgroundImage="url("+Editor.nextImage+")",b.style.left="",b.style.right="2px",L.appendChild(T),L.appendChild(b),mxEvent.addListener(T,"click",mxUtils.bind(this,function(){f(mxUtils.mod(this.format.currentStylePage-1,r))})),mxEvent.addListener(b,"click",mxUtils.bind(this,function(){f(mxUtils.mod(this.format.currentStylePage+1,r))})),I(T),I(b))}else E();return t},DiagramStylePanel.prototype.destroy=function(){BaseFormatPanel.prototype.destroy.apply(this,arguments),this.darkModeChangedListener&&(this.editorUi.removeListener(this.darkModeChangedListener),this.darkModeChangedListener=null)},DiagramFormatPanel=function(t,e,n){BaseFormatPanel.call(this,t,e,n),this.init()},mxUtils.extend(DiagramFormatPanel,BaseFormatPanel),DiagramFormatPanel.showPageView=!0,DiagramFormatPanel.prototype.showBackgroundImageOption=!0,DiagramFormatPanel.prototype.init=function(){var t=this.editorUi.editor.graph;this.container.appendChild(this.addView(this.createPanel())),t.isEnabled()&&(this.container.appendChild(this.addOptions(this.createPanel())),this.container.appendChild(this.addPaperSize(this.createPanel())),this.container.appendChild(this.addStyleOps(this.createPanel())))},DiagramFormatPanel.prototype.addView=function(t){var e,n,l=this.editorUi,s=l.editor.graph;return t.appendChild(this.createTitle(mxResources.get("view"))),this.addGridOption(t),DiagramFormatPanel.showPageView&&t.appendChild(this.createOption(mxResources.get("pageView"),function(){return s.pageVisible},function(t){l.actions.get("pageView").funct()},{install:function(t){this.listener=function(){t(s.pageVisible)},l.addListener("pageViewChanged",this.listener)},destroy:function(){l.removeListener(this.listener)}})),s.isEnabled()&&(e=this.createColorOption(mxResources.get("background"),function(){return s.background},function(t){t=new ChangePageSetup(l,t);t.ignoreImage=!0,s.model.execute(t)},"#ffffff",{install:function(t){this.listener=function(){t(s.background)},l.addListener("backgroundColorChanged",this.listener)},destroy:function(){l.removeListener(this.listener)}}),this.showBackgroundImageOption&&((n=e.getElementsByTagName("span")[0]).style.display="inline-block",n.style.textOverflow="ellipsis",n.style.overflow="hidden",n.style.maxWidth="68px",mxClient.IS_FF&&(n.style.marginTop="1px"),"1"!=urlParams.customMenu&&((n=mxUtils.button(mxResources.get("change"),function(t){l.showBackgroundImageDialog(null,l.editor.graph.backgroundImage),mxEvent.consume(t)})).className="geColorBtn",n.style.position="absolute",n.style.marginTop="-3px",n.style.height="22px",n.style.left="118px",n.style.width="56px",e.appendChild(n))),t.appendChild(e)),t},DiagramFormatPanel.prototype.addOptions=function(t){var e=this.editorUi,n=e.editor.graph;return t.appendChild(this.createTitle(mxResources.get("options"))),n.isEnabled()&&(t.appendChild(this.createOption(mxResources.get("connectionArrows"),function(){return n.connectionArrowsEnabled},function(t){e.actions.get("connectionArrows").funct()},{install:function(t){this.listener=function(){t(n.connectionArrowsEnabled)},e.addListener("connectionArrowsChanged",this.listener)},destroy:function(){e.removeListener(this.listener)}})),t.appendChild(this.createOption(mxResources.get("connectionPoints"),function(){return n.connectionHandler.isEnabled()},function(t){e.actions.get("connectionPoints").funct()},{install:function(t){this.listener=function(){t(n.connectionHandler.isEnabled())},e.addListener("connectionPointsChanged",this.listener)},destroy:function(){e.removeListener(this.listener)}})),t.appendChild(this.createOption(mxResources.get("guides"),function(){return n.graphHandler.guidesEnabled},function(t){e.actions.get("guides").funct()},{install:function(t){this.listener=function(){t(n.graphHandler.guidesEnabled)},e.addListener("guidesEnabledChanged",this.listener)},destroy:function(){e.removeListener(this.listener)}}))),t},DiagramFormatPanel.prototype.addGridOption=function(t){var n=this,l=this.editorUi,s=l.editor.graph,i=document.createElement("input");i.style.position="absolute",i.style.textAlign="right",i.style.width="48px",i.style.marginTop="-2px",i.style.height="21px",i.style.border="1px solid rgb(160, 160, 160)",i.style.borderRadius="4px",i.style.boxSizing="border-box",i.value=this.inUnit(s.getGridSize())+" "+this.getUnit();var o=this.createStepper(i,e,this.getUnitStep(),null,null,null,this.isFloatUnit());function e(t){var e=(n.isFloatUnit()?parseFloat:parseInt)(i.value);(e=n.fromUnit(Math.max(n.inUnit(1),isNaN(e)?n.inUnit(10):e)))!=s.getGridSize()&&(mxGraph.prototype.gridSize=e,s.setGridSize(e)),i.value=n.inUnit(e)+" "+n.getUnit(),mxEvent.consume(t)}i.style.display=s.isGridEnabled()?"":"none",o.style.display=i.style.display,mxEvent.addListener(i,"keydown",function(t){13==t.keyCode?(s.container.focus(),mxEvent.consume(t)):27==t.keyCode&&(i.value=s.getGridSize(),s.container.focus(),mxEvent.consume(t))}),mxEvent.addListener(i,"blur",e),mxEvent.addListener(i,"change",e),i.style.right="78px",o.style.marginTop="-17px",o.style.right="66px";var a=this.createColorOption(mxResources.get("grid"),function(){var t=s.view.gridColor;return s.isGridEnabled()?t:null},function(t){var e=s.isGridEnabled();t==mxConstants.NONE?s.setGridEnabled(!1):(s.setGridEnabled(!0),l.setGridColor(t)),i.style.display=s.isGridEnabled()?"":"none",o.style.display=i.style.display,e!=s.isGridEnabled()&&(s.defaultGridEnabled=s.isGridEnabled(),l.fireEvent(new mxEventObject("gridEnabledChanged")))},Editor.isDarkMode()?s.view.defaultDarkGridColor:s.view.defaultGridColor,{install:function(t){this.listener=function(){t(s.isGridEnabled()?s.view.gridColor:null)},l.addListener("gridColorChanged",this.listener),l.addListener("gridEnabledChanged",this.listener)},destroy:function(){l.removeListener(this.listener)}});a.appendChild(i),a.appendChild(o),t.appendChild(a)},DiagramFormatPanel.prototype.addDocumentProperties=function(t){this.editorUi.editor.graph;return t.appendChild(this.createTitle(mxResources.get("options"))),t},DiagramFormatPanel.prototype.addPaperSize=function(t){var e=this.editorUi,n=e.editor.graph;t.appendChild(this.createTitle(mxResources.get("paperSize")));var l=PageSetupDialog.addPageFormatPanel(t,"formatpanel",n.pageFormat,function(t){null!=n.pageFormat&&n.pageFormat.width==t.width&&n.pageFormat.height==t.height||((t=new ChangePageSetup(e,null,null,t)).ignoreColor=!0,t.ignoreImage=!0,n.model.execute(t))});this.addKeyHandler(l.widthInput,function(){l.set(n.pageFormat)}),this.addKeyHandler(l.heightInput,function(){l.set(n.pageFormat)});function s(){l.set(n.pageFormat)}return e.addListener("pageFormatChanged",s),this.listeners.push({destroy:function(){e.removeListener(s)}}),n.getModel().addListener(mxEvent.CHANGE,s),this.listeners.push({destroy:function(){n.getModel().removeListener(s)}}),t},DiagramFormatPanel.prototype.addStyleOps=function(t){var e=mxUtils.button(mxResources.get("editData"),mxUtils.bind(this,function(t){this.editorUi.actions.get("editData").funct()}));return e.setAttribute("title",mxResources.get("editData")+" ("+this.editorUi.actions.get("editData").shortcut+")"),e.style.width="210px",e.style.marginBottom="2px",t.appendChild(e),mxUtils.br(t),(e=mxUtils.button(mxResources.get("clearDefaultStyle"),mxUtils.bind(this,function(t){this.editorUi.actions.get("clearDefaultStyle").funct()}))).setAttribute("title",mxResources.get("clearDefaultStyle")+" ("+this.editorUi.actions.get("clearDefaultStyle").shortcut+")"),e.style.width="210px",t.appendChild(e),t},DiagramFormatPanel.prototype.destroy=function(){BaseFormatPanel.prototype.destroy.apply(this,arguments),this.gridEnabledListener&&(this.editorUi.removeListener(this.gridEnabledListener),this.gridEnabledListener=null)};