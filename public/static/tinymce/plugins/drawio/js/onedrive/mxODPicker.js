function mxODPicker(e,x,m,d,u,i,o,g,v,t,n,l,r){var s="";function b(e,t){return(t=t||document).querySelector(e)}null==x&&(x=function(i){if(null!=U)if(U.style.background="transparent",U.innerHTML="",null==i||i.folder)t(mxResources.get("noPreview"));else{w.spin(U);try{null!=i.remoteItem&&(i=i.remoteItem),function t(e,o,n){if(null==e["@microsoft.graph.downloadUrl"]){if(null!=e.parentReference)return void d(e.id,e.parentReference.driveId,function(e){t(e,o,n)},n);n()}var l=new XMLHttpRequest;l.open("GET",e["@microsoft.graph.downloadUrl"]);var r=!!e.file&&"image/png"==e.file.mimeType;l.onreadystatechange=function(){if(4==this.readyState){if(200<=this.status&&this.status<=299)try{var e=l.responseText;r&&(e="data:image/png;base64,"+Editor.base64Encode(e),e=Editor.extractGraphModelFromPng(e));var t=mxUtils.parseXml(e),i=Editor.extractGraphModel(t.documentElement);if(null!=i)return void o(i.ownerDocument)}catch(e){}n()}};r&&l.overrideMimeType&&l.overrideMimeType("text/plain; charset=x-user-defined");l.send()}(S=i,function(e){var t;S==i&&(t=e.getElementsByTagName("diagram"),f=AspectDialog.prototype.createViewer(U,0==t.length?e.documentElement:t[0],null,"transparent"),w.stop())},function(){C=null,t(mxResources.get("notADiagramFile"))})}catch(e){C=null,t(mxResources.get("notADiagramFile"))}}function t(e){var t=document.createElement("div");t.className="odPreviewStatus",mxUtils.write(t,e),U.appendChild(t),w.stop()}},s='<div style="text-align: center;" class="odPreview"></div>'),null==u&&(u=function(){var e=null;try{e=JSON.parse(localStorage.getItem("mxODPickerRecentList"))}catch(e){}return e}),null==i&&(i=function(e){var t;null!=e&&(t=u()||{},delete e["@microsoft.graph.downloadUrl"],t[e.id]=e,localStorage.setItem("mxODPickerRecentList",JSON.stringify(t)))});var a='<div class="odCatsList"><div class="odCatsListLbl">OneDrive</div><div id="odFiles" class="odCatListTitle odCatSelected">'+mxUtils.htmlEntities(mxResources.get("files"))+'</div><div id="odRecent" class="odCatListTitle">'+mxUtils.htmlEntities(mxResources.get("recent"))+'</div><div id="odShared" class="odCatListTitle">'+mxUtils.htmlEntities(mxResources.get("shared"))+'</div><div id="odSharepoint" class="odCatListTitle">'+mxUtils.htmlEntities(mxResources.get("sharepoint"))+'</div></div><div class="odFilesSec"><div class="searchBar" style="display:none"><input type="search" id="odSearchBox" placeholder="'+mxUtils.htmlEntities(mxResources.get("search"))+'"></div><div class="odFilesBreadcrumb"></div><div id="refreshOD" class="odRefreshButton"><img src="/images/update32.png" width="16" height="16" title="'+mxUtils.htmlEntities(mxResources.get("refresh"))+'Refresh" border="0"/></div><div class="odFilesList"></div></div>'+s+(t?'<div id="odBackBtn" class="odLinkBtn">&lt; '+mxUtils.htmlEntities(mxResources.get("back"))+"</div>":"")+(n?'<button id="odSubmitBtn" class="odSubmitBtn">'+mxUtils.htmlEntities(mxResources.get(v?"save":"open"))+"</button>":""),c=null!=window.Editor&&null!=Editor.isDarkMode&&Editor.isDarkMode(),p=".odCatsList {\tbox-sizing: border-box;\tposition:absolute;\ttop:0px;\tbottom:50%;\twidth:30%;\tborder: 1px solid #CCCCCC;\tborder-bottom:none;\tdisplay: inline-block;\toverflow-x: hidden;\toverflow-y: auto;}.odCatsListLbl {\theight: 17px;\tcolor: #6D6D6D;\tfont-size: 14px;\tfont-weight: bold;\tline-height: 17px;\tmargin: 10px 0 3px 5px;}.odFilesSec {\tbox-sizing: border-box;\tposition:absolute;\tleft:30%;\ttop:0px;\tbottom:50%;\twidth: 70%;\tborder: 1px solid #CCCCCC;\tborder-left:none;\tborder-bottom:none;\tdisplay: inline-block;\toverflow: hidden;}.odFilesBreadcrumb {\tbox-sizing: border-box;\tposition:absolute;\tmin-height: 32px;\tleft:0px;\tright:20px;\ttext-overflow:ellipsis;\toverflow:hidden;\tfont-size: 13px;\tcolor: #6D6D6D;\tpadding: 5px;}.odRefreshButton {\tbox-sizing: border-box;\tposition:absolute;\tright:0px;\ttop:0px;\tpadding: 4px;\tmargin: 1px;\theight:24px;\tcursor:default;}.odRefreshButton>img {\topacity:0.5;}.odRefreshButton:hover {\tbackground-color:#ddd;\tborder-radius:50%;}.odRefreshButton:active {\topacity:0.7;}.odFilesList {\tbox-sizing: border-box;\tposition:absolute;\ttop:32px;\tbottom:0px;\twidth: 100%;\toverflow-x: hidden;\toverflow-y: auto;}.odFileImg {\twidth: 24px;\tpadding-left: 5px;\tpadding-right: 5px;}.odFileTitle {\tcursor: default;\tfont-weight: normal;\tcolor: #666666 !important;\twidth: calc(100% - 20px);\twhite-space: nowrap;\toverflow: hidden;\ttext-overflow: ellipsis;}.odFileListGrid {\twidth: 100%;\twhite-space: nowrap;\tfont-size: 13px;    box-sizing: border-box;    border-spacing: 0;}.odOddRow {"+(c?"":"\tbackground-color: #eeeeee;")+"}.odEvenRow {"+(c?"":"\tbackground-color: #FFFFFF;")+"}.odRowSelected {\tbackground-color: #cadfff;}.odCatListTitle {\tbox-sizing: border-box;\theight: 17px;\tcursor: default;\tcolor: #666666;\tfont-size: 14px;\tline-height: 17px;\tmargin: 5px 0 5px 0px;    padding-left: 10px;}.odCatSelected {\tfont-weight: bold;\tbackground-color: #cadfff;}.odEmptyFolder {\theight: 17px;\tcolor: #6D6D6D;\tfont-size: 14px;\tfont-weight: bold;\tline-height: 17px;\tmargin: 10px 0 3px 5px;\twidth: 100%;    text-align: center;}.odBCFolder {\tcursor: pointer;\tcolor: #0432ff;}.odPreviewStatus {\tposition:absolute;\ttext-align:center;\twidth:100%;\ttop:50%;\ttransform: translateY(-50%);\tfont-size:13px;\topacity:0.5;}.odPreview {    position:absolute;\t overflow:hidden;\t border: 1px solid #CCCCCC;    bottom:0px;    top: 50%;    left:0px;    right:0px;}.odLinkBtn {   position: absolute;\tfont-size: 12px;\tcursor: pointer;\tcolor: #6D6D6D;\tleft: 5px;\tbottom: 3px;}.odSubmitBtn {   position: absolute;\tcolor: #333;\tright: 5px;\tbottom: 5px;}",w=new Spinner({left:"50%",lines:12,length:8,width:3,radius:5,rotate:0,color:"#000",speed:1,trail:60,shadow:!1,hwaccel:!1,className:"spinner",zIndex:2e9}),h=new Editor,f=null,C=null,E=null,y=null,R=!1,k=[],L=null,S=null;function T(){function t(e){o(C,e),i(C)}l&&null!=f?h.exportToCanvas(function(e){t(EditorUi.prototype.createImageDataUri(e,null,"png"))},400,null,null,function(e){console.log(e)},600,null,null,null,null,null,f):t()}function F(){var e=b(".odFilesBreadcrumb");if(null!=e){e.innerHTML="";for(var t,i=0;i<k.length-1;i++){var o=document.createElement("span");o.className="odBCFolder",o.innerHTML=mxUtils.htmlEntities(k[i].name||mxResources.get("home")),e.appendChild(o),function(e,t){o.addEventListener("click",function(){x(null),k=k.slice(0,t),D(e.driveId,e.folderId,e.siteId,e.name)})}(k[i],i);var n=document.createElement("span");n.innerHTML=" &gt; ",e.appendChild(n)}null!=k[k.length-1]&&((t=document.createElement("span")).innerHTML=mxUtils.htmlEntities(1==k.length?mxResources.get("officeSelDiag"):k[k.length-1].name||mxResources.get("home")),e.appendChild(t))}}function I(){var e,t,i;null==C||R||("sharepoint"==E?D("site",null,C.id,C.displayName):"site"==E?D("subsite",null,C.id,C.name):(e=C.folder,t=((C=C.remoteItem||C).parentReference?C.parentReference.driveId:null)||E,i=C.id,e?D(t,i,null,C.name):T()))}function D(p,e,t,i,o){if(!R){b(".odCatsList").style.display="block",b(".odFilesSec").style.display="block",null!=U&&(U.innerHTML="",U.style.top="50%");var r=R=!0,h=0;L=arguments;var n,d=setTimeout(function(){R=r=!1,w.stop(),g(mxResources.get("timeout"))},2e4),f=b(".odFilesList");switch(f.innerHTML="",w.spin(f),p){case"recent":k=[{name:mxResources.get("recent",null,"Recent"),driveId:p}];var l,s=u()||{},a=[];for(l in s)a.push(s[l]);return clearTimeout(d),void c(a);case"shared":n="/me/drive/sharedWithMe",k=[{name:mxResources.get("sharedWithMe",null,"Shared With Me"),driveId:p}];break;case"sharepoint":n="/sites?search=",k=[{name:mxResources.get("sharepointSites",null,"Sharepoint Sites"),driveId:p}],h=1;break;case"site":k.push({name:i,driveId:p,folderId:e,siteId:t}),n="/sites/"+t+"/drives",h=2;break;case"subsite":k.push({name:i,driveId:p,folderId:e,siteId:t}),n="/drives/"+t+(e?"/items/"+e:"/root")+"/children";break;case"search":k=[{driveId:p=E,name:mxResources.get("back",null,"Back")}],o=encodeURIComponent(o.replace(/\'/g,"\\'")),n=y?"/sites/"+y+"/drive/root/search(q='"+o+"')":p?"/drives/"+p+"/root/search(q='"+o+"')":"/me/drive/root/search(q='"+o+"')";break;default:null==e?k=[{driveId:p}]:k.push({name:i,driveId:p,folderId:e}),n=(p?"/drives/"+p:"/me/drive")+(e?"/items/"+e:"/root")+"/children"}h||(n+=(0<n.indexOf("?")?"&":"?")+"select=id,name,description,parentReference,file,createdBy,lastModifiedBy,lastModifiedDateTime,size,folder,remoteItem,@microsoft.graph.downloadUrl"),m(n,function(e){if(r){clearTimeout(d);for(var t=e.value||[],i=h?t:[],o=0;!h&&o<t.length;o++){var n=t[o],l=n.file?n.file.mimeType:null;(n.folder||"text/html"==l||"text/xml"==l||"application/xml"==l||"image/png"==l||/\.svg$/.test(n.name)||/\.html$/.test(n.name)||/\.xml$/.test(n.name)||/\.png$/.test(n.name)||/\.drawio$/.test(n.name))&&i.push(n)}c(i)}},function(e){if(r){clearTimeout(d);var t=null;try{t=JSON.parse(e.responseText).error.message}catch(e){}g(mxResources.get("errorFetchingFolder",null,"Error fetching folder items")+(null!=t?" ("+t+")":"")),R=!1,w.stop()}})}function c(e){w.stop();var t=document.createElement("table");t.className="odFileListGrid";for(var i,o=null,n=0,l=0;null!=e&&l<e.length;l++){var r,d,s,a,c,m,u=e[l];(1!=h||!u.webUrl||0<u.webUrl.indexOf("sharepoint.com/sites/")||u.webUrl.indexOf("sharepoint.com/")<0)&&(r=u.displayName||u.name,d=mxUtils.htmlEntities(u.description||r),h&&(u.folder=!0),s=null!=u.folder,v&&!s||((a=document.createElement("tr")).className=n++%2?"odOddRow":"odEvenRow",(c=document.createElement("td")).style.width="36px",(m=document.createElement("img")).src="/images/"+(s?"folder.png":"file.png"),m.className="odFileImg",c.appendChild(m),a.appendChild(c),c=document.createElement("td"),(m=document.createElement("div")).className="odFileTitle",m.innerHTML=mxUtils.htmlEntities(r),m.setAttribute("title",d),c.appendChild(m),a.appendChild(c),t.appendChild(a),null==o&&((o=a).className+=" odRowSelected",E=p,x(C=u)),function(e,t){a.addEventListener("dblclick",I),a.addEventListener("click",function(){o!=t&&(o.className=o.className.replace("odRowSelected",""),(o=t).className+=" odRowSelected",E=p,x(C=e))})}(u,a)))}0==n?((i=document.createElement("div")).className="odEmptyFolder",i.innerHTML=mxUtils.htmlEntities(mxResources.get("folderEmpty",null,"Folder is empty!")),f.appendChild(i)):f.appendChild(t),F(),R=!1}}this.getSelectedItem=function(){return null!=C&&i(C),C},null==b("#mxODPickerCss")&&(s=document.head||document.getElementsByTagName("head")[0],c=document.createElement("style"),s.appendChild(c),c.type="text/css",c.id="mxODPickerCss",c.appendChild(document.createTextNode(p))),e.innerHTML=a;var B,U=b(".odPreview"),N=b("#odFiles"),M=(a=".odCatListTitle",(B=B||document).querySelectorAll(a));function z(e){N.className=N.className.replace("odCatSelected",""),(N=e).className+=" odCatSelected"}for(var O=0;O<M.length;O++)M[O].addEventListener("click",function(){if(C=S=null,!R)switch(z(this),this.id){case"odFiles":D();break;case"odRecent":D("recent");break;case"odShared":D("shared");break;case"odSharepoint":D("sharepoint")}});var P=null;function H(e){R||D("search",P=null,null,null,e)}b("#odSearchBox").addEventListener("keyup",function(e){var t=this;null!=P&&clearTimeout(P),13==e.keyCode?H(t.value):P=setTimeout(function(){H(t.value)},500)}),b("#refreshOD").addEventListener("click",function(){null!=L&&(x(null),D.apply(this,L))}),t&&b("#odBackBtn").addEventListener("click",t),n&&b("#odSubmitBtn").addEventListener("click",T),document.body.onselectstart=function(){return!1},null!=r?(n=r.pop(),"sharepoint"==r[0].driveId&&z(b("#odSharepoint")),k=r,D(n.driveId,n.folderId,n.siteId,n.name)):D()}