!function(){var q=mxGuide.prototype.move;mxGuide.prototype.move=function(e,i,t,h){var n=i.y,s=i.x,l=!1,r=!1;if(null!=this.states&&null!=e&&null!=i){var o=this,u=new mxCellState,d=this.graph.getView().scale,x=Math.max(2,this.getGuideTolerance()/2);u.x=e.x+s,u.y=e.y+n,u.width=e.width,u.height=e.height;for(var g=[],y=[],a=0;a<this.states.length;a++){var f=this.states[a];f instanceof mxCellState&&(!h&&this.graph.isCellSelected(f.cell)||((u.x>=f.x&&u.x<=f.x+f.width||f.x>=u.x&&f.x<=u.x+u.width)&&(u.y>f.y+f.height+4||u.y+u.height+4<f.y)?g.push(f):(u.y>=f.y&&u.y<=f.y+f.height||f.y>=u.y&&f.y<=u.y+u.height)&&(u.x>f.x+f.width+4||u.x+u.width+4<f.x)&&y.push(f)))}var p=0,w=0,m=0,v=0,P=0,b=0,c=0,A=0,V=5*d;if(1<g.length){g.push(u),g.sort(function(e,i){return e.y-i.y});var G=!1,H=u==g[0],C=u==g[g.length-1];if(!H&&!C)for(a=1;a<g.length-1;a++)if(u==g[a]){var k=g[a-1],m=w=v=((L=g[a+1]).y-k.y-k.height-u.height)/2;break}for(a=0;a<g.length-1;a++){var k=g[a],E=g[a+1],S=u==k||u==E,D=E.y-k.y-k.height;if(G|=u==k,0==w&&0==p)w=D,p=1;else if(Math.abs(w-D)<=(S||1==a&&G?x:0))p+=1;else{if(1<p&&G){g=g.slice(0,a+1);break}if(!(3<=g.length-a)||G)break;m=w=(p=0)!=v?v:0,g.splice(0,0==a?1:a),a=-1}0!=m||S||(w=m=D)}3==g.length&&g[1]==u&&(m=0)}if(1<y.length){y.push(u),y.sort(function(e,i){return e.x-i.x});G=!1,H=u==y[0],C=u==y[y.length-1];if(!H&&!C)for(a=1;a<y.length-1;a++)if(u==y[a]){k=y[a-1],c=b=A=((L=y[a+1]).x-k.x-k.width-u.width)/2;break}for(a=0;a<y.length-1;a++){var k=y[a],E=y[a+1],S=u==k||u==E,I=E.x-k.x-k.width;if(G|=u==k,0==b&&0==P)b=I,P=1;else if(Math.abs(b-I)<=(S||1==a&&G?x:0))P+=1;else{if(1<P&&G){y=y.slice(0,a+1);break}if(!(3<=y.length-a)||G)break;c=b=(P=0)!=A?A:0,y.splice(0,0==a?1:a),a=-1}0!=c||S||(b=c=I)}3==y.length&&y[1]==u&&(c=0)}function O(e,i,t,h){var n=[],s=0,l=0,l=h?(s=V,0):(s=0,V);if(n.push(new mxPoint(e.x-s,e.y-l)),n.push(new mxPoint(e.x+s,e.y+l)),n.push(e),n.push(i),n.push(new mxPoint(i.x-s,i.y-l)),n.push(new mxPoint(i.x+s,i.y+l)),null!=t)return t.points=n,t;n=new mxPolyline(n,mxConstants.GUIDE_COLOR,mxConstants.GUIDE_STROKEWIDTH);return n.dialect=mxConstants.DIALECT_SVG,n.pointerEvents=!1,n.init(o.graph.getView().getOverlayPane()),n}C=function(e,i){if(e&&null!=o.guidesArrHor)for(var t=0;t<o.guidesArrHor.length;t++)o.guidesArrHor[t].node.style.visibility="hidden";if(i&&null!=o.guidesArrVer)for(t=0;t<o.guidesArrVer.length;t++)o.guidesArrVer[t].node.style.visibility="hidden"};if(1<P&&P==y.length-1){var T=[],M=o.guidesArrHor,X=[],Y=0,_=y[R=y[0]==u?1:0].y+y[R].height;if(0<c)for(a=0;a<y.length-1;a++){k=y[a],E=y[a+1];u==k?(Y=E.x-k.width-c,X.push(new mxPoint(Y+k.width+V,_)),X.push(new mxPoint(E.x-V,_))):u==E?(X.push(new mxPoint(k.x+k.width+V,_)),Y=k.x+k.width+c,X.push(new mxPoint(Y-V,_))):(X.push(new mxPoint(k.x+k.width+V,_)),X.push(new mxPoint(E.x-V,_)))}else{var k=y[0],L=y[2],Y=k.x+k.width+(L.x-k.x-k.width-u.width)/2;X.push(new mxPoint(k.x+k.width+V,_)),X.push(new mxPoint(Y-V,_)),X.push(new mxPoint(Y+u.width+V,_)),X.push(new mxPoint(L.x-V,_))}for(a=0;a<X.length;a+=2)(j=O(X[a],X[a+1],null!=M?M[a/2]:null)).node.style.visibility="visible",j.redraw(),T.push(j);for(a=X.length/2;null!=M&&a<M.length;a++)M[a].destroy();o.guidesArrHor=T,s=Y-e.x,l=!0}else C(!0);if(1<p&&p==g.length-1){var R,T=[],M=o.guidesArrVer,U=[],K=0,W=g[R=g[0]==u?1:0].x+g[R].width;if(0<m)for(a=0;a<g.length-1;a++){k=g[a],E=g[a+1];u==k?(K=E.y-k.height-m,U.push(new mxPoint(W,K+k.height+V)),U.push(new mxPoint(W,E.y-V))):u==E?(U.push(new mxPoint(W,k.y+k.height+V)),K=k.y+k.height+m,U.push(new mxPoint(W,K-V))):(U.push(new mxPoint(W,k.y+k.height+V)),U.push(new mxPoint(W,E.y-V)))}else{k=g[0],L=g[2],K=k.y+k.height+(L.y-k.y-k.height-u.height)/2;U.push(new mxPoint(W,k.y+k.height+V)),U.push(new mxPoint(W,K-V)),U.push(new mxPoint(W,K+u.height+V)),U.push(new mxPoint(W,L.y-V))}for(var j,a=0;a<U.length;a+=2)(j=O(U[a],U[a+1],null!=M?M[a/2]:null,!0)).node.style.visibility="visible",j.redraw(),T.push(j);for(a=U.length/2;null!=M&&a<M.length;a++)M[a].destroy();o.guidesArrVer=T,n=K-e.y,r=!0}else C(!1,!0)}if(l||r){s=new mxPoint(s,n),n=q.call(this,e,s,t,h);return l&&!r?s.y=n.y:r&&!l&&(s.x=n.x),n.y!=s.y&&null!=this.guideY&&null!=this.guideY.node&&(this.guideY.node.style.visibility="hidden"),n.x!=s.x&&null!=this.guideX&&null!=this.guideX.node&&(this.guideX.node.style.visibility="hidden"),s}return C(!0,!0),q.apply(this,arguments)};var n=mxGuide.prototype.setVisible;mxGuide.prototype.setVisible=function(e){n.call(this,e);var i=this.guidesArrVer,t=this.guidesArrHor;if(null!=i)for(var h=0;h<i.length;h++)i[h].node.style.visibility=e?"visible":"hidden";if(null!=t)for(h=0;h<t.length;h++)t[h].node.style.visibility=e?"visible":"hidden"};var h=mxGuide.prototype.destroy;mxGuide.prototype.destroy=function(){h.call(this);var e=this.guidesArrVer,i=this.guidesArrHor;if(null!=e){for(var t=0;t<e.length;t++)e[t].destroy();this.guidesArrVer=null}if(null!=i){for(t=0;t<i.length;t++)i[t].destroy();this.guidesArrHor=null}}}();