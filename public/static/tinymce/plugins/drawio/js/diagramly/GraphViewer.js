GraphViewer=function(t,e,i){this.init(t,e,i)},mxUtils.extend(GraphViewer,mxEventSource),GraphViewer.prototype.editBlankUrl="https://app.diagrams.net/",GraphViewer.prototype.imageBaseUrl="https://viewer.diagrams.net/",GraphViewer.prototype.toolbarHeight="BackCompat"==document.compatMode?24:26,GraphViewer.prototype.lightboxChrome=!0,GraphViewer.prototype.lightboxZIndex=999,GraphViewer.prototype.toolbarZIndex=999,GraphViewer.prototype.autoFit=!1,GraphViewer.prototype.autoCrop=!1,GraphViewer.prototype.autoOrigin=!0,GraphViewer.prototype.center=!1,GraphViewer.prototype.forceCenter=!1,GraphViewer.prototype.allowZoomIn=!1,GraphViewer.prototype.allowZoomOut=!0,GraphViewer.prototype.showTitleAsTooltip=!1,GraphViewer.prototype.checkVisibleState=!0,GraphViewer.prototype.minHeight=28,GraphViewer.prototype.minWidth=100,GraphViewer.prototype.responsive=!1,GraphViewer.prototype.init=function(d,p,t){this.graphConfig=null!=t?t:{},this.autoFit=null!=this.graphConfig["auto-fit"]?this.graphConfig["auto-fit"]:this.autoFit,this.autoCrop=null!=this.graphConfig["auto-crop"]?this.graphConfig["auto-crop"]:this.autoCrop,this.autoOrigin=null!=this.graphConfig["auto-origin"]?this.graphConfig["auto-origin"]:this.autoOrigin,this.allowZoomOut=null!=this.graphConfig["allow-zoom-out"]?this.graphConfig["allow-zoom-out"]:this.allowZoomOut,this.allowZoomIn=null!=this.graphConfig["allow-zoom-in"]?this.graphConfig["allow-zoom-in"]:this.allowZoomIn,this.forceCenter=(null!=this.graphConfig.forceCenter?this.graphConfig:this).forceCenter,this.center=null!=this.graphConfig.center?this.graphConfig.center:this.center||this.forceCenter,this.checkVisibleState=null!=this.graphConfig["check-visible-state"]?this.graphConfig["check-visible-state"]:this.checkVisibleState,this.toolbarItems=null!=this.graphConfig.toolbar?this.graphConfig.toolbar.split(" "):[],this.zoomEnabled=0<=mxUtils.indexOf(this.toolbarItems,"zoom"),this.layersEnabled=0<=mxUtils.indexOf(this.toolbarItems,"layers"),this.tagsEnabled=0<=mxUtils.indexOf(this.toolbarItems,"tags"),this.lightboxEnabled=0<=mxUtils.indexOf(this.toolbarItems,"lightbox"),this.lightboxClickEnabled=0!=this.graphConfig.lightbox,this.initialWidth=null!=d?d.style.width:null,this.widthIsEmpty=null==this.initialWidth||""==this.initialWidth,this.currentPage=parseInt(this.graphConfig.page)||0,this.responsive=(null!=this.graphConfig.responsive?this.graphConfig:this).responsive&&!this.zoomEnabled&&!mxClient.NO_FO&&!mxClient.IS_SF,this.pageId=this.graphConfig.pageId,this.editor=null;var e,i,o;"inline"==this.graphConfig["toolbar-position"]&&(this.minHeight+=this.toolbarHeight),null!=p&&(this.xmlDocument=p.ownerDocument,this.xmlNode=p,this.xml=mxUtils.getXml(p),null!=d&&(e=mxUtils.bind(this,function(){var i;this.graph=new Graph(d),this.graph.enableFlowAnimation=!0,this.graph.defaultPageBackgroundColor="transparent",this.graph.transparentBackground=!1,this.responsive&&this.graph.dialect==mxConstants.DIALECT_SVG&&(i=this.graph.view.getDrawPane().ownerSVGElement,this.graph.view.getCanvas(),null!=this.graphConfig.border?i.style.padding=this.graphConfig.border+"px":""==d.style.padding&&(i.style.padding="8px"),i.style.boxSizing="border-box",i.style.overflow="visible",this.graph.fit=function(){},this.graph.sizeDidChange=function(){var t=this.view.graphBounds,e=this.view.translate;i.setAttribute("viewBox",t.x+e.x-this.panDx+" "+(t.y+e.y-this.panDy)+" "+(t.width+1)+" "+(t.height+1)),this.container.style.backgroundColor=i.style.backgroundColor,this.fireEvent(new mxEventObject(mxEvent.SIZE,"bounds",t))}),this.graphConfig.move&&(this.graph.isMoveCellsEvent=function(t){return!0}),this.lightboxClickEnabled&&(d.style.cursor="pointer"),this.editor=new Editor(!0,null,null,this.graph),this.editor.editBlankUrl=this.editBlankUrl,this.graph.lightbox=!0,this.graph.centerZoom=!1,this.graph.autoExtend=!1,this.graph.autoScroll=!1,this.graph.setEnabled(!1),1==this.graphConfig["toolbar-nohide"]&&(this.editor.defaultGraphOverflow="visible"),this.xmlNode=this.editor.extractGraphModel(this.xmlNode,!0),this.xmlNode!=p&&(this.xml=mxUtils.getXml(this.xmlNode),this.xmlDocument=this.xmlNode.ownerDocument);var o=this;if(this.graph.getImageFromBundles=function(t){return o.getImageUrl(t)},mxClient.IS_SVG&&this.graph.addSvgShadow(this.graph.view.canvas.ownerSVGElement,null,!0),"mxfile"==this.xmlNode.nodeName){var n=this.xmlNode.getElementsByTagName("diagram");if(0<n.length){if(null!=this.pageId)for(var t=0;t<n.length;t++)if(this.pageId==n[t].getAttribute("id")){this.currentPage=t;break}var r=this.graph.getGlobalVariable,o=this;this.graph.getGlobalVariable=function(t){var e=n[o.currentPage];return"page"==t?e.getAttribute("name")||"Page-"+(o.currentPage+1):"pagenumber"==t?o.currentPage+1:"pagecount"==t?n.length:r.apply(this,arguments)}}}this.diagrams=[];var e=null;this.selectPage=function(t){this.handlingResize||(this.currentPage=mxUtils.mod(t,this.diagrams.length),this.updateGraphXml(Editor.parseDiagramNode(this.diagrams[this.currentPage])))},this.selectPageById=function(t){var e=this.getIndexById(t),t=0<=e;return t&&this.selectPage(e),t};var s=mxUtils.bind(this,function(){null!=this.xmlNode&&"mxfile"==this.xmlNode.nodeName||(this.diagrams=[]),this.xmlNode!=e&&(this.diagrams=this.xmlNode.getElementsByTagName("diagram"),e=this.xmlNode)}),a=this.graph.setBackgroundImage;this.graph.setBackgroundImage=function(t){var e,i;null==t||!Graph.isPageLink(t.src)||0<(i=(e=t.src).indexOf(","))&&(0<=(i=o.getIndexById(e.substring(i+1)))&&((t=o.getImageForGraphModel(Editor.parseDiagramNode(o.diagrams[i]))).originalSrc=e)),a.apply(this,arguments)};var l=this.graph.getGraphBounds;this.graph.getGraphBounds=function(t){var e,i,o=l.apply(this,arguments),t=this.backgroundImage;return null!=t&&(e=this.view.translate,i=this.view.scale,(o=mxRectangle.fromRectangle(o)).add(new mxRectangle((e.x+t.x)*i,(e.y+t.y)*i,t.width*i,t.height*i))),o},this.addListener("xmlNodeChanged",s),s(),urlParams.page=o.currentPage;s=null;this.graph.getModel().beginUpdate();try{urlParams.nav=0!=this.graphConfig.nav?"1":"0",this.editor.setGraphXml(this.xmlNode),this.graph.view.scale=this.graphConfig.zoom||1,s=this.setLayersVisible(),this.responsive||(this.graph.border=null!=this.graphConfig.border?this.graphConfig.border:8)}finally{this.graph.getModel().endUpdate()}this.responsive||(this.graph.panningHandler.isForcePanningEvent=function(t){return!mxEvent.isPopupTrigger(t.getEvent())&&"auto"==this.graph.container.style.overflow},this.graph.panningHandler.useLeftButtonForPanning=!0,this.graph.panningHandler.ignoreCell=!0,this.graph.panningHandler.usePopupTrigger=!1,this.graph.panningHandler.pinchEnabled=!1),this.graph.setPanning(!1),null!=this.graphConfig.toolbar?this.addToolbar():null!=this.graphConfig.title&&this.showTitleAsTooltip&&d.setAttribute("title",this.graphConfig.title),this.responsive||this.addSizeHandler(),!this.showLayers(this.graph)||this.forceCenter||this.layersEnabled&&!this.autoCrop||this.crop(),this.addClickHandler(this.graph),this.graph.setTooltips(0!=this.graphConfig.tooltips),this.graph.initialViewState={translate:this.graph.view.translate.clone(),scale:this.graph.view.scale},null!=s&&this.setLayersVisible(s),this.graph.customLinkClicked=function(t){var e;return Graph.isPageLink(t)?(e=t.indexOf(","),o.selectPageById(t.substring(e+1))||alert(mxResources.get("pageNotFound")||"Page not found")):this.handleCustomLink(t),!0};var h=this.graph.foldTreeCell;this.graph.foldTreeCell=mxUtils.bind(this,function(){return this.treeCellFolded=!0,h.apply(this.graph,arguments)}),this.fireEvent(new mxEventObject("render"))}),i=window.MutationObserver||window.WebKitMutationObserver||window.MozMutationObserver,this.checkVisibleState&&0==d.offsetWidth&&void 0!==i?(t=this.getObservableParent(d),(o=new i(mxUtils.bind(this,function(t){0<d.offsetWidth&&(o.disconnect(),e())}))).observe(t,{attributes:!0})):e()))},GraphViewer.prototype.getObservableParent=function(t){for(var e=t.parentNode;e!=document.body&&null!=e.parentNode&&"none"!==mxUtils.getCurrentStyle(e).display;)e=e.parentNode;return e},GraphViewer.prototype.getImageUrl=function(t){return null!=t&&"http://"!=t.substring(0,7)&&"https://"!=t.substring(0,8)&&"data:image"!=t.substring(0,10)&&("/"==t.charAt(0)&&(t=t.substring(1,t.length)),t=this.imageBaseUrl+t),t},GraphViewer.prototype.getImageForGraphModel=function(t){var e=Graph.createOffscreenGraph(this.graph.getStylesheet());e.getGlobalVariable=this.graph.getGlobalVariable,document.body.appendChild(e.container);var i=new mxCodec(t.ownerDocument).decode(t).root;e.model.setRoot(i);t=e.getSvg(),i=e.getGraphBounds();return document.body.removeChild(e.container),new mxImage(Editor.createSvgDataUri(mxUtils.getXml(t)),i.width,i.height,i.x,i.y)},GraphViewer.prototype.getIndexById=function(t){if(null!=this.diagrams)for(var e=0;e<this.diagrams.length;e++)if(this.diagrams[e].getAttribute("id")==t)return e;return-1},GraphViewer.prototype.setXmlNode=function(t){t=this.editor.extractGraphModel(t,!0),this.xmlDocument=t.ownerDocument,this.xml=mxUtils.getXml(t),this.xmlNode=t,this.updateGraphXml(t),this.fireEvent(new mxEventObject("xmlNodeChanged"))},GraphViewer.prototype.setFileNode=function(t){null==this.xmlNode&&(this.xmlDocument=t.ownerDocument,this.xml=mxUtils.getXml(t),this.xmlNode=t),this.setGraphXml(t)},GraphViewer.prototype.updateGraphXml=function(t){this.setGraphXml(t),this.fireEvent(new mxEventObject("graphChanged"))},GraphViewer.prototype.setLayersVisible=function(t){var e=!0;if(!this.autoOrigin){var i=[],o=this.graph.getModel();o.beginUpdate();try{for(var n=0;n<o.getChildCount(o.root);n++){var r=o.getChildAt(o.root,n),e=e&&o.isVisible(r);i.push(o.isVisible(r)),o.setVisible(r,null==t||t[n])}}finally{o.endUpdate()}}return e?null:i},GraphViewer.prototype.setGraphXml=function(t){if(null!=this.graph){this.graph.view.translate=new mxPoint,this.graph.view.scale=1;var e=null;this.graph.getModel().beginUpdate();try{this.graph.getModel().clear(),this.editor.setGraphXml(t),e=this.setLayersVisible(!0)}finally{this.graph.getModel().endUpdate()}this.responsive||(this.widthIsEmpty?(this.graph.container.style.width="",this.graph.container.style.height=""):this.graph.container.style.width=this.initialWidth,this.positionGraph()),this.graph.initialViewState={translate:this.graph.view.translate.clone(),scale:this.graph.view.scale},e&&this.setLayersVisible(e)}},GraphViewer.prototype.addSizeHandler=function(){var n=this.graph.container,r=this.graph.getGraphBounds(),i=!1;1!=this.graphConfig["toolbar-nohide"]?n.style.overflow="hidden":n.style.overflow="visible";var t,e,o=mxUtils.bind(this,function(){var t,e;i||(i=!0,t=this.graph.getGraphBounds(),1!=this.graphConfig["toolbar-nohide"]?t.width+2*this.graph.border>n.offsetWidth-2?n.style.overflow="auto":n.style.overflow="hidden":n.style.overflow="visible",null!=this.toolbar&&1!=this.graphConfig["toolbar-nohide"]?(e=n.getBoundingClientRect(),t=mxUtils.getScrollOrigin(document.body),t="relative"===document.body.style.position?document.body.getBoundingClientRect():{left:-t.x,top:-t.y},e={left:e.left-t.left,top:e.top-t.top,bottom:e.bottom-t.top,right:e.right-t.left},this.toolbar.style.left=e.left+"px","bottom"==this.graphConfig["toolbar-position"]?this.toolbar.style.top=e.bottom-1+"px":"inline"!=this.graphConfig["toolbar-position"]?(this.toolbar.style.width=Math.max(this.minToolbarWidth,n.offsetWidth)+"px",this.toolbar.style.top=e.top+1+"px"):this.toolbar.style.top=e.top+"px"):null!=this.toolbar&&(this.toolbar.style.width=Math.max(this.minToolbarWidth,n.offsetWidth)+"px"),this.treeCellFolded&&(this.treeCellFolded=!1,this.positionGraph(this.graph.view.translate),this.graph.initialViewState.translate=this.graph.view.translate.clone()),i=!1)}),s=null;this.handlingResize=!1,this.fitGraph=mxUtils.bind(this,function(t){var e=n.offsetWidth;e==s||this.handlingResize||(this.handlingResize=!0,"auto"==n.style.overflow&&(n.style.overflow="hidden"),this.graph.maxFitScale=null!=t?t:this.graphConfig.zoom||(this.allowZoomIn?null:1),this.graph.fit(null,null,null,null,null,!0),(this.center||0==this.graphConfig.resize&&""!=n.style.height)&&this.graph.center(),this.graph.maxFitScale=null,0==this.graphConfig.resize&&""!=n.style.height||this.updateContainerHeight(n,Math.max(this.minHeight,this.graph.getGraphBounds().height+2*this.graph.border+1)),this.graph.initialViewState={translate:this.graph.view.translate.clone(),scale:this.graph.view.scale},s=e,window.setTimeout(mxUtils.bind(this,function(){this.handlingResize=!1}),0))}),GraphViewer.useResizeSensor&&(document.documentMode<=9?(mxEvent.addListener(window,"resize",o),this.graph.addListener("size",o)):new ResizeSensor(this.graph.container,o)),this.graphConfig.resize||(this.zoomEnabled||!this.autoFit)&&0!=this.graphConfig.resize?(this.graph.minimumContainerSize=new mxRectangle(0,0,this.minWidth,this.minHeight),this.graph.resizeContainer=!0):(!this.widthIsEmpty||""!=n.style.height&&this.autoFit||this.updateContainerWidth(n,r.width+2*this.graph.border),0==this.graphConfig.resize&&""!=n.style.height||this.updateContainerHeight(n,Math.max(this.minHeight,r.height+2*this.graph.border+1)),!this.zoomEnabled&&this.autoFit?(t=s=null,e=mxUtils.bind(this,function(){window.clearTimeout(t),this.handlingResize||(t=window.setTimeout(mxUtils.bind(this,this.fitGraph),100))}),GraphViewer.useResizeSensor&&(document.documentMode<=9?mxEvent.addListener(window,"resize",e):new ResizeSensor(this.graph.container,e))):document.documentMode<=9||this.graph.addListener("size",o));var a=mxUtils.bind(this,function(t){var e=n.style.minWidth;this.widthIsEmpty&&(n.style.minWidth="100%");var i,o=null!=this.graphConfig["max-height"]?this.graphConfig["max-height"]:""!=n.style.height&&this.autoFit?n.offsetHeight:void 0;0<n.offsetWidth&&null==t&&this.allowZoomOut&&(this.allowZoomIn||r.width+2*this.graph.border>n.offsetWidth||r.height+2*this.graph.border>o)?((i=null)!=o&&r.height+2*this.graph.border>o-2&&(i=(o-2*this.graph.border-2)/r.height),this.fitGraph(i)):this.widthIsEmpty||null!=t||0!=this.graphConfig.resize||""==n.style.height?(t=null!=t?t:new mxPoint,this.graph.view.setTranslate(Math.floor(this.graph.border-r.x/this.graph.view.scale)+t.x,Math.floor(this.graph.border-r.y/this.graph.view.scale)+t.y),s=n.offsetWidth):this.graph.center((!this.widthIsEmpty||r.width<this.minWidth)&&1!=this.graphConfig.resize),n.style.minWidth=e});8==document.documentMode?window.setTimeout(a,0):a(),this.positionGraph=function(t){r=this.graph.getGraphBounds(),s=null,a(t)}},GraphViewer.prototype.crop=function(){var t=this.graph,e=t.getGraphBounds(),i=t.border,o=t.view.scale,n=null!=e.x?Math.floor(t.view.translate.x-e.x/o+i):i,i=null!=e.y?Math.floor(t.view.translate.y-e.y/o+i):i;t.view.setTranslate(n,i)},GraphViewer.prototype.updateContainerWidth=function(t,e){t.style.width=e+"px"},GraphViewer.prototype.updateContainerHeight=function(t,e){!this.forceCenter&&!this.zoomEnabled&&this.autoFit&&"BackCompat"!=document.compatMode&&8!=document.documentMode||(t.style.height=e+"px")},GraphViewer.prototype.showLayers=function(t,e){var i=this.graphConfig.layers,o=null!=i&&0<i.length?i.split(" "):[],n=this.graphConfig.layerIds,r=null!=n&&0<n.length,i=!1;if(0<o.length||r||null!=e){var s=null!=e?e.getModel():null,a=t.getModel();a.beginUpdate();try{var l=a.getChildCount(a.root);if(null==s){var h=!1,d={};if(r)for(var p=0;p<n.length;p++)null!=(g=a.getCell(n[p]))&&(h=!0,d[g.id]=!0);else for(p=0;p<o.length;p++)null!=(g=a.getChildAt(a.root,parseInt(o[p])))&&(h=!0,d[g.id]=!0);for(p=0;h&&p<l;p++){var g=a.getChildAt(a.root,p);a.setVisible(g,d[g.id]||!1)}}else for(p=0;p<l;p++)a.setVisible(a.getChildAt(a.root,p),s.isVisible(s.getChildAt(s.root,p)))}finally{a.endUpdate()}i=!0}return i},GraphViewer.prototype.addToolbar=function(){var o=this.graph.container;this.graph.container.style.cursor;"bottom"==this.graphConfig["toolbar-position"]?o.style.marginBottom=this.toolbarHeight+"px":"inline"!=this.graphConfig["toolbar-position"]&&(o.style.marginTop=this.toolbarHeight+"px");var e,i,n,r,s,a,l=o.ownerDocument.createElement("div");l.style.position="absolute",l.style.overflow="hidden",l.style.boxSizing="border-box",l.style.whiteSpace="nowrap",l.style.textAlign="left",l.style.zIndex=this.toolbarZIndex,l.style.backgroundColor="#eee",l.style.height=this.toolbarHeight+"px",this.toolbar=l,"inline"==this.graphConfig["toolbar-position"]&&(mxUtils.setPrefixedStyle(l.style,"transition","opacity 100ms ease-in-out"),mxUtils.setOpacity(l,30),i=e=null,n=mxUtils.bind(this,function(t){null!=e&&(window.clearTimeout(e),fadeThead=null),null!=i&&(window.clearTimeout(i),fadeThead2=null),e=window.setTimeout(mxUtils.bind(this,function(){mxUtils.setOpacity(l,0),e=null,i=window.setTimeout(mxUtils.bind(this,function(){l.style.display="none",i=null}),100)}),t||200)}),r=mxUtils.bind(this,function(t){null!=e&&(window.clearTimeout(e),fadeThead=null),null!=i&&(window.clearTimeout(i),fadeThead2=null),l.style.display="",mxUtils.setOpacity(l,t||30)}),mxEvent.addListener(this.graph.container,mxClient.IS_POINTER?"pointermove":"mousemove",mxUtils.bind(this,function(t){mxEvent.isTouchEvent(t)||(r(30),n())})),mxEvent.addListener(l,mxClient.IS_POINTER?"pointermove":"mousemove",function(t){mxEvent.consume(t)}),mxEvent.addListener(l,"mouseenter",mxUtils.bind(this,function(t){r(100)})),mxEvent.addListener(l,"mousemove",mxUtils.bind(this,function(t){r(100),mxEvent.consume(t)})),mxEvent.addListener(l,"mouseleave",mxUtils.bind(this,function(t){mxEvent.isTouchEvent(t)||r(30)})),s=this.graph,a=s.getTolerance(),s.addMouseListener({startX:0,startY:0,scrollLeft:0,scrollTop:0,mouseDown:function(t,e){this.startX=e.getGraphX(),this.startY=e.getGraphY(),this.scrollLeft=s.container.scrollLeft,this.scrollTop=s.container.scrollTop},mouseMove:function(t,e){},mouseUp:function(t,e){mxEvent.isTouchEvent(e.getEvent())&&Math.abs(this.scrollLeft-s.container.scrollLeft)<a&&Math.abs(this.scrollTop-s.container.scrollTop)<a&&Math.abs(this.startX-e.getGraphX())<a&&Math.abs(this.startY-e.getGraphY())<a&&(0<parseFloat(l.style.opacity||0)?n():r(30))}}));var t=this.toolbarItems,h=0;function d(t,e,i,o){var n=document.createElement("div");n.style.borderRight="1px solid #d0d0d0",n.style.padding="3px 6px 3px 6px",mxEvent.addListener(n,"click",t),null!=i&&n.setAttribute("title",i),n.style.display="inline-block";i=document.createElement("img");return i.setAttribute("border","0"),i.setAttribute("src",e),i.style.width="18px",null==o||o?(mxEvent.addListener(n,"mouseenter",function(){n.style.backgroundColor="#ddd"}),mxEvent.addListener(n,"mouseleave",function(){n.style.backgroundColor="#eee"}),mxUtils.setOpacity(i,60),n.style.cursor="pointer"):mxUtils.setOpacity(n,30),n.appendChild(i),l.appendChild(n),h++,n}for(var p,g=null,u=null,c=null,m=null,x=0;x<t.length;x++){var f,b,y,w,v,C,E=t[x];"pages"==E?((m=o.ownerDocument.createElement("div")).style.cssText="display:inline-block;position:relative;top:5px;padding:0 4px 0 4px;vertical-align:top;font-family:Helvetica,Arial;font-size:12px;;cursor:default;",mxUtils.setOpacity(m,70),(f=d(mxUtils.bind(this,function(){this.selectPage(this.currentPage-1)}),Editor.previousImage,mxResources.get("previousPage")||"Previous Page")).style.borderRightStyle="none",f.style.paddingLeft="0px",f.style.paddingRight="0px",l.appendChild(m),(b=d(mxUtils.bind(this,function(){this.selectPage(this.currentPage+1)}),Editor.nextImage,mxResources.get("nextPage")||"Next Page")).style.paddingLeft="0px",b.style.paddingRight="0px",y=mxUtils.bind(this,function(){m.innerHTML="",mxUtils.write(m,this.currentPage+1+" / "+this.diagrams.length),m.style.display=1<this.diagrams.length?"inline-block":"none",f.style.display=m.style.display,b.style.display=m.style.display}),this.addListener("graphChanged",y),y()):"zoom"==E?this.zoomEnabled&&(d(mxUtils.bind(this,function(){this.graph.zoomOut()}),Editor.zoomOutImage,mxResources.get("zoomOut")||"Zoom Out"),d(mxUtils.bind(this,function(){this.graph.zoomIn()}),Editor.zoomInImage,mxResources.get("zoomIn")||"Zoom In"),d(mxUtils.bind(this,function(){this.graph.view.scaleAndTranslate(this.graph.initialViewState.scale,this.graph.initialViewState.translate.x,this.graph.initialViewState.translate.y)}),Editor.zoomFitImage,mxResources.get("fit")||"Fit")):"layers"==E?this.layersEnabled&&(w=this.graph.getModel(),v=d(mxUtils.bind(this,function(t){var e,i;null!=g?(g.parentNode.removeChild(g),g=null):(g=this.graph.createLayersDialog(mxUtils.bind(this,function(){var t,e;this.autoCrop?this.crop():this.autoOrigin&&(t=this.graph.getGraphBounds(),e=this.graph.view,t.x<0||t.y<0?(this.crop(),this.graph.originalViewState=this.graph.initialViewState,this.graph.initialViewState={translate:e.translate.clone(),scale:e.scale}):null!=this.graph.originalViewState&&0<t.x/e.scale+this.graph.originalViewState.translate.x-e.translate.x&&0<t.y/e.scale+this.graph.originalViewState.translate.y-e.translate.y&&(e.setTranslate(this.graph.originalViewState.translate.x,this.graph.originalViewState.translate.y),this.graph.originalViewState=null,this.graph.initialViewState={translate:e.translate.clone(),scale:e.scale}))})),mxEvent.addListener(g,"mouseleave",function(){g.parentNode.removeChild(g),g=null}),e=v.getBoundingClientRect(),g.style.width="140px",g.style.padding="2px 0px 2px 0px",g.style.border="1px solid #d0d0d0",g.style.backgroundColor="#eee",g.style.fontFamily=Editor.defaultHtmlFont,g.style.fontSize="11px",g.style.zIndex=this.toolbarZIndex+1,mxUtils.setOpacity(g,80),i=mxUtils.getDocumentScrollOrigin(document),g.style.left=i.x+e.left-1+"px",g.style.top=i.y+e.bottom-2+"px",document.body.appendChild(g))}),Editor.layersImage,mxResources.get("layers")||"Layers"),w.addListener(mxEvent.CHANGE,function(){v.style.display=1<w.getChildCount(w.root)?"inline-block":"none"}),v.style.display=1<w.getChildCount(w.root)?"inline-block":"none"):"tags"==E?this.tagsEnabled&&(C=d(mxUtils.bind(this,function(t){var e,i;null==u&&((u=this.graph.createTagsDialog(mxUtils.bind(this,function(){return!0}))).div.getElementsByTagName("div")[0].style.position="",u.div.style.maxHeight="160px",u.div.style.maxWidth="120px",u.div.style.padding="2px",u.div.style.overflow="auto",u.div.style.height="auto",u.div.style.position="fixed",u.div.style.fontFamily=Editor.defaultHtmlFont,u.div.style.fontSize="11px",u.div.style.backgroundColor="#eee",u.div.style.color="#000",u.div.style.border="1px solid #d0d0d0",u.div.style.zIndex=this.toolbarZIndex+1,mxUtils.setOpacity(u.div,80)),null!=c?(c.parentNode.removeChild(c),c=null):(c=u.div,mxEvent.addListener(c,"mouseleave",function(){c.parentNode.removeChild(c),c=null}),e=C.getBoundingClientRect(),i=mxUtils.getDocumentScrollOrigin(document),c.style.left=i.x+e.left-1+"px",c.style.top=i.y+e.bottom-2+"px",document.body.appendChild(c),u.refresh())}),Editor.tagsImage,mxResources.get("tags")||"Tags"),w.addListener(mxEvent.CHANGE,mxUtils.bind(this,function(){C.style.display=0<this.graph.getAllTags().length?"inline-block":"none"})),C.style.display=0<this.graph.getAllTags().length?"inline-block":"none"):"lightbox"==E?this.lightboxEnabled&&d(mxUtils.bind(this,function(){this.showLightbox()}),Editor.fullscreenImage,mxResources.get("fullscreen")||"Fullscreen"):null==this.graphConfig["toolbar-buttons"]||null!=(E=this.graphConfig["toolbar-buttons"][E])&&(E.elem=d(null==E.enabled||E.enabled?E.handler:function(){},E.image,E.title,E.enabled))}null!=this.graph.minimumContainerSize&&(this.graph.minimumContainerSize.width=34*h),null!=this.graphConfig.title&&((p=o.ownerDocument.createElement("div")).style.cssText="display:inline-block;position:relative;padding:3px 6px 0 6px;vertical-align:top;font-family:Helvetica,Arial;font-size:12px;top:4px;cursor:default;",p.setAttribute("title",this.graphConfig.title),mxUtils.write(p,this.graphConfig.title),mxUtils.setOpacity(p,70),l.appendChild(p),this.filename=p),this.minToolbarWidth=34*h;var G=o.style.border,U=mxUtils.bind(this,function(){var t,e,i;l.style.width="inline"==this.graphConfig["toolbar-position"]?"auto":Math.max(this.minToolbarWidth,o.offsetWidth)+"px",l.style.border="1px solid #d0d0d0",1!=this.graphConfig["toolbar-nohide"]?(e=o.getBoundingClientRect(),t=mxUtils.getScrollOrigin(document.body),t="relative"===document.body.style.position?document.body.getBoundingClientRect():{left:-t.x,top:-t.y},e={left:e.left-t.left,top:e.top-t.top,bottom:e.bottom-t.top,right:e.right-t.left},l.style.left=e.left+"px","bottom"==this.graphConfig["toolbar-position"]?l.style.top=e.bottom-1+"px":"inline"!=this.graphConfig["toolbar-position"]?(l.style.marginTop=-this.toolbarHeight+"px",l.style.top=e.top+1+"px"):l.style.top=e.top+"px","1px solid transparent"==G&&(o.style.border="1px solid #d0d0d0"),document.body.appendChild(l),i=mxUtils.bind(this,function(){null!=l.parentNode&&l.parentNode.removeChild(l),null!=g&&(g.parentNode.removeChild(g),g=null),o.style.border=G}),mxEvent.addListener(document,"mousemove",function(t){for(var e=mxEvent.getSource(t);null!=e;){if(e==o||e==l||e==g)return;e=e.parentNode}i()}),mxEvent.addListener(document.body,"mouseleave",function(t){i()})):(l.style.top=-this.toolbarHeight+"px",o.appendChild(l))});1!=this.graphConfig["toolbar-nohide"]?mxEvent.addListener(o,"mouseenter",U):U(),this.responsive&&"undefined"!=typeof ResizeObserver&&new ResizeObserver(function(){null!=l.parentNode&&U()}).observe(o)},GraphViewer.prototype.disableButton=function(t){var e=this.graphConfig["toolbar-buttons"][t];null!=e&&(mxUtils.setOpacity(e.elem,30),mxEvent.removeListener(e.elem,"click",e.handler),mxEvent.addListener(e.elem,"mouseenter",function(){e.elem.style.backgroundColor="#eee"}))},GraphViewer.prototype.addClickHandler=function(o,n){o.linkPolicy=this.graphConfig.target||o.linkPolicy,o.addClickHandler(this.graphConfig.highlight,mxUtils.bind(this,function(t,e){if(null==e)for(var i=mxEvent.getSource(t);i!=o.container&&null!=i&&null==e;)"a"==i.nodeName.toLowerCase()&&(e=i.getAttribute("href")),i=i.parentNode;null!=n?null==e||o.isCustomLink(e)?mxEvent.consume(t):o.isExternalProtocol(e)||o.isBlankLink(e)||window.setTimeout(function(){n.destroy()},0):null!=e&&null==n&&o.isCustomLink(e)&&(mxEvent.isTouchEvent(t)||!mxEvent.isPopupTrigger(t))&&o.customLinkClicked(e)&&(mxUtils.clearSelection(),mxEvent.consume(t))}),mxUtils.bind(this,function(t){null!=n||!this.lightboxClickEnabled||mxEvent.isTouchEvent(t)&&0!=this.toolbarItems.length||this.showLightbox()}))},GraphViewer.prototype.showLightbox=function(t,e,i){"open"==this.graphConfig.lightbox||window.self!==window.top?null==this.lightboxWindow||this.lightboxWindow.closed?(e=null==e||e,i={client:1,target:i=null!=i?i:"blank"},(t=null!=t?t:null==this.graphConfig.editable||this.graphConfig.editable)&&(i.edit=this.graphConfig.edit||"_blank"),e&&(i.close=1),this.layersEnabled&&(i.layers=1),this.tagsEnabled&&(i.tags={}),null!=this.graphConfig&&0!=this.graphConfig.nav&&(i.nav=1),null!=this.graphConfig&&null!=this.graphConfig.highlight&&(i.highlight=this.graphConfig.highlight.substring(1)),null!=this.currentPage&&0<this.currentPage&&(i.page=this.currentPage),void 0!==window.postMessage&&(null==document.documentMode||10<=document.documentMode)?null==this.lightboxWindow&&mxEvent.addListener(window,"message",mxUtils.bind(this,function(t){"ready"==t.data&&t.source==this.lightboxWindow&&this.lightboxWindow.postMessage(this.xml,"*")})):i.data=encodeURIComponent(this.xml),"1"==urlParams.dev&&(i.dev="1"),this.lightboxWindow=window.open(("1"!=urlParams.dev?EditorUi.lightboxHost:"https://test.draw.io")+"/#P"+encodeURIComponent(JSON.stringify(i)))):this.lightboxWindow.focus():this.showLocalLightbox()},GraphViewer.prototype.showLocalLightbox=function(){mxUtils.getDocumentScrollOrigin(document);var t=document.createElement("div");t.style.cssText="position:fixed;top:0;left:0;bottom:0;right:0;",t.style.zIndex=this.lightboxZIndex,t.style.backgroundColor="#000000",mxUtils.setOpacity(t,70),document.body.appendChild(t);var e=document.createElement("img");e.setAttribute("border","0"),e.setAttribute("src",Editor.closeBlackImage),e.style.cssText="position:fixed;top:32px;right:32px;",e.style.cursor="pointer",mxEvent.addListener(e,"click",function(){o.destroy()}),urlParams.pages="1",urlParams.page=this.currentPage,urlParams["page-id"]=this.graphConfig.pageId,urlParams["layer-ids"]=null!=this.graphConfig.layerIds&&0<this.graphConfig.layerIds.length?this.graphConfig.layerIds.join(" "):null,urlParams.nav=0!=this.graphConfig.nav?"1":"0",urlParams.layers=this.layersEnabled?"1":"0",this.tagsEnabled&&(urlParams.tags="{}"),(null==document.documentMode||10<=document.documentMode)&&(Editor.prototype.editButtonLink=this.graphConfig.edit,Editor.prototype.editButtonFunc=this.graphConfig.editFunc),EditorUi.prototype.updateActionStates=function(){},EditorUi.prototype.addBeforeUnloadListener=function(){},EditorUi.prototype.addChromelessClickHandler=function(){};var i=Graph.prototype.shadowId;Graph.prototype.shadowId="lightboxDropShadow";var o=new EditorUi(new Editor(!0),document.createElement("div"),!0);o.editor.editBlankUrl=this.editBlankUrl,o.editor.graph.shadowId="lightboxDropShadow",Graph.prototype.shadowId=i,o.refresh=function(){};var n=mxUtils.bind(this,function(t){27==t.keyCode&&o.destroy()}),r=o.destroy;o.destroy=function(){mxEvent.removeListener(document.documentElement,"keydown",n),document.body.removeChild(t),document.body.removeChild(e),document.body.style.overflow="auto",GraphViewer.resizeSensorEnabled=!0,r.apply(this,arguments)};var s=o.editor.graph,a=s.container;a.style.overflow="hidden",this.lightboxChrome?(a.style.border="1px solid #c0c0c0",a.style.margin="40px",mxEvent.addListener(document.documentElement,"keydown",n)):(t.style.display="none",e.style.display="none");var l=this;s.getImageFromBundles=function(t){return l.getImageUrl(t)};var h=o.createTemporaryGraph;return o.createTemporaryGraph=function(){var t=h.apply(this,arguments);return t.getImageFromBundles=function(t){return l.getImageUrl(t)},t},this.graphConfig.move&&(s.isMoveCellsEvent=function(t){return!0}),mxUtils.setPrefixedStyle(a.style,"border-radius","4px"),a.style.position="fixed",GraphViewer.resizeSensorEnabled=!1,document.body.style.overflow="hidden",mxClient.IS_SF||mxClient.IS_EDGE||(mxUtils.setPrefixedStyle(a.style,"transform","rotateY(90deg)"),mxUtils.setPrefixedStyle(a.style,"transition","all .25s ease-in-out")),this.addClickHandler(s,o),window.setTimeout(mxUtils.bind(this,function(){a.style.outline="none",a.style.zIndex=this.lightboxZIndex,e.style.zIndex=this.lightboxZIndex,document.body.appendChild(a),document.body.appendChild(e),o.setFileData(this.xml),mxUtils.setPrefixedStyle(a.style,"transform","rotateY(0deg)"),o.chromelessToolbar.style.bottom="60px",o.chromelessToolbar.style.zIndex=this.lightboxZIndex,document.body.appendChild(o.chromelessToolbar),o.getEditBlankXml=mxUtils.bind(this,function(){return this.xml}),o.lightboxFit(),o.chromelessResize(),this.showLayers(s,this.graph),mxEvent.addListener(t,"click",function(){o.destroy()})}),0),o},GraphViewer.prototype.updateTitle=function(t){t=t||"",this.showTitleAsTooltip&&null!=this.graph&&null!=this.graph.container&&this.graph.container.setAttribute("title",t),null!=this.filename&&(this.filename.innerHTML="",mxUtils.write(this.filename,t),this.filename.setAttribute("title",t))},GraphViewer.processElements=function(t){mxUtils.forEach(GraphViewer.getElementsByClassName(t||"mxgraph"),function(e){try{e.innerHTML="",GraphViewer.createViewerForElement(e)}catch(t){e.innerHTML=t.message,null!=window.console&&console.error(t)}})},GraphViewer.getElementsByClassName=function(t){if(document.getElementsByClassName){for(var e=document.getElementsByClassName(t),i=[],o=0;o<e.length;o++)i.push(e[o]);return i}for(var n=document.getElementsByTagName("*"),e=[],o=0;o<n.length;o++){var r=n[o].className;null!=r&&0<r.length&&(r=r.split(" "),0<=mxUtils.indexOf(r,t)&&e.push(n[o]))}return e},GraphViewer.createViewerForElement=function(e,i){var o,n,t=e.getAttribute("data-mxgraph");null!=t&&(o=JSON.parse(t),n=function(t){t=mxUtils.parseXml(t),t=new GraphViewer(e,t.documentElement,o);null!=i&&i(t)},null!=o.url?GraphViewer.getUrl(o.url,function(t){n(t)}):n(o.xml))},GraphViewer.initCss=function(){try{var t=document.createElement("style");t.type="text/css",t.innerHTML=["div.mxTooltip {","-webkit-box-shadow: 3px 3px 12px #C0C0C0;","-moz-box-shadow: 3px 3px 12px #C0C0C0;","box-shadow: 3px 3px 12px #C0C0C0;","background: #FFFFCC;","border-style: solid;","border-width: 1px;","border-color: black;","font-family: Arial;","font-size: 8pt;","position: absolute;","cursor: default;","padding: 4px;","color: black;}","td.mxPopupMenuIcon div {","width:16px;","height:16px;}","html div.mxPopupMenu {","-webkit-box-shadow:2px 2px 3px #d5d5d5;","-moz-box-shadow:2px 2px 3px #d5d5d5;","box-shadow:2px 2px 3px #d5d5d5;","_filter:progid:DXImageTransform.Microsoft.DropShadow(OffX=2, OffY=2, Color='#d0d0d0',Positive='true');","background:white;","position:absolute;","border:3px solid #e7e7e7;","padding:3px;}","html table.mxPopupMenu {","border-collapse:collapse;","margin:0px;}","html td.mxPopupMenuItem {","padding:7px 30px 7px 30px;","font-family:Helvetica Neue,Helvetica,Arial Unicode MS,Arial;","font-size:10pt;}","html td.mxPopupMenuIcon {","background-color:white;","padding:0px;}","td.mxPopupMenuIcon .geIcon {","padding:2px;","padding-bottom:4px;","margin:2px;","border:1px solid transparent;","opacity:0.5;","_width:26px;","_height:26px;}","td.mxPopupMenuIcon .geIcon:hover {","border:1px solid gray;","border-radius:2px;","opacity:1;}","html tr.mxPopupMenuItemHover {","background-color: #eeeeee;","color: black;}","table.mxPopupMenu hr {","color:#cccccc;","background-color:#cccccc;","border:none;","height:1px;}","table.mxPopupMenu tr {\tfont-size:4pt;}",".geDialog { font-family:Helvetica Neue,Helvetica,Arial Unicode MS,Arial;","font-size:10pt;","border:none;","margin:0px;}",".geDialog {\tposition:absolute;\tbackground:white;\toverflow:hidden;\tpadding:30px;\tborder:1px solid #acacac;\t-webkit-box-shadow:0px 0px 2px 2px #d5d5d5;\t-moz-box-shadow:0px 0px 2px 2px #d5d5d5;\tbox-shadow:0px 0px 2px 2px #d5d5d5;\t_filter:progid:DXImageTransform.Microsoft.DropShadow(OffX=2, OffY=2, Color='#d5d5d5', Positive='true');\tz-index: 2;}.geDialogClose {\tposition:absolute;\twidth:9px;\theight:9px;\topacity:0.5;\tcursor:pointer;\t_filter:alpha(opacity=50);}.geDialogClose:hover {\topacity:1;}.geDialogTitle {\tbox-sizing:border-box;\twhite-space:nowrap;\tbackground:rgb(229, 229, 229);\tborder-bottom:1px solid rgb(192, 192, 192);\tfont-size:15px;\tfont-weight:bold;\ttext-align:center;\tcolor:rgb(35, 86, 149);}.geDialogFooter {\tbackground:whiteSmoke;\twhite-space:nowrap;\ttext-align:right;\tbox-sizing:border-box;\tborder-top:1px solid #e5e5e5;\tcolor:darkGray;}",".geBtn {\tbackground-color: #f5f5f5;\tborder-radius: 2px;\tborder: 1px solid #d8d8d8;\tcolor: #333;\tcursor: default;\tfont-size: 11px;\tfont-weight: bold;\theight: 29px;\tline-height: 27px;\tmargin: 0 0 0 8px;\tmin-width: 72px;\toutline: 0;\tpadding: 0 8px;\tcursor: pointer;}.geBtn:hover, .geBtn:focus {\t-webkit-box-shadow: 0px 1px 1px rgba(0,0,0,0.1);\t-moz-box-shadow: 0px 1px 1px rgba(0,0,0,0.1);\tbox-shadow: 0px 1px 1px rgba(0,0,0,0.1);\tborder: 1px solid #c6c6c6;\tbackground-color: #f8f8f8;\tbackground-image: linear-gradient(#f8f8f8 0px,#f1f1f1 100%);\tcolor: #111;}.geBtn:disabled {\topacity: .5;}.gePrimaryBtn {\tbackground-color: #4d90fe;\tbackground-image: linear-gradient(#4d90fe 0px,#4787ed 100%);\tborder: 1px solid #3079ed;\tcolor: #fff;}.gePrimaryBtn:hover, .gePrimaryBtn:focus {\tbackground-color: #357ae8;\tbackground-image: linear-gradient(#4d90fe 0px,#357ae8 100%);\tborder: 1px solid #2f5bb7;\tcolor: #fff;}.gePrimaryBtn:disabled {\topacity: .5;}"].join("\n"),document.getElementsByTagName("head")[0].appendChild(t)}catch(t){}},GraphViewer.cachedUrls={},GraphViewer.getUrl=function(t,e,i){var o;null!=GraphViewer.cachedUrls[t]?e(GraphViewer.cachedUrls[t]):((o=new(null!=navigator.userAgent&&0<navigator.userAgent.indexOf("MSIE 9")?XDomainRequest:XMLHttpRequest)).open("GET",t),o.onload=function(){e(null!=o.getText?o.getText():o.responseText)},o.onerror=i,o.send())},GraphViewer.resizeSensorEnabled=!0,GraphViewer.useResizeSensor=!0,function(){function l(i,t){function e(){GraphViewer.resizeSensorEnabled&&t()}function m(){var t,e;this.q=[],this.add=function(t){this.q.push(t)},this.call=function(){for(t=0,e=this.q.length;t<e;t++)this.q[t].call()}}function o(t,e){if(t.resizedAttached){if(t.resizedAttached)return void t.resizedAttached.add(e)}else t.resizedAttached=new m,t.resizedAttached.add(e);t.resizeSensor=document.createElement("div"),t.resizeSensor.className="resize-sensor";var i="position: absolute; left: 0; top: 0; right: 0; bottom: 0; overflow: hidden; z-index: -1; visibility: hidden;",e="position: absolute; left: 0; top: 0; transition: 0s;";t.resizeSensor.style.cssText=i,t.resizeSensor.innerHTML='<div class="resize-sensor-expand" style="'+i+'"><div style="'+e+'"></div></div><div class="resize-sensor-shrink" style="'+i+'"><div style="'+e+' width: 200%; height: 200%"></div></div>',t.appendChild(t.resizeSensor),"static"==(i="position",(e=t).currentStyle?e.currentStyle[i]:window.getComputedStyle?window.getComputedStyle(e,null).getPropertyValue(i):e.style[i])&&(t.style.position="relative");function o(){r.style.width=1e5+"px",r.style.height=1e5+"px",n.scrollLeft=1e5,n.scrollTop=1e5,s.scrollLeft=1e5,s.scrollTop=1e5}var n=t.resizeSensor.childNodes[0],r=n.childNodes[0],s=t.resizeSensor.childNodes[1];o();function a(){t.resizedAttached&&(g&&(t.resizedAttached.call(),g=!1),x(a))}var l,h,d,p,g=!1;x(a);function u(){(d=t.offsetWidth)==l&&(p=t.offsetHeight)==h||(g=!0,l=d,h=p),o()}function c(t,e,i){t.attachEvent?t.attachEvent("on"+e,i):t.addEventListener(e,i)}c(n,"scroll",u),c(s,"scroll",u)}var n=Object.prototype.toString.call(i),r="[object Array]"===n||"[object NodeList]"===n||"[object HTMLCollection]"===n||"undefined"!=typeof jQuery&&i instanceof jQuery||"undefined"!=typeof Elements&&i instanceof Elements;if(r)for(var s=0,a=i.length;s<a;s++)o(i[s],e);else o(i,e);this.detach=function(){if(r)for(var t=0,e=i.length;t<e;t++)l.detach(i[t]);else l.detach(i)}}var x=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||function(t){return window.setTimeout(t,20)};l.detach=function(t){t.resizeSensor&&(t.removeChild(t.resizeSensor),delete t.resizeSensor,delete t.resizedAttached)},window.ResizeSensor=l}();