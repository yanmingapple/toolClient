DrawioClient=function(e,t){mxEventSource.call(this),this.ui=e,this.cookieName=t,this.token=this.getPersistentToken()},mxUtils.extend(DrawioClient,mxEventSource),DrawioClient.prototype.token=null,DrawioClient.prototype.user=null,DrawioClient.prototype.setUser=function(e){this.user=e,this.fireEvent(new mxEventObject("userChanged"))},DrawioClient.prototype.getUser=function(){return this.user},DrawioClient.prototype.clearPersistentToken=function(){var e;isLocalStorage?(localStorage.removeItem("."+this.cookieName),sessionStorage.removeItem("."+this.cookieName)):"undefined"!=typeof Storage&&((e=new Date).setYear(e.getFullYear()-1),document.cookie=this.cookieName+"=; expires="+e.toUTCString())},DrawioClient.prototype.getPersistentToken=function(e){var t,o,i,n=null;return null==(n=isLocalStorage&&null==(n=localStorage.getItem("."+this.cookieName))&&e?sessionStorage.getItem("."+this.cookieName):n)&&"undefined"!=typeof Storage&&(t=document.cookie,o=this.cookieName+"=",0<=(i=t.indexOf(o))&&((e=t.indexOf(";",i+=o.length))<0?e=t.length:postCookie=t.substring(e),null!=(n=0<(e=t.substring(i,e)).length?e:null)&&isLocalStorage&&((e=new Date).setYear(e.getFullYear()-1),document.cookie=o+"; expires="+e.toUTCString(),localStorage.setItem("."+this.cookieName,n)))),n},DrawioClient.prototype.setPersistentToken=function(e,t){try{var o,i;null!=e?isLocalStorage?(t?sessionStorage:localStorage).setItem("."+this.cookieName,e):"undefined"!=typeof Storage&&((o=new Date).setYear(o.getFullYear()+10),i=this.cookieName+"="+e+"; path=/"+(t?"":"; expires="+o.toUTCString()),"https"==document.location.protocol.toLowerCase()&&(i+=";secure"),document.cookie=i):this.clearPersistentToken()}catch(e){this.ui.handleError(e)}};