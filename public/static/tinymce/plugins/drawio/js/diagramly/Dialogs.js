var StorageDialog=function(p,g,h){h=null!=h?h:2;var e=document.createElement("div");e.style.textAlign="center",e.style.whiteSpace="nowrap",e.style.paddingTop="0px",e.style.paddingBottom="20px";var t=document.createElement("div");t.style.border="1px solid #d3d3d3",t.style.borderWidth="1px 0px 1px 0px",t.style.padding="10px 0px 20px 0px";var x=0,b=0,y=document.createElement("div");y.style.paddingTop="2px",t.appendChild(y);var v=document.createElement("p");function l(e,t,l,n,i,s){b++,++x>h&&(mxUtils.br(y),x=1);var a=document.createElement("a");a.style.overflow="hidden",a.style.display="inline-block",a.className="geBaseButton",a.style.boxSizing="border-box",a.style.fontSize="11px",a.style.position="relative",a.style.margin="4px",a.style.marginTop="8px",a.style.marginBottom="0px",a.style.padding="8px 10px 8px 10px",a.style.width="88px",a.style.height="100px",a.style.whiteSpace="nowrap",a.setAttribute("title",t);var o,r,d,c=document.createElement("div");if(c.style.textOverflow="ellipsis",c.style.overflow="hidden",c.style.position="absolute",c.style.bottom="8px",c.style.left="0px",c.style.right="0px",mxUtils.write(c,t),a.appendChild(c),null!=e?((o=document.createElement("img")).setAttribute("src",e),o.setAttribute("border","0"),o.setAttribute("align","absmiddle"),o.style.width="60px",o.style.height="60px",o.style.paddingBottom="6px",a.appendChild(o)):(c.style.paddingTop="5px",c.style.whiteSpace="normal",mxClient.IS_IOS?(a.style.padding="0px 10px 20px 10px",a.style.top="6px"):mxClient.IS_FF&&(c.style.paddingTop="0px",c.style.marginTop="-2px")),null!=i)for(var m=0;m<i.length;m++)mxUtils.br(c),mxUtils.write(c,i[m]);function u(){mxEvent.addListener(a,"click",null!=s?s:function(){l!=App.MODE_GOOGLE||p.isDriveDomain()?l==App.MODE_GOOGLE&&p.spinner.spin(document.body,mxResources.get("authorizing"))?p.drive.checkToken(mxUtils.bind(this,function(){p.spinner.stop(),p.setMode(l,!0),g()})):l==App.MODE_ONEDRIVE&&p.spinner.spin(document.body,mxResources.get("authorizing"))?p.oneDrive.checkToken(mxUtils.bind(this,function(){p.spinner.stop(),p.setMode(l,!0),g()})):(p.setMode(l,!0),g()):window.location.hostname=DriveClient.prototype.newAppHostname})}null!=n&&null==p[n]?(o.style.visibility="hidden",mxUtils.setOpacity(c,10),(r=new Spinner({lines:12,length:12,width:5,radius:10,rotate:0,color:Editor.isDarkMode()?"#c0c0c0":"#000",speed:1.5,trail:60,shadow:!1,hwaccel:!1,top:"40%",zIndex:2e9})).spin(a),d=window.setTimeout(function(){null==p[n]&&(r.stop(),a.style.display="none")},3e4),p.addListener("clientLoaded",mxUtils.bind(this,function(e,t){null!=p[n]&&t.getProperty("client")==p[n]&&(window.clearTimeout(d),mxUtils.setOpacity(c,100),o.style.visibility="",r.stop(),u(),"drive"==n&&null!=v.parentNode&&v.parentNode.removeChild(v))}))):u(),y.appendChild(a)}var n=document.createElement("p");n.style.cssText="font-size:22px;padding:4px 0 16px 0;margin:0;color:gray;",mxUtils.write(n,mxResources.get("saveDiagramsTo")+":"),e.appendChild(n);e.appendChild(t),x=0,"function"==typeof window.DriveClient&&l(IMAGE_PATH+"/google-drive-logo.svg",mxResources.get("googleDrive"),App.MODE_GOOGLE,"drive"),"function"==typeof window.OneDriveClient&&l(IMAGE_PATH+"/onedrive-logo.svg",mxResources.get("oneDrive"),App.MODE_ONEDRIVE,"oneDrive"),"1"!=urlParams.noDevice&&l(IMAGE_PATH+"/osa_drive-harddisk.png",mxResources.get("device"),App.MODE_DEVICE),!isLocalStorage||"1"!=urlParams.browser&&"1"!=urlParams.offline||l(IMAGE_PATH+"/osa_database.png",mxResources.get("browser"),App.MODE_BROWSER),"function"==typeof window.DropboxClient&&l(IMAGE_PATH+"/dropbox-logo.svg",mxResources.get("dropbox"),App.MODE_DROPBOX,"dropbox"),null!=p.gitHub&&l(IMAGE_PATH+"/github-logo.svg",mxResources.get("github"),App.MODE_GITHUB,"gitHub"),null!=p.gitLab&&l(IMAGE_PATH+"/gitlab-logo.svg",mxResources.get("gitlab"),App.MODE_GITLAB,"gitLab"),b<6&&null!=p.notion&&l(IMAGE_PATH+"/notion-logo.svg",mxResources.get("notion"),App.MODE_NOTION,"notion");t=document.createElement("span");t.style.cssText="position:absolute;cursor:pointer;bottom:27px;color:gray;userSelect:none;text-align:center;left:50%;",mxUtils.setPrefixedStyle(t.style,"transform","translate(-50%,0)"),mxUtils.write(t,mxResources.get("decideLater")),mxEvent.addListener(t,"click",function(){p.hideDialog();var e=Editor.useLocalStorage;p.createFile(p.defaultFilename,null,null,null,null,null,null,!0),Editor.useLocalStorage=e}),e.appendChild(t),mxClient.IS_SVG&&isLocalStorage&&"0"!=urlParams.gapi&&(null==document.documentMode||10<=document.documentMode)&&window.setTimeout(function(){null==p.drive&&(v.style.padding="7px",v.style.fontSize="9pt",v.style.marginTop="-14px",v.innerHTML='<a style="background-color:#dcdcdc;padding:6px;color:black;text-decoration:none;" href="https://desk.draw.io/a/solutions/articles/16000074659" target="_blank"><img border="0" src="'+mxGraph.prototype.warningImage.src+'" align="absmiddle" style="margin-top:-4px"> '+mxResources.get("googleDriveMissingClickHere")+"</a>",e.appendChild(v))},5e3),this.container=e},SplashDialog=function(l){console.log("SplashDialog()");var e=document.createElement("div");e.style.textAlign="center",!mxClient.IS_CHROMEAPP&&!EditorUi.isElectronApp||null!=(o=l.addLanguageMenu(e,!0))&&(o.style.bottom="19px");l.getServiceCount();var t=document.createElement("img");t.setAttribute("border","0"),t.setAttribute("align","absmiddle"),t.style.width="32px",t.style.height="32px",t.style.marginRight="8px",t.style.marginTop="-4px";var n=document.createElement("div");n.style.margin="8px 0px 0px 0px",n.style.padding="18px 0px 24px 0px";var i,s,a,o,r,d="",d=l.mode==App.MODE_GOOGLE?(t.src=IMAGE_PATH+"/google-drive-logo.svg",mxResources.get("googleDrive")):l.mode==App.MODE_DROPBOX?(t.src=IMAGE_PATH+"/dropbox-logo.svg",mxResources.get("dropbox")):l.mode==App.MODE_ONEDRIVE?(t.src=IMAGE_PATH+"/onedrive-logo.svg",mxResources.get("oneDrive")):l.mode==App.MODE_GITHUB?(t.src=IMAGE_PATH+"/github-logo.svg",mxResources.get("github")):l.mode==App.MODE_GITLAB?(t.src=IMAGE_PATH+"/gitlab-logo.svg",mxResources.get("gitlab")):l.mode==App.MODE_NOTION?(t.src=IMAGE_PATH+"/notion-logo.svg",mxResources.get("notion")):l.mode==App.MODE_BROWSER?(t.src=IMAGE_PATH+"/osa_database.png",mxResources.get("browser")):l.mode==App.MODE_TRELLO?(t.src=IMAGE_PATH+"/trello-logo.svg",mxResources.get("trello")):(t.src=IMAGE_PATH+"/osa_drive-harddisk.png",n.style.paddingBottom="10px",n.style.paddingTop="30px",mxResources.get("device")),c=document.createElement("button");c.className="geBigButton",c.style.marginBottom="8px",c.style.fontSize="18px",c.style.padding="10px",c.style.width="340px",mxClient.IS_CHROMEAPP||EditorUi.isElectronApp?(n.style.padding="42px 0px 56px 0px",c.style.marginBottom="12px"):(n.style.border="1px solid #d3d3d3",n.style.borderWidth="1px 0px 1px 0px",r=document.createElement("table"),i=document.createElement("tbody"),s=document.createElement("tr"),a=document.createElement("td"),o=document.createElement("td"),r.setAttribute("align","center"),a.appendChild(t),(u=document.createElement("div")).style.fontSize="22px",u.style.paddingBottom="6px",u.style.color="gray",mxUtils.write(u,d),o.style.textAlign="left",o.appendChild(u),s.appendChild(a),s.appendChild(o),i.appendChild(s),r.appendChild(i),e.appendChild(r),(r=document.createElement("span")).style.cssText="position:absolute;cursor:pointer;bottom:27px;color:gray;userSelect:none;text-align:center;left:50%;",mxUtils.setPrefixedStyle(r.style,"transform","translate(-50%,0)"),mxUtils.write(r,mxResources.get("changeStorage")),mxEvent.addListener(r,"click",function(){l.hideDialog(!1),l.setMode(null),l.clearMode(),l.showSplash(!0)}),e.appendChild(r)),mxUtils.write(c,mxResources.get("createNewDiagram")),mxEvent.addListener(c,"click",function(){l.hideDialog(),l.actions.get("new").funct()}),n.appendChild(c),mxUtils.br(n),(c=document.createElement("button")).className="geBigButton",c.style.marginBottom="22px",c.style.fontSize="18px",c.style.padding="10px",c.style.width="340px",mxUtils.write(c,mxResources.get("openExistingDiagram")),mxEvent.addListener(c,"click",function(){l.actions.get("open").funct()}),n.appendChild(c);if(l.mode==App.MODE_GOOGLE?mxResources.get("googleDrive"):l.mode==App.MODE_DROPBOX?mxResources.get("dropbox"):l.mode==App.MODE_ONEDRIVE?mxResources.get("oneDrive"):l.mode==App.MODE_GITHUB?mxResources.get("github"):l.mode==App.MODE_GITLAB?mxResources.get("gitlab"):l.mode==App.MODE_NOTION?mxResources.get("notion"):l.mode==App.MODE_TRELLO?mxResources.get("trello"):l.mode==App.MODE_DEVICE?mxResources.get("device"):l.mode==App.MODE_BROWSER&&mxResources.get("browser"),!mxClient.IS_CHROMEAPP&&!EditorUi.isElectronApp){function m(e){c.style.marginBottom="24px";var t=document.createElement("a");t.style.display="inline-block",t.style.color="gray",t.style.cursor="pointer",t.style.marginTop="6px",mxUtils.write(t,mxResources.get("signOut")),c.style.marginBottom="16px",n.style.paddingBottom="18px",mxEvent.addListener(t,"click",function(){l.confirm(mxResources.get("areYouSure"),function(){e()})}),n.appendChild(t)}if(l.mode==App.MODE_GOOGLE&&null!=l.drive){var u,p=l.drive.getUsersList();if(0<p.length){(u=document.createElement("span")).style.marginTop="6px",mxUtils.write(u,mxResources.get("changeUser")+":"),c.style.marginBottom="16px",n.style.paddingBottom="18px",n.appendChild(u);var g=document.createElement("select");g.style.marginLeft="4px",g.style.width="140px";for(var h=0;h<p.length;h++){var x=document.createElement("option");mxUtils.write(x,p[h].displayName),x.value=h,g.appendChild(x),(x=document.createElement("option")).innerHTML="&nbsp;&nbsp;&nbsp;",mxUtils.write(x,"<"+p[h].email+">"),x.setAttribute("disabled","disabled"),g.appendChild(x)}x=document.createElement("option");mxUtils.write(x,mxResources.get("addAccount")),x.value=p.length,g.appendChild(x),mxEvent.addListener(g,"change",function(){var e=g.value,t=p.length!=e;t&&l.drive.setUser(p[e]),l.drive.authorize(t,function(){l.setMode(App.MODE_GOOGLE),l.hideDialog(),l.showSplash()},function(e){l.handleError(e,null,function(){l.hideDialog(),l.showSplash()})},!0)}),n.appendChild(g)}else m(function(){l.drive.logout()})}else l.mode!=App.MODE_ONEDRIVE||null==l.oneDrive||l.oneDrive.noLogout?l.mode==App.MODE_GITHUB&&null!=l.gitHub?m(function(){l.gitHub.logout(),l.openLink("https://www.github.com/logout")}):l.mode==App.MODE_GITLAB&&null!=l.gitLab?m(function(){l.gitLab.logout(),l.openLink(DRAWIO_GITLAB_URL+"/users/sign_out")}):l.mode==App.MODE_NOTION&&null!=l.notion?m(function(){l.notion.logout()}):l.mode==App.MODE_TRELLO&&null!=l.trello?l.trello.isAuthorized()&&m(function(){l.trello.logout()}):l.mode==App.MODE_DROPBOX&&null!=l.dropbox&&m(function(){l.dropbox.logout(),l.openLink("https://www.dropbox.com/logout")}):m(function(){l.oneDrive.logout()})}e.appendChild(n),this.container=e},EmbedDialog=function(n,i,s,e,a,t,l,o,r){l=null!=l?l:"Check out the diagram I made using @drawio";var d=document.createElement("div"),c=/^https?:\/\//.test(i)||/^mailto:\/\//.test(i);null!=t?mxUtils.write(d,t):mxUtils.write(d,mxResources.get(i.length<5e5?c?"link":"mainEmbedNotice":"preview")+":"),mxUtils.br(d);var m=document.createElement("div");m.style.position="absolute",m.style.top="30px",m.style.right="30px",m.style.color="gray",mxUtils.write(m,n.formatFileSize(i.length)),d.appendChild(m);var u=document.createElement("textarea");u.setAttribute("autocomplete","off"),u.setAttribute("autocorrect","off"),u.setAttribute("autocapitalize","off"),u.setAttribute("spellcheck","false"),u.style.fontFamily="monospace",u.style.wordBreak="break-all",u.style.marginTop="10px",u.style.resize="none",u.style.height="150px",u.style.width="440px",u.style.border="1px solid gray",u.value=mxResources.get("updatingDocument"),d.appendChild(u),mxUtils.br(d),this.init=function(){window.setTimeout(function(){i.length<5e5?(u.value=i,u.focus(),mxClient.IS_GC||mxClient.IS_FF||5<=document.documentMode?u.select():document.execCommand("selectAll",!1,null)):(u.setAttribute("readonly","true"),u.value=mxResources.get("tooLargeUseDownload"))},0)};t=document.createElement("div");t.style.position="absolute",t.style.bottom="36px",t.style.right="32px";var p,m=null;!EmbedDialog.showPreviewOption||mxClient.IS_CHROMEAPP&&!c||navigator.standalone||!(c||mxClient.IS_SVG&&(null==document.documentMode||9<document.documentMode))||((m=mxUtils.button(null!=o?o:mxResources.get(i.length<5e5?"preview":"openInNewWindow"),function(){var e=i.length<5e5?u.value:i;if(null!=a)a(e);else if(c)try{var t=n.openLink(e);null!=t&&(null==s||0<s)&&window.setTimeout(mxUtils.bind(this,function(){try{null!=t&&null!=t.location.href&&t.location.href.substring(0,8)!=e.substring(0,8)&&(t.close(),n.handleError({message:mxResources.get("drawingTooLarge")}))}catch(e){}}),s||500)}catch(e){n.handleError({message:e.message||mxResources.get("drawingTooLarge")})}else{var l=window.open(),l=null!=l?l.document:null;null!=l?(l.writeln("<html><head><title>"+encodeURIComponent(mxResources.get("preview"))+'</title><meta charset="utf-8"></head><body>'+i+"</body></html>"),l.close()):n.handleError({message:mxResources.get("errorUpdatingPreview")})}})).className="geBtn",t.appendChild(m)),(!c||7500<i.length)&&((p=mxUtils.button(mxResources.get("download"),function(){n.hideDialog(),n.saveData(null!=r?r:"embed.txt","txt",i,"text/plain")})).className="geBtn",t.appendChild(p)),!c||n.isOffline()&&!mxClient.IS_CHROMEAPP||(i.length<51200&&(p=mxUtils.button("",function(){try{var e="https://www.facebook.com/sharer.php?p[url]="+encodeURIComponent(u.value);n.openLink(e)}catch(e){n.handleError({message:e.message||mxResources.get("drawingTooLarge")})}}),(g=document.createElement("img")).setAttribute("src",Editor.facebookImage),g.setAttribute("width","18"),g.setAttribute("height","18"),g.setAttribute("border","0"),p.appendChild(g),p.setAttribute("title",mxResources.get("facebook")+" ("+n.formatFileSize(51200)+" max)"),p.style.verticalAlign="bottom",p.style.paddingTop="4px",p.style.minWidth="46px",p.className="geBtn",t.appendChild(p)),i.length<7168&&(h=mxUtils.button("",function(){try{var e="https://twitter.com/intent/tweet?text="+encodeURIComponent(l)+"&url="+encodeURIComponent(u.value);n.openLink(e)}catch(e){n.handleError({message:e.message||mxResources.get("drawingTooLarge")})}}),(g=document.createElement("img")).setAttribute("src",Editor.tweetImage),g.setAttribute("width","18"),g.setAttribute("height","18"),g.setAttribute("border","0"),g.style.marginBottom="5px",h.appendChild(g),h.setAttribute("title",mxResources.get("twitter")+" ("+n.formatFileSize(7168)+" max)"),h.style.verticalAlign="bottom",h.style.paddingTop="4px",h.style.minWidth="46px",h.className="geBtn",t.appendChild(h)));var g=mxUtils.button(mxResources.get("close"),function(){n.hideDialog()});t.appendChild(g);var h=mxUtils.button(mxResources.get("copy"),function(){u.focus(),mxClient.IS_GC||mxClient.IS_FF||5<=document.documentMode?u.select():document.execCommand("selectAll",!1,null),document.execCommand("copy"),n.alert(mxResources.get("copiedToClipboard"))});i.length<5e5?mxClient.IS_SF||null!=document.documentMode?g.className="geBtn gePrimaryBtn":(t.appendChild(h),h.className="geBtn gePrimaryBtn",g.className="geBtn"):(t.appendChild(m),g.className="geBtn",m.className="geBtn gePrimaryBtn"),d.appendChild(t),this.container=d};EmbedDialog.showPreviewOption=!0;var GoogleSitesDialog=function(e,t){var l=document.createElement("div"),n=e.editor.graph,i=n.getGraphBounds(),s=n.view.scale,a=Math.floor(i.x/s-n.view.translate.x),o=Math.floor(i.y/s-n.view.translate.y);mxUtils.write(l,mxResources.get("googleGadget")+":"),mxUtils.br(l);var r=document.createElement("input");r.setAttribute("type","text"),r.style.marginBottom="8px",r.style.marginTop="2px",r.style.width="410px",l.appendChild(r),mxUtils.br(l),this.init=function(){r.focus(),mxClient.IS_GC||mxClient.IS_FF||5<=document.documentMode?r.select():document.execCommand("selectAll",!1,null)},mxUtils.write(l,mxResources.get("top")+":");var d=document.createElement("input");d.setAttribute("type","text"),d.setAttribute("size","4"),d.style.marginRight="16px",d.style.marginLeft="4px",d.value=a,l.appendChild(d),mxUtils.write(l,mxResources.get("height")+":");var c=document.createElement("input");c.setAttribute("type","text"),c.setAttribute("size","4"),c.style.marginLeft="4px",c.value=Math.ceil(i.height/s),l.appendChild(c),mxUtils.br(l);s=document.createElement("hr");s.setAttribute("size","1"),s.style.marginBottom="16px",s.style.marginTop="16px",l.appendChild(s),mxUtils.write(l,mxResources.get("publicDiagramUrl")+":"),mxUtils.br(l);var m=document.createElement("input");m.setAttribute("type","text"),m.setAttribute("size","28"),m.style.marginBottom="8px",m.style.marginTop="2px",m.style.width="410px",m.value=t||"",l.appendChild(m),mxUtils.br(l),mxUtils.write(l,mxResources.get("borderWidth")+":");var u=document.createElement("input");u.setAttribute("type","text"),u.setAttribute("size","3"),u.style.marginBottom="8px",u.style.marginLeft="4px",u.value="0",l.appendChild(u),mxUtils.br(l);var p=document.createElement("input");p.setAttribute("type","checkbox"),p.setAttribute("checked","checked"),p.defaultChecked=!0,p.style.marginLeft="16px",l.appendChild(p),mxUtils.write(l,mxResources.get("pan")+" ");var g=document.createElement("input");g.setAttribute("type","checkbox"),g.setAttribute("checked","checked"),g.defaultChecked=!0,g.style.marginLeft="8px",l.appendChild(g),mxUtils.write(l,mxResources.get("zoom")+" ");var h=document.createElement("input");h.setAttribute("type","checkbox"),h.style.marginLeft="8px",h.setAttribute("title",window.location.href),l.appendChild(h),mxUtils.write(l,mxResources.get("edit")+" ");var x=document.createElement("input");x.setAttribute("type","checkbox"),x.style.marginLeft="8px",l.appendChild(x),mxUtils.write(l,mxResources.get("asNew")+" "),mxUtils.br(l);var b=document.createElement("input");b.setAttribute("type","checkbox"),b.setAttribute("checked","checked"),b.defaultChecked=!0,b.style.marginLeft="16px",l.appendChild(b),mxUtils.write(l,mxResources.get("resize")+" ");var y=document.createElement("input");y.setAttribute("type","checkbox"),y.style.marginLeft="8px",l.appendChild(y),mxUtils.write(l,mxResources.get("fit")+" ");var v=document.createElement("input");v.setAttribute("type","checkbox"),v.style.marginLeft="8px",l.appendChild(v),mxUtils.write(l,mxResources.get("embed")+" ");var f=e.getBasenames().join(";"),E=e.getCurrentFile();function w(){var e,t=null!=E&&null!=E.getTitle()?E.getTitle():this.defaultFilename;v.checked&&""!=m.value?(e="https://www.draw.io/gadget.xml?type=4&diagram="+encodeURIComponent(mxUtils.htmlEntities(m.value)),null!=t&&(e+="&title="+encodeURIComponent(t)),0<f.length&&(e+="&s="+f),""!=u.value&&"0"!=u.value&&(e+="&border="+u.value),""!=c.value&&(e+="&height="+c.value),e+="&pan="+(p.checked?"1":"0"),e+="&zoom="+(g.checked?"1":"0"),e+="&fit="+(y.checked?"1":"0"),e+="&resize="+(b.checked?"1":"0"),e+="&x0="+Number(d.value),e+="&y0="+o,n.mathEnabled&&(e+="&math=1"),x.checked?e+="&edit=_blank":h.checked&&(e+="&edit="+encodeURIComponent(mxUtils.htmlEntities(window.location.href))),r.value=e):E.constructor==DriveFile||E.constructor==DropboxFile?(e="https://www.draw.io/gadget.xml?embed=0&diagram=",""!=m.value?e+=encodeURIComponent(mxUtils.htmlEntities(m.value))+"&type=3":(e+=E.getHash().substring(1),E.constructor==DropboxFile?e+="&type=2":e+="&type=1"),null!=t&&(e+="&title="+encodeURIComponent(t)),""!=c.value&&(e+="&height="+(parseInt(c.value)+parseInt(d.value))),r.value=e):r.value=""}mxEvent.addListener(p,"change",w),mxEvent.addListener(g,"change",w),mxEvent.addListener(b,"change",w),mxEvent.addListener(y,"change",w),mxEvent.addListener(h,"change",w),mxEvent.addListener(x,"change",w),mxEvent.addListener(v,"change",w),mxEvent.addListener(c,"change",w),mxEvent.addListener(d,"change",w),mxEvent.addListener(u,"change",w),mxEvent.addListener(m,"change",w),w(),mxEvent.addListener(r,"click",function(){r.focus(),mxClient.IS_GC||mxClient.IS_FF||5<=document.documentMode?r.select():document.execCommand("selectAll",!1,null)});s=document.createElement("div");s.style.paddingTop="12px",s.style.textAlign="right";t=mxUtils.button(mxResources.get("close"),function(){e.hideDialog()});t.className="geBtn gePrimaryBtn",s.appendChild(t),l.appendChild(s),this.container=l},CreateGraphDialog=function(m,e,u){var p=document.createElement("div");p.style.textAlign="right",this.init=function(){var n=document.createElement("div");n.style.position="relative",n.style.border="1px solid gray",n.style.width="100%",n.style.height="360px",n.style.overflow="hidden",n.style.marginBottom="16px",mxEvent.disableContextMenu(n),p.appendChild(n);var s=new Graph(n);s.setCellsCloneable(!0),s.setPanning(!0),s.setAllowDanglingEdges(!1),s.connectionHandler.select=!1,s.view.setTranslate(20,20),s.border=20,s.panningHandler.useLeftButtonForPanning=!0;var a="curved=1;";mxCellRenderer.prototype.installCellOverlayListeners;s.cellRenderer.installCellOverlayListeners=function(t,l,e){mxCellRenderer.prototype.installCellOverlayListeners.apply(this,arguments),mxEvent.addListener(e.node,mxClient.IS_POINTER?"pointerdown":"mousedown",function(e){l.fireEvent(new mxEventObject("pointerdown","event",e,"state",t))}),!mxClient.IS_POINTER&&mxClient.IS_TOUCH&&mxEvent.addListener(e.node,"touchstart",function(e){l.fireEvent(new mxEventObject("pointerdown","event",e,"state",t))})},s.getAllConnectionConstraints=function(){return null},s.connectionHandler.marker.highlight.keepOnTop=!1,s.connectionHandler.createEdgeState=function(e){var t=s.createEdge(null,null,null,null,null,a);return new mxCellState(this.graph.view,t,this.graph.getCellStyle(t))};var l,i,o,r,d=s.getDefaultParent(),c=mxUtils.bind(this,function(i){var e=new mxCellOverlay(this.connectImage,"Add outgoing");e.cursor="hand",e.addListener(mxEvent.CLICK,function(e,t){s.connectionHandler.reset(),s.clearSelection();var l,n=s.getCellGeometry(i);o(function(){l=s.insertVertex(d,null,"Entry",n.x,n.y,80,30,"rounded=1;"),c(l),s.view.refresh(l);s.insertEdge(d,null,"",i,l,a)},function(){s.scrollCellToVisible(l)})}),e.addListener("pointerdown",function(e,t){var l=t.getProperty("event"),n=t.getProperty("state");s.popupMenuHandler.hideMenu(),s.stopEditing(!1);t=mxUtils.convertPoint(s.container,mxEvent.getClientX(l),mxEvent.getClientY(l));s.connectionHandler.start(n,t.x,t.y),s.isMouseDown=!0,s.isMouseTrigger=mxEvent.isMouseEvent(l),mxEvent.consume(l)}),s.addCellOverlay(i,e)});s.getModel().beginUpdate();try{l=s.insertVertex(d,null,"Start",0,0,80,30,"ellipse"),c(l)}finally{s.getModel().endUpdate()}"horizontalTree"==u?((i=new mxCompactTreeLayout(s)).edgeRouting=!1,i.levelDistance=30,a="edgeStyle=elbowEdgeStyle;elbow=horizontal;"):"verticalTree"==u?((i=new mxCompactTreeLayout(s,!1)).edgeRouting=!1,i.levelDistance=30,a="edgeStyle=elbowEdgeStyle;elbow=vertical;"):"radialTree"==u?((i=new mxRadialTreeLayout(s,!1)).edgeRouting=!1,i.levelDistance=80):"verticalFlow"==u?i=new mxHierarchicalLayout(s,mxConstants.DIRECTION_NORTH):"horizontalFlow"==u?i=new mxHierarchicalLayout(s,mxConstants.DIRECTION_WEST):"organic"==u?(i=new mxFastOrganicLayout(s,!1)).forceConstant=80:"circle"==u&&(i=new mxCircleLayout(s)),null!=i&&(o=function(e,t){s.getModel().beginUpdate();try{null!=e&&e(),i.execute(s.getDefaultParent(),l)}catch(e){throw e}finally{e=new mxMorphing(s);e.addListener(mxEvent.DONE,mxUtils.bind(this,function(){s.getModel().endUpdate(),null!=t&&t()})),e.startAnimation()}},r=mxEdgeHandler.prototype.connect,mxEdgeHandler.prototype.connect=function(e,t,l,n,i){r.apply(this,arguments),o()},s.resizeCell=function(){mxGraph.prototype.resizeCell.apply(this,arguments),o()},s.connectionHandler.addListener(mxEvent.CONNECT,function(){o()}));var e=mxUtils.button(mxResources.get("close"),function(){m.confirm(mxResources.get("areYouSure"),function(){null!=n.parentNode&&(s.destroy(),n.parentNode.removeChild(n)),m.hideDialog()})});e.className="geBtn",m.editor.cancelFirst&&p.appendChild(e);var t=mxUtils.button(mxResources.get("insert"),function(e){s.clearCellOverlays();var t=s.getModel().getChildren(s.getDefaultParent()),l=mxEvent.isAltDown(e)?m.editor.graph.getFreeInsertPoint():m.editor.graph.getCenterInsertPoint(s.getBoundingBoxFromGeometry(t,!0)),t=m.editor.graph.importCells(t,l.x,l.y),e=m.editor.graph.view,l=e.getBounds(t);l.x-=e.translate.x,l.y-=e.translate.y,m.editor.graph.scrollRectToVisible(l),m.editor.graph.setSelectionCells(t),null!=n.parentNode&&(s.destroy(),n.parentNode.removeChild(n)),m.hideDialog()});p.appendChild(t),t.className="geBtn gePrimaryBtn",m.editor.cancelFirst||p.appendChild(e)},this.container=p};CreateGraphDialog.prototype.connectImage=new mxImage(mxClient.IS_SVG?"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABoAAAAaCAYAAACpSkzOAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNSBNYWNpbnRvc2giIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6RjQ3OTk0QjMyRDcyMTFFNThGQThGNDVBMjNBMjFDMzkiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6RjQ3OTk0QjQyRDcyMTFFNThGQThGNDVBMjNBMjFDMzkiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDoyRjA0N0I2MjJENzExMUU1OEZBOEY0NUEyM0EyMUMzOSIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDpGNDc5OTRCMjJENzIxMUU1OEZBOEY0NUEyM0EyMUMzOSIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PjIf+MgAAATlSURBVHjanFZraFxFFD735u4ru3ls0yZG26ShgmJoKK1J2vhIYzBgRdtIURHyw1hQUH9IxIgI2h8iCEUF/1RRlNQYCsYfCTHVhiTtNolpZCEStqSC22xIsrs1bDfu7t37Gs/cO3Ozxs1DBw73zpk555vzmHNGgJ0NYatFgmNLYUHYUoHASMz5ijmgVLmxgfKCUiBxC4ACJAeSG8nb1dVVOTc3dyoSibwWDofPBIPBJzo7O8vpGtvjpDICGztxkciECpF2LS0tvZtOpwNkk5FKpcYXFxffwL1+JuPgllPj8nk1F6RoaGjoKCqZ5ApljZDZO4SMRA0SuG2QUJIQRV8HxMOM9vf3H0ZZH9Nhg20MMl2QkFwjIyNHWlpahtADnuUMwLcRHX5aNSBjCJYEsSSLUeLEbhGe3ytCmQtA1/XY+Pj46dbW1iDuyCJp9BC5ycBj4hoeHq5ra2sbw0Xn1ZgBZ+dVkA1Lc+6p0Ck2p0QS4Ox9EhwpEylYcmBg4LH29vYQLilIOt0u5FhDfevNZDI/u93uw6PLOrwTUtjxrbPYbhD42WgMrF8JmR894ICmCgnQjVe8Xu8pXEkzMJKbuo5oNPomBbm1ZsD7s2kwFA1JZ6QBUXWT1nmGNc/qoMgavDcrQzxjQGFh4aOYIJ0sFAXcEtui4uLiVjr5KpSBVFYDDZVrWUaKRRWSAYeK0fmKykgDXbVoNaPChRuyqdDv97czL5nXxQbq6empQmsaklkDBiNpSwFVrmr2P6UyicD5piI4f8wHh0oEm8/p4h8pyGiEWvVQd3e3nxtjAzU1NR2jP7NRBWQ8GbdEzzJAmc0V3RR4cI8Dvmwuhc8fKUFA0d6/ltHg5p+Kuaejo6OeY0jcNJ/PV00ZS0nFUoZRvvFS1bZFsKHCCQ2Pl8H0chY+C96B6ZUsrCQ1qKtwQVFRURW/QhIXMAzDPAZ6BgOr8tTa8dDxCmiYGApaJbJMxSzV+brE8pdgWkcpY5dbMF1AR9XH8/xu2ilef48bvn92n82ZwHh+8ssqTEXS9p7dHisiiURikd8PbpExNTU1UVNTA3V3Y7lC16n0gpB/NwpNcZjfa7dScC4Qh0kOQCwnlEgi3F/hMVl9fX0zvKrzSk2lfXjRhj0eT/2rvWG4+Pta3oJY7XfC3hInXAv/ldeFLx8shQ+eqQL0UAAz7ylkpej5eNZRVBWL6BU6ef14OYiY1oqyTtmsavr/5koaRucT1pzx+ZpL1+GV5nLutksUgIcmtwTRiuuVZXnU5XId7A2swJkfFsymRWC91hHg1Viw6x23+7vn9sPJ+j20BE1hCXqSWaNSQ8ScbknRZWxub1PGCw/fBV+c3AeijlUbY5bBjEqr9GuYZP4jP41WudGSC6erTRCqdGZm5i1WvXWeDHnbBCZGc2Nj4wBl/hZOwrmBBfgmlID1HmGJutHaF+tKoevp/XCgstDkjo2NtWKLuc6AVN4mNjY+s1XQxoenOoFuDPHGtnRbJj9ej5GvL0dI7+giuRyMk1giazc+DP6vgUDgOJVlOv7R+PJ12QIeL6SyeDz+Kfp8ZrNWjgDTsVjsQ7qXyTjztXJhm9ePxFLfMTg4eG9tbe1RTP9KFFYQfHliYmIS69kCC7jKYmKwxxD5P88tkVkqbPPcIps9t4T/+HjcuJ/s5BFJgf4WYABCtxGuxIZ90gAAAABJRU5ErkJggg==":IMAGE_PATH+"/handle-connect.png",26,26);var BackgroundImageDialog=function(n,t,e){var i=document.createElement("div");i.style.whiteSpace="nowrap";var l=document.createElement("h2");mxUtils.write(l,mxResources.get("backgroundImage")),l.style.marginTop="5px",i.appendChild(l);var s=null!=e&&null!=e.originalSrc,a=!1,o=document.createElement("input");o.style.cssText="margin-right:8px;margin-bottom:8px;",o.setAttribute("value","url"),o.setAttribute("type","radio"),o.setAttribute("name","geBackgroundImageDialogOption");var r=document.createElement("input");r.style.cssText="margin-right:8px;margin-bottom:8px;",r.setAttribute("value","url"),r.setAttribute("type","radio"),r.setAttribute("name","geBackgroundImageDialogOption");var d=document.createElement("input");d.setAttribute("type","text"),d.style.marginBottom="8px",d.style.width="320px",d.value=s||null==e?"":e.src;var c=document.createElement("select");if(c.style.width="320px",null!=n.pages)for(var m=0;m<n.pages.length;m++){var u=document.createElement("option");mxUtils.write(u,n.pages[m].getName()||mxResources.get("pageWithNumber",[m+1])),u.setAttribute("value","data:page/id,"+n.pages[m].getId()),n.pages[m]==n.currentPage&&u.setAttribute("disabled","disabled"),null!=e&&e.originalSrc==u.getAttribute("value")&&(u.setAttribute("selected","selected"),a=!0),c.appendChild(u)}s||null!=n.pages&&1!=n.pages.length||(o.style.display="none",r.style.display="none",c.style.display="none");function p(e,t){g||null!=e&&h||(r.checked?null!=t&&t(c.value):""==d.value||n.isOffline()?(b.value="",v.value="",null!=t&&t("")):(d.value=mxUtils.trim(d.value),n.loadImage(d.value,function(e){b.value=e.width,v.value=e.height,null!=t&&t(d.value)},function(){n.showError(mxResources.get("error"),mxResources.get("fileNotFound"),mxResources.get("ok")),b.value="",v.value="",null!=t&&t(null)})))}var g=!1,h=!1;this.init=function(){var t,l;(s?c:d).focus(),mxEvent.addListener(c,"focus",function(){o.removeAttribute("checked"),r.setAttribute("checked","checked"),r.checked=!0}),mxEvent.addListener(d,"focus",function(){r.removeAttribute("checked"),o.setAttribute("checked","checked"),o.checked=!0}),Graph.fileSupport&&(d.setAttribute("placeholder",mxResources.get("dragImagesHere")),t=i.parentNode,n.editor.graph,l=null,mxEvent.addListener(t,"dragleave",function(e){null!=l&&(l.parentNode.removeChild(l),l=null),e.stopPropagation(),e.preventDefault()}),mxEvent.addListener(t,"dragover",mxUtils.bind(this,function(e){null==l&&(!mxClient.IS_IE||10<document.documentMode)&&(l=n.highlightElement(t)),e.stopPropagation(),e.preventDefault()})),mxEvent.addListener(t,"drop",mxUtils.bind(this,function(e){var t;null!=l&&(l.parentNode.removeChild(l),l=null),0<e.dataTransfer.files.length?n.importFiles(e.dataTransfer.files,0,0,n.maxBackgroundSize,function(e,t,l,n,i,s){d.value=e,p()},function(){},function(e){return"image/"==e.type.substring(0,6)},function(e){for(var t=0;t<e.length;t++)e[t]()},!0,n.maxBackgroundBytes,n.maxBackgroundBytes,!0):0<=mxUtils.indexOf(e.dataTransfer.types,"text/uri-list")&&(t=e.dataTransfer.getData("text/uri-list"),/\.(gif|jpg|jpeg|tiff|png|svg)$/i.test(t)&&(d.value=decodeURIComponent(t),p())),e.stopPropagation(),e.preventDefault()}),!1))},i.appendChild(o),i.appendChild(d),mxUtils.br(i);var x=document.createElement("span");x.style.marginLeft="30px",mxUtils.write(x,mxResources.get("width")+":"),i.appendChild(x);var b=document.createElement("input");b.setAttribute("type","text"),b.style.width="60px",b.style.marginLeft="8px",b.style.marginRight="16px",b.value=null==e||s?"":e.width,i.appendChild(b),mxUtils.write(i,mxResources.get("height")+":");var y,v=document.createElement("input");v.setAttribute("type","text"),v.style.width="60px",v.style.marginLeft="8px",v.style.marginRight="16px",v.value=null==e||s?"":e.height,i.appendChild(v),mxUtils.br(i),mxUtils.br(i),mxEvent.addListener(d,"change",p),ImageDialog.filePicked=function(e){e.action==google.picker.Action.PICKED&&(null==e.docs[0].thumbnails||null!=(e=e.docs[0].thumbnails[e.docs[0].thumbnails.length-1])&&(d.value=e.url,p())),d.focus()},i.appendChild(r),i.appendChild(c),mxUtils.br(i),s?(r.setAttribute("checked","checked"),r.checked=!0):(o.setAttribute("checked","checked"),o.checked=!0),!a&&r.checked&&(y=document.createElement("option"),mxUtils.write(y,mxResources.get("pageNotFound")),y.setAttribute("disabled","disabled"),y.setAttribute("selected","selected"),y.setAttribute("value","pageNotFound"),c.appendChild(y),mxEvent.addListener(c,"change",function(){null==y.parentNode||y.selected||y.parentNode.removeChild(y)}));l=document.createElement("div");l.style.marginTop="30px",l.style.textAlign="right";x=mxUtils.button(mxResources.get("reset"),function(){d.value="",b.value="",v.value="",o.checked=!0,g=!1});mxEvent.addGestureListeners(x,function(){g=!0}),x.className="geBtn",x.width="100",l.appendChild(x);x=mxUtils.button(mxResources.get("cancel"),function(){g=!0,n.hideDialog()});x.className="geBtn",n.editor.cancelFirst&&l.appendChild(x),applyBtn=mxUtils.button(mxResources.get("apply"),function(){n.hideDialog(),p(null,function(e){t(""!=e&&null!=e?new mxImage(e,b.value,v.value):null,null==e)})}),mxEvent.addGestureListeners(applyBtn,function(){h=!0}),applyBtn.className="geBtn gePrimaryBtn",l.appendChild(applyBtn),n.editor.cancelFirst||l.appendChild(x),i.appendChild(l),this.container=i},ParseDialog=function(L,e,t){var U="@startuml\nskinparam shadowing false\nAlice -> Bob: Authentication Request\nBob --\x3e Alice: Authentication Response\n\nAlice -> Bob: Another authentication Request\nAlice <-- Bob: Another authentication Response\n@enduml",M=L.editor.graph.getFreeInsertPoint();var l=document.createElement("div");l.style.textAlign="right";var n=document.createElement("textarea");n.style.resize="none",n.style.width="100%",n.style.height="354px",n.style.marginBottom="16px";var i=document.createElement("select");"formatSql"!=t&&"mermaid"!=t||(i.style.display="none");var s=document.createElement("option");s.setAttribute("value","list"),mxUtils.write(s,mxResources.get("list")),"plantUml"!=t&&i.appendChild(s),null!=t&&"fromText"!=t||s.setAttribute("selected","selected");var a=document.createElement("option");a.setAttribute("value","table"),mxUtils.write(a,mxResources.get("formatSql")),"formatSql"==t&&(i.appendChild(a),a.setAttribute("selected","selected"));var o=document.createElement("option");o.setAttribute("value","mermaid"),mxUtils.write(o,mxResources.get("formatSql")),"mermaid"==t&&(i.appendChild(o),o.setAttribute("selected","selected"));s=document.createElement("option");s.setAttribute("value","diagram"),mxUtils.write(s,mxResources.get("diagram")),"plantUml"!=t&&i.appendChild(s);a=document.createElement("option");a.setAttribute("value","plantUmlSvg"),mxUtils.write(a,mxResources.get("plantUml")+" ("+mxResources.get("formatSvg")+")"),"plantUml"==t&&a.setAttribute("selected","selected");o=document.createElement("option");o.setAttribute("value","plantUmlPng"),mxUtils.write(o,mxResources.get("plantUml")+" ("+mxResources.get("formatPng")+")");s=document.createElement("option");function r(){return"list"==i.value?"Person\n-name: String\n-birthDate: Date\n--\n+getName(): String\n+setName(String): void\n+isBirthday(): boolean\n\nAddress\n-street: String\n-city: String\n-state: String":"mermaid"==i.value?"graph TD;\n  A--\x3eB;\n  A--\x3eC;\n  B--\x3eD;\n  C--\x3eD;":"table"==i.value?"CREATE TABLE Suppliers\n(\nsupplier_id int NOT NULL PRIMARY KEY,\nsupplier_name char(50) NOT NULL,\ncontact_name char(50),\n);\nCREATE TABLE Customers\n(\ncustomer_id int NOT NULL PRIMARY KEY,\ncustomer_name char(50) NOT NULL,\naddress char(50),\ncity char(50),\nstate char(25),\nzip_code char(10)\n);\n":"plantUmlPng"==i.value?"@startuml\nskinparam backgroundcolor transparent\nskinparam shadowing false\nAlice -> Bob: Authentication Request\nBob --\x3e Alice: Authentication Response\n\nAlice -> Bob: Another authentication Request\nAlice <-- Bob: Another authentication Response\n@enduml":"plantUmlSvg"==i.value||"plantUmlTxt"==i.value?U:";Example:\na->b\nb->edge label->c\nc->a\n"}s.setAttribute("value","plantUmlTxt"),mxUtils.write(s,mxResources.get("plantUml")+" ("+mxResources.get("text")+")"),EditorUi.enablePlantUml&&Graph.fileSupport&&!L.isOffline()&&"plantUml"==t&&(i.appendChild(a),i.appendChild(o),i.appendChild(s));var d=r();n.value=d,l.appendChild(n),this.init=function(){n.focus()},Graph.fileSupport&&(n.addEventListener("dragover",function(e){e.stopPropagation(),e.preventDefault()},!1),n.addEventListener("drop",function(e){var t;e.stopPropagation(),e.preventDefault(),0<e.dataTransfer.files.length&&(t=e.dataTransfer.files[0],(e=new FileReader).onload=function(e){n.value=e.target.result},e.readAsText(t))},!1)),l.appendChild(i),mxEvent.addListener(i,"change",function(){var e=r();0!=n.value.length&&n.value!=d||(d=e,n.value=d)}),"1"!=urlParams.customMenu&&(L.isOffline()||"mermaid"!=t&&"plantUml"!=t||((c=mxUtils.button(mxResources.get("help"),function(){L.openLink("mermaid"==t?"https://mermaid-js.github.io/mermaid/#/":"https://plantuml.com/")})).className="geBtn",l.appendChild(c)));s=mxUtils.button(mxResources.get("close"),function(){n.value==d?L.hideDialog():L.confirm(mxResources.get("areYouSure"),function(){L.hideDialog()})});s.className="geBtn",L.editor.cancelFirst&&l.appendChild(s);var c=mxUtils.button(mxResources.get("insert"),function(e){L.hideDialog(),function(i,e,a){var n,t=i.split("\n");if("plantUmlPng"==e||"plantUmlSvg"==e||"plantUmlTxt"==e){function s(e,t,l,n,i){M=mxEvent.isAltDown(a)?M:b.getCenterInsertPoint(new mxRectangle(0,0,n,i));var s=null;b.getModel().beginUpdate();try{s="txt"==t?L.insertAsPreText(l,M.x,M.y):b.insertVertex(null,null,null,M.x,M.y,n,i,"shape=image;noLabel=1;verticalAlign=top;aspect=fixed;imageAspect=0;image="+L.convertDataUri(l)+";"),b.setAttributeForCell(s,"plantUmlData",JSON.stringify({data:e,format:t},null,2))}finally{b.getModel().endUpdate()}null!=s&&(b.setSelectionCell(s),b.scrollCellToVisible(s))}L.spinner.spin(document.body,mxResources.get("inserting"))&&(b=L.editor.graph,n="plantUmlTxt"==e?"txt":"plantUmlPng"==e?"png":"svg",i==U&&"svg"==n?window.setTimeout(function(){L.spinner.stop(),s(i,n,"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiBjb250ZW50U2NyaXB0VHlwZT0iYXBwbGljYXRpb24vZWNtYXNjcmlwdCIgY29udGVudFN0eWxlVHlwZT0idGV4dC9jc3MiIGhlaWdodD0iMjEycHgiIHByZXNlcnZlQXNwZWN0UmF0aW89Im5vbmUiIHN0eWxlPSJ3aWR0aDoyOTVweDtoZWlnaHQ6MjEycHg7IiB2ZXJzaW9uPSIxLjEiIHZpZXdCb3g9IjAgMCAyOTUgMjEyIiB3aWR0aD0iMjk1cHgiIHpvb21BbmRQYW49Im1hZ25pZnkiPjxkZWZzLz48Zz48bGluZSBzdHlsZT0ic3Ryb2tlOiAjQTgwMDM2OyBzdHJva2Utd2lkdGg6IDEuMDsgc3Ryb2tlLWRhc2hhcnJheTogNS4wLDUuMDsiIHgxPSIzMSIgeDI9IjMxIiB5MT0iMzQuNDg4MyIgeTI9IjE3MS43MzA1Ii8+PGxpbmUgc3R5bGU9InN0cm9rZTogI0E4MDAzNjsgc3Ryb2tlLXdpZHRoOiAxLjA7IHN0cm9rZS1kYXNoYXJyYXk6IDUuMCw1LjA7IiB4MT0iMjY0LjUiIHgyPSIyNjQuNSIgeTE9IjM0LjQ4ODMiIHkyPSIxNzEuNzMwNSIvPjxyZWN0IGZpbGw9IiNGRUZFQ0UiIGhlaWdodD0iMzAuNDg4MyIgc3R5bGU9InN0cm9rZTogI0E4MDAzNjsgc3Ryb2tlLXdpZHRoOiAxLjU7IiB3aWR0aD0iNDciIHg9IjgiIHk9IjMiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nQW5kR2x5cGhzIiB0ZXh0TGVuZ3RoPSIzMyIgeD0iMTUiIHk9IjIzLjUzNTIiPkFsaWNlPC90ZXh0PjxyZWN0IGZpbGw9IiNGRUZFQ0UiIGhlaWdodD0iMzAuNDg4MyIgc3R5bGU9InN0cm9rZTogI0E4MDAzNjsgc3Ryb2tlLXdpZHRoOiAxLjU7IiB3aWR0aD0iNDciIHg9IjgiIHk9IjE3MC43MzA1Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZ0FuZEdseXBocyIgdGV4dExlbmd0aD0iMzMiIHg9IjE1IiB5PSIxOTEuMjY1NiI+QWxpY2U8L3RleHQ+PHJlY3QgZmlsbD0iI0ZFRkVDRSIgaGVpZ2h0PSIzMC40ODgzIiBzdHlsZT0ic3Ryb2tlOiAjQTgwMDM2OyBzdHJva2Utd2lkdGg6IDEuNTsiIHdpZHRoPSI0MCIgeD0iMjQ0LjUiIHk9IjMiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nQW5kR2x5cGhzIiB0ZXh0TGVuZ3RoPSIyNiIgeD0iMjUxLjUiIHk9IjIzLjUzNTIiPkJvYjwvdGV4dD48cmVjdCBmaWxsPSIjRkVGRUNFIiBoZWlnaHQ9IjMwLjQ4ODMiIHN0eWxlPSJzdHJva2U6ICNBODAwMzY7IHN0cm9rZS13aWR0aDogMS41OyIgd2lkdGg9IjQwIiB4PSIyNDQuNSIgeT0iMTcwLjczMDUiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nQW5kR2x5cGhzIiB0ZXh0TGVuZ3RoPSIyNiIgeD0iMjUxLjUiIHk9IjE5MS4yNjU2Ij5Cb2I8L3RleHQ+PHBvbHlnb24gZmlsbD0iI0E4MDAzNiIgcG9pbnRzPSIyNTIuNSw2MS43OTg4LDI2Mi41LDY1Ljc5ODgsMjUyLjUsNjkuNzk4OCwyNTYuNSw2NS43OTg4IiBzdHlsZT0ic3Ryb2tlOiAjQTgwMDM2OyBzdHJva2Utd2lkdGg6IDEuMDsiLz48bGluZSBzdHlsZT0ic3Ryb2tlOiAjQTgwMDM2OyBzdHJva2Utd2lkdGg6IDEuMDsiIHgxPSIzMS41IiB4Mj0iMjU4LjUiIHkxPSI2NS43OTg4IiB5Mj0iNjUuNzk4OCIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEzIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmdBbmRHbHlwaHMiIHRleHRMZW5ndGg9IjE0NyIgeD0iMzguNSIgeT0iNjEuMDU2NiI+QXV0aGVudGljYXRpb24gUmVxdWVzdDwvdGV4dD48cG9seWdvbiBmaWxsPSIjQTgwMDM2IiBwb2ludHM9IjQyLjUsOTEuMTA5NCwzMi41LDk1LjEwOTQsNDIuNSw5OS4xMDk0LDM4LjUsOTUuMTA5NCIgc3R5bGU9InN0cm9rZTogI0E4MDAzNjsgc3Ryb2tlLXdpZHRoOiAxLjA7Ii8+PGxpbmUgc3R5bGU9InN0cm9rZTogI0E4MDAzNjsgc3Ryb2tlLXdpZHRoOiAxLjA7IHN0cm9rZS1kYXNoYXJyYXk6IDIuMCwyLjA7IiB4MT0iMzYuNSIgeDI9IjI2My41IiB5MT0iOTUuMTA5NCIgeTI9Ijk1LjEwOTQiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMyIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nQW5kR2x5cGhzIiB0ZXh0TGVuZ3RoPSIxNTciIHg9IjQ4LjUiIHk9IjkwLjM2NzIiPkF1dGhlbnRpY2F0aW9uIFJlc3BvbnNlPC90ZXh0Pjxwb2x5Z29uIGZpbGw9IiNBODAwMzYiIHBvaW50cz0iMjUyLjUsMTIwLjQxOTksMjYyLjUsMTI0LjQxOTksMjUyLjUsMTI4LjQxOTksMjU2LjUsMTI0LjQxOTkiIHN0eWxlPSJzdHJva2U6ICNBODAwMzY7IHN0cm9rZS13aWR0aDogMS4wOyIvPjxsaW5lIHN0eWxlPSJzdHJva2U6ICNBODAwMzY7IHN0cm9rZS13aWR0aDogMS4wOyIgeDE9IjMxLjUiIHgyPSIyNTguNSIgeTE9IjEyNC40MTk5IiB5Mj0iMTI0LjQxOTkiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMyIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nQW5kR2x5cGhzIiB0ZXh0TGVuZ3RoPSIxOTkiIHg9IjM4LjUiIHk9IjExOS42Nzc3Ij5Bbm90aGVyIGF1dGhlbnRpY2F0aW9uIFJlcXVlc3Q8L3RleHQ+PHBvbHlnb24gZmlsbD0iI0E4MDAzNiIgcG9pbnRzPSI0Mi41LDE0OS43MzA1LDMyLjUsMTUzLjczMDUsNDIuNSwxNTcuNzMwNSwzOC41LDE1My43MzA1IiBzdHlsZT0ic3Ryb2tlOiAjQTgwMDM2OyBzdHJva2Utd2lkdGg6IDEuMDsiLz48bGluZSBzdHlsZT0ic3Ryb2tlOiAjQTgwMDM2OyBzdHJva2Utd2lkdGg6IDEuMDsgc3Ryb2tlLWRhc2hhcnJheTogMi4wLDIuMDsiIHgxPSIzNi41IiB4Mj0iMjYzLjUiIHkxPSIxNTMuNzMwNSIgeTI9IjE1My43MzA1Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTMiIGxlbmd0aEFkanVzdD0ic3BhY2luZ0FuZEdseXBocyIgdGV4dExlbmd0aD0iMjA5IiB4PSI0OC41IiB5PSIxNDguOTg4MyI+QW5vdGhlciBhdXRoZW50aWNhdGlvbiBSZXNwb25zZTwvdGV4dD48IS0tTUQ1PVs3ZjNlNGQwYzkwMWVmZGJjNTdlYjQ0MjQ5YTNiODE5N10KQHN0YXJ0dW1sDQpza2lucGFyYW0gc2hhZG93aW5nIGZhbHNlDQpBbGljZSAtPiBCb2I6IEF1dGhlbnRpY2F0aW9uIFJlcXVlc3QNCkJvYiAtIC0+IEFsaWNlOiBBdXRoZW50aWNhdGlvbiBSZXNwb25zZQ0KDQpBbGljZSAtPiBCb2I6IEFub3RoZXIgYXV0aGVudGljYXRpb24gUmVxdWVzdA0KQWxpY2UgPC0gLSBCb2I6IEFub3RoZXIgYXV0aGVudGljYXRpb24gUmVzcG9uc2UNCkBlbmR1bWwNCgpQbGFudFVNTCB2ZXJzaW9uIDEuMjAyMC4wMihTdW4gTWFyIDAxIDA0OjIyOjA3IENTVCAyMDIwKQooTUlUIHNvdXJjZSBkaXN0cmlidXRpb24pCkphdmEgUnVudGltZTogT3BlbkpESyBSdW50aW1lIEVudmlyb25tZW50CkpWTTogT3BlbkpESyA2NC1CaXQgU2VydmVyIFZNCkphdmEgVmVyc2lvbjogMTIrMzMKT3BlcmF0aW5nIFN5c3RlbTogTWFjIE9TIFgKRGVmYXVsdCBFbmNvZGluZzogVVRGLTgKTGFuZ3VhZ2U6IGVuCkNvdW50cnk6IFVTCi0tPjwvZz48L3N2Zz4=",295,212)},200):L.generatePlantUmlImage(i,n,function(e,t,l){L.spinner.stop(),s(i,n,e,t,l)},function(e){L.handleError(e)}))}else if("mermaid"==e)L.spinner.spin(document.body,mxResources.get("inserting"))&&(b=L.editor.graph,L.generateMermaidImage(i,n,function(e,t,l){M=mxEvent.isAltDown(a)?M:b.getCenterInsertPoint(new mxRectangle(0,0,t,l)),L.spinner.stop();var n=null;b.getModel().beginUpdate();try{n=b.insertVertex(null,null,null,M.x,M.y,t,l,"shape=image;noLabel=1;verticalAlign=top;imageAspect=1;image="+e+";"),b.setAttributeForCell(n,"mermaidData",JSON.stringify({data:i,config:EditorUi.defaultMermaidConfig},null,2))}finally{b.getModel().endUpdate()}null!=n&&(b.setSelectionCell(n),b.scrollCellToVisible(n))},function(e){L.handleError(e)}));else if("table"==e){for(var l=null,o=[],r=0,d={},c=0;c<t.length;c++){var m=mxUtils.trim(t[c]);"primary key"==m.substring(0,11).toLowerCase()?((p=m.match(/\((.+)\)/))&&p[1]&&(d[p[1]]=!0),t.splice(c,1)):0<m.toLowerCase().indexOf("primary key")&&(d[m.split(" ")[0]]=!0,t[c]=mxUtils.trim(m.replace(/primary key/i,"")))}for(c=0;c<t.length;c++){var u,p,g,h=mxUtils.trim(t[c]);"create table"==h.substring(0,12).toLowerCase()?("("==(u=mxUtils.trim(h.substring(12))).charAt(u.length-1)&&(u=mxUtils.trim(u.substring(0,u.length-1))),(l=new mxCell(u,new mxGeometry(r,0,160,40),"shape=table;startSize=30;container=1;collapsible=1;childLayout=tableLayout;fixedRows=1;rowLines=0;fontStyle=1;align=center;resizeLast=1;")).vertex=!0,o.push(l),null!=(T=L.editor.graph.getPreferredSizeForCell(g))&&(l.geometry.width=T.width+10)):null!=l&&")"==h.charAt(0)?(r+=l.geometry.width+40,l=null):"("!=h&&null!=l&&(p=d[(u=h.substring(0,","==h.charAt(h.length-1)?h.length-1:h.length)).split(" ")[0]],(g=new mxCell("",new mxGeometry(0,0,160,30),"shape=partialRectangle;collapsible=0;dropTarget=0;pointerEvents=0;fillColor=none;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;top=0;left=0;right=0;bottom="+(p?"1":"0")+";")).vertex=!0,(h=new mxCell(p?"PK":"",new mxGeometry(0,0,30,30),"shape=partialRectangle;overflow=hidden;connectable=0;fillColor=none;top=0;left=0;bottom=0;right=0;"+(p?"fontStyle=1;":""))).vertex=!0,g.insert(h),(h=new mxCell(u,new mxGeometry(30,0,130,30),"shape=partialRectangle;overflow=hidden;connectable=0;fillColor=none;top=0;left=0;bottom=0;right=0;align=left;spacingLeft=6;"+(p?"fontStyle=5;":""))).vertex=!0,g.insert(h),null!=(T=L.editor.graph.getPreferredSizeForCell(h))&&l.geometry.width<T.width+30&&(l.geometry.width=Math.min(320,Math.max(l.geometry.width,T.width+30))),l.insert(g,p?0:null),l.geometry.height+=30)}0<o.length&&(b=L.editor.graph,M=mxEvent.isAltDown(a)?M:b.getCenterInsertPoint(b.getBoundingBoxFromGeometry(o,!0)),b.setSelectionCells(b.importCells(o,M.x,M.y)),b.scrollCellToVisible(b.getSelectionCell()))}else if("list"==e){if(0<t.length){for(var x,b=L.editor.graph,y=null,o=[],v=0,c=0;c<t.length;c++)";"!=t[c].charAt(0)&&(0==t[c].length?y=null:null==y?((y=new mxCell(t[c],new mxGeometry(v,0,160,30),"swimlane;fontStyle=1;childLayout=stackLayout;horizontal=1;startSize=26;horizontalStack=0;resizeParent=1;resizeParentMax=0;resizeLast=0;collapsible=1;marginBottom=0;")).vertex=!0,o.push(y),null!=(T=b.getPreferredSizeForCell(y))&&y.geometry.width<T.width+10&&(y.geometry.width=T.width+10),v+=y.geometry.width+40):"--"==t[c]?((x=new mxCell("",new mxGeometry(0,0,40,8),"line;strokeWidth=1;fillColor=none;align=left;verticalAlign=middle;spacingTop=-1;spacingLeft=3;spacingRight=3;rotatable=0;labelPosition=right;points=[];portConstraint=eastwest;")).vertex=!0,y.geometry.height+=x.geometry.height,y.insert(x)):0<t[c].length&&((x=new mxCell(t[c],new mxGeometry(0,0,60,26),"text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;")).vertex=!0,null!=(T=b.getPreferredSizeForCell(x))&&x.geometry.width<T.width&&(x.geometry.width=T.width),y.geometry.width=Math.max(y.geometry.width,x.geometry.width),y.geometry.height+=x.geometry.height,y.insert(x)));if(0<o.length){M=mxEvent.isAltDown(a)?M:b.getCenterInsertPoint(b.getBoundingBoxFromGeometry(o,!0)),b.getModel().beginUpdate();try{o=b.importCells(o,M.x,M.y);for(var f=[],c=0;c<o.length;c++)f.push(o[c]),f=f.concat(o[c].children);b.fireEvent(new mxEventObject("cellsInserted","cells",f))}finally{b.getModel().endUpdate()}b.setSelectionCells(o),b.scrollCellToVisible(b.getSelectionCell())}}}else{var E=new Object,o=[];function w(e){var t=E[e];return null==t&&((t=new mxCell(e,new mxGeometry(0,0,80,30),"whiteSpace=wrap;html=1;")).vertex=!0,E[e]=t,o.push(t)),t}for(var C,A,D,c=0;c<t.length;c++)";"==t[c].charAt(0)||2<=(D=t[c].split("->")).length&&(C=w(D[0]),A=w(D[D.length-1]),(D=new mxCell(2<D.length?D[1]:"",new mxGeometry)).edge=!0,C.insertEdge(D,!0),A.insertEdge(D,!1),o.push(D));if(0<o.length){e=document.createElement("div");e.style.visibility="hidden",document.body.appendChild(e),(b=new Graph(e)).getModel().beginUpdate();try{o=b.importCells(o);for(var T,c=0;c<o.length;c++)b.getModel().isVertex(o[c])&&(T=b.getPreferredSizeForCell(o[c]),o[c].geometry.width=Math.max(o[c].geometry.width,T.width),o[c].geometry.height=Math.max(o[c].geometry.height,T.height));var R=new mxFastOrganicLayout(b);R.disableEdgeStyle=!1,R.forceConstant=120,R.execute(b.getDefaultParent());var I=new mxParallelEdgeLayout(b);I.spacing=20,I.execute(b.getDefaultParent())}finally{b.getModel().endUpdate()}b.clearCellOverlays();f=[];L.editor.graph.getModel().beginUpdate();try{o=b.getModel().getChildren(b.getDefaultParent()),M=mxEvent.isAltDown(a)?M:L.editor.graph.getCenterInsertPoint(b.getBoundingBoxFromGeometry(o,!0)),f=L.editor.graph.importCells(o,M.x,M.y),L.editor.graph.fireEvent(new mxEventObject("cellsInserted","cells",f))}finally{L.editor.graph.getModel().endUpdate()}L.editor.graph.setSelectionCells(f),L.editor.graph.scrollCellToVisible(L.editor.graph.getSelectionCell()),b.destroy(),e.parentNode.removeChild(e)}}}(n.value,i.value,e)});l.appendChild(c),c.className="geBtn gePrimaryBtn",L.editor.cancelFirst||l.appendChild(s),this.container=l},NewDialog=function(f,e,l,n,t,i,b,o,r,y,x,s,a,d,c,m,u,p){var g=(window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth)<500;l=null==l||l,t=null!=t&&t,b=null!=b?b:"#ebf2f9",o=null!=o?o:Editor.isDarkMode()?"#a2a2a2":"#e6eff8",r=null!=r?r:Editor.isDarkMode()?"1px dashed #00a8ff":"1px solid #ccd9ea",x=null!=x?x:EditorUi.templateFile;var h=document.createElement("div");h.style.userSelect="none",h.style.height="100%";var v=document.createElement("div");v.style.whiteSpace="nowrap",v.style.height="46px",l&&h.appendChild(v);var E=document.createElement("img");E.setAttribute("border","0"),E.setAttribute("align","absmiddle"),E.style.width="40px",E.style.height="40px",E.style.marginRight="10px",E.style.paddingBottom="4px",f.mode==App.MODE_GOOGLE?E.src=IMAGE_PATH+"/google-drive-logo.svg":f.mode==App.MODE_DROPBOX?E.src=IMAGE_PATH+"/dropbox-logo.svg":f.mode==App.MODE_ONEDRIVE?E.src=IMAGE_PATH+"/onedrive-logo.svg":f.mode==App.MODE_GITHUB?E.src=IMAGE_PATH+"/github-logo.svg":f.mode==App.MODE_GITLAB?E.src=IMAGE_PATH+"/gitlab-logo.svg":f.mode==App.MODE_NOTION?E.src=IMAGE_PATH+"/notion-logo.svg":f.mode==App.MODE_TRELLO?E.src=IMAGE_PATH+"/trello-logo.svg":f.mode==App.MODE_BROWSER?E.src=IMAGE_PATH+"/osa_database.png":E.src=IMAGE_PATH+"/osa_drive-harddisk.png",e||g||!l||v.appendChild(E),l&&mxUtils.write(v,(g?mxResources.get("name"):null==f.mode||f.mode==App.MODE_GOOGLE||f.mode==App.MODE_BROWSER?mxResources.get("diagramName"):mxResources.get("filename"))+":");E=".drawio";f.mode==App.MODE_GOOGLE&&null!=f.drive?E=f.drive.extension:f.mode==App.MODE_DROPBOX&&null!=f.dropbox?E=f.dropbox.extension:f.mode==App.MODE_ONEDRIVE&&null!=f.oneDrive?E=f.oneDrive.extension:f.mode==App.MODE_GITHUB&&null!=f.gitHub?E=f.gitHub.extension:f.mode==App.MODE_GITLAB&&null!=f.gitLab?E=f.gitLab.extension:f.mode==App.MODE_NOTION&&null!=f.notion?E=f.notion.extension:f.mode==App.MODE_TRELLO&&null!=f.trello&&(E=f.trello.extension);var w=document.createElement("input");w.setAttribute("value",f.defaultFilename+E),w.style.marginLeft="10px",w.style.width=e||g?"144px":"244px",this.init=function(){l&&(w.focus(),mxClient.IS_GC||mxClient.IS_FF||5<=document.documentMode?w.select():document.execCommand("selectAll",!1,null)),null!=j.parentNode&&null!=j.parentNode.parentNode&&mxEvent.addGestureListeners(j.parentNode.parentNode,mxUtils.bind(this,function(e){f.sidebar.hideTooltip()}),null,null)},l&&(v.appendChild(w),p?w.style.width=e||g?"350px":"450px":(null!=f.editor.diagramFileTypes&&((p=FilenameDialog.createFileTypes(f,w,f.editor.diagramFileTypes)).style.marginLeft="6px",p.style.width=e||g?"80px":"180px",v.appendChild(p)),null!=f.editor.fileExtensions&&((U=FilenameDialog.createTypeHint(f,w,f.editor.fileExtensions)).style.marginTop="12px",v.appendChild(U))));var v=!1,C=0;function A(e){null!=e&&(J=q=e?135:140);var t=!0;if(null!=re)for(;C<re.length&&(t||0!=mxUtils.mod(C,30));){var l=re[C++],l=function(a,l,o,e,t,n,r,i,s,d,c){var m=document.createElement("div");m.className="geTemplate",m.style.position="relative",m.style.height=J+"px",m.style.width=q+"px";var u=null;Editor.isDarkMode()&&(m.style.filter="invert(100%)");null!=o?m.setAttribute("title",mxResources.get(o,null,o)):null!=e&&0<e.length&&m.setAttribute("title",e);function p(e,t){null==u?(e=/^https?:\/\//.test(e=e)&&!f.editor.isCorsEnabledForUrl(e)?PROXY_URL+"?url="+encodeURIComponent(e):TEMPLATE_PATH+"/"+e,mxUtils.get(e,mxUtils.bind(this,function(e){200<=e.getStatus()&&e.getStatus()<=299&&(u=e.getText()),t(u)}))):t(u)}var g=!1;function h(s){null==a||g||f.sidebar.currentElt==m?f.sidebar.hideTooltip():(f.sidebar.hideTooltip(),f.sidebar.currentElt=m,g=!0,p(a,function(e){var t,l,n,i;g&&f.sidebar.currentElt==m&&(t=e,l=mxEvent.getClientX(s),n=mxEvent.getClientY(s),null!=t&&mxUtils.isAncestorNode(document.body,m)&&(i=mxUtils.parseXml(t),e=Editor.parseDiagramNode(i.documentElement),t=new mxCodec(e.ownerDocument),i=new mxGraphModel,t.decode(e,i),t=i.root.getChildAt(0).children,e=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,i=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,f.sidebar.createTooltip(m,t,Math.min(e-80,1e3),Math.min(i-80,800),null!=o?mxResources.get(o,null,o):null,!0,new mxPoint(l,n),!0,function(){v=null!=f.sidebar.tooltip&&"none"!=f.sidebar.tooltip.style.display,K(m,null,null,a,r,c)},!0,!1))),g=!1}))}{function x(t){S.setAttribute("disabled","disabled"),m.style.backgroundColor="transparent",m.style.border="1px solid transparent",N.spin(j),p(a,function(e){N.stop(),null!=e&&(K(m,e,l,null,null,c,oe),t&&_())})}var b,y;null!=n?(m.style.display="inline-flex",m.style.justifyContent="center",m.style.alignItems="center",(b=document.createElement("img")).setAttribute("src",n),b.setAttribute("alt",e),b.style.maxWidth=J+"px",b.style.maxHeight=q+"px",y=n.replace(".drawio.xml","").replace(".drawio","").replace(".xml",""),m.appendChild(b),b.onerror=function(){this.src!=y?this.src=y:(this.src=Editor.errorImage,this.onerror=null)},mxEvent.addGestureListeners(m,mxUtils.bind(this,function(e){K(m,null,null,a,r,c)}),null,null),mxEvent.addListener(m,"dblclick",function(e){_(),mxEvent.consume(e)})):!d&&null!=a&&0<a.length?(s=s||TEMPLATE_PATH+"/"+a.substring(0,a.length-4)+".png",m.style.backgroundImage="url("+s+")",m.style.backgroundPosition="center center",m.style.backgroundRepeat="no-repeat",null!=o&&(m.innerHTML='<table width="100%" height="100%" style="line-height:1.3em;'+(Editor.isDarkMode()?"":"background:rgba(255,255,255,0.85);")+'border:inherit;"><tr><td align="center" valign="middle"><span style="display:inline-block;padding:4px 8px 4px 8px;user-select:none;border-radius:3px;background:rgba(255,255,255,0.85);overflow:hidden;text-overflow:ellipsis;max-width:'+(J-34)+'px;">'+mxUtils.htmlEntities(mxResources.get(o,null,o))+"</span></td></tr></table>"),mxEvent.addGestureListeners(m,mxUtils.bind(this,function(e){x()}),null,null),mxEvent.addListener(m,"dblclick",function(e){x(!0),mxEvent.consume(e)})):(m.innerHTML='<table width="100%" height="100%" style="line-height:1.3em;"><tr><td align="center" valign="middle"><span style="display:inline-block;padding:4px 8px 4px 8px;user-select:none;border-radius:3px;background:#ffffff;overflow:hidden;text-overflow:ellipsis;max-width:'+(J-34)+'px;">'+mxUtils.htmlEntities(mxResources.get(o,null,o))+"</span></td></tr></table>",t&&K(m),mxEvent.addGestureListeners(m,mxUtils.bind(this,function(e){K(m,null,null,a,r)}),null,null),null!=i?mxEvent.addListener(m,"click",i):(mxEvent.addListener(m,"click",function(e){K(m,null,null,a,r)}),mxEvent.addListener(m,"dblclick",function(e){_(),mxEvent.consume(e)})))}{var v;null!=a&&"1"!=urlParams.customMenu&&((i=document.createElement("img")).setAttribute("src",Sidebar.prototype.searchImage),i.setAttribute("title",mxResources.get("preview")),i.className="geActiveButton",i.style.position="absolute",i.style.cursor="default",i.style.padding="8px",i.style.right="0px",i.style.top="0px",m.appendChild(i),v=!1,mxEvent.addGestureListeners(i,mxUtils.bind(this,function(e){v=f.sidebar.currentElt==m}),null,null),mxEvent.addListener(i,"click",mxUtils.bind(this,function(e){v||h(e),mxEvent.consume(e)})))}return j.appendChild(m),m}(l.url,l.libs,l.title,l.tooltip||l.title,l.select,l.imgUrl,l.info,l.onClick,l.preview,l.noImg,l.clibs);t&&l.click(),t=!1}}var D,T,R,I,L,U,M,k,N=new Spinner({lines:12,length:10,width:5,radius:10,rotate:0,color:"#000",speed:1.5,trail:60,shadow:!1,hwaccel:!1,top:"40%",zIndex:2e9}),S=mxUtils.button(m||mxResources.get("create"),function(){S.setAttribute("disabled","disabled"),_(),S.removeAttribute("disabled")});S.className="geBtn gePrimaryBtn",(s||a)&&(D=[],L=function(e){S.setAttribute("disabled","disabled");for(var t=0;t<D.length;t++)D[t].className=t==e?"geBtn gePrimaryBtn":"geBtn"},v=!(I=R=T=null),(U=document.createElement("div")).style.whiteSpace="nowrap",U.style.height="30px",h.appendChild(U),m=mxUtils.button(mxResources.get("Templates",null,"Templates"),function(){Q.style.display="",Z.style.display="",j.style.left="160px",L(0),j.scrollTop=0,j.innerHTML="",C=0,T!=re&&(re=T,$=R,le=I,Q.innerHTML="",ce(),T=null)}),D.push(m),U.appendChild(m),M=function(e){Q.style.display="none",Z.style.display="none",j.style.left="30px",L(e?-1:1),null==T&&(T=re),j.scrollTop=0,j.innerHTML="",N.spin(j);function t(e,t,l){C=0,N.stop(),re=e;var n=0;for(i in l=l||{})n+=l[i].length;if(t)j.innerHTML=t;else if(0==e.length&&0==n)j.innerHTML=mxUtils.htmlEntities(mxResources.get("noDiagrams",null,"No Diagrams Found"));else if(j.innerHTML="",0<n){for(var i in Q.style.display="",j.style.left="160px",Q.innerHTML="",le=0,$={"draw.io":e},l)$[i]=l[i];ce()}else A(!0)}e?a(k.value,t):s(t)},s&&(m=mxUtils.button(mxResources.get("Recent",null,"Recent"),function(){M()}),U.appendChild(m),D.push(m)),a&&((W=document.createElement("span")).style.marginLeft="10px",W.innerHTML=mxUtils.htmlEntities(mxResources.get("search")+":"),U.appendChild(W),(k=document.createElement("input")).style.marginRight="10px",k.style.marginLeft="10px",k.style.width="220px",mxEvent.addListener(k,"keypress",function(e){13==e.keyCode&&M(!0)}),U.appendChild(k),(W=mxUtils.button(mxResources.get("search"),function(){M(!0)})).className="geBtn",U.appendChild(W)),L(0));var B=null,O=null,P=null,G=null,H=null,F=null,z=null;function _(){var t;H&&null!=d?(l||f.hideDialog(),d(H,z,w.value)):n?(l||f.hideDialog(),n(P,w.value,F,B)):null!=(t=w.value)&&0<t.length&&f.pickFolder(f.mode,function(e){f.createFile(t,P,null!=B&&0<B.length?B:null,null,function(){f.hideDialog()},null,e,null,null!=O&&0<O.length?O:null)},f.mode!=App.MODE_GOOGLE||null==f.stateArg||null==f.stateArg.folderId)}var j=document.createElement("div");j.style.border="1px solid #d3d3d3",j.style.position="absolute",j.style.left="160px",j.style.right="34px";var W=l?72:40;j.style.top=(W+=v?30:0)+"px",j.style.bottom="68px",j.style.margin="6px 0 0 -1px",j.style.padding="6px",j.style.overflow="auto";var Z=document.createElement("div");Z.style.cssText="position:absolute;left:30px;width:128px;top:"+W+"px;height:22px;margin-top: 6px;white-space: nowrap";var V=document.createElement("input");V.style.cssText="width:105px;height:16px;border:1px solid #d3d3d3;padding: 3px 20px 3px 3px;font-size: 12px",V.setAttribute("placeholder",mxResources.get("search")),V.setAttribute("type","text"),Z.appendChild(V);var X=document.createElement("img"),Y="undefined"!=typeof Sidebar?Sidebar.prototype.searchImage:IMAGE_PATH+"/search.png";X.setAttribute("src",Y),X.setAttribute("title",mxResources.get("search")),X.style.position="relative",X.style.left="-18px",X.style.top="1px",X.style.background="url('"+f.editor.transparentImage+"')",Z.appendChild(X),mxEvent.addListener(X,"click",function(){X.getAttribute("src")==Dialog.prototype.closeImage&&(X.setAttribute("src",Y),X.setAttribute("title",mxResources.get("search")),V.value="",de()),V.focus()}),mxEvent.addListener(V,"keydown",mxUtils.bind(this,function(e){13==e.keyCode&&(function(){var e=V.value;if(""!=e){if(null==NewDialog.tagsList[x]){var t={};for(o in $)for(var l=$[o],n=0;n<l.length;n++)if(null!=(r=l[n]).tags)for(var i=r.tags.toLowerCase().split(";"),s=0;s<i.length;s++)null==t[i[s]]&&(t[i[s]]=[]),t[i[s]].push(r);NewDialog.tagsList[x]=t}var a=e.toLowerCase().split(" ");if(t=NewDialog.tagsList[x],0<le&&null==t.__tagsList__){for(var o in te)for(l=te[o],n=0;n<l.length;n++){var r=l[n];(i=r.title.split(" ")).push(o);for(s=0;s<i.length;s++){var d=i[s].toLowerCase();null==t[d]&&(t[d]=[]),t[d].push(r)}}t.__tagsList__=!0}for(var c=[],m={},u=0,n=0;n<a.length;n++)if(0<a[n].length){var p=t[a[n]],g={};if(c=[],null!=p)for(s=0;s<p.length;s++){r=p[s];0==u==(null==m[r.url])&&(g[r.url]=!0,c.push(r))}m=g,u++}j.scrollTop=0,j.innerHTML="",C=0;var h=document.createElement("div");h.style.cssText="border: 1px solid #D3D3D3; padding: 6px; background: #F5F5F5;",mxUtils.write(h,mxResources.get(0==c.length?"noResultsFor":"resultsFor",[e])),j.appendChild(h),null!=ie&&null==se&&(ie.style.backgroundColor="",se=ie,ie=h),re=c,T=null,A(!1)}else de()}(),mxEvent.consume(e))})),mxEvent.addListener(V,"keyup",mxUtils.bind(this,function(e){""==V.value?(X.setAttribute("src",Y),X.setAttribute("title",mxResources.get("search"))):(X.setAttribute("src",Dialog.prototype.closeImage),X.setAttribute("title",mxResources.get("reset")))})),W+=23;var Q=document.createElement("div");Q.style.cssText="position:absolute;left:30px;width:128px;top:"+W+"px;bottom:68px;margin-top:6px;overflow:auto;border:1px solid #d3d3d3;",mxEvent.addListener(j,"scroll",function(){f.sidebar.hideTooltip()});var J=140,q=140;function K(e,t,l,n,i,s,a){null!=G&&(G.style.backgroundColor="transparent",G.style.border="1px solid transparent"),S.removeAttribute("disabled"),P=t,B=l,O=s,H=n,F=a,z=i,(G=e).style.backgroundColor=o,G.style.border=r}var $={},ee={},te={},le=0,ne=!0,ie=null,se=null;$.basic=[{title:"blankDiagram",select:!0}];var ae,oe,re=$.basic;function de(){null!=se&&(se.click(),se=null)}function ce(){if(ne&&(ne=!1,mxEvent.addListener(j,"scroll",function(e){j.scrollTop+j.clientHeight>=j.scrollHeight&&(A(),mxEvent.consume(e))})),0<le){var e="font-weight: bold;background: #f9f9f9;padding: 5px 0 5px 0;text-align: center;",t=document.createElement("div");for(o in t.style.cssText=e,mxUtils.write(t,mxResources.get("custom")),Q.appendChild(t),te){var l=document.createElement("div"),n=o,i=te[o];18<n.length&&(n=n.substring(0,18)+"&hellip;"),l.style.cssText="display:block;cursor:pointer;padding:6px;white-space:nowrap;margin-bottom:-1px;overflow:hidden;text-overflow:ellipsis;user-select:none;",l.setAttribute("title",n+" ("+i.length+")"),mxUtils.write(l,l.getAttribute("title")),null!=y&&(l.style.padding=y),Q.appendChild(l),function(e,t){mxEvent.addListener(l,"click",function(){ie!=t&&(ie.style.backgroundColor="",(ie=t).style.backgroundColor=b,j.scrollTop=0,j.innerHTML="",C=0,re=te[e],T=null,A(!1))})}(o,l)}(t=document.createElement("div")).style.cssText=e,mxUtils.write(t,"draw.io"),Q.appendChild(t)}function s(e,t){var l=mxResources.get(e);return(l=18<(l=null==l?e.substring(0,1).toUpperCase()+e.substring(1):l).length?l.substring(0,18)+"&hellip;":l)+" ("+t.length+")"}function a(e,t,l){mxEvent.addListener(t,"click",function(){ie!=t&&(ie.style.backgroundColor="",(ie=t).style.backgroundColor=b,j.scrollTop=0,j.innerHTML="",C=0,re=l?ee[e][l]:$[e],T=null,A(!1))})}for(var o in $){var r=ee[o],d=l=document.createElement(r?"ul":"div"),c=s(o,i=$[o]);if(null!=r){var m=document.createElement("li"),u=document.createElement("div");u.className="geTempTreeCaret",u.setAttribute("title",c),mxUtils.write(u,c),m.appendChild(d=u);var p,g=document.createElement("ul");for(p in g.className="geTempTreeNested",g.style.visibility="hidden",r){var h=document.createElement("li"),x=s(p,r[p]);h.setAttribute("title",x),mxUtils.write(h,x),a(o,h,p),g.appendChild(h)}m.appendChild(g),l.className="geTempTree",l.appendChild(m),function(e,t){mxEvent.addListener(t,"click",function(){e.style.visibility="visible",e.classList.toggle("geTempTreeActive"),e.classList.toggle("geTempTreeNested")&&setTimeout(function(){e.style.visibility="hidden"},550),t.classList.toggle("geTempTreeCaret-down")})}(g,u)}else l.style.cssText="display:block;cursor:pointer;padding:6px;white-space:nowrap;margin-bottom:-1px;overflow:hidden;text-overflow:ellipsis;user-select:none;transition: all 0.5s;",l.setAttribute("title",c),mxUtils.write(l,c);null!=y&&(l.style.padding=y),Q.appendChild(l),null==ie&&0<i.length&&((ie=l).style.backgroundColor=b,re=i),a(o,d)}A(!1)}function me(){mxUtils.get(oe,function(e){if(!ae){ae=!0;for(var t=e.getXml().documentElement.firstChild,l={};null!=t;){if(void 0!==t.getAttribute)if("clibs"==t.nodeName){for(var n=t.getAttribute("name"),i=t.getElementsByTagName("add"),s=[],a=0;a<i.length;a++)s.push(encodeURIComponent(mxUtils.getTextContent(i[a])));null!=n&&0<s.length&&(l[n]=s.join(";"))}else{var o,r,d,c=t.getAttribute("url");null!=c&&(d=t.getAttribute("section"),n=t.getAttribute("subsection"),null==d&&(r=c.indexOf("/"),d=c.substring(0,r),null!=n||-1<(o=c.indexOf("/",r+1))&&(n=c.substring(r+1,o))),null==(r=$[d])&&($[d]=r=[]),null!=l[o=t.getAttribute("clibs")]&&(o=l[o]),o={url:t.getAttribute("url"),libs:t.getAttribute("libs"),title:t.getAttribute("title"),tooltip:t.getAttribute("name")||t.getAttribute("url"),preview:t.getAttribute("preview"),clibs:o,tags:t.getAttribute("tags")},r.push(o),null!=n&&(null==(r=ee[d])&&(ee[d]=r={}),null==(d=r[n])&&(r[n]=d=[]),d.push(o)))}t=t.nextSibling}N.stop(),ce()}})}e||(h.appendChild(Z),h.appendChild(Q),h.appendChild(j),ae=!1,oe=x,/^https?:\/\//.test(oe)&&!f.editor.isCorsEnabledForUrl(oe)&&(oe=PROXY_URL+"?url="+encodeURIComponent(oe)),N.spin(j),null!=u?u(function(e,t){te=e,I=le=t,me()},me):me(),R=$),mxEvent.addListener(w,"keypress",function(e){f.dialog.container.firstChild==h&&13==e.keyCode&&_()});u=document.createElement("div");u.style.marginTop=e?"4px":"16px",u.style.textAlign="right",u.style.position="absolute",u.style.left="40px",u.style.bottom="24px",u.style.right="40px","1"!=urlParams.customMenu&&(e||f.isOffline()||!l||null!=n||t||((ue=mxUtils.button(mxResources.get("help"),function(){f.openLink("https://support.draw.io/display/DO/Creating+and+Opening+Files")})).className="geBtn",u.appendChild(ue)));var ue=mxUtils.button(mxResources.get("cancel"),function(){null!=i&&i(),f.hideDialog(!0)});ue.className="geBtn",!f.editor.cancelFirst||t&&null==i||u.appendChild(ue),"1"!=urlParams.customMenu&&(e||"1"==urlParams.embed||t||mxClient.IS_ANDROID||mxClient.IS_IOS||"1"==urlParams.noDevice||((e=mxUtils.button(mxResources.get("fromTemplateUrl"),function(){var e=new FilenameDialog(f,"",mxResources.get("create"),function(e){null!=e&&0<e.length&&(e=f.getUrl(window.location.pathname+"?mode="+f.mode+"&title="+encodeURIComponent(w.value)+"&create="+encodeURIComponent(e)),null==f.getCurrentFile()?window.location.href=e:window.openWindow(e))},mxResources.get("url"));f.showDialog(e.container,300,80,!0,!0),e.init()})).className="geBtn",u.appendChild(e))),Graph.fileSupport&&c&&((c=mxUtils.button(mxResources.get("import"),function(){var t;null==f.newDlgFileInputElt&&((t=document.createElement("input")).setAttribute("multiple","multiple"),t.setAttribute("type","file"),mxEvent.addListener(t,"change",function(e){f.openFiles(t.files,!0),t.value=""}),t.style.display="none",document.body.appendChild(t),f.newDlgFileInputElt=t),f.newDlgFileInputElt.click()})).className="geBtn",u.appendChild(c)),u.appendChild(S),f.editor.cancelFirst||null!=n||t&&null==i||u.appendChild(ue),h.appendChild(u),this.container=h};NewDialog.tagsList={};var CreateDialog=function(c,i,l,e,t,n,s,a,o,r,d,m,u,p,g,h,x){d="1"!=urlParams.noDevice&&d,s=null==s||s,a=null==a||a,m=null!=m?m:4,x=null==x||x;var b=document.createElement("div");b.style.whiteSpace="nowrap";var y=!0;null==e&&c.addLanguageMenu(b);var v=document.createElement("h2");mxUtils.write(v,t||mxResources.get("create")),v.style.marginTop="0px",v.style.marginBottom="24px",b.appendChild(v),mxUtils.write(b,mxResources.get("filename")+":");var f=document.createElement("input");f.setAttribute("value",i),f.style.width="200px",f.style.marginLeft="10px",f.style.marginBottom="20px",f.style.maxWidth="70%",this.init=function(){f.focus(),mxClient.IS_GC||mxClient.IS_FF||5<=document.documentMode?f.select():document.execCommand("selectAll",!1,null)},b.appendChild(f),null!=h&&(null!=c.editor.diagramFileTypes&&((w=FilenameDialog.createFileTypes(c,f,c.editor.diagramFileTypes)).style.marginLeft="6px",w.style.width="80px",b.appendChild(w)),b.appendChild(FilenameDialog.createTypeHint(c,f,h)));var E,w=null;"1"==urlParams.noDevice||null==u||null==p||"image/"!=p.substring(0,6)||"image/svg"==p.substring(0,9)&&!mxClient.IS_SVG||(f.style.width="160px",h=document.createElement("img"),E=g?u:btoa(unescape(encodeURIComponent(u))),h.setAttribute("src","data:"+p+";base64,"+E),h.style.position="absolute",h.style.top="70px",h.style.right="100px",h.style.maxWidth="120px",h.style.maxHeight="80px",mxUtils.setPrefixedStyle(h.style,"transform","translate(50%,-50%)"),b.appendChild(h),mxClient.IS_FF||null==navigator.clipboard||"image/png"!=p||((w=mxUtils.button(mxResources.get("copy"),function(e){var t=c.base64ToBlob(E,"image/png"),t=new ClipboardItem({"image/png":t,"text/html":new Blob(['<img src="data:'+p+";base64,"+E+'">'],{type:"text/html"})});navigator.clipboard.write([t]).then(mxUtils.bind(this,function(){c.alert(mxResources.get("copiedToClipboard"))})).catch(mxUtils.bind(this,function(e){c.handleError(e)}))})).style.marginTop="6px",w.className="geBtn"),o&&Editor.popupsAllowed&&(h.style.cursor="pointer",mxEvent.addGestureListeners(h,null,null,function(e){mxEvent.isPopupTrigger(e)||B("_blank")}))),mxUtils.br(b);var C=document.createElement("div");C.style.textAlign="center";var A=0;function D(e,t,l,n){var i=document.createElement("a");i.style.overflow="hidden";var s=document.createElement("img");s.src=e,s.setAttribute("border","0"),s.setAttribute("align","absmiddle"),s.style.width="60px",s.style.height="60px",s.style.paddingBottom="6px",i.style.display="inline-block",i.className="geBaseButton",i.style.position="relative",i.style.margin="4px",i.style.padding="8px 8px 10px 8px",i.style.whiteSpace="nowrap",i.appendChild(s),i.style.color="gray",i.style.fontSize="11px";var a,o,r=document.createElement("div");function d(){mxEvent.addListener(i,"click",function(){console.log("Dialogs.js-click()"),M(l),B(l)})}i.appendChild(r),mxUtils.write(r,t),null!=n&&null==c[n]?(s.style.visibility="hidden",mxUtils.setOpacity(r,10),(a=new Spinner({lines:12,length:12,width:5,radius:10,rotate:0,color:"#000",speed:1.5,trail:60,shadow:!1,hwaccel:!1,top:"40%",zIndex:2e9})).spin(i),o=window.setTimeout(function(){null==c[n]&&(a.stop(),i.style.display="none")},3e4),c.addListener("clientLoaded",mxUtils.bind(this,function(){null!=c[n]&&(window.clearTimeout(o),mxUtils.setOpacity(r,100),s.style.visibility="",a.stop(),d())}))):d(),C.appendChild(i),++A==m&&(mxUtils.br(C),A=0)}y?(C.style.marginTop="6px",b.appendChild(C)):mxUtils.write(b,mxResources.get("chooseAnOption")+":");var T,R,I,L,U=document.createElement("select");function M(e){var t,l,n;s&&(l=(t=f.value).lastIndexOf("."),i.lastIndexOf(".")<0&&(!y||l<0)&&(n="",(e=null!=e?e:U.value)==App.MODE_GOOGLE?n=c.drive.extension:e==App.MODE_GITHUB?n=c.gitHub.extension:e==App.MODE_GITLAB?n=c.gitLab.extension:e==App.MODE_NOTION?n=c.notion.extension:e==App.MODE_TRELLO?n=c.trello.extension:e==App.MODE_DROPBOX?n=c.dropbox.extension:e==App.MODE_ONEDRIVE?n=c.oneDrive.extension:e==App.MODE_DEVICE&&(n=".drawio"),0<=l&&(t=t.substring(0,l)),f.value=t+n))}U.style.marginLeft="10px",c.isOfflineApp()||c.isOffline()||("function"==typeof window.DriveClient&&((T=document.createElement("option")).setAttribute("value",App.MODE_GOOGLE),mxUtils.write(T,mxResources.get("googleDrive")),U.appendChild(T),D(IMAGE_PATH+"/google-drive-logo.svg",mxResources.get("googleDrive"),App.MODE_GOOGLE,"drive")),"function"==typeof window.OneDriveClient&&((T=document.createElement("option")).setAttribute("value",App.MODE_ONEDRIVE),mxUtils.write(T,mxResources.get("oneDrive")),U.appendChild(T),c.mode==App.MODE_ONEDRIVE&&T.setAttribute("selected","selected"),D(IMAGE_PATH+"/onedrive-logo.svg",mxResources.get("oneDrive"),App.MODE_ONEDRIVE,"oneDrive")),"function"==typeof window.DropboxClient&&((R=document.createElement("option")).setAttribute("value",App.MODE_DROPBOX),mxUtils.write(R,mxResources.get("dropbox")),U.appendChild(R),c.mode==App.MODE_DROPBOX&&R.setAttribute("selected","selected"),D(IMAGE_PATH+"/dropbox-logo.svg",mxResources.get("dropbox"),App.MODE_DROPBOX,"dropbox")),null!=c.gitHub&&((R=document.createElement("option")).setAttribute("value",App.MODE_GITHUB),mxUtils.write(R,mxResources.get("github")),U.appendChild(R),D(IMAGE_PATH+"/github-logo.svg",mxResources.get("github"),App.MODE_GITHUB,"gitHub")),null!=c.gitLab&&((I=document.createElement("option")).setAttribute("value",App.MODE_GITLAB),mxUtils.write(I,mxResources.get("gitlab")),U.appendChild(I),D(IMAGE_PATH+"/gitlab-logo.svg",mxResources.get("gitlab"),App.MODE_GITLAB,"gitLab")),null!=c.notion&&((I=document.createElement("option")).setAttribute("value",App.MODE_NOTION),mxUtils.write(I,mxResources.get("notion")),U.appendChild(I),D(IMAGE_PATH+"/notion-logo.svg",mxResources.get("notion"),App.MODE_NOTION,"notion")),"function"==typeof window.TrelloClient&&((L=document.createElement("option")).setAttribute("value",App.MODE_TRELLO),mxUtils.write(L,mxResources.get("trello")),U.appendChild(L),D(IMAGE_PATH+"/trello-logo.svg",mxResources.get("trello"),App.MODE_TRELLO,"trello"))),Editor.useLocalStorage&&"device"!=urlParams.storage&&(null==c.getCurrentFile()||"1"==urlParams.noDevice)||((L=document.createElement("option")).setAttribute("value",App.MODE_DEVICE),mxUtils.write(L,mxResources.get("device")),U.appendChild(L),c.mode!=App.MODE_DEVICE&&a||L.setAttribute("selected","selected"),d&&D(IMAGE_PATH+"/osa_drive-harddisk.png",mxResources.get("device"),App.MODE_DEVICE)),a&&isLocalStorage&&"0"!=urlParams.browser&&((S=document.createElement("option")).setAttribute("value",App.MODE_BROWSER),mxUtils.write(S,mxResources.get("browser")),U.appendChild(S),c.mode==App.MODE_BROWSER&&S.setAttribute("selected","selected"),D(IMAGE_PATH+"/osa_database.png",mxResources.get("browser"),App.MODE_BROWSER));a=document.createElement("div");a.style.marginTop=y?"26px":"38px",a.style.textAlign="center",y||(b.appendChild(U),mxEvent.addListener(U,"change",M),M()),"1"!=urlParams.customMenu&&null!=r&&((k=mxUtils.button(mxResources.get("help"),function(){c.openLink(r)})).className="geBtn",a.appendChild(k));var k,N,S=mxUtils.button(mxResources.get(null!=e?"close":"cancel"),function(){null!=e?e():(c.fileLoaded(null),c.hideDialog(),window.close(),window.location.href=c.getUrl())});function B(e){var t=f.value;(null==e||null!=t&&0<t.length)&&(x&&c.hideDialog(),l(t,e,f))}S.className="geBtn",c.editor.cancelFirst&&null==e&&a.appendChild(S),null==e&&((k=mxUtils.button(mxResources.get("decideLater"),function(){B(null)})).className="geBtn",a.appendChild(k)),o&&Editor.popupsAllowed&&((N=mxUtils.button(mxResources.get("openInNewWindow"),function(){B("_blank")})).className="geBtn",a.appendChild(N)),CreateDialog.showDownloadButton&&((N=mxUtils.button(mxResources.get("download"),function(){B("download")})).className="geBtn",a.appendChild(N),null!=w&&(N.style.marginTop="6px",a.style.marginTop="6px")),null!=w&&(mxUtils.br(a),a.appendChild(w)),y||((n=mxUtils.button(n||mxResources.get("create"),function(){B(d?"download":y?App.MODE_DEVICE:U.value)})).className="geBtn gePrimaryBtn",a.appendChild(n)),c.editor.cancelFirst&&null==e||a.appendChild(S),mxEvent.addListener(f,"keypress",function(e){13==e.keyCode?B(y?App.MODE_DEVICE:U.value):27==e.keyCode&&(c.fileLoaded(null),c.hideDialog(),window.close())}),b.appendChild(a),this.container=b};CreateDialog.showDownloadButton="1"!=urlParams.noDevice;var PopupDialog=function(e,t,l,n,i){i=null==i||i;var s=document.createElement("div");s.style.textAlign="left",s.style.height="100%",mxUtils.write(s,mxResources.get("fileOpenLocation")),mxUtils.br(s),mxUtils.br(s);var a=mxUtils.button(mxResources.get("openInThisWindow"),function(){i&&e.hideDialog(),null!=n&&n()});a.className="geBtn",a.style.marginBottom="8px",a.style.width="280px",s.appendChild(a),mxUtils.br(s);var o=mxUtils.button(mxResources.get("openInNewWindow"),function(){i&&e.hideDialog(),null!=l&&l(),e.openLink(t,null,!0)});o.className="geBtn gePrimaryBtn",o.style.width=a.style.width,s.appendChild(o),mxUtils.br(s),mxUtils.br(s),mxUtils.write(s,mxResources.get("allowPopups")),this.container=s},ImageDialog=function(a,e,t,o,n,r){r=null==r||r;var i=a.editor.graph,s=document.createElement("div");mxUtils.write(s,e);var l=document.createElement("div");l.className="geTitle",l.style.backgroundColor="transparent",l.style.borderColor="transparent",l.style.whiteSpace="nowrap",l.style.textOverflow="clip",l.style.cursor="default",l.style.paddingRight="20px";var d=document.createElement("input");d.setAttribute("value",t),d.setAttribute("type","text"),d.setAttribute("spellcheck","false"),d.setAttribute("autocorrect","off"),d.setAttribute("autocomplete","off"),d.setAttribute("autocapitalize","off"),d.style.marginTop="6px";e=Graph.fileSupport?460:340;d.style.width=e-20+"px",d.style.backgroundImage="url('"+Dialog.prototype.clearImage+"')",d.style.backgroundRepeat="no-repeat",d.style.backgroundPosition="100% 50%",d.style.paddingRight="14px";t=document.createElement("div");t.setAttribute("title",mxResources.get("reset")),t.style.position="relative",t.style.left="-16px",t.style.width="12px",t.style.height="14px",t.style.cursor="pointer",t.style.display="inline-block",t.style.top="3px",t.style.background="url('"+a.editor.transparentImage+"')",mxEvent.addListener(t,"click",function(){d.value="",d.focus()}),l.appendChild(d),l.appendChild(t),s.appendChild(l);function c(e,t){var l;null!=e?null!=(l=n?null:i.getModel().getGeometry(i.getSelectionCell()))?m(e,l.width,l.height,t):m(e,null,null,t):(a.hideDialog(),o(null))}var m=function(l,n,i,s){var e="data:"==l.substring(0,5);console.log(""),!a.isOffline()||e&&"undefined"==typeof chrome?0<l.length&&a.spinner.spin(document.body,mxResources.get("inserting"))?a.loadImage(l,function(e){a.spinner.stop(),a.hideDialog();var t=!1===s?1:null!=n&&null!=i?Math.max(n/e.width,i/e.height):Math.min(1,Math.min(520/e.width,520/e.height));r&&(l=a.convertDataUri(l)),o(l,Math.round(Number(e.width)*t),Math.round(Number(e.height)*t))},function(){a.spinner.stop(),o(null),a.showError(mxResources.get("error"),mxResources.get("fileNotFound"),mxResources.get("ok"))}):(a.hideDialog(),o(l)):(l=a.convertDataUri(l),n=null==n?120:n,i=null==i?100:i,a.hideDialog(),o(l,n,i))};this.init=function(){var t,l;d.focus(),Graph.fileSupport&&(d.setAttribute("placeholder",mxResources.get("dragImagesHere")),t=s.parentNode,a.editor.graph,l=null,mxEvent.addListener(t,"dragleave",function(e){null!=l&&(l.parentNode.removeChild(l),l=null),e.stopPropagation(),e.preventDefault()}),mxEvent.addListener(t,"dragover",mxUtils.bind(this,function(e){null==l&&(!mxClient.IS_IE||10<document.documentMode)&&(l=a.highlightElement(t)),e.stopPropagation(),e.preventDefault()})),mxEvent.addListener(t,"drop",mxUtils.bind(this,function(e){var t;null!=l&&(l.parentNode.removeChild(l),l=null),0<e.dataTransfer.files.length?a.importFiles(e.dataTransfer.files,0,0,a.maxImageSize,function(e,t,l,n,i,s,a,o){c(e,o)},function(){},function(e){return"image/"==e.type.substring(0,6)},function(e){for(var t=0;t<e.length;t++)e[t]()},!mxEvent.isControlDown(e),null,null,!0):0<=mxUtils.indexOf(e.dataTransfer.types,"text/uri-list")&&(t=e.dataTransfer.getData("text/uri-list"),/\.(gif|jpg|jpeg|tiff|png|svg)($|\?)/i.test(t)&&c(decodeURIComponent(t))),e.stopPropagation(),e.preventDefault()}),!1))};e=document.createElement("div");e.style.marginTop="14px",e.style.textAlign="center";var u,t=mxUtils.button(mxResources.get("cancel"),function(){a.spinner.stop(),a.hideDialog()});t.className="geBtn",a.editor.cancelFirst&&e.appendChild(t),ImageDialog.filePicked=function(e){e.action==google.picker.Action.PICKED&&(null==e.docs[0].thumbnails||null!=(e=e.docs[0].thumbnails[e.docs[0].thumbnails.length-1])&&(d.value=e.url)),d.focus()},Graph.fileSupport&&(null==a.imgDlgFileInputElt&&((u=document.createElement("input")).setAttribute("multiple","multiple"),u.setAttribute("type","file"),mxEvent.addListener(u,"change",function(e){null!=u.files&&(a.importFiles(u.files,0,0,a.maxImageSize,function(e,t,l,n,i,s){c(e)},function(){},function(e){return"image/"==e.type.substring(0,6)},function(e){for(var t=0;t<e.length;t++)e[t]()},!0),u.type="",u.type="file",u.value="")}),u.style.display="none",document.body.appendChild(u),a.imgDlgFileInputElt=u),(l=mxUtils.button(mxResources.get("open"),function(){a.imgDlgFileInputElt.click()})).className="geBtn",e.appendChild(l)),document.createElement("canvas").getContext&&"data:image/"==d.value.substring(0,11)&&"data:image/svg"!=d.value.substring(0,14)&&((p=mxUtils.button(mxResources.get("crop"),function(){var e=new CropImageDialog(a,d.value,function(e){d.value=e});a.showDialog(e.container,300,380,!0,!0),e.init()})).className="geBtn",e.appendChild(p)),mxEvent.addListener(d,"keypress",function(e){13==e.keyCode&&c(d.value)});var p=mxUtils.button(mxResources.get("apply"),function(){c(d.value)});p.className="geBtn gePrimaryBtn",e.appendChild(p),a.editor.cancelFirst||e.appendChild(t),Graph.fileSupport&&(e.style.marginTop="120px",s.style.backgroundImage="url('"+IMAGE_PATH+"/droptarget.png')",s.style.backgroundPosition="center 65%",s.style.backgroundRepeat="no-repeat",(t=document.createElement("div")).style.position="absolute",t.style.width="420px",t.style.top="58%",t.style.textAlign="center",t.style.fontSize="18px",t.style.color="#a0c3ff",mxUtils.write(t,mxResources.get("dragImagesHere")),s.appendChild(t)),s.appendChild(e),this.container=s},LinkDialog=function(n,t,e,l,i,s,a){var o=document.createElement("div");o.style.height="100%",mxUtils.write(o,mxResources.get("editLink")+":");var r=document.createElement("div");r.className="geTitle",r.style.backgroundColor="transparent",r.style.borderColor="transparent",r.style.whiteSpace="nowrap",r.style.textOverflow="clip",r.style.cursor="default",r.style.paddingRight="20px";var d=document.createElement("input");d.setAttribute("placeholder",mxResources.get("dragUrlsHere")),d.setAttribute("type","text"),d.style.marginTop="6px",d.style.width="100%",d.style.boxSizing="border-box",d.style.backgroundImage="url('"+Dialog.prototype.clearImage+"')",d.style.backgroundRepeat="no-repeat",d.style.backgroundPosition="100% 50%",d.style.paddingRight="14px",d.style.marginBottom="4px";var c=document.createElement("div");c.setAttribute("title",mxResources.get("reset")),c.style.position="relative",c.style.left="-16px",c.style.width="12px",c.style.height="14px",c.style.cursor="pointer",c.style.display="inline-block",c.style.top="3px",c.style.background="url('"+n.editor.transparentImage+"')",mxEvent.addListener(c,"click",function(){d.value="",d.focus()});var m=document.createElement("input");m.style.cssText="margin-right:8px;margin-bottom:8px;",m.setAttribute("value","url"),m.setAttribute("type","radio"),m.setAttribute("name","geLinkDialogOption");var u=document.createElement("input");u.style.cssText="margin-right:8px;margin-bottom:8px;",u.setAttribute("value","url"),u.setAttribute("type","radio"),u.setAttribute("name","geLinkDialogOption");var p=document.createElement("select");p.style.width="520px";var g=document.createElement("input");if(g.setAttribute("type","checkbox"),g.style.margin="0 6p 0 6px",null!=a&&(g.setAttribute("checked","checked"),g.defaultChecked=!0),a=null!=a?a:"_blank",g.setAttribute("title",a),s&&(d.style.width="340px"),i&&null!=n.pages){null!=t&&Graph.isPageLink(t)?(u.setAttribute("checked","checked"),u.defaultChecked=!0):(d.setAttribute("value",t),m.setAttribute("checked","checked"),m.defaultChecked=!0),r.appendChild(m),r.appendChild(d),r.appendChild(c),s&&(r.appendChild(g),mxUtils.write(r,mxResources.get("openInNewWindow"))),mxUtils.br(r),r.appendChild(u);for(var h,x=!1,b=0;b<n.pages.length;b++){var y=document.createElement("option");mxUtils.write(y,n.pages[b].getName()||mxResources.get("pageWithNumber",[b+1])),y.setAttribute("value","data:page/id,"+n.pages[b].getId()),t==y.getAttribute("value")&&(y.setAttribute("selected","selected"),x=!0),p.appendChild(y)}!x&&u.checked&&(h=document.createElement("option"),mxUtils.write(h,mxResources.get("pageNotFound")),h.setAttribute("disabled","disabled"),h.setAttribute("selected","selected"),h.setAttribute("value","pageNotFound"),p.appendChild(h),mxEvent.addListener(p,"change",function(){null==h.parentNode||h.selected||h.parentNode.removeChild(h)})),r.appendChild(p)}else d.setAttribute("value",t),r.appendChild(d),r.appendChild(c);o.appendChild(r);var v=mxUtils.button(e,function(){n.hideDialog();var e=u.checked?"pageNotFound"!==p.value?p.value:t:d.value;l(e,LinkDialog.selectedDocs,g.checked?a:null)});v.style.verticalAlign="middle",v.className="geBtn gePrimaryBtn",this.init=function(){var t,l;u.checked?p.focus():(d.focus(),mxClient.IS_GC||mxClient.IS_FF||5<=document.documentMode?d.select():document.execCommand("selectAll",!1,null)),mxEvent.addListener(p,"focus",function(){m.removeAttribute("checked"),u.setAttribute("checked","checked"),u.checked=!0}),mxEvent.addListener(d,"focus",function(){u.removeAttribute("checked"),m.setAttribute("checked","checked"),m.checked=!0}),Graph.fileSupport&&(t=o.parentNode,n.editor.graph,l=null,mxEvent.addListener(t,"dragleave",function(e){null!=l&&(l.parentNode.removeChild(l),l=null),e.stopPropagation(),e.preventDefault()}),mxEvent.addListener(t,"dragover",mxUtils.bind(this,function(e){null==l&&(!mxClient.IS_IE||10<document.documentMode)&&(l=n.highlightElement(t)),e.stopPropagation(),e.preventDefault()})),mxEvent.addListener(t,"drop",mxUtils.bind(this,function(e){null!=l&&(l.parentNode.removeChild(l),l=null),0<=mxUtils.indexOf(e.dataTransfer.types,"text/uri-list")&&(d.value=decodeURIComponent(e.dataTransfer.getData("text/uri-list")),m.setAttribute("checked","checked"),m.checked=!0,v.click()),e.stopPropagation(),e.preventDefault()}),!1))};var f=document.createElement("div");f.style.marginTop="18px",f.style.textAlign="center","1"!=urlParams.customMenu&&((E=mxUtils.button(mxResources.get("help"),function(){n.openLink("https://www.diagrams.net/doc/faq/custom-links")})).style.verticalAlign="middle",E.className="geBtn",f.appendChild(E),n.isOffline()&&!mxClient.IS_CHROMEAPP&&(E.style.display="none"));var E=mxUtils.button(mxResources.get("cancel"),function(){n.hideDialog()});function w(e,t,l){l=mxUtils.button("",l);l.className="geBtn",l.setAttribute("title",t);t=document.createElement("img");t.style.height="26px",t.style.width="26px",t.setAttribute("src",e),l.style.minWidth="42px",l.style.verticalAlign="middle",l.appendChild(t),f.appendChild(l)}E.style.verticalAlign="middle",E.className="geBtn",n.editor.cancelFirst&&f.appendChild(E),LinkDialog.selectedDocs=null,LinkDialog.filePicked=function(e){var t;e.action==google.picker.Action.PICKED?(LinkDialog.selectedDocs=e.docs,t=e.docs[0].url,"application/mxe"==e.docs[0].mimeType||null!=e.docs[0].mimeType&&"application/vnd.jgraph."==e.docs[0].mimeType.substring(0,23)?t="https://www.draw.io/#G"+e.docs[0].id:"application/vnd.google-apps.folder"==e.docs[0].mimeType&&(t="https://drive.google.com/#folders/"+e.docs[0].id),d.value=t,d.focus()):LinkDialog.selectedDocs=null,d.focus()},"undefined"!=typeof google&&void 0!==google.picker&&null!=n.drive&&w(IMAGE_PATH+"/google-drive-logo.svg",mxResources.get("googlePlus"),function(){n.spinner.spin(document.body,mxResources.get("authorizing"))&&n.drive.checkToken(mxUtils.bind(this,function(){var e;n.spinner.stop(),null==n.linkPicker&&(e=n.drive.createLinkPicker(),n.linkPicker=e.setCallback(function(e){LinkDialog.filePicked(e)}).build()),n.linkPicker.setVisible(!0)}))}),"undefined"!=typeof Dropbox&&void 0!==Dropbox.choose&&w(IMAGE_PATH+"/dropbox-logo.svg",mxResources.get("dropbox"),function(){Dropbox.choose({linkType:"direct",cancel:function(){},success:function(e){d.value=e[0].link,d.focus()}})}),null!=n.oneDrive&&w(IMAGE_PATH+"/onedrive-logo.svg",mxResources.get("oneDrive"),function(){n.oneDrive.pickFile(function(e,t){d.value=t.value[0].webUrl,d.focus()})}),null!=n.gitHub&&w(IMAGE_PATH+"/github-logo.svg",mxResources.get("github"),function(){n.gitHub.pickFile(function(e){var t,l,n,i;null!=e&&(l=(t=e.split("/"))[0],n=t[1],i=t[2],e=t.slice(3,t.length).join("/"),d.value="https://github.com/"+l+"/"+n+"/blob/"+i+"/"+e,d.focus())})}),null!=n.gitLab&&w(IMAGE_PATH+"/gitlab-logo.svg",mxResources.get("gitlab"),function(){n.gitLab.pickFile(function(e){var t,l,n,i;null!=e&&(l=(t=e.split("/"))[0],n=t[1],i=t[2],e=t.slice(3,t.length).join("/"),d.value=DRAWIO_GITLAB_URL+"/"+l+"/"+n+"/blob/"+i+"/"+e,d.focus())})}),mxEvent.addListener(d,"keypress",function(e){13==e.keyCode&&(n.hideDialog(),e=(u.checked?p:d).value,l(e,LinkDialog.selectedDocs))}),f.appendChild(v),n.editor.cancelFirst||f.appendChild(E),o.appendChild(f),this.container=o},FeedbackDialog=function(l,n,e,i){var t=document.createElement("div"),s=document.createElement("div");mxUtils.write(s,mxResources.get("sendYourFeedback")),s.style.fontSize="18px",s.style.marginBottom="18px",t.appendChild(s),s=document.createElement("div"),mxUtils.write(s,mxResources.get("yourEmailAddress")+(e?"":" ("+mxResources.get("required")+")")),t.appendChild(s);var a=document.createElement("input");a.setAttribute("type","text"),a.style.marginTop="6px",a.style.width="600px";var o,r=mxUtils.button(mxResources.get("sendMessage"),function(){var e,t=m.value+(d.checked?"\nDiagram:\n"+(null!=i?i:mxUtils.getXml(l.getXmlFileData())):"")+"\nuserAgent:\n"+navigator.userAgent+"\nappVersion:\n"+navigator.appVersion+"\nappName:\n"+navigator.appName+"\nplatform:\n"+navigator.platform;t.length>FeedbackDialog.maxAttachmentSize?l.alert(mxResources.get("drawingTooLarge")):(l.hideDialog(),l.spinner.spin(document.body)&&(e=null!=FeedbackDialog.feedbackUrl?FeedbackDialog.feedbackUrl:"/email",mxUtils.post(e,"email="+encodeURIComponent(a.value)+"&version="+encodeURIComponent(EditorUi.VERSION)+"&url="+encodeURIComponent(window.location.href)+"&body="+encodeURIComponent((null!=n?n:"Feedback")+":\n"+t),function(e){l.spinner.stop(),200<=e.getStatus()&&e.getStatus()<=299?l.alert(mxResources.get("feedbackSent")):l.alert(mxResources.get("errorSendingFeedback"))},function(){l.spinner.stop(),l.alert(mxResources.get("errorSendingFeedback"))})))});r.className="geBtn gePrimaryBtn",e||(r.setAttribute("disabled","disabled"),o=/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/,mxEvent.addListener(a,"change",function(){0<a.value.length&&0<o.test(a.value)?r.removeAttribute("disabled"):r.setAttribute("disabled","disabled")}),mxEvent.addListener(a,"keyup",function(){0<a.value.length&&o.test(a.value)?r.removeAttribute("disabled"):r.setAttribute("disabled","disabled")})),t.appendChild(a),this.init=function(){a.focus()};var d=document.createElement("input");d.setAttribute("type","checkbox"),d.setAttribute("checked","checked"),d.defaultChecked=!0;var c=document.createElement("p");c.style.marginTop="14px",c.appendChild(d);e=document.createElement("span");mxUtils.write(e," "+mxResources.get("includeCopyOfMyDiagram")),c.appendChild(e),mxEvent.addListener(e,"click",function(e){d.checked=!d.checked,mxEvent.consume(e)}),t.appendChild(c),s=document.createElement("div"),mxUtils.write(s,mxResources.get("feedback")),t.appendChild(s);var m=document.createElement("textarea");m.style.resize="none",m.style.width="600px",m.style.height="140px",m.style.marginTop="6px",m.setAttribute("placeholder",mxResources.get("comments")),t.appendChild(m);c=document.createElement("div");c.style.marginTop="26px",c.style.textAlign="right";s=mxUtils.button(mxResources.get("cancel"),function(){l.hideDialog()});s.className="geBtn",l.editor.cancelFirst?(c.appendChild(s),c.appendChild(r)):(c.appendChild(r),c.appendChild(s)),t.appendChild(c),this.container=t};FeedbackDialog.maxAttachmentSize=1e6;var RevisionDialog=function(m,t,l){var e=document.createElement("div"),n=document.createElement("h3");n.style.marginTop="0px",mxUtils.write(n,mxResources.get("revisionHistory")),e.appendChild(n);var i=document.createElement("div");i.style.position="absolute",i.style.overflow="auto",i.style.width="170px",i.style.height="378px",e.appendChild(i);var u=document.createElement("div");u.style.position="absolute",u.style.border="1px solid lightGray",u.style.left="199px",u.style.width="470px",u.style.height="376px",u.style.overflow="hidden";var p=document.createElement("div");p.style.cssText="position:absolute;left:0;right:0;top:0;bottom:20px;text-align:center;transform:translate(0,50%);pointer-events:none;",u.appendChild(p),mxEvent.disableContextMenu(u),e.appendChild(u);var g=new Graph(u);g.setTooltips(!1),g.setEnabled(!1),g.setPanning(!0),g.panningHandler.ignoreCell=!0,g.panningHandler.useLeftButtonForPanning=!0,g.minFitScale=null,g.maxFitScale=null,g.centerZoom=!0;var h=0,x=null,b=0,s=g.getGlobalVariable;g.getGlobalVariable=function(e){return"page"==e&&null!=x&&null!=x[b]?x[b].getAttribute("name"):"pagenumber"==e?b+1:"pagecount"==e?null!=x?x.length:1:s.apply(this,arguments)},g.getLinkForCell=function(){return null},Editor.MathJaxRender&&g.addListener(mxEvent.SIZE,mxUtils.bind(this,function(e,t){m.editor.graph.mathEnabled&&Editor.MathJaxRender(g.container)}));for(var a={lines:11,length:15,width:6,radius:10,corners:1,rotate:0,direction:1,color:Editor.isDarkMode()?"#c0c0c0":"#000",speed:1.4,trail:60,shadow:!1,hwaccel:!1,className:"spinner",zIndex:2e9,top:"50%",left:"50%"},y=new Spinner(a),v=m.getCurrentFile(),o=m.getXmlFileData(!0,!1,!0).getElementsByTagName("diagram"),r={},d=0;d<o.length;d++)r[o[d].getAttribute("id")]=o[d];var f=null,E=null,w=null,C=null,A=mxUtils.button("",function(){null!=w&&g.zoomIn()});A.className="geSprite geSprite-zoomin",A.setAttribute("title",mxResources.get("zoomIn")),A.style.outline="none",A.style.border="none",A.style.margin="2px",A.setAttribute("disabled","disabled"),mxUtils.setOpacity(A,20);var D=mxUtils.button("",function(){null!=w&&g.zoomOut()});D.className="geSprite geSprite-zoomout",D.setAttribute("title",mxResources.get("zoomOut")),D.style.outline="none",D.style.border="none",D.style.margin="2px",D.setAttribute("disabled","disabled"),mxUtils.setOpacity(D,20);var T=mxUtils.button("",function(){null!=w&&(g.maxFitScale=8,g.fit(8),g.center())});T.className="geSprite geSprite-fit",T.setAttribute("title",mxResources.get("fit")),T.style.outline="none",T.style.border="none",T.style.margin="2px",T.setAttribute("disabled","disabled"),mxUtils.setOpacity(T,20);var R=mxUtils.button("",function(){null!=w&&(g.zoomActual(),g.center())});R.className="geSprite geSprite-actualsize",R.setAttribute("title",mxResources.get("actualSize")),R.style.outline="none",R.style.border="none",R.style.margin="2px",R.setAttribute("disabled","disabled"),mxUtils.setOpacity(R,20);var I=mxUtils.button("",function(){});I.className="geSprite geSprite-middle",I.setAttribute("title",mxResources.get("compare")),I.style.outline="none",I.style.border="none",I.style.margin="2px",mxUtils.setOpacity(I,60);var c=u.cloneNode(!1);c.style.pointerEvent="none",u.parentNode.appendChild(c);var L=new Graph(c);L.setTooltips(!1),L.setEnabled(!1),L.setPanning(!0),L.panningHandler.ignoreCell=!0,L.panningHandler.useLeftButtonForPanning=!0,L.minFitScale=null,L.maxFitScale=null,L.centerZoom=!0,mxEvent.addGestureListeners(I,function(e){var t=r[x[h].getAttribute("id")];mxUtils.setOpacity(I,20),p.innerHTML="",null==t?mxUtils.write(p,mxResources.get("pageNotFound")):(U.style.display="none",u.style.display="none",c.style.display="",c.style.backgroundColor=u.style.backgroundColor,t=Editor.parseDiagramNode(t),new mxCodec(t.ownerDocument).decode(t,L.getModel()),L.view.scaleAndTranslate(g.view.scale,g.view.translate.x,g.view.translate.y))},null,function(){mxUtils.setOpacity(I,60),p.innerHTML="","none"==u.style.display&&(U.style.display="",u.style.display="",c.style.display="none")});var U=document.createElement("div");U.style.position="absolute",U.style.textAlign="right",U.style.color="gray",U.style.marginTop="10px",U.style.backgroundColor="transparent",U.style.top="440px",U.style.right="32px",U.style.maxWidth="380px",U.style.cursor="default";var M=mxUtils.button(mxResources.get("download"),function(){var e,t;null!=w&&(t=mxUtils.getXml(w.documentElement),e=m.getBaseFilename()+".drawio",m.isLocalFileSave()?m.saveLocalFile(t,e,"text/xml"):(t="undefined"==typeof pako?"&xml="+encodeURIComponent(t):"&data="+encodeURIComponent(Graph.compress(t)),new mxXmlRequest(SAVE_URL,"filename="+encodeURIComponent(e)+"&format=xml"+t).simulate(document,"_blank")))});M.className="geBtn",M.setAttribute("disabled","disabled");var k=mxUtils.button(mxResources.get("restore"),function(e){null!=w&&null!=C&&(mxEvent.isShiftDown(e)?null!=w&&(e=m.getPagesForNode(w.documentElement),e=m.diffPages(m.pages,e),(e=new TextareaDialog(m,mxResources.get("compare"),JSON.stringify(e,null,2),function(e){if(0<e.length)try{m.confirm(mxResources.get("areYouSure"),function(){v.patch([JSON.parse(e)],null,!0),m.hideDialog(),m.hideDialog()})}catch(e){m.handleError(e)}},null,null,null,null,null,!0,null,mxResources.get("merge"))).textarea.style.width="600px",e.textarea.style.height="380px",m.showDialog(e.container,620,460,!0,!0),e.init()):m.confirm(mxResources.get("areYouSure"),function(){null!=l?l(C):m.spinner.spin(document.body,mxResources.get("restoring"))&&v.save(!0,function(e){m.spinner.stop(),m.replaceFileData(C),m.hideDialog()},function(e){m.spinner.stop(),m.editor.setStatus(""),m.handleError(e,null!=e?mxResources.get("errorSavingFile"):null)})}))});k.className="geBtn",k.setAttribute("disabled","disabled"),k.setAttribute("title","Shift+Click for Diff");var N=document.createElement("select");N.setAttribute("disabled","disabled"),N.style.maxWidth="80px",N.style.position="relative",N.style.top="-2px",N.style.verticalAlign="bottom",N.style.marginRight="6px",N.style.display="none";var S=null;mxEvent.addListener(N,"change",function(e){null!=S&&(S(e),mxEvent.consume(e))});var B=mxUtils.button(mxResources.get("edit"),function(){null!=w&&(window.openFile=new OpenFile(function(){window.openFile=null}),window.openFile.setData(mxUtils.getXml(w.documentElement)),m.openLink(m.getUrl(),null,!0))});B.className="geBtn",B.setAttribute("disabled","disabled"),null!=l&&(B.style.display="none");var O=mxUtils.button(mxResources.get("show"),function(){null!=E&&m.openLink(E.getUrl(N.selectedIndex))});O.className="geBtn gePrimaryBtn",O.setAttribute("disabled","disabled"),null!=l&&(O.style.display="none",k.className="geBtn gePrimaryBtn");var P=document.createElement("div");P.style.position="absolute",P.style.top="482px",P.style.width="640px",P.style.textAlign="right";n=document.createElement("div");n.className="geToolbarContainer",n.style.backgroundColor="transparent",n.style.padding="2px",n.style.border="none",n.style.left="199px",n.style.top="442px";var G=null;if(null!=t&&0<t.length){u.style.cursor="move";a=document.createElement("table");a.style.border="1px solid lightGray",a.style.borderCollapse="collapse",a.style.borderSpacing="0px",a.style.width="100%";var H=document.createElement("tbody"),F=(new Date).toDateString();null!=m.currentPage&&null!=m.pages&&(h=mxUtils.indexOf(m.pages,m.currentPage));for(d=t.length-1;0<=d;d--){var z=function(r){var e,d=new Date(r.modifiedDate),c=null;return 0<=d.getTime()&&((c=document.createElement("tr")).style.borderBottom="1px solid lightGray",c.style.fontSize="12px",c.style.cursor="pointer",(e=document.createElement("td")).style.padding="6px",e.style.whiteSpace="nowrap",r==t[t.length-1]?mxUtils.write(e,mxResources.get("current")):d.toDateString()===F?mxUtils.write(e,d.toLocaleTimeString()):mxUtils.write(e,d.toLocaleDateString()+" "+d.toLocaleTimeString()),c.appendChild(e),c.setAttribute("title",d.toLocaleDateString()+" "+d.toLocaleTimeString()+(null!=r.fileSize?" "+m.formatFileSize(parseInt(r.fileSize)):"")+(null!=r.lastModifyingUserName?" "+r.lastModifyingUserName:"")),mxEvent.addListener(c,"click",function(e){E!=r&&(y.stop(),null!=f&&(f.style.backgroundColor=""),E=r,(f=c).style.backgroundColor=Editor.isDarkMode()?"#000000":"#ebf2f9",C=w=null,U.removeAttribute("title"),U.innerHTML=mxUtils.htmlEntities(mxResources.get("loading")+"..."),u.style.backgroundColor=g.defaultPageBackgroundColor,p.innerHTML="",g.getModel().clear(),k.setAttribute("disabled","disabled"),M.setAttribute("disabled","disabled"),A.setAttribute("disabled","disabled"),D.setAttribute("disabled","disabled"),R.setAttribute("disabled","disabled"),T.setAttribute("disabled","disabled"),I.setAttribute("disabled","disabled"),B.setAttribute("disabled","disabled"),O.setAttribute("disabled","disabled"),N.setAttribute("disabled","disabled"),mxUtils.setOpacity(A,20),mxUtils.setOpacity(D,20),mxUtils.setOpacity(T,20),mxUtils.setOpacity(R,20),mxUtils.setOpacity(I,20),y.spin(u),r.getXml(function(e){if(E==r)try{!function(e){y.stop(),p.innerHTML="";var t=mxUtils.parseXml(e),l=m.editor.extractGraphModel(t.documentElement,!0);if(null!=l){function n(e){var t=e.getAttribute("background");return null!=t&&""!=t&&t!=mxConstants.NONE||(t=g.defaultPageBackgroundColor),u.style.backgroundColor=t,new mxCodec(e.ownerDocument).decode(e,g.getModel()),g.maxFitScale=1,g.fit(8),g.center(),e}function i(e){return e=null!=e?n(Editor.parseDiagramNode(e)):e}if(N.style.display="none",N.innerHTML="",w=t,C=e,parseSelectFunction=null,x=null,b=0,"mxfile"==l.nodeName){var s=l.getElementsByTagName("diagram");x=[];for(var a=0;a<s.length;a++)x.push(s[a]);if(b=Math.min(h,x.length-1),0<x.length&&i(x[b]),1<x.length){N.removeAttribute("disabled"),N.style.display="";for(a=0;a<x.length;a++){var o=document.createElement("option");mxUtils.write(o,x[a].getAttribute("name")||mxResources.get("pageWithNumber",[a+1])),o.setAttribute("value",a),a==b&&o.setAttribute("selected","selected"),N.appendChild(o)}}S=function(){try{var e=parseInt(N.value);b=h=e,i(x[e])}catch(e){N.value=h,m.handleError(e)}}}else n(l);l=r.lastModifyingUserName;null!=l&&20<l.length&&(l=l.substring(0,20)+"..."),U.innerHTML="",mxUtils.write(U,(null!=l?l+" ":"")+d.toLocaleDateString()+" "+d.toLocaleTimeString()),U.setAttribute("title",c.getAttribute("title")),A.removeAttribute("disabled"),D.removeAttribute("disabled"),T.removeAttribute("disabled"),R.removeAttribute("disabled"),I.removeAttribute("disabled"),null!=v&&v.isRestricted()||(m.editor.graph.isEnabled()&&k.removeAttribute("disabled"),M.removeAttribute("disabled"),O.removeAttribute("disabled"),B.removeAttribute("disabled")),mxUtils.setOpacity(A,60),mxUtils.setOpacity(D,60),mxUtils.setOpacity(T,60),mxUtils.setOpacity(R,60),mxUtils.setOpacity(I,60)}else N.style.display="none",N.innerHTML="",U.innerHTML="",mxUtils.write(U,mxResources.get("errorLoadingFile")),mxUtils.write(p,mxResources.get("errorLoadingFile"))}(e)}catch(e){U.innerHTML=mxUtils.htmlEntities(mxResources.get("error")+": "+e.message)}},function(e){y.stop(),N.style.display="none",N.innerHTML="",U.innerHTML="",mxUtils.write(U,mxResources.get("errorLoadingFile")),mxUtils.write(p,mxResources.get("errorLoadingFile"))}),mxEvent.consume(e))}),mxEvent.addListener(c,"dblclick",function(e){O.click(),window.getSelection?window.getSelection().removeAllRanges():document.selection&&document.selection.empty(),mxEvent.consume(e)},!1),H.appendChild(c)),c}(t[d]);null!=z&&d==t.length-1&&(G=z)}a.appendChild(H),i.appendChild(a)}else null==v||null==m.drive&&v.constructor==window.DriveFile||null==m.dropbox&&v.constructor==window.DropboxFile?(u.style.display="none",n.style.display="none",mxUtils.write(i,mxResources.get("notAvailable"))):(u.style.display="none",n.style.display="none",mxUtils.write(i,mxResources.get("noRevisions")));this.init=function(){null!=G&&G.click()};i=mxUtils.button(mxResources.get("close"),function(){m.hideDialog()});i.className="geBtn",n.appendChild(N),n.appendChild(A),n.appendChild(D),n.appendChild(R),n.appendChild(T),n.appendChild(I),m.editor.cancelFirst?(P.appendChild(i),P.appendChild(M),P.appendChild(B),P.appendChild(k),P.appendChild(O)):(P.appendChild(M),P.appendChild(B),P.appendChild(k),P.appendChild(O),P.appendChild(i)),e.appendChild(P),e.appendChild(n),e.appendChild(U),this.container=e},DraftDialog=function(e,t,l,n,i,s,a,o,r){var d=document.createElement("div"),c=document.createElement("div");c.style.marginTop="0px",c.style.whiteSpace="nowrap",c.style.overflow="auto",c.style.lineHeight="normal",mxUtils.write(c,t),d.appendChild(c);var m=document.createElement("select"),u=mxUtils.bind(this,function(){v=mxUtils.parseXml(r[m.value].data),f=e.editor.extractGraphModel(v.documentElement,!0),E=0,this.init()});if(null!=r){m.style.marginLeft="4px";for(var p=0;p<r.length;p++){var g=document.createElement("option");g.setAttribute("value",p);var h=new Date(r[p].created),x=new Date(r[p].modified);mxUtils.write(g,h.toLocaleDateString()+" "+h.toLocaleTimeString()+" - "+(h.toDateString(),x.toDateString(),x.toLocaleDateString())+" "+x.toLocaleTimeString()),m.appendChild(g)}c.appendChild(m),mxEvent.addListener(m,"change",u)}null==l&&(l=r[0].data);var b=document.createElement("div");b.style.position="absolute",b.style.border="1px solid lightGray",b.style.marginTop="10px",b.style.left="40px",b.style.right="40px",b.style.top="46px",b.style.bottom="74px",b.style.overflow="hidden",mxEvent.disableContextMenu(b),d.appendChild(b);var y=new Graph(b);y.setEnabled(!1),y.setPanning(!0),y.panningHandler.ignoreCell=!0,y.panningHandler.useLeftButtonForPanning=!0,y.minFitScale=null,y.maxFitScale=null,y.centerZoom=!0;var v=mxUtils.parseXml(l),f=e.editor.extractGraphModel(v.documentElement,!0),E=0,w=null,C=y.getGlobalVariable;y.getGlobalVariable=function(e){return"page"==e&&null!=w&&null!=w[E]?w[E].getAttribute("name"):"pagenumber"==e?E+1:"pagecount"==e?null!=w?w.length:1:C.apply(this,arguments)},y.getLinkForCell=function(){return null};var A=mxUtils.button("",function(){y.zoomIn()});A.className="geSprite geSprite-zoomin",A.setAttribute("title",mxResources.get("zoomIn")),A.style.outline="none",A.style.border="none",A.style.margin="2px",mxUtils.setOpacity(A,60);var D=mxUtils.button("",function(){y.zoomOut()});D.className="geSprite geSprite-zoomout",D.setAttribute("title",mxResources.get("zoomOut")),D.style.outline="none",D.style.border="none",D.style.margin="2px",mxUtils.setOpacity(D,60);var T=mxUtils.button("",function(){y.maxFitScale=8,y.fit(8),y.center()});T.className="geSprite geSprite-fit",T.setAttribute("title",mxResources.get("fit")),T.style.outline="none",T.style.border="none",T.style.margin="2px",mxUtils.setOpacity(T,60);t=mxUtils.button("",function(){y.zoomActual(),y.center()});t.className="geSprite geSprite-actualsize",t.setAttribute("title",mxResources.get("actualSize")),t.style.outline="none",t.style.border="none",t.style.margin="2px",mxUtils.setOpacity(t,60);c=mxUtils.button(a||mxResources.get("discard"),function(){i.apply(this,[m.value,mxUtils.bind(this,function(){null!=m.parentNode&&(m.options[m.selectedIndex].parentNode.removeChild(m.options[m.selectedIndex]),0<m.options.length?(m.value=m.options[0].value,u()):e.hideDialog(!0))})])});c.className="geBtn";var R=document.createElement("select");R.style.maxWidth="80px",R.style.position="relative",R.style.top="-2px",R.style.verticalAlign="bottom",R.style.marginRight="6px",R.style.display="none";l=mxUtils.button(s||mxResources.get("edit"),function(){n.apply(this,[m.value])});l.className="geBtn gePrimaryBtn";a=document.createElement("div");a.style.position="absolute",a.style.bottom="30px",a.style.right="40px",a.style.textAlign="right";s=document.createElement("div");s.className="geToolbarContainer",s.style.cssText="box-shadow:none !important;background-color:transparent;padding:2px;border-style:none !important;bottom:30px;",this.init=function(){function t(e){var t;return null!=e&&(null!=(t=e.getAttribute("background"))&&""!=t&&t!=mxConstants.NONE||(t=Editor.isDarkMode()?"transparent":"#ffffff"),b.style.backgroundColor=t,new mxCodec(e.ownerDocument).decode(e,y.getModel()),y.maxFitScale=1,y.fit(8),y.center()),e}function l(e){return e=null!=e?t(Editor.parseDiagramNode(e)):e}if(mxEvent.addListener(R,"change",function(e){E=parseInt(R.value),l(w[E]),mxEvent.consume(e)}),"mxfile"==f.nodeName){var e=f.getElementsByTagName("diagram");w=[];for(var n=0;n<e.length;n++)w.push(e[n]);if(0<w.length&&l(w[E]),R.innerHTML="",1<w.length){R.style.display="";for(n=0;n<w.length;n++){var i=document.createElement("option");mxUtils.write(i,w[n].getAttribute("name")||mxResources.get("pageWithNumber",[n+1])),i.setAttribute("value",n),n==E&&i.setAttribute("selected","selected"),R.appendChild(i)}}else R.style.display="none"}else t(f)},s.appendChild(R),s.appendChild(A),s.appendChild(D),s.appendChild(t),s.appendChild(T);T=mxUtils.button(mxResources.get("cancel"),function(){e.hideDialog(!0)});T.className="geBtn";o=null!=o?mxUtils.button(mxResources.get("ignore"),o):null;null!=o&&(o.className="geBtn"),e.editor.cancelFirst?(a.appendChild(T),null!=o&&a.appendChild(o),a.appendChild(c),a.appendChild(l)):(a.appendChild(l),a.appendChild(c),null!=o&&a.appendChild(o),a.appendChild(T)),d.appendChild(a),d.appendChild(s),this.container=d},FindWindow=function(x,e,t,l,n,b){var i=x.actions.get("findReplace"),y=x.editor.graph,v=null,f=null,E=!1,w=!1,C=null,A=0,o=1,s=document.createElement("div");s.style.userSelect="none",s.style.overflow="hidden",s.style.padding="10px",s.style.height="100%";var D,a=b?"260px":"200px",T=document.createElement("input");T.setAttribute("placeholder",mxResources.get("find")),T.setAttribute("type","text"),T.style.marginTop="4px",T.style.marginBottom="6px",T.style.width=a,T.style.fontSize="12px",T.style.borderRadius="4px",T.style.padding="6px",s.appendChild(T),mxUtils.br(s),b&&((D=document.createElement("input")).setAttribute("placeholder",mxResources.get("replaceWith")),D.setAttribute("type","text"),D.style.marginTop="4px",D.style.marginBottom="6px",D.style.width=a,D.style.fontSize="12px",D.style.borderRadius="4px",D.style.padding="6px",s.appendChild(D),mxUtils.br(s),mxEvent.addListener(D,"input",M));var R=document.createElement("input");R.setAttribute("id","geFindWinRegExChck"),R.setAttribute("type","checkbox"),R.style.marginRight="4px",s.appendChild(R);var r=document.createElement("label");r.setAttribute("for","geFindWinRegExChck"),s.appendChild(r),mxUtils.write(r,mxResources.get("regularExpression")),s.appendChild(r),"1"!=urlParams.customMenu&&((c=x.menus.createHelpLink("https://www.diagrams.net/doc/faq/find-shapes")).style.position="relative",c.style.marginLeft="6px",c.style.top="-1px",s.appendChild(c)),mxUtils.br(s);var I=document.createElement("input");I.setAttribute("id","geFindWinAllPagesChck"),I.setAttribute("type","checkbox"),I.style.marginRight="4px",s.appendChild(I);var d=document.createElement("label");d.setAttribute("for","geFindWinAllPagesChck"),s.appendChild(d),mxUtils.write(d,mxResources.get("allPages")),s.appendChild(d);var L=document.createElement("div");function U(e,t,l,n){if("object"==typeof t.value&&null!=t.value.attributes)for(var i=t.value.attributes,s=0;s<i.length;s++)if("label"!=i[s].nodeName){var a=mxUtils.trim(i[s].nodeValue.replace(/[\x00-\x1F\x7F-\x9F]|\s+/g," ")).toLowerCase();if(null==e&&(n&&0<=a.indexOf(l)||!n&&a.substring(0,l.length)===l)||null!=e&&e.test(a))return 1}}function M(){E&&D.value?(m.removeAttribute("disabled"),u.removeAttribute("disabled")):(m.setAttribute("disabled","disabled"),u.setAttribute("disabled","disabled")),D.value&&T.value?p.removeAttribute("disabled"):p.setAttribute("disabled","disabled")}function k(e,t,l){N.innerHTML="";var n=y.model.getDescendants(y.model.getRoot()),i=T.value.toLowerCase(),s=R.checked?new RegExp(i):null,a=null;v!=i&&(v=i,f=null,w=!1);var o,r=(C=null)==f;if(0<i.length){if(w){w=!1;for(var d=0;d<x.pages.length;d++)if(x.currentPage==x.pages[d]){o=d;break}var c,m=(o+1)%x.pages.length;for(f=null;w=!1,c=x.pages[m],y=x.createTemporaryGraph(y.getStylesheet()),x.updatePageRoot(c),y.model.setRoot(c.root),m=(m+1)%x.pages.length,!k(!0,t,l)&&m!=o;);return f&&(f=null,l?x.editor.graph.model.execute(new SelectPage(x,c)):x.selectPage(c)),w=!1,y=x.editor.graph,k(!0,t,l)}for(d=0;d<n.length;d++){var u=y.view.getState(n[d]);if(t&&null!=s&&(r=r||u==f),null!=u&&null!=u.cell.value&&(r||null==a)&&(y.model.isVertex(u.cell)||y.model.isEdge(u.cell))){label=null!=u.style&&"1"==u.style.html?(L.innerHTML=y.sanitizeHtml(y.getLabel(u.cell)),mxUtils.extractTextWithWhitespace([L])):y.getLabel(u.cell),label=mxUtils.trim(label.replace(/[\x00-\x1F\x7F-\x9F]|\s+/g," ")).toLowerCase();var p=0;t&&b&&null!=s&&u==f&&(label=label.substr(A),p=A);var g=""==D.value,h=g;if(null==s&&(h&&0<=label.indexOf(i)||!h&&label.substring(0,i.length)===i||g&&U(s,u.cell,i,h))||null!=s&&(s.test(label)||g&&U(s,u.cell,i,h))){if(b&&(A=null!=s?(h=label.match(s),C=h[0].toLowerCase(),p+h.index+C.length):(C=i).length),r){a=u;break}null==a&&(a=u)}}r=r||u==f}}if(null!=a){if(d==n.length&&I.checked)return k(w=!(f=null),t,l);f=a,y.scrollCellToVisible(f.cell),y.isEnabled()&&!y.isCellLocked(f.cell)?l||y.getSelectionCell()==f.cell&&1==y.getSelectionCount()||y.setSelectionCell(f.cell):y.highlightCell(f.cell)}else{if(!e&&I.checked)return k(w=!0,t,l);y.isEnabled()&&!l&&y.clearSelection()}return E=null!=a,b&&!e&&M(),0==i.length||null!=a}mxUtils.br(s);a=document.createElement("div");a.style.left="0px",a.style.right="0px",a.style.marginTop="6px",a.style.padding="0 6px 0 6px",a.style.textAlign="center",s.appendChild(a);r=mxUtils.button(mxResources.get("reset"),function(){N.innerHTML="",T.value="",T.style.backgroundColor="",b&&(D.value="",M()),v=f=null,w=!1,T.focus()});r.setAttribute("title",mxResources.get("reset")),r.style.float="none",r.style.width="120px",r.style.marginTop="6px",r.style.marginLeft="8px",r.style.overflow="hidden",r.style.textOverflow="ellipsis",r.className="geBtn",b||a.appendChild(r);var c=mxUtils.button(mxResources.get("find"),function(){try{T.style.backgroundColor=k()?"":Editor.isDarkMode()?"#ff0000":"#ffcfcf"}catch(e){x.handleError(e)}});c.setAttribute("title",mxResources.get("find")+" (Enter)"),c.style.float="none",c.style.width="120px",c.style.marginTop="6px",c.style.marginLeft="8px",c.style.overflow="hidden",c.style.textOverflow="ellipsis",c.className="geBtn gePrimaryBtn",a.appendChild(c);var m,u,p,N=document.createElement("div");function g(e,t,l,n,i){if(null==i||"1"!=i.html)return(o=e.toLowerCase().indexOf(t,n))<0?e:e.substr(0,o)+l+e.substr(o+t.length);i=e;t=mxUtils.htmlEntities(t);for(var s=[],a=-1;-1<(a=e.indexOf("<",a+1));)s.push(a);var o,r=e.match(/<[^>]*>/g);if((o=(e=e.replace(/<[^>]*>/g,"")).toLowerCase().indexOf(t,n))<0)return i;for(var d,c=o+t.length,l=mxUtils.htmlEntities(l),m=e.substr(0,o)+l+e.substr(c),u=0,p=0;p<s.length;p++)m=s[p]-u<o?m.substr(0,s[p])+r[p]+m.substr(s[p]):s[p]-u<c?m.substr(0,d=o+u)+r[p]+m.substr(d):(d=s[p]+(l.length-t.length),m.substr(0,d)+r[p]+m.substr(d)),u+=r[p].length;return m}N.style.marginTop="10px",b?((m=mxUtils.button(mxResources.get("replFind"),function(){try{var e,t;null!=C&&null!=f&&D.value&&(e=f.cell,t=y.getLabel(e),y.isCellEditable(e)&&y.model.setValue(e,g(t,C,D.value,A-C.length,y.getCurrentCellStyle(e))),T.style.backgroundColor=k(!1,!0)?"":Editor.isDarkMode()?"#ff0000":"#ffcfcf")}catch(e){x.handleError(e)}})).setAttribute("title",mxResources.get("replFind")),m.style.float="none",m.style.width="120px",m.style.marginTop="6px",m.style.marginLeft="8px",m.style.overflow="hidden",m.style.textOverflow="ellipsis",m.className="geBtn gePrimaryBtn",m.setAttribute("disabled","disabled"),a.appendChild(m),mxUtils.br(a),(u=mxUtils.button(mxResources.get("replace"),function(){try{var e,t;null!=C&&null!=f&&D.value&&(e=f.cell,t=y.getLabel(e),y.model.setValue(e,g(t,C,D.value,A-C.length,y.getCurrentCellStyle(e))),m.setAttribute("disabled","disabled"),u.setAttribute("disabled","disabled"))}catch(e){x.handleError(e)}})).setAttribute("title",mxResources.get("replace")),u.style.float="none",u.style.width="120px",u.style.marginTop="6px",u.style.marginLeft="8px",u.style.overflow="hidden",u.style.textOverflow="ellipsis",u.className="geBtn gePrimaryBtn",u.setAttribute("disabled","disabled"),a.appendChild(u),(p=mxUtils.button(mxResources.get("replaceAll"),function(){if(N.innerHTML="",D.value){var e=x.currentPage,t=x.editor.graph.getSelectionCells();x.editor.graph.rendering=!1,y.getModel().beginUpdate();try{for(var l=0,n={};k(!1,!0,!0)&&l<100;){var i=f.cell,s=y.getLabel(i),a=n[i.id];if(a&&a.replAllMrk==o&&a.replAllPos>=A)break;n[i.id]={replAllMrk:o,replAllPos:A},y.isCellEditable(i)&&(y.model.setValue(i,g(s,C,D.value,A-C.length,y.getCurrentCellStyle(i))),l++)}e!=x.currentPage&&x.editor.graph.model.execute(new SelectPage(x,e)),mxUtils.write(N,mxResources.get("matchesRepl",[l]))}catch(e){x.handleError(e)}finally{y.getModel().endUpdate(),x.editor.graph.setSelectionCells(t),x.editor.graph.rendering=!0}o++}})).setAttribute("title",mxResources.get("replaceAll")),p.style.float="none",p.style.width="120px",p.style.marginTop="6px",p.style.marginLeft="8px",p.style.overflow="hidden",p.style.textOverflow="ellipsis",p.className="geBtn gePrimaryBtn",p.setAttribute("disabled","disabled"),a.appendChild(p),mxUtils.br(a),a.appendChild(r),(d=mxUtils.button(mxResources.get("close"),mxUtils.bind(this,function(){this.window.setVisible(!1)}))).setAttribute("title",mxResources.get("close")),d.style.float="none",d.style.width="120px",d.style.marginTop="6px",d.style.marginLeft="8px",d.style.overflow="hidden",d.style.textOverflow="ellipsis",d.className="geBtn",a.appendChild(d),mxUtils.br(a),a.appendChild(N)):(r.style.width="90px",c.style.width="90px"),mxEvent.addListener(T,"keyup",function(e){if(91==e.keyCode||93==e.keyCode||17==e.keyCode)mxEvent.consume(e);else if(27==e.keyCode)i.funct();else if(v!=T.value.toLowerCase()||13==e.keyCode)try{T.style.backgroundColor=k()?"":Editor.isDarkMode()?"#ff0000":"#ffcfcf"}catch(e){T.style.backgroundColor=Editor.isDarkMode()?"#ff0000":"#ffcfcf"}}),mxEvent.addListener(s,"keydown",function(e){70==e.keyCode&&x.keyHandler.isControlDown(e)&&!mxEvent.isShiftDown(e)&&(i.funct(),mxEvent.consume(e))}),this.window=new mxWindow(mxResources.get("find")+(b?"/"+mxResources.get("replace"):""),s,e,t,l,n,!0,!0),this.window.destroyOnClose=!1,this.window.setMaximizable(!1),this.window.setResizable(!1),this.window.setClosable(!0),this.window.addListener("show",mxUtils.bind(this,function(){this.window.fit(),this.window.isVisible()?(T.focus(),mxClient.IS_GC||mxClient.IS_FF||5<=document.documentMode?T.select():document.execCommand("selectAll",!1,null),null!=x.pages&&1<x.pages.length?I.removeAttribute("disabled"):(I.checked=!1,I.setAttribute("disabled","disabled"))):y.container.focus()})),this.window.setLocation=function(e,t){var l=window.innerWidth||document.body.clientWidth||document.documentElement.clientWidth,n=window.innerHeight||document.body.clientHeight||document.documentElement.clientHeight;e=Math.max(0,Math.min(e,l-this.table.clientWidth)),t=Math.max(0,Math.min(t,n-this.table.clientHeight-("1"==urlParams.sketch?3:48))),this.getX()==e&&this.getY()==t||mxWindow.prototype.setLocation.apply(this,arguments)};var h=mxUtils.bind(this,function(){var e=this.window.getX(),t=this.window.getY();this.window.setLocation(e,t)});mxEvent.addListener(window,"resize",h),this.destroy=function(){mxEvent.removeListener(window,"resize",h),this.window.destroy()}},FreehandWindow=function(e,t,l,n,i){var s=e.editor.graph,e=document.createElement("div");e.style.textAlign="center",e.style.userSelect="none",e.style.overflow="hidden",e.style.height="100%";var a=mxUtils.button(mxResources.get("startDrawing"),function(){s.freehand.isDrawing()?s.freehand.stopDrawing():s.freehand.startDrawing()});a.setAttribute("title",mxResources.get("startDrawing")),a.style.marginTop="10px",a.style.width="90%",a.style.boxSizing="border-box",a.style.overflow="hidden",a.style.textOverflow="ellipsis",a.style.textAlign="center",a.className="geBtn gePrimaryBtn",e.appendChild(a),this.window=new mxWindow(mxResources.get("freehand"),e,t,l,n,i,!0,!0),this.window.destroyOnClose=!1,this.window.setMaximizable(!1),this.window.setResizable(!1),this.window.setClosable(!0),s.addListener("freehandStateChanged",mxUtils.bind(this,function(){a.innerHTML="",mxUtils.write(a,mxResources.get(s.freehand.isDrawing()?"stopDrawing":"startDrawing")),a.setAttribute("title",mxResources.get(s.freehand.isDrawing()?"stopDrawing":"startDrawing")),a.className="geBtn"+(s.freehand.isDrawing()?"":" gePrimaryBtn")})),this.window.addListener("show",mxUtils.bind(this,function(){this.window.fit()})),this.window.addListener("hide",mxUtils.bind(this,function(){s.freehand.isDrawing()&&s.freehand.stopDrawing()})),this.window.setLocation=function(e,t){var l=window.innerWidth||document.body.clientWidth||document.documentElement.clientWidth,n=window.innerHeight||document.body.clientHeight||document.documentElement.clientHeight;e=Math.max(0,Math.min(e,l-this.table.clientWidth)),t=Math.max(0,Math.min(t,n-this.table.clientHeight-("1"==urlParams.sketch?3:48))),this.getX()==e&&this.getY()==t||mxWindow.prototype.setLocation.apply(this,arguments)};var o=mxUtils.bind(this,function(){var e=this.window.getX(),t=this.window.getY();this.window.setLocation(e,t)});mxEvent.addListener(window,"resize",o),this.destroy=function(){mxEvent.removeListener(window,"resize",o),this.window.destroy()}},TagsWindow=function(o,e,t,l,n){var r=o.editor.graph,i=o.editor.graph.createTagsDialog(mxUtils.bind(this,function(){return this.window.isVisible()}),null,function(s,a){var e;r.isEnabled()&&(e=new FilenameDialog(o,"",mxResources.get("add"),function(e){if(o.hideDialog(),null!=e&&0<e.length){for(var t=e.split(" "),l=[],n=0;n<t.length;n++){var i=mxUtils.trim(t[n]);""!=i&&mxUtils.indexOf(s,i)<0&&l.push(i)}0<l.length&&(r.isSelectionEmpty()?a(s.concat(l)):r.addTagsForCells(r.getSelectionCells(),l))}},mxResources.get("enterValue")+" ("+mxResources.get("tags")+")"),o.showDialog(e.container,300,80,!0,!0),e.init())}),s=i.div;this.window=new mxWindow(mxResources.get("tags"),s,e,t,l,n,!0,!0),this.window.minimumSize=new mxRectangle(0,0,212,120),this.window.destroyOnClose=!1,this.window.setMaximizable(!1),this.window.setResizable(!0),this.window.setClosable(!0),this.window.addListener("show",mxUtils.bind(this,function(){i.refresh(),this.window.fit()})),this.window.setLocation=function(e,t){var l=window.innerWidth||document.body.clientWidth||document.documentElement.clientWidth,n=window.innerHeight||document.body.clientHeight||document.documentElement.clientHeight;e=Math.max(0,Math.min(e,l-this.table.clientWidth)),t=Math.max(0,Math.min(t,n-this.table.clientHeight-("1"==urlParams.sketch?3:48))),this.getX()==e&&this.getY()==t||mxWindow.prototype.setLocation.apply(this,arguments)};var a=mxUtils.bind(this,function(){var e=this.window.getX(),t=this.window.getY();this.window.setLocation(e,t)});mxEvent.addListener(window,"resize",a),this.destroy=function(){mxEvent.removeListener(window,"resize",a),this.window.destroy()}},AuthDialog=function(e,t,l,n){var i=document.createElement("div");i.style.textAlign="center";var s=document.createElement("p");s.style.fontSize="16pt",s.style.padding="0px",s.style.margin="0px",s.style.color="gray",mxUtils.write(s,mxResources.get("authorizationRequired"));var a="Unknown",o=document.createElement("img");o.setAttribute("border","0"),o.setAttribute("align","absmiddle"),o.style.marginRight="10px",t==e.drive?(a=mxResources.get("googleDrive"),o.src=IMAGE_PATH+"/google-drive-logo-white.svg"):t==e.dropbox?(a=mxResources.get("dropbox"),o.src=IMAGE_PATH+"/dropbox-logo-white.svg"):t==e.oneDrive?(a=mxResources.get("oneDrive"),o.src=IMAGE_PATH+"/onedrive-logo-white.svg"):t==e.gitHub?(a=mxResources.get("github"),o.src=IMAGE_PATH+"/github-logo-white.svg"):t==e.gitLab?(a=mxResources.get("gitlab"),o.src=IMAGE_PATH+"/gitlab-logo.svg",o.style.width="32px"):t==e.notion?(a=mxResources.get("notion"),o.src=IMAGE_PATH+"/notion-logo-white.svg",o.style.width="32px"):t==e.trello&&(a=mxResources.get("trello"),o.src=IMAGE_PATH+"/trello-logo-white.svg");e=document.createElement("p");mxUtils.write(e,mxResources.get("authorizeThisAppIn",[a]));var r=document.createElement("input");r.setAttribute("type","checkbox");var a=mxUtils.button(mxResources.get("authorize"),function(){n(r.checked)});a.insertBefore(o,a.firstChild),a.style.marginTop="6px",a.className="geBigButton",a.style.fontSize="18px",a.style.padding="14px",i.appendChild(s),i.appendChild(e),i.appendChild(a),l&&((a=document.createElement("p")).style.marginTop="20px",a.appendChild(r),l=document.createElement("span"),mxUtils.write(l," "+mxResources.get("rememberMe")),a.appendChild(l),i.appendChild(a),r.checked=!0,r.defaultChecked=!0,mxEvent.addListener(l,"click",function(e){r.checked=!r.checked,mxEvent.consume(e)})),this.container=i},MoreShapesDialog=function(a,e,t){t=null!=t?t:a.sidebar.entries;var l=document.createElement("div"),n=[];if(null!=a.sidebar.customEntries)for(var i=0;i<a.sidebar.customEntries.length;i++){for(var s=a.sidebar.customEntries[i],o={title:a.getResource(s.title),entries:[]},r=0;r<s.entries.length;r++){var d=s.entries[r];o.entries.push({id:d.id,title:a.getResource(d.title),desc:a.getResource(d.desc),image:d.preview})}n.push(o)}for(i=0;i<t.length;i++)if(null==a.sidebar.enabledLibraries)n.push(t[i]);else{for(o={title:t[i].title,entries:[]},r=0;r<t[i].entries.length;r++)0<=mxUtils.indexOf(a.sidebar.enabledLibraries,t[i].entries[r].id)&&o.entries.push(t[i].entries[r]);0<o.entries.length&&n.push(o)}if(t=n,e){var c=mxUtils.bind(this,function(e){for(var s=0;s<e.length;s++)!function(e){var t=x.cloneNode(!1);t.style.fontWeight="bold",t.style.backgroundColor=Editor.isDarkMode()?"#505759":"#e5e5e5",t.style.padding="6px 0px 6px 20px",mxUtils.write(t,e.title),u.appendChild(t);for(var i=0;i<e.entries.length;i++)!function(l){var n=x.cloneNode(!1);n.style.cursor="pointer",n.style.padding="4px 0px 4px 20px",n.style.whiteSpace="nowrap",n.style.overflow="hidden",n.style.textOverflow="ellipsis",n.setAttribute("title",l.title+" ("+l.id+")");var t=document.createElement("input");t.setAttribute("type","checkbox"),t.checked=a.sidebar.isEntryVisible(l.id),t.defaultChecked=t.checked,n.appendChild(t),mxUtils.write(n," "+l.title),u.appendChild(n);function e(e){var t;null!=e&&"INPUT"==mxEvent.getSource(e).nodeName||(p.style.textAlign="center",p.style.padding="0px",p.style.color="",p.innerHTML="",null!=l.desc&&((t=document.createElement("pre")).style.boxSizing="border-box",t.style.fontFamily="inherit",t.style.margin="20px",t.style.right="0px",t.style.textAlign="left",mxUtils.write(t,l.desc),p.appendChild(t)),null!=l.imageCallback?l.imageCallback(p):null!=l.image?p.innerHTML+='<img border="0" src="'+l.image+'"/>':null==l.desc&&(p.style.padding="20px",p.style.color="rgb(179, 179, 179)",mxUtils.write(p,mxResources.get("noPreview"))),null!=g&&(g.style.backgroundColor=""),(g=n).style.backgroundColor=Editor.isDarkMode()?"#000000":"#ebf2f9",null!=e&&mxEvent.consume(e))}mxEvent.addListener(n,"click",e),mxEvent.addListener(n,"dblclick",function(e){t.checked=!t.checked,mxEvent.consume(e)}),h.push(function(){return t.checked?l.id:null}),0==s&&0==i&&e()}(e.entries[i])}(e[s])}),m=document.createElement("div");m.className="geDialogTitle",mxUtils.write(m,mxResources.get("shapes")),m.style.position="absolute",m.style.top="0px",m.style.left="0px",m.style.lineHeight="40px",m.style.height="40px",m.style.right="0px";var u=document.createElement("div"),p=document.createElement("div");u.style.position="absolute",u.style.top="40px",u.style.left="0px",u.style.width="202px",u.style.bottom="60px",u.style.overflow="auto",p.style.position="absolute",p.style.left="202px",p.style.right="0px",p.style.top="40px",p.style.bottom="60px",p.style.overflow="auto",p.style.borderLeft="1px solid rgb(211, 211, 211)",p.style.textAlign="center";var g=null,h=[],x=document.createElement("div");x.style.position="relative",x.style.left="0px",x.style.right="0px",c(t),l.style.padding="30px",l.appendChild(m),l.appendChild(u),l.appendChild(p),(R=document.createElement("div")).className="geDialogFooter",R.style.position="absolute",R.style.paddingRight="16px",R.style.color="gray",R.style.left="0px",R.style.right="0px",R.style.bottom="0px",R.style.height="60px",R.style.lineHeight="52px",(I=document.createElement("input")).setAttribute("type","checkbox"),(isLocalStorage||mxClient.IS_CHROMEAPP)&&((A=document.createElement("span")).style.paddingRight="20px",A.appendChild(I),mxUtils.write(A," "+mxResources.get("rememberThisSetting")),I.checked=!0,I.defaultChecked=!0,mxEvent.addListener(A,"click",function(e){mxEvent.getSource(e)!=I&&(I.checked=!I.checked,mxEvent.consume(e))}),R.appendChild(A)),(D=mxUtils.button(mxResources.get("cancel"),function(){a.hideDialog()})).className="geBtn",(T=mxUtils.button(mxResources.get("apply"),function(){a.hideDialog();var e=[];console.log(" ");for(var t=0;t<h.length;t++){var l=h[t].apply(this,arguments);null!=l&&e.push(l)}console.log(e.join(";")),a.sidebar.showEntries(e.join(";"),I.checked,!0)})).className="geBtn gePrimaryBtn",a.editor.cancelFirst?(R.appendChild(D),R.appendChild(T)):(R.appendChild(T),R.appendChild(D)),l.appendChild(R)}else{var b=document.createElement("table"),y=document.createElement("tbody");l.style.height="100%",l.style.overflow="auto";var v=document.createElement("tr");b.style.width="100%";var e=document.createElement("td"),c=document.createElement("td"),m=document.createElement("td"),f=mxUtils.bind(this,function(e,t,l){var n=document.createElement("input");n.type="checkbox",b.appendChild(n),n.checked=a.sidebar.isEntryVisible(l);var i=document.createElement("span");mxUtils.write(i,t);t=document.createElement("div");return t.style.display="block",t.appendChild(n),t.appendChild(i),mxEvent.addListener(i,"click",function(e){n.checked=!n.checked,mxEvent.consume(e)}),e.appendChild(t),function(){return n.checked?l:null}});v.appendChild(e),v.appendChild(c),v.appendChild(m),y.appendChild(v),b.appendChild(y);for(var h=[],E=0,i=0;i<t.length;i++)for(r=0;r<t[i].entries.length;r++)E++;for(var w=[e,c,m],C=0,i=0;i<t.length;i++)!function(e){for(var t,l,n=0;n<e.entries.length;n++)t=e.entries[n],l=void 0,l=Math.floor(C/(E/3)),h.push(f(w[l],t.title,t.id)),C++}(t[i]);l.appendChild(b);m=document.createElement("div");m.style.marginTop="18px",m.style.textAlign="center";var A,D,T,R,I=document.createElement("input");isLocalStorage&&(I.setAttribute("type","checkbox"),I.checked=!0,I.defaultChecked=!0,m.appendChild(I),A=document.createElement("span"),mxUtils.write(A," "+mxResources.get("rememberThisSetting")),m.appendChild(A),mxEvent.addListener(A,"click",function(e){I.checked=!I.checked,mxEvent.consume(e)})),l.appendChild(m),(D=mxUtils.button(mxResources.get("cancel"),function(){a.hideDialog()})).className="geBtn",(T=mxUtils.button(mxResources.get("apply"),function(){for(var e=["search"],t=0;t<h.length;t++){var l=h[t].apply(this,arguments);null!=l&&e.push(l)}a.sidebar.showEntries(0<e.length?e.join(";"):"",I.checked),a.hideDialog()})).className="geBtn gePrimaryBtn",(R=document.createElement("div")).style.marginTop="26px",R.style.textAlign="right",a.editor.cancelFirst?(R.appendChild(D),R.appendChild(T)):(R.appendChild(T),R.appendChild(D)),l.appendChild(R)}this.container=l},PluginsDialog=function(s,e,n){var t=document.createElement("div"),i=document.createElement("div");i.style.height="120px",i.style.overflow="auto";var a=mxSettings.getPlugins().slice();function o(){if(0==a.length)i.innerHTML=mxUtils.htmlEntities(mxResources.get("noPlugins"));else{i.innerHTML="";for(var e=0;e<a.length;e++){var t=document.createElement("span");t.style.whiteSpace="nowrap";var l=document.createElement("span");l.className="geSprite geSprite-delete",l.style.position="relative",l.style.cursor="pointer",l.style.top="5px",l.style.marginRight="4px",l.style.display="inline-block",t.appendChild(l),mxUtils.write(t,a[e]),i.appendChild(t),mxUtils.br(i),mxEvent.addListener(l,"click",function(e){return function(){s.confirm(mxResources.get("delete")+' "'+a[e]+'"?',function(){null!=n&&n(a[e]),a.splice(e,1),o()})}}(e))}}}t.appendChild(i),o();var l=mxUtils.button(mxResources.get("add")+"...",null!=e?function(){e(function(e){e&&mxUtils.indexOf(a,e)<0&&a.push(e),o()})}:function(){var e=document.createElement("div"),t=document.createElement("span");t.style.marginTop="6px",mxUtils.write(t,mxResources.get("builtinPlugins")+": "),e.appendChild(t);var l=document.createElement("select");l.style.width="150px";for(var n=0;n<App.publicPlugin.length;n++){var i=document.createElement("option");mxUtils.write(i,App.publicPlugin[n]),i.value=App.publicPlugin[n],l.appendChild(i)}e.appendChild(l),mxUtils.br(e),mxUtils.br(e);t=mxUtils.button(mxResources.get("custom")+"...",function(){var e=new FilenameDialog(s,"",mxResources.get("add"),function(e){if(s.hideDialog(),null!=e&&0<e.length){for(var t=e.split(";"),l=0;l<t.length;l++){var n=t[l],i=App.pluginRegistry[n];0<(n=null!=i?i:n).length&&mxUtils.indexOf(a,n)<0&&a.push(n)}o()}},mxResources.get("enterValue")+" ("+mxResources.get("url")+")");s.showDialog(e.container,300,80,!0,!0),e.init()});t.className="geBtn";t=new CustomDialog(s,e,mxUtils.bind(this,function(){var e=App.pluginRegistry[l.value];mxUtils.indexOf(a,e)<0&&(a.push(e),o())}),null,null,null,t);s.showDialog(t.container,300,100,!0,!0)});l.className="geBtn";var r=mxUtils.button(mxResources.get("cancel"),function(){s.hideDialog()});r.className="geBtn";var d=mxUtils.button(mxResources.get("apply"),function(){mxSettings.setPlugins(a),mxSettings.save(),s.hideDialog(),s.alert(mxResources.get("restartForChangeRequired"))});d.className="geBtn gePrimaryBtn";var c,m=document.createElement("div");m.style.marginTop="14px",m.style.textAlign="right","1"!=urlParams.customMenu&&((c=mxUtils.button(mxResources.get("help"),function(){s.openLink("https://www.diagrams.net/doc/faq/plugins")})).className="geBtn",s.isOffline()&&!mxClient.IS_CHROMEAPP&&(c.style.display="none"),m.appendChild(c)),s.editor.cancelFirst?(m.appendChild(r),m.appendChild(l),m.appendChild(d)):(m.appendChild(l),m.appendChild(d),m.appendChild(r)),t.appendChild(m),this.container=t},CropImageDialog=function(t,l,n){var e=document.createElement("div"),i=document.createElement("div");i.style.width="300px",i.style.height="300px",e.appendChild(i);var s=null;function a(e){null!=s&&s.destroy(),(s=e?new Croppie(i,{viewport:{width:150,height:150,type:"circle"},enableExif:!0,showZoomer:!1,enableResize:!1,enableOrientation:!0}):new Croppie(i,{viewport:{width:150,height:150,type:"square"},enableExif:!0,showZoomer:!1,enableResize:!0,enableOrientation:!0})).bind({url:l})}this.init=function(){a()};var o=document.createElement("input");o.setAttribute("type","checkbox"),o.setAttribute("id","croppieCircle"),o.style.margin="5px",e.appendChild(o);var r,d,c=document.createElement("label");c.setAttribute("for","croppieCircle"),mxUtils.write(c,mxResources.get("circle")),e.appendChild(c),r=document.createElement("div"),m=document.createElement("button"),u=document.createElement("button"),r.appendChild(m),r.appendChild(u),d=document.createElement("i"),c=document.createElement("i"),m.appendChild(d),u.appendChild(c),r.className="cr-rotate-controls",r.style.float="right",r.style.position="inherit",m.className="cr-rotate-l",u.className="cr-rotate-r",e.appendChild(r),m.addEventListener("click",function(){s.rotate(-90)}),u.addEventListener("click",function(){s.rotate(90)}),mxEvent.addListener(o,"change",function(){a(this.checked)});var m=mxUtils.button(mxResources.get("cancel"),function(){t.hideDialog()});m.className="geBtn";var u=mxUtils.button(mxResources.get("apply"),function(){s.result({type:"base64",size:"original"}).then(function(e){n(e),t.hideDialog()})});u.className="geBtn gePrimaryBtn";o=document.createElement("div");o.style.marginTop="20px",o.style.textAlign="right",t.editor.cancelFirst?(o.appendChild(m),o.appendChild(u)):(o.appendChild(u),o.appendChild(m)),e.appendChild(o),this.container=e},EditGeometryDialog=function(l,n){var i=l.editor.graph,e=1==n.length?i.getCellGeometry(n[0]):null,t=document.createElement("div"),s=document.createElement("table"),a=document.createElement("tbody"),o=document.createElement("tr"),r=document.createElement("td"),d=document.createElement("td");s.style.paddingLeft="6px",mxUtils.write(r,mxResources.get("relative")+":");var c=document.createElement("input");c.setAttribute("type","checkbox"),null!=e&&e.relative&&(c.setAttribute("checked","checked"),c.defaultChecked=!0),this.init=function(){c.focus()},d.appendChild(c),o.appendChild(r),o.appendChild(d),a.appendChild(o),o=document.createElement("tr"),r=document.createElement("td"),d=document.createElement("td"),mxUtils.write(r,mxResources.get("left")+":");var m=document.createElement("input");m.setAttribute("type","text"),m.style.width="100px",m.value=null!=e?e.x:"",d.appendChild(m),o.appendChild(r),o.appendChild(d),a.appendChild(o),o=document.createElement("tr"),r=document.createElement("td"),d=document.createElement("td"),mxUtils.write(r,mxResources.get("top")+":");var u=document.createElement("input");u.setAttribute("type","text"),u.style.width="100px",u.value=null!=e?e.y:"",d.appendChild(u),o.appendChild(r),o.appendChild(d),a.appendChild(o),o=document.createElement("tr"),r=document.createElement("td"),d=document.createElement("td"),mxUtils.write(r,mxResources.get("dx")+":");var p=document.createElement("input");p.setAttribute("type","text"),p.style.width="100px",p.value=null!=e&&null!=e.offset?e.offset.x:"",d.appendChild(p),o.appendChild(r),o.appendChild(d),a.appendChild(o),o=document.createElement("tr"),r=document.createElement("td"),d=document.createElement("td"),mxUtils.write(r,mxResources.get("dy")+":");var g=document.createElement("input");g.setAttribute("type","text"),g.style.width="100px",g.value=null!=e&&null!=e.offset?e.offset.y:"",d.appendChild(g),o.appendChild(r),o.appendChild(d),a.appendChild(o),o=document.createElement("tr"),r=document.createElement("td"),d=document.createElement("td"),mxUtils.write(r,mxResources.get("width")+":");var h=document.createElement("input");h.setAttribute("type","text"),h.style.width="100px",h.value=null!=e?e.width:"",d.appendChild(h),o.appendChild(r),o.appendChild(d),a.appendChild(o),o=document.createElement("tr"),r=document.createElement("td"),d=document.createElement("td"),mxUtils.write(r,mxResources.get("height")+":");var x=document.createElement("input");x.setAttribute("type","text"),x.style.width="100px",x.value=null!=e?e.height:"",d.appendChild(x),o.appendChild(r),o.appendChild(d),a.appendChild(o),o=document.createElement("tr"),r=document.createElement("td"),d=document.createElement("td"),mxUtils.write(r,mxResources.get("rotation")+":");var b=document.createElement("input");b.setAttribute("type","text"),b.style.width="100px",b.value=1==n.length?mxUtils.getValue(i.getCellStyle(n[0]),mxConstants.STYLE_ROTATION,0):"",d.appendChild(b),o.appendChild(r),o.appendChild(d),a.appendChild(o),s.appendChild(a),t.appendChild(s);a=mxUtils.button(mxResources.get("cancel"),function(){l.hideDialog()});a.className="geBtn";var y=mxUtils.button(mxResources.get("apply"),function(){l.hideDialog(),i.getModel().beginUpdate();try{for(var e=0;e<n.length;e++){var t=i.getCellGeometry(n[e]);null!=t&&(t=t.clone(),i.isCellMovable(n[e])&&(t.relative=c.checked,0<mxUtils.trim(m.value).length&&(t.x=Number(m.value)),0<mxUtils.trim(u.value).length&&(t.y=Number(u.value)),0<mxUtils.trim(p.value).length&&(null==t.offset&&(t.offset=new mxPoint),t.offset.x=Number(p.value)),0<mxUtils.trim(g.value).length&&(null==t.offset&&(t.offset=new mxPoint),t.offset.y=Number(g.value))),i.isCellResizable(n[e])&&(0<mxUtils.trim(h.value).length&&(t.width=Number(h.value)),0<mxUtils.trim(x.value).length&&(t.height=Number(x.value))),i.getModel().setGeometry(n[e],t)),0<mxUtils.trim(b.value).length&&i.setCellStyles(mxConstants.STYLE_ROTATION,Number(b.value),[n[e]])}}finally{i.getModel().endUpdate()}});y.className="geBtn gePrimaryBtn",mxEvent.addListener(t,"keypress",function(e){13==e.keyCode&&y.click()});s=document.createElement("div");s.style.marginTop="20px",s.style.textAlign="right",l.editor.cancelFirst?(s.appendChild(a),s.appendChild(y)):(s.appendChild(y),s.appendChild(a)),t.appendChild(s),this.container=t},LibraryDialog=function(L,e,t,l,n,i){var U=[],s=(L.editor.graph,document.createElement("div"));s.style.height="100%";var a=document.createElement("div");a.style.whiteSpace="nowrap",a.style.height="40px",s.appendChild(a),mxUtils.write(a,mxResources.get("filename")+":");var o=e;null==e&&(o=L.defaultLibraryName+".xml");var r=document.createElement("input");r.setAttribute("value",o),r.style.marginRight="20px",r.style.marginLeft="10px",r.style.width="500px",null==n||n.isRenamable()||r.setAttribute("disabled","true"),this.init=function(){null!=n&&!n.isRenamable()||(r.focus(),mxClient.IS_GC||mxClient.IS_FF||5<=document.documentMode?r.select():document.execCommand("selectAll",!1,null))},a.appendChild(r);var M=document.createElement("div");M.style.borderWidth="1px 0px 1px 0px",M.style.borderColor="#d3d3d3",M.style.borderStyle="solid",M.style.marginTop="6px",M.style.overflow="auto",M.style.height="340px",M.style.backgroundPosition="center center",M.style.backgroundRepeat="no-repeat",0==U.length&&Graph.fileSupport&&(M.style.backgroundImage="url('"+IMAGE_PATH+"/droptarget.png')");var k=document.createElement("div");k.style.position="absolute",k.style.width="640px",k.style.top="260px",k.style.textAlign="center",k.style.fontSize="22px",k.style.color="#a0c3ff",mxUtils.write(k,mxResources.get("dragImagesHere")),s.appendChild(k);var N={},S=100,B=100,O=null,d=null;function P(e){for(var t=document.elementFromPoint(e.clientX,e.clientY);null!=t&&t.parentNode!=M;)t=t.parentNode;var l=null;if(null!=t)for(var n=M.firstChild,l=0;null!=n&&n!=t;)n=n.nextSibling,l++;return l}function c(e){"true"!=mxEvent.getSource(e).getAttribute("contentEditable")&&null!=G&&(G(),G=null,mxEvent.consume(e))}var G=null;mxEvent.addListener(M,"mousedown",c),mxEvent.addListener(M,"pointerdown",c),mxEvent.addListener(M,"touchstart",c);var H=new mxUrlConverter,F=!1;function z(t,e,l,n,i,s,a,o,r){try{if(L.spinner.stop(),null==e||"image/"==e.substring(0,6)){function d(){x.innerHTML="",x.style.cursor="pointer",x.style.whiteSpace="nowrap",x.style.textOverflow="ellipsis",mxUtils.write(x,null!=b.title&&0<b.title.length?b.title:mxResources.get("untitled")),null==b.title||0==b.title.length?x.style.color="#d0d0d0":x.style.color=""}var c,m,u,p,g,h,x,b,y;null==t&&null!=a||null==N[t]?(M.style.backgroundImage="",k.style.display="none",m=s,((c=i)>L.maxImageSize||s>L.maxImageSize)&&(i*=u=Math.min(1,Math.min(L.maxImageSize/Math.max(1,i)),L.maxImageSize/Math.max(1,s)),s*=u),m<c?(m=Math.round(m*S/c),c=S):(c=Math.round(c*B/m),m=B),(p=document.createElement("div")).setAttribute("draggable","true"),p.style.display="inline-block",p.style.position="relative",p.style.padding="0 12px",p.style.cursor="move",mxUtils.setPrefixedStyle(p.style,"transition","transform .1s ease-in-out"),null!=t?((g=document.createElement("img")).setAttribute("src",H.convert(t)),g.style.width=c+"px",g.style.height=m+"px",g.style.margin="10px",g.style.paddingBottom=Math.floor((B-m)/2)+"px",g.style.paddingLeft=Math.floor((S-c)/2)+"px",p.appendChild(g)):null!=a&&0<(A=L.stringToCells(Graph.decompress(a.xml))).length&&(L.sidebar.createThumb(A,S,B,p,null,!0,!1),p.firstChild.style.display="inline-block",p.firstChild.style.cursor=""),(h=document.createElement("img")).setAttribute("src",Editor.closeBlackImage),h.setAttribute("border","0"),h.setAttribute("title",mxResources.get("delete")),h.setAttribute("align","top"),h.style.paddingTop="4px",h.style.position="absolute",h.style.marginLeft="-12px",h.style.zIndex="1",h.style.cursor="pointer",mxEvent.addListener(h,"dragstart",function(e){mxEvent.consume(e)}),T=p,R=t,I=a,mxEvent.addListener(h,"click",function(e){N[R]=null;for(var t=0;t<U.length;t++)if(null!=U[t].data&&U[t].data==R||null!=U[t].xml&&null!=I&&U[t].xml==I.xml){U.splice(t,1);break}p.parentNode.removeChild(T),0==U.length&&(M.style.backgroundImage="url('"+IMAGE_PATH+"/droptarget.png')",k.style.display=""),mxEvent.consume(e)}),mxEvent.addListener(h,"dblclick",function(e){mxEvent.consume(e)}),p.appendChild(h),p.style.marginBottom="30px",(x=document.createElement("div")).style.position="absolute",x.style.boxSizing="border-box",x.style.bottom="-18px",x.style.left="10px",x.style.right="10px",x.style.backgroundColor=Editor.isDarkMode()?Editor.darkColor:"#ffffff",x.style.overflow="hidden",x.style.textAlign="center",(b=null)!=t?(b={data:t,w:i,h:s,title:r},null!=o&&(b.aspect=o),N[t]=g,U.push(b)):null!=a&&(a.aspect="fixed",U.push(a),b=a),mxEvent.addListener(x,"keydown",function(e){13==e.keyCode&&null!=G&&(G(),G=null,mxEvent.consume(e))}),d(),p.appendChild(x),mxEvent.addListener(x,"mousedown",function(e){"true"!=x.getAttribute("contentEditable")&&mxEvent.consume(e)}),y=function(e){var t;mxClient.IS_IOS||mxClient.IS_FF||!(null==document.documentMode||9<document.documentMode)?(t=new FilenameDialog(L,b.title||"",mxResources.get("ok"),function(e){null!=e&&(b.title=e,d())},mxResources.get("enterValue")),L.showDialog(t.container,300,80,!0,!0),t.init(),mxEvent.consume(e)):"true"!=x.getAttribute("contentEditable")&&(null!=G&&(G(),G=null),null!=b.title&&0!=b.title.length||(x.innerHTML=""),x.style.textOverflow="",x.style.whiteSpace="",x.style.cursor="text",x.style.color="",x.setAttribute("contentEditable","true"),mxUtils.setPrefixedStyle(x.style,"user-select","text"),x.focus(),document.execCommand("selectAll",!1,null),G=function(){x.removeAttribute("contentEditable"),x.style.cursor="pointer",b.title=x.innerHTML,d()},mxEvent.consume(e))},mxEvent.addListener(x,"click",y),mxEvent.addListener(p,"dblclick",y),M.appendChild(p),mxEvent.addListener(p,"dragstart",function(e){null==t&&null!=a&&(h.style.visibility="hidden",x.style.visibility="hidden"),mxClient.IS_FF&&null!=a.xml&&e.dataTransfer.setData("Text",a.xml),O=P(e),mxClient.IS_GC&&(p.style.opacity="0.9"),window.setTimeout(function(){mxUtils.setPrefixedStyle(p.style,"transform","scale(0.5,0.5)"),mxUtils.setOpacity(p,30),h.style.visibility="",x.style.visibility=""},0)}),mxEvent.addListener(p,"dragend",function(e){"hidden"==h.style.visibility&&(h.style.visibility="",x.style.visibility=""),O=null,mxUtils.setOpacity(p,100),mxUtils.setPrefixedStyle(p.style,"transform",null)})):F||(F=!0,L.handleError({message:mxResources.get("fileExists")}))}else{var v=!1;try{var f=mxUtils.parseXml(t);if("mxlibrary"==f.documentElement.nodeName){if(null!=(C=JSON.parse(mxUtils.getTextContent(f.documentElement)))&&0<C.length)for(var E=0;E<C.length;E++)null!=C[E].xml?z(null,null,0,0,0,0,C[E]):z(C[E].data,null,0,0,C[E].w,C[E].h,null,"fixed",C[E].title);v=!0}else if("mxfile"==f.documentElement.nodeName){for(var w=f.documentElement.getElementsByTagName("diagram"),E=0;E<w.length;E++){var C=mxUtils.getTextContent(w[E]),A=L.stringToCells(Graph.decompress(C)),D=L.editor.graph.getBoundingBoxFromGeometry(A);z(null,null,0,0,0,0,{xml:C,w:D.width,h:D.height})}v=!0}}catch(e){}v||(L.spinner.stop(),L.handleError({message:mxResources.get("errorLoadingFile")}))}}catch(e){}var T,R,I}if(null!=l)for(var m=0;m<l.length;m++){var u=l[m];z(u.data,null,0,0,u.w,u.h,u,u.aspect,u.title)}function p(e){e.dataTransfer.dropEffect=null!=O?"move":"copy",e.stopPropagation(),e.preventDefault()}mxEvent.addListener(M,"dragleave",function(e){k.style.cursor="";for(var t=mxEvent.getSource(e);null!=t;){if(t==M||t==k){e.stopPropagation(),e.preventDefault();break}t=t.parentNode}});var g=function(d){return function(e,t,l,n,i,s,a,o,r){null!=r&&(/(\.v(dx|sdx?))($|\?)/i.test(r.name)||/(\.vs(x|sx?))($|\?)/i.test(r.name))?L.importVisio(r,mxUtils.bind(this,function(e){z(e,t,0,0,i,s,a,"fixed",mxEvent.isAltDown(d)?null:a.substring(0,a.lastIndexOf(".")).replace(/_/g," "))})):null!=r&&!L.isOffline()&&(new XMLHttpRequest).upload&&L.isRemoteFileFormat(e,r.name)?L.parseFile(r,mxUtils.bind(this,function(e){4==e.readyState&&(L.spinner.stop(),200<=e.status&&e.status<=299&&(z(e.responseText,t,0,0,i,s,a,"fixed",mxEvent.isAltDown(d)?null:a.substring(0,a.lastIndexOf(".")).replace(/_/g," ")),M.scrollTop=M.scrollHeight))})):(z(e,t,0,0,i,s,a,"fixed",mxEvent.isAltDown(d)?null:a.substring(0,a.lastIndexOf(".")).replace(/_/g," ")),M.scrollTop=M.scrollHeight)}};function h(e){var t;e.stopPropagation(),e.preventDefault(),F=!1,d=P(e),null!=O?null!=d&&d<M.children.length?(U.splice(O<d?d-1:d,0,U.splice(O,1)[0]),M.insertBefore(M.children[O],M.children[d])):(U.push(U.splice(O,1)[0]),M.appendChild(M.children[O])):0<e.dataTransfer.files.length?L.importFiles(e.dataTransfer.files,0,0,L.maxImageSize,g(e)):0<=mxUtils.indexOf(e.dataTransfer.types,"text/uri-list")&&(t=decodeURIComponent(e.dataTransfer.getData("text/uri-list")),(/(\.jpg)($|\?)/i.test(t)||/(\.png)($|\?)/i.test(t)||/(\.gif)($|\?)/i.test(t)||/(\.svg)($|\?)/i.test(t))&&L.loadImage(t,function(e){z(t,null,0,0,e.width,e.height),M.scrollTop=M.scrollHeight})),e.stopPropagation(),e.preventDefault()}mxEvent.addListener(M,"dragover",p),mxEvent.addListener(M,"drop",h),mxEvent.addListener(k,"dragover",p),mxEvent.addListener(k,"drop",h),s.appendChild(M);o=document.createElement("div");o.style.textAlign="right",o.style.marginTop="20px";var x,b,a=mxUtils.button(mxResources.get("cancel"),function(){L.hideDialog(!0)});a.setAttribute("id","btnCancel"),a.className="geBtn",L.editor.cancelFirst&&o.appendChild(a),"draw.io"!=L.getServiceName()||null==n||n.constructor!=DriveLibrary&&n.constructor!=GitHubLibrary||((b=mxUtils.button(mxResources.get("link"),function(){L.spinner.spin(document.body,mxResources.get("loading"))&&n.getPublicUrl(function(e){var t;L.spinner.stop(),null!=e?(t=L.getSearch(["create","title","mode","url","drive","splash","state","clibs","ui"]),t+=(0==t.length?"?":"&")+"splash=0&clibs=U"+encodeURIComponent(e),t=new EmbedDialog(L,window.location.protocol+"//"+window.location.host+"/"+t,null,null,null,null,"Check out the library I made using @drawio"),L.showDialog(t.container,450,240,!0),t.init()):n.constructor==DriveLibrary?L.showError(mxResources.get("error"),mxResources.get("diagramIsNotPublic"),mxResources.get("share"),mxUtils.bind(this,function(){L.drive.showPermissions(n.getId())}),null,mxResources.get("ok"),mxUtils.bind(this,function(){})):L.handleError({message:mxResources.get("diagramIsNotPublic")})})})).className="geBtn",o.appendChild(b)),(b=mxUtils.button(mxResources.get("export"),function(){var e=L.createLibraryDataFromImages(U),t=r.value;/(\.xml)$/i.test(t)||(t+=".xml"),L.isLocalFileSave()?L.saveLocalFile(e,t,"text/xml",null,null,!0,null,"xml"):new mxXmlRequest(SAVE_URL,"filename="+encodeURIComponent(t)+"&format=xml&xml="+encodeURIComponent(e)).simulate(document,"_blank")})).setAttribute("id","btnDownload"),b.className="geBtn",o.appendChild(b),Graph.fileSupport&&(null==L.libDlgFileInputElt&&((x=document.createElement("input")).setAttribute("multiple","multiple"),x.setAttribute("type","file"),mxEvent.addListener(x,"change",function(d){F=!1,L.importFiles(x.files,0,0,L.maxImageSize,function(e,t,l,n,i,s,a,o,r){null!=x.files&&(g(d)(e,t,l,n,i,s,a,o,r),x.type="",x.type="file",x.value="")}),M.scrollTop=M.scrollHeight}),x.style.display="none",document.body.appendChild(x),L.libDlgFileInputElt=x),(b=mxUtils.button(mxResources.get("import"),function(){null!=G&&(G(),G=null),L.libDlgFileInputElt.click()})).setAttribute("id","btnAddImage"),b.className="geBtn",o.appendChild(b)),(b=mxUtils.button(mxResources.get("addImages"),function(){null!=G&&(G(),G=null),L.showImageDialog(mxResources.get("addImageUrl"),"",function(e,t,l){var n;F=!1,null!=e&&("data:image/"!=e.substring(0,11)||0<(n=e.indexOf(","))&&(e=e.substring(0,n)+";base64,"+e.substring(n+1)),z(e,null,0,0,t,l),M.scrollTop=M.scrollHeight)})})).setAttribute("id","btnAddImageUrl"),b.className="geBtn",o.appendChild(b),this.saveBtnClickHandler=function(e,t,l,n){L.saveLibrary(e,t,l,n)},(b=mxUtils.button(mxResources.get("save"),mxUtils.bind(this,function(){null!=G&&(G(),G=null),this.saveBtnClickHandler(r.value,U,n,i)}))).setAttribute("id","btnSave"),b.className="geBtn gePrimaryBtn",o.appendChild(b),L.editor.cancelFirst||o.appendChild(a),s.appendChild(o),this.container=s},EditShapeDialog=function(a,e,t,l,n){l=null!=l?l:300,n=null!=n?n:120;var i=document.createElement("table"),s=document.createElement("tbody");i.style.cellPadding="4px",o=document.createElement("tr"),(r=document.createElement("td")).setAttribute("colspan","2"),r.style.fontSize="10pt",mxUtils.write(r,t),o.appendChild(r),s.appendChild(o);var o=document.createElement("tr"),r=document.createElement("td"),d=document.createElement("textarea");d.style.outline="none",d.style.resize="none",d.style.width=l-200+"px",d.style.height=n+"px",this.textarea=d,this.init=function(){d.focus(),d.scrollTop=0},r.appendChild(d),o.appendChild(r),r=document.createElement("td");l=document.createElement("div");l.style.position="relative",l.style.border="1px solid gray",l.style.top="6px",l.style.width="200px",l.style.height=n+4+"px",l.style.overflow="hidden",l.style.marginBottom="16px",mxEvent.disableContextMenu(l),r.appendChild(l);var c=new Graph(l);c.setEnabled(!1);var m=a.editor.graph.cloneCell(e);c.addCells([m]);var l=c.view.getState(m),u="";null!=l.shape&&null!=l.shape.stencil&&(u=mxUtils.getPrettyXml(l.shape.stencil.desc)),mxUtils.write(d,u||"");l=c.getGraphBounds(),n=Math.min(160/l.width,(n-40)/l.height);c.view.scaleAndTranslate(n,20/n-l.x,20/n-l.y),o.appendChild(r),s.appendChild(o),o=document.createElement("tr"),(r=document.createElement("td")).setAttribute("colspan","2"),r.style.paddingTop="2px",r.style.whiteSpace="nowrap",r.setAttribute("align","right"),"1"!=urlParams.customMenu&&(a.isOffline()||((p=mxUtils.button(mxResources.get("help"),function(){a.openLink("https://www.diagrams.net/doc/faq/shape-complex-create-edit")})).className="geBtn",r.appendChild(p)));var p=mxUtils.button(mxResources.get("cancel"),function(){a.hideDialog()});p.className="geBtn",a.editor.cancelFirst&&r.appendChild(p);function g(e,t,l){var n=d.value,i=mxUtils.parseXml(n),n=mxUtils.getPrettyXml(i.documentElement);if(null!=(i=i.documentElement.getElementsByTagName("parsererror"))&&0<i.length)a.showError(mxResources.get("error"),mxResources.get("containsValidationErrors"),mxResources.get("ok"));else{l&&a.hideDialog();var s,i=!e.model.contains(t);if(!l||i||n!=u){n=Graph.compress(n),e.getModel().beginUpdate();try{i&&(s=a.editor.graph.getFreeInsertPoint(),t.geometry.x=s.x,t.geometry.y=s.y,e.addCell(t)),e.setCellStyles(mxConstants.STYLE_SHAPE,"stencil("+n+")",[t])}catch(e){throw e}finally{e.getModel().endUpdate()}i&&(e.setSelectionCell(t),e.scrollCellToVisible(t))}}}"1"!=urlParams.customMenu&&((h=mxUtils.button(mxResources.get("preview"),function(){g(c,m,!1)})).className="geBtn",r.appendChild(h));var h=mxUtils.button(mxResources.get("apply"),function(){g(a.editor.graph,e,!0)});h.className="geBtn gePrimaryBtn",r.appendChild(h),a.editor.cancelFirst||r.appendChild(p),o.appendChild(r),s.appendChild(o),i.appendChild(s),this.container=i},CustomDialog=function(t,e,l,n,i,s,a,o,r,d){var c=document.createElement("div");c.appendChild(e);e=document.createElement("div");e.style.marginTop="30px",e.style.textAlign="center",null!=a&&e.appendChild(a),"1"!=urlParams.customMenu&&(t.isOffline()||null==s||((a=mxUtils.button(mxResources.get("help"),function(){t.openLink(s)})).className="geBtn",e.appendChild(a)));r=mxUtils.button(r||mxResources.get("cancel"),function(){t.hideDialog(),null!=n&&n()});r.className="geBtn",o&&(r.style.display="none"),t.editor.cancelFirst&&e.appendChild(r);i=mxUtils.button(i||mxResources.get("ok"),mxUtils.bind(this,function(){if(d||t.hideDialog(null,null,this.container),null!=l){var e=l();if("string"==typeof e)return void t.showError(mxResources.get("error"),e)}d&&t.hideDialog(null,null,this.container)}));e.appendChild(i),i.className="geBtn gePrimaryBtn",t.editor.cancelFirst||e.appendChild(r),c.appendChild(e),this.cancelBtn=r,this.okButton=i,this.container=c},TemplatesDialog=function(A,o,e,h,t,l,n,i,m,r,s,d,a,c,u){var p='<div class="geTempDlgHeader"><img src="/images/draw.io-logo.svg" class="geTempDlgHeaderLogo"><input type="search" class="geTempDlgSearchBox" '+(i?"":'style="display: none"')+' placeholder="'+mxResources.get("search")+'"></div><div class="geTemplatesList" style="display: none"><div class="geTempDlgBack">&lt; '+mxResources.get("back")+'</div><div class="geTempDlgHLine"></div><div class="geTemplatesLbl">'+mxResources.get("templates")+'</div></div><div class="geTempDlgContent" style="width: 100%"><div class="geTempDlgNewDiagramCat"><div class="geTempDlgNewDiagramCatLbl">'+mxResources.get("newDiagram")+'</div><div class="geTempDlgNewDiagramCatList"></div><div class="geTempDlgNewDiagramCatFooter"><div class="geTempDlgShowAllBtn">'+mxResources.get("showMore")+'</div></div></div><div class="geTempDlgDiagramsList"><div class="geTempDlgDiagramsListHeader"><div class="geTempDlgDiagramsListTitle"></div><div class="geTempDlgDiagramsListBtns"><div class="geTempDlgRadioBtn geTempDlgRadioBtnLarge" data-id="myDiagramsBtn"><img src="/images/my-diagrams.svg" class="geTempDlgMyDiagramsBtnImg"> <span>'+mxResources.get("myDiagrams")+'</span></div><div class="geTempDlgRadioBtn geTempDlgRadioBtnLarge geTempDlgRadioBtnActive" data-id="allDiagramsBtn"><img src="/images/all-diagrams-sel.svg" class="geTempDlgAllDiagramsBtnImg"> <span>'+mxResources.get("allDiagrams")+'</span></div><div class="geTempDlgSpacer"> </div><div class="geTempDlgRadioBtn geTempDlgRadioBtnSmall geTempDlgRadioBtnActive" data-id="tilesBtn"><img src="/images/tiles-sel.svg" class="geTempDlgTilesBtnImg"></div><div class="geTempDlgRadioBtn geTempDlgRadioBtnSmall" data-id="listBtn"><img src="/images/list.svg" class="geTempDlgListBtnImg"></div></div></div><div class="geTempDlgDiagramsTiles"></div></div></div><br style="clear:both;"/><div class="geTempDlgFooter"><div class="geTempDlgErrMsg"></div>'+(a?'<span class="geTempDlgLinkToDiagram geTempDlgLinkToDiagramHint">'+mxResources.get("linkToDiagramHint")+'</span><button class="geTempDlgLinkToDiagram geTempDlgLinkToDiagramBtn">'+mxResources.get("linkToDiagram")+"</button>":"")+(d?'<div class="geTempDlgOpenBtn">'+mxResources.get("open")+"</div>":"")+'<div class="geTempDlgCreateBtn">'+mxResources.get("create")+'</div><div class="geTempDlgCancelBtn">'+mxResources.get("cancel")+"</div></div>",y=document.createElement("div");y.innerHTML=p,y.className="geTemplateDlg",this.container=y,h=null!=h?h:TEMPLATE_PATH+"/index.xml",t=null!=t?t:NEW_DIAGRAM_CATS_PATH+"/index.xml";var g,x,v=!1,f=!1,E=null,b=null,D=null,w=null,C=!1,T=!0,R=!1,I=[],L=null,U=!1,M=y.querySelector(".geTempDlgShowAllBtn"),k=y.querySelector(".geTempDlgDiagramsTiles"),N=y.querySelector(".geTempDlgDiagramsListTitle"),S=y.querySelector(".geTempDlgDiagramsListBtns"),B=y.querySelector(".geTempDlgContent"),O=y.querySelector(".geTempDlgDiagramsList"),P=y.querySelector(".geTempDlgNewDiagramCat"),G=y.querySelector(".geTempDlgNewDiagramCatList"),H=y.querySelector(".geTempDlgCreateBtn"),F=y.querySelector(".geTempDlgOpenBtn"),z=y.querySelector(".geTempDlgSearchBox"),_=y.querySelector(".geTempDlgErrMsg"),j=new Spinner({lines:12,length:10,width:5,radius:10,rotate:0,color:"#000",speed:1.5,trail:60,shadow:!1,hwaccel:!1,top:"50px",zIndex:2e9});function W(e){_.innerHTML=mxUtils.htmlEntities(e),_.style.display="block",setTimeout(function(){_.style.display="none"},4e3)}function Z(){null!=E&&(E.style.fontWeight="normal",E.style.textDecoration="none",b=E,E=null)}function V(e,t,l,n,i,s,a){return!(-1<e.className.indexOf("geTempDlgRadioBtnActive"))&&(e.className+=" geTempDlgRadioBtnActive",y.querySelector(".geTempDlgRadioBtn[data-id="+n+"]").className="geTempDlgRadioBtn "+(a?"geTempDlgRadioBtnLarge":"geTempDlgRadioBtnSmall"),y.querySelector("."+t).src="/images/"+l+"-sel.svg",y.querySelector("."+i).src="/images/"+s+".svg",1)}mxEvent.addListener(y.querySelector(".geTempDlgBack"),"click",function(){Z(),U=!1,y.querySelector(".geTemplatesList").style.display="none",B.style.width="100%",P.style.display="",O.style.minHeight="calc(100% - 280px)",z.style.display=i?"":"none",z.value="",g=null,ce(T)}),mxEvent.addListener(y.querySelector(".geTempDlgRadioBtn[data-id=allDiagramsBtn]"),"click",function(){V(this,"geTempDlgAllDiagramsBtnImg","all-diagrams","myDiagramsBtn","geTempDlgMyDiagramsBtnImg","my-diagrams",!0)&&(T=!0,null==g?ce(T):pe(g))}),mxEvent.addListener(y.querySelector(".geTempDlgRadioBtn[data-id=myDiagramsBtn]"),"click",function(){V(this,"geTempDlgMyDiagramsBtnImg","my-diagrams","allDiagramsBtn","geTempDlgAllDiagramsBtnImg","all-diagrams",!0)&&(T=!1,null==g?ce(T):pe(g))}),mxEvent.addListener(y.querySelector(".geTempDlgRadioBtn[data-id=listBtn]"),"click",function(){V(this,"geTempDlgListBtnImg","list","tilesBtn","geTempDlgTilesBtnImg","tiles",!1)&&K(I,!(R=!0),R,L)}),mxEvent.addListener(y.querySelector(".geTempDlgRadioBtn[data-id=tilesBtn]"),"click",function(){V(this,"geTempDlgTilesBtnImg","tiles","listBtn","geTempDlgListBtnImg","list",!1)&&K(I,R=!1,R,L)});var X=!1;function Y(o,r,d,c){var l=null;function e(e){var t,l,n,i,s,a;X&&A.sidebar.currentElt==r&&(t=e,l=mxEvent.getClientX(c),n=mxEvent.getClientY(c),null!=t&&mxUtils.isAncestorNode(document.body,r)&&(i=mxUtils.parseXml(t),null!=(e=Editor.extractGraphModel(i.documentElement,!0))&&("mxfile"==e.nodeName&&(e=Editor.parseDiagramNode(e.getElementsByTagName("diagram")[0])),t=new mxCodec(e.ownerDocument),i=new mxGraphModel,t.decode(e,i),t=i.root.getChildAt(0).children||[],e=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,i=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,A.sidebar.createTooltip(r,t,Math.min(e-80,1e3),Math.min(i-80,800),null!=o.title?mxResources.get(o.title,null,o.title):null,!0,new mxPoint(l,n),!0,null,!0),(s=document.createElement("div")).className="geTempDlgDialogMask",y.appendChild(s),a=A.sidebar.hideTooltip,A.sidebar.hideTooltip=function(){s&&(y.removeChild(s),s=null,a.apply(this,arguments),A.sidebar.hideTooltip=a)},mxEvent.addListener(s,"click",function(){A.sidebar.hideTooltip()})))),X=!1,d.src="/images/icon-search.svg"}X||A.sidebar.currentElt==r?A.sidebar.hideTooltip():(A.sidebar.hideTooltip(),A.sidebar.currentElt=r,X=!0,d.src="/images/aui-wait.gif",o.isExt?m(o,e,function(){W(mxResources.get("cantLoadPrev")),X=!1,d.src="/images/icon-search.svg"}):function(e,t){null==l?(e=/^https?:\/\//.test(e=e)&&!A.editor.isCorsEnabledForUrl(e)?PROXY_URL+"?url="+encodeURIComponent(e):TEMPLATE_PATH+"/"+e,mxUtils.get(e,mxUtils.bind(this,function(e){200<=e.getStatus()&&e.getStatus()<=299&&(l=e.getText()),t(l)}))):t(l)}(o.url,e))}function Q(e,t,l){if(null!=D){for(var n=D.className.split(" "),i=0;i<n.length;i++)if(-1<n[i].indexOf("Active")){n.splice(i,1);break}D.className=n.join(" ")}null!=e?((D=e).className+=" "+t,(w=l).isCategory,H.className="geTempDlgCreateBtn"):(w=D=null,H.className="geTempDlgCreateBtn geTempDlgBtnDisabled")}function J(e,l){function t(){w=a,H.className="geTempDlgCreateBtn",l&&(F.className="geTempDlgOpenBtn")}function n(){W(mxResources.get("cannotLoad")),t()}function i(e,t){u||A.hideDialog(!0),o(e,t,a,l)}function s(t){a.isExternal?m(a,function(e){i(e,t)},n):a.url?mxUtils.get(TEMPLATE_PATH+"/"+a.url,mxUtils.bind(this,function(e){200<=e.getStatus()&&e.getStatus()<=299?i(e.getText(),t):n()})):i(A.emptyDiagramXml,t)}var a;null!=w&&(a=w,w=null,"boolean"!=typeof l&&(l=a.isExternal&&d),1==e?r(a.url,a):l?(F.className="geTempDlgOpenBtn geTempDlgBtnDisabled geTempDlgBtnBusy",s()):(H.className="geTempDlgCreateBtn geTempDlgBtnDisabled geTempDlgBtnBusy",e=null==A.mode||A.mode==App.MODE_GOOGLE||A.mode==App.MODE_BROWSER?mxResources.get("diagramName"):mxResources.get("filename"),e=new FilenameDialog(A,A.defaultFilename+".drawio",mxResources.get("ok"),s,e,function(e){var t=null!=e&&0<e.length;return t&&u?(s(e),!1):t},null,null,null,t,c?null:[]),A.showDialog(e.container,350,80,!0,!0),e.init()))}function q(e){H.innerHTML=mxUtils.htmlEntities(mxResources.get(U||e?"create":"copy"));var t=e?"none":"";d&&(F.style.display=t);for(var l=y.querySelectorAll(".geTempDlgLinkToDiagram"),n=0;n<l.length;n++)l[n].style.display=t}function K(e,t,l,n,i){function s(){q(t)}i||(k.innerHTML="",Q(),I=e,L=n);var a,o,r=null;l&&((r=document.createElement("table")).className="geTempDlgDiagramsListGrid",a=document.createElement("tr"),(o=document.createElement("th")).style.width="50%",o.innerHTML=mxUtils.htmlEntities(mxResources.get("diagram")),a.appendChild(o),(o=document.createElement("th")).style.width="25%",o.innerHTML=mxUtils.htmlEntities(mxResources.get("changedBy")),a.appendChild(o),(o=document.createElement("th")).style.width="25%",o.innerHTML=mxUtils.htmlEntities(mxResources.get("lastModifiedOn")),a.appendChild(o),r.appendChild(a),k.appendChild(r));for(var d,c=0;c<e.length;c++){e[c].isExternal=!t;var m=e[c].url,u=mxUtils.htmlEntities(t?mxResources.get(e[c].title,null,e[c].title):e[c].title),p=u||e[c].url,g=e[c].imgUrl,h=mxUtils.htmlEntities(e[c].changedBy||""),x="";e[c].lastModifiedOn&&(null==(E=A.timeSince(new Date(e[c].lastModifiedOn)))&&(E=mxResources.get("lessThanAMinute")),x=mxUtils.htmlEntities(mxResources.get("timeAgo",[E],"{1} ago")));var b,y,v,f,g=g||TEMPLATE_PATH+"/"+m.substring(0,m.length-4)+".png",E=l?50:15;null!=u&&u.length>E&&(u=u.substring(0,E)+"&hellip;"),l?(b=document.createElement("tr"),m=document.createElement("td"),(f=document.createElement("img")).src="/images/icon-search.svg",f.className="geTempDlgDiagramListPreviewBtn",f.setAttribute("title",mxResources.get("preview")),i||m.appendChild(f),(E=document.createElement("span")).className="geTempDlgDiagramTitle",E.innerHTML=u,m.appendChild(E),b.appendChild(m),(m=document.createElement("td")).innerHTML=h,b.appendChild(m),(m=document.createElement("td")).innerHTML=x,b.appendChild(m),r.appendChild(b),null==D&&(s(),Q(b,"geTempDlgDiagramsListGridActive",e[c])),function(t,l,n){mxEvent.addListener(b,"click",function(){D!=l&&(s(),Q(l,"geTempDlgDiagramsListGridActive",t))}),mxEvent.addListener(b,"dblclick",J),mxEvent.addListener(f,"click",function(e){Y(t,l,n,e)})}(e[c],b,f)):((y=document.createElement("div")).className="geTempDlgDiagramTile",y.setAttribute("title",p),null==D&&(s(),Q(y,"geTempDlgDiagramTileActive",e[c])),(p=document.createElement("div")).className="geTempDlgDiagramTileImg geTempDlgDiagramTileImgLoading",(v=document.createElement("img")).style.display="none",function(e,t,l){v.onload=function(){t.className="geTempDlgDiagramTileImg",e.style.display=""},v.onerror=function(){this.src!=l?this.src=l:t.className="geTempDlgDiagramTileImg geTempDlgDiagramTileImgError"}}(v,p,g?g.replace(".drawio.xml","").replace(".drawio","").replace(".xml",""):""),v.src=g,p.appendChild(v),y.appendChild(p),(p=document.createElement("div")).className="geTempDlgDiagramTileLbl",p.innerHTML=null!=u?u:"",y.appendChild(p),(f=document.createElement("img")).src="/images/icon-search.svg",f.className="geTempDlgDiagramPreviewBtn",f.setAttribute("title",mxResources.get("preview")),i||y.appendChild(f),function(t,l,n){mxEvent.addListener(y,"click",function(){D!=l&&(s(),Q(l,"geTempDlgDiagramTileActive",t))}),mxEvent.addListener(y,"dblclick",J),mxEvent.addListener(f,"click",function(e){Y(t,l,n,e)})}(e[c],y,f),k.appendChild(y))}for(d in n){var w,C=n[d];0<C.length&&((w=document.createElement("div")).className="geTempDlgImportCat",w.innerHTML=mxResources.get(d,null,d),k.appendChild(w),K(C,t,l,null,!0))}}function $(e,t){G.innerHTML="",Q();for(var l=Math.floor(G.offsetWidth/150)-1,n=!t&&e.length>l?l:e.length,i=0;i<n;i++){var s=e[i];s.isCategory=!0;var a=document.createElement("div");null==(c=mxResources.get(s.title))&&(c=s.title.substring(0,1).toUpperCase()+s.title.substring(1)),a.className="geTempDlgNewDiagramCatItem",a.setAttribute("title",c),15<(c=mxUtils.htmlEntities(c)).length&&(c=c.substring(0,15)+"&hellip;"),null==D&&(q(!0),Q(a,"geTempDlgNewDiagramCatItemActive",s)),(r=document.createElement("div")).className="geTempDlgNewDiagramCatItemImg";var o=document.createElement("img");o.src=NEW_DIAGRAM_CATS_PATH+"/"+s.img,r.appendChild(o),a.appendChild(r),(d=document.createElement("div")).className="geTempDlgNewDiagramCatItemLbl",d.innerHTML=c,a.appendChild(d),G.appendChild(a),function(e,t){mxEvent.addListener(a,"click",function(){D!=t&&(q(!0),Q(t,"geTempDlgNewDiagramCatItemActive",e))}),mxEvent.addListener(a,"dblclick",J)}(s,a)}(a=document.createElement("div")).className="geTempDlgNewDiagramCatItem";var r,d,c=mxResources.get("showAllTemps");a.setAttribute("title",c),(r=document.createElement("div")).className="geTempDlgNewDiagramCatItemImg",r.innerHTML="...",r.style.fontSize="32px",a.appendChild(r),(d=document.createElement("div")).className="geTempDlgNewDiagramCatItemLbl",d.innerHTML=c,a.appendChild(d),G.appendChild(a),mxEvent.addListener(a,"click",function(){U=!0;var l=y.querySelector(".geTemplatesList");l.style.display="block",B.style.width="",z.style.display="",z.value="",g=null,function e(){var t=l.querySelector(".geTemplateDrawioCatLink");null!=t?t.click():setTimeout(e,200)}()}),M.style.display=e.length<=l?"none":""}function ee(s,a,e){var t=y.querySelector(".geTemplatesList");function l(e,t){var l=mxResources.get(e),n=(l=null==l?e.substring(0,1).toUpperCase()+e.substring(1):l)+" ("+t.length+")",e=l=mxUtils.htmlEntities(l);return{lbl:(l=15<l.length?l.substring(0,15)+"&hellip;":l)+" ("+t.length+")",fullLbl:n,lblOnly:e}}function n(e,t,l,n,i){mxEvent.addListener(l,"click",function(){E!=l&&(null!=E?(E.style.fontWeight="normal",E.style.textDecoration="none"):(P.style.display="none",O.style.minHeight="100%"),(E=l).style.fontWeight="bold",E.style.textDecoration="underline",B.scrollTop=0,v&&(f=!0),N.innerHTML=t,S.style.display="none",K(i?a[e]:n?ie[e][n]:s[e],!i))})}if(0<e){var i,o="font-weight: bold;background: #f9f9f9;padding: 5px 0 5px 0;text-align: center;margin-top: 10px;",e=document.createElement("div");for(i in e.style.cssText=o,mxUtils.write(e,mxResources.get("custom")),t.appendChild(e),a){var r=document.createElement("div"),d=l(i,a[i]);r.className="geTemplateCatLink",r.setAttribute("title",d.fullLbl),r.innerHTML=d.lbl,t.appendChild(r),n(i,d.lblOnly,r,null,!0)}(e=document.createElement("div")).style.cssText=o,mxUtils.write(e,"draw.io"),t.appendChild(e)}for(i in s){var c=ie[i],m=r=document.createElement(c?"ul":"div"),d=l(i,s[i]);if(null!=c){var u=document.createElement("li"),p=document.createElement("div");p.className="geTempTreeCaret geTemplateCatLink geTemplateDrawioCatLink",p.style.padding="0",p.setAttribute("title",d.fullLbl),p.innerHTML=d.lbl,u.appendChild(m=p);var g,h=document.createElement("ul");for(g in h.className="geTempTreeNested",h.style.visibility="hidden",c){var x=document.createElement("li"),b=l(g,c[g]);x.setAttribute("title",b.fullLbl),x.innerHTML=b.lbl,x.className="geTemplateCatLink",x.style.padding="0",x.style.margin="0",n(i,b.lblOnly,x,g),h.appendChild(x)}u.appendChild(h),r.className="geTempTree",r.appendChild(u),function(l,n){mxEvent.addListener(n,"click",function(){for(var t=l.querySelectorAll("li"),e=0;e<t.length;e++)t[e].style.margin="";l.style.visibility="visible",l.classList.toggle("geTempTreeActive"),l.classList.toggle("geTempTreeNested")&&setTimeout(function(){for(var e=0;e<t.length;e++)t[e].style.margin="0";l.style.visibility="hidden"},250),n.classList.toggle("geTempTreeCaret-down")})}(h,p)}else r.className="geTemplateCatLink geTemplateDrawioCatLink",r.setAttribute("title",d.fullLbl),r.innerHTML=d.lbl;t.appendChild(r),n(i,d.lblOnly,m)}}mxEvent.addListener(M,"click",function(){C?(P.style.height="280px",G.style.height="190px",M.innerHTML=mxUtils.htmlEntities(mxResources.get("showMore")),$(ae)):(P.style.height="440px",G.style.height="355px",M.innerHTML=mxUtils.htmlEntities(mxResources.get("showLess")),$(ae,!0)),C=!C});var te=!1,le=!1,ne={},ie={},se={},ae=[],oe=0;function re(){mxUtils.get(h,function(e){if(!te){te=!0;for(var t=e.getXml().documentElement.firstChild,l={};null!=t;){if(void 0!==t.getAttribute)if("clibs"==t.nodeName){for(var n=t.getAttribute("name"),i=t.getElementsByTagName("add"),s=[],a=0;a<i.length;a++)s.push(encodeURIComponent(mxUtils.getTextContent(i[a])));null!=n&&0<s.length&&(l[n]=s.join(";"))}else{var o,r,d,c=t.getAttribute("url");null!=c&&(d=t.getAttribute("section"),n=t.getAttribute("subsection"),null==d&&(r=c.indexOf("/"),d=c.substring(0,r),null!=n||-1<(o=c.indexOf("/",r+1))&&(n=c.substring(r+1,o))),null==(r=ne[d])&&(ne[d]=r=[]),null!=l[o=t.getAttribute("clibs")]&&(o=l[o]),o={url:t.getAttribute("url"),libs:t.getAttribute("libs"),title:t.getAttribute("title")||t.getAttribute("name"),preview:t.getAttribute("preview"),clibs:o,tags:t.getAttribute("tags")},r.push(o),null!=n&&(null==(r=ie[d])&&(ie[d]=r={}),null==(d=r[n])&&(r[n]=d=[]),d.push(o)))}t=t.nextSibling}ee(ne,se,oe)}})}null!=s?s(function(e,t){se=e,oe=t,re()},re):re(),mxUtils.get(t,function(e){if(!le){le=!0;for(var t=e.getXml().documentElement.firstChild;null!=t;)void 0!==t.getAttribute&&null!=t.getAttribute("title")&&ae.push({img:t.getAttribute("img"),libs:t.getAttribute("libs"),clibs:t.getAttribute("clibs"),title:t.getAttribute("title")}),t=t.nextSibling;$(ae)}});var de=function(e,t,l){if(S.style.display="",j.stop(),v=!1,f)f=!1;else if(t)k.innerHTML=t;else{var n,i=0;for(n in l=l||{})i+=l[n].length;0==e.length&&0==i?k.innerHTML=mxUtils.htmlEntities(mxResources.get("noDiagrams")):K(e,!1,R,0==i?null:l)}};function ce(e){n&&(B.scrollTop=0,k.innerHTML="",j.spin(k),v=!(f=!1),N.innerHTML=mxUtils.htmlEntities(mxResources.get("recentDiag")),g=null,n(de,function(){W(mxResources.get("cannotLoad")),de([])},e?null:l))}ce(T);var me=null;function ue(e){if(""!=e){if(null==TemplatesDialog.tagsList[h]){var t={};for(o in ne)for(var l=ne[o],n=0;n<l.length;n++)if(null!=(g=l[n]).tags)for(var i=g.tags.toLowerCase().split(";"),s=0;s<i.length;s++)null==t[i[s]]&&(t[i[s]]=[]),t[i[s]].push(g);TemplatesDialog.tagsList[h]=t}var a=e.toLowerCase().split(" "),t=TemplatesDialog.tagsList[h];if(0<oe&&null==t.__tagsList__){for(var o in se)for(l=se[o],n=0;n<l.length;n++){(i=(g=l[n]).title.split(" ")).push(o);for(s=0;s<i.length;s++){var r=i[s].toLowerCase();null==t[r]&&(t[r]=[]),t[r].push(g)}}t.__tagsList__=!0}for(var d=[],c={},m=0,n=0;n<a.length;n++)if(0<a[n].length){var u=t[a[n]],p={},d=[];if(null!=u)for(var g,s=0;s<u.length;s++)0==m==(null==c[(g=u[s]).url])&&(p[g.url]=!0,d.push(g));c=p,m++}0==d.length?N.innerHTML=mxResources.get("noResultsFor",[e]):K(d,!0)}else null!=b&&(b.click(),b=null)}function pe(e){g==e&&T==x||(Z(),B.scrollTop=0,k.innerHTML="",N.innerHTML=mxUtils.htmlEntities(mxResources.get("searchResults"))+' "'+mxUtils.htmlEntities(e)+'"',me=null,U?ue(e):i&&(e?(j.spin(k),v=!(f=!1),i(e,de,function(){W(mxResources.get("searchFailed")),de([])},T?null:l)):ce(T)),g=e,x=T)}function ge(e){null!=me&&clearTimeout(me),13==e.keyCode?pe(z.value):me=setTimeout(function(){pe(z.value)},1e3)}mxEvent.addListener(z,"keyup",ge),mxEvent.addListener(z,"search",ge),mxEvent.addListener(z,"input",ge),mxEvent.addListener(H,"click",function(e){J(!1,!1)}),d&&mxEvent.addListener(F,"click",function(e){J(!1,!0)}),a&&mxEvent.addListener(y.querySelector(".geTempDlgLinkToDiagramBtn"),"click",function(e){J(!0)}),mxEvent.addListener(y.querySelector(".geTempDlgCancelBtn"),"click",function(){null!=e&&e(),u||A.hideDialog(!0)})};TemplatesDialog.tagsList={};var BtnDialog=function(e,t,l,n){var i=document.createElement("div");i.style.textAlign="center";var s=document.createElement("p");s.style.fontSize="16pt",s.style.padding="0px",s.style.margin="0px",s.style.color="gray",mxUtils.write(s,mxResources.get("done"));var a="Unknown",o=document.createElement("img");o.setAttribute("border","0"),o.setAttribute("align","absmiddle"),o.style.marginRight="10px",t==e.drive?(a=mxResources.get("googleDrive"),o.src=IMAGE_PATH+"/google-drive-logo-white.svg"):t==e.dropbox?(a=mxResources.get("dropbox"),o.src=IMAGE_PATH+"/dropbox-logo-white.svg"):t==e.oneDrive?(a=mxResources.get("oneDrive"),o.src=IMAGE_PATH+"/onedrive-logo-white.svg"):t==e.gitHub?(a=mxResources.get("github"),o.src=IMAGE_PATH+"/github-logo-white.svg"):t==e.gitLab?(a=mxResources.get("gitlab"),o.src=IMAGE_PATH+"/gitlab-logo.svg"):t==e.notion?(a=mxResources.get("notion"),o.src=IMAGE_PATH+"/notion-logo.svg"):t==e.trello&&(a=mxResources.get("trello"),o.src=IMAGE_PATH+"/trello-logo-white.svg");e=document.createElement("p");mxUtils.write(e,mxResources.get("authorizedIn",[a],"You are now authorized in {1}"));n=mxUtils.button(l,n);n.insertBefore(o,n.firstChild),n.style.marginTop="6px",n.className="geBigButton",n.style.fontSize="18px",n.style.padding="14px",i.appendChild(s),i.appendChild(e),i.appendChild(n),this.container=i},FontDialog=function(n,e,t,l,i){var s,a,o,r=document.createElement("table"),d=document.createElement("tbody");r.style.marginTop="8px",s=document.createElement("tr"),(a=document.createElement("td")).colSpan=2,a.style.whiteSpace="nowrap",a.style.fontSize="10pt",a.style.fontWeight="bold";var c=document.createElement("input");c.style.cssText="margin-right:8px;margin-bottom:8px;",c.setAttribute("value","sysfonts"),c.setAttribute("type","radio"),c.setAttribute("name","current-fontdialog"),c.setAttribute("id","fontdialog-sysfonts"),a.appendChild(c),(o=document.createElement("label")).setAttribute("for","fontdialog-sysfonts"),mxUtils.write(o,mxResources.get("sysFonts",null,"System Fonts")),a.appendChild(o),s.appendChild(a),d.appendChild(s),s=document.createElement("tr"),(a=document.createElement("td")).style.whiteSpace="nowrap",a.style.fontSize="10pt",a.style.width="120px",a.style.paddingLeft="15px",mxUtils.write(a,mxResources.get("fontname",null,"Font Name")+":"),s.appendChild(a);var m=document.createElement("input");"s"==l&&m.setAttribute("value",e),m.style.marginLeft="4px",m.style.width="250px",m.className="dlg_fontName_s",(a=document.createElement("td")).appendChild(m),s.appendChild(a),d.appendChild(s),s=document.createElement("tr"),(a=document.createElement("td")).colSpan=2,a.style.whiteSpace="nowrap",a.style.fontSize="10pt",a.style.fontWeight="bold";var u,p=document.createElement("input");p.style.cssText="margin-right:8px;margin-bottom:8px;",p.setAttribute("value","googlefonts"),p.setAttribute("type","radio"),p.setAttribute("name","current-fontdialog"),p.setAttribute("id","fontdialog-googlefonts"),a.appendChild(p),(o=document.createElement("label")).setAttribute("for","fontdialog-googlefonts"),mxUtils.write(o,mxResources.get("googleFonts",null,"Google Fonts")),a.appendChild(o),mxClient.IS_CHROMEAPP||n.isOffline()&&!EditorUi.isElectronApp||"1"!=urlParams.customMenu&&((u=n.menus.createHelpLink("https://fonts.google.com/")).getElementsByTagName("img")[0].setAttribute("valign","middle"),a.appendChild(u)),s.appendChild(a),d.appendChild(s),s=document.createElement("tr"),(a=document.createElement("td")).style.whiteSpace="nowrap",a.style.fontSize="10pt",a.style.width="120px",a.style.paddingLeft="15px",mxUtils.write(a,mxResources.get("fontname",null,"Font Name")+":"),s.appendChild(a);var g=document.createElement("input");"g"==l&&g.setAttribute("value",e),g.style.marginLeft="4px",g.style.width="250px",g.className="dlg_fontName_g",(a=document.createElement("td")).appendChild(g),s.appendChild(a),d.appendChild(s),s=document.createElement("tr"),(a=document.createElement("td")).colSpan=2,a.style.whiteSpace="nowrap",a.style.fontSize="10pt",a.style.fontWeight="bold";var h=document.createElement("input");h.style.cssText="margin-right:8px;margin-bottom:8px;",h.setAttribute("value","webfonts"),h.setAttribute("type","radio"),h.setAttribute("name","current-fontdialog"),h.setAttribute("id","fontdialog-webfonts"),a.appendChild(h),(o=document.createElement("label")).setAttribute("for","fontdialog-webfonts"),mxUtils.write(o,mxResources.get("webfonts",null,"Web Fonts")),a.appendChild(o),s.appendChild(a),Editor.enableWebFonts&&d.appendChild(s),s=document.createElement("tr"),(a=document.createElement("td")).style.whiteSpace="nowrap",a.style.fontSize="10pt",a.style.width="120px",a.style.paddingLeft="15px",mxUtils.write(a,mxResources.get("fontname",null,"Font Name")+":"),s.appendChild(a);var x=document.createElement("input");"w"==l&&(Editor.enableWebFonts?x:m).setAttribute("value",e),x.style.marginLeft="4px",x.style.width="250px",x.className="dlg_fontName_w",(a=document.createElement("td")).appendChild(x),s.appendChild(a),Editor.enableWebFonts&&d.appendChild(s),s=document.createElement("tr"),(a=document.createElement("td")).style.whiteSpace="nowrap",a.style.fontSize="10pt",a.style.width="120px",a.style.paddingLeft="15px",mxUtils.write(a,mxResources.get("fontUrl",null,"Font URL")+":"),s.appendChild(a);var b=document.createElement("input");b.setAttribute("value",t||""),b.style.marginLeft="4px",b.style.width="250px",b.className="dlg_fontUrl",(a=document.createElement("td")).appendChild(b),s.appendChild(a),Editor.enableWebFonts&&d.appendChild(s),this.init=function(){var e=m;"g"==l?e=g:"w"==l&&Editor.enableWebFonts&&(e=x),e.focus(),mxClient.IS_GC||mxClient.IS_FF||5<=document.documentMode?e.select():document.execCommand("selectAll",!1,null)},s=document.createElement("tr"),(a=document.createElement("td")).colSpan=2,a.style.paddingTop="20px",a.style.whiteSpace="nowrap",a.setAttribute("align","right"),"1"!=urlParams.customMenu&&(n.isOffline()||((y=mxUtils.button(mxResources.get("help"),function(){n.openLink("https://www.diagrams.net/blog/external-fonts")})).className="geBtn",a.appendChild(y)));var y=mxUtils.button(mxResources.get("cancel"),function(){n.hideDialog(),i()});y.className="geBtn",n.editor.cancelFirst&&a.appendChild(y);var v=mxUtils.button(mxResources.get("apply"),function(){var e,t,l;c.checked?(e=m.value,l="s"):p.checked?(e=g.value,t=Editor.GOOGLE_FONTS+encodeURIComponent(e).replace(/%20/g,"+"),l="g"):h.checked&&(e=x.value,t=b.value,l="w"),function(e,t,l){if(null!=e&&0!=e.length){if("w"!=l||/(ftp|http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?/.test(t))return 1;r.querySelector(".dlg_fontUrl").style.border="1px solid red"}else r.querySelector(".dlg_fontName_"+l).style.border="1px solid red"}(e,t,l)&&(i(e,t,l),n.hideDialog())});function f(e){this.style.border="",13==e.keyCode&&v.click()}v.className="geBtn gePrimaryBtn",mxEvent.addListener(m,"keypress",f),mxEvent.addListener(g,"keypress",f),mxEvent.addListener(x,"keypress",f),mxEvent.addListener(b,"keypress",f),mxEvent.addListener(m,"focus",function(){c.setAttribute("checked","checked"),c.checked=!0}),mxEvent.addListener(g,"focus",function(){p.setAttribute("checked","checked"),p.checked=!0}),mxEvent.addListener(x,"focus",function(){h.setAttribute("checked","checked"),h.checked=!0}),mxEvent.addListener(b,"focus",function(){h.setAttribute("checked","checked"),h.checked=!0}),a.appendChild(v),n.editor.cancelFirst||a.appendChild(y),s.appendChild(a),d.appendChild(s),r.appendChild(d),this.container=r};function AspectDialog(e,t,l,n,i){this.aspect={pageId:t||(e.pages?e.pages[0].getId():null),layerIds:l||[]};var s=document.createElement("div"),a=document.createElement("h5");a.style.margin="0 0 10px",mxUtils.write(a,mxResources.get("pages")),s.appendChild(a);t=document.createElement("div");t.className="geAspectDlgList",s.appendChild(t),(a=document.createElement("h5")).style.margin="0 0 10px",mxUtils.write(a,mxResources.get("layers")),s.appendChild(a);l=document.createElement("div");l.className="geAspectDlgList",s.appendChild(l),this.pagesContainer=t,this.layersContainer=l,this.ui=e;a=document.createElement("div");a.style.marginTop="16px",a.style.textAlign="center";t=mxUtils.button(mxResources.get("cancel"),function(){e.hideDialog(),null!=i&&i()});t.className="geBtn",e.editor.cancelFirst&&a.appendChild(t);l=mxUtils.button(mxResources.get("ok"),mxUtils.bind(this,function(){e.hideDialog(),n({pageId:this.selectedPage,layerIds:Object.keys(this.selectedLayers)})}));a.appendChild(l),l.className="geBtn gePrimaryBtn",e.editor.cancelFirst||a.appendChild(t),l.setAttribute("disabled","disabled"),this.okBtn=l,s.appendChild(a),this.container=s}AspectDialog.prototype.init=function(){var e=this.ui.getFileData(!0);if(this.ui.pages)for(var t=0;t<this.ui.pages.length;t++){var l=this.ui.updatePageRoot(this.ui.pages[t]);this.createPageItem(l.getId(),l.getName(),l.node)}else this.createPageItem("1","Page-1",mxUtils.parseXml(e).documentElement)},AspectDialog.prototype.createViewer=function(e,t,l,n){mxEvent.disableContextMenu(e),e.style.userSelect="none";var i=new Graph(e);i.setTooltips(!1),i.setEnabled(!1),i.setPanning(!1),i.minFitScale=null,i.maxFitScale=null,i.centerZoom=!0;var s="mxGraphModel"==t.nodeName?t:Editor.parseDiagramNode(t);if(null!=s){t=s.getAttribute("background");null!=t&&""!=t&&t!=mxConstants.NONE||(t=null!=n?n:"#ffffff"),e.style.backgroundColor=t;var t=new mxCodec(s.ownerDocument),a=i.getModel();t.decode(s,a);for(var o=a.getChildCount(a.root),r=null==l,d=0;d<o;d++){var c=a.getChildAt(a.root,d);a.setVisible(c,r||l==c.id)}i.maxFitScale=1,i.fit(0),i.center()}return i},AspectDialog.prototype.createPageItem=function(n,e,i){var s=document.createElement("div");s.className="geAspectDlgListItem",s.setAttribute("data-page-id",n),s.innerHTML='<div style="max-width: 100%; max-height: 100%;"></div><div class="geAspectDlgListItemText">'+mxUtils.htmlEntities(e)+"</div>",this.pagesContainer.appendChild(s);var a=this.createViewer(s.childNodes[0],i),e=mxUtils.bind(this,function(){null!=this.selectedItem&&(this.selectedItem.className="geAspectDlgListItem"),this.selectedItem=s,this.selectedPage=n,s.className+=" geAspectDlgListItemSelected",this.layersContainer.innerHTML="",this.selectedLayers={},this.okBtn.setAttribute("disabled","disabled");for(var e=a.model,t=e.getChildCells(e.getRoot()),l=0;l<t.length;l++)this.createLayerItem(t[l],n,a,i)});mxEvent.addListener(s,"click",e),this.aspect.pageId==n&&e()},AspectDialog.prototype.createLayerItem=function(e,t,l,n){var l=l.convertValueToString(e)||mxResources.get("background")||"Background",i=document.createElement("div");i.setAttribute("data-layer-id",e.id),i.className="geAspectDlgListItem",i.innerHTML='<div style="max-width: 100%; max-height: 100%;"></div><div class="geAspectDlgListItemText">'+mxUtils.htmlEntities(l)+"</div>",this.layersContainer.appendChild(i),this.createViewer(i.childNodes[0],n,e.id);n=mxUtils.bind(this,function(){0<=i.className.indexOf("geAspectDlgListItemSelected")?(i.className="geAspectDlgListItem",delete this.selectedLayers[e.id],0==Object.keys(this.selectedLayers).length&&this.okBtn.setAttribute("disabled","disabled")):(i.className+=" geAspectDlgListItemSelected",this.selectedLayers[e.id]=!0,this.okBtn.removeAttribute("disabled"))});mxEvent.addListener(i,"click",n),-1!=this.aspect.layerIds.indexOf(e.id)&&n()};var FilePropertiesDialog=function(e){var t=document.createElement("table"),l=document.createElement("tbody");t.style.width="100%",t.style.marginTop="8px";var n,i,s,a,o,r,d=e.getCurrentFile(),c=null!=d&&null!=d.getTitle()?d.getTitle():e.defaultFilename,m=null,m=/(\.png)$/i.test(c)?(n=1,c=0,null!=(o=e.fileNode)&&(o.hasAttribute("scale")&&(n=parseFloat(o.getAttribute("scale"))),o.hasAttribute("border")&&(c=parseInt(o.getAttribute("border")))),a=document.createElement("tr"),(o=document.createElement("td")).style.whiteSpace="nowrap",o.style.fontSize="10pt",o.style.width="120px",mxUtils.write(o,mxResources.get("zoom")+":"),a.appendChild(o),(i=document.createElement("input")).setAttribute("value",100*n+"%"),i.style.marginLeft="4px",i.style.width="180px",(o=document.createElement("td")).style.whiteSpace="nowrap",o.appendChild(i),a.appendChild(o),l.appendChild(a),a=document.createElement("tr"),(o=document.createElement("td")).style.whiteSpace="nowrap",o.style.fontSize="10pt",o.style.width="120px",mxUtils.write(o,mxResources.get("borderWidth")+":"),a.appendChild(o),(s=document.createElement("input")).setAttribute("value",c),s.style.marginLeft="4px",s.style.width="180px",(o=document.createElement("td")).style.whiteSpace="nowrap",o.appendChild(s),a.appendChild(o),l.appendChild(a),this.init=function(){i.focus(),mxClient.IS_GC||mxClient.IS_FF||5<=document.documentMode?i.select():document.execCommand("selectAll",!1,null)},function(){null!=e.fileNode&&(e.fileNode.setAttribute("scale",Math.max(0,parseInt(i.value)/100)),e.fileNode.setAttribute("border",Math.max(0,parseInt(s.value))),null!=d&&d.fileChanged()),e.hideDialog()}):(u=null!=d?d.isCompressed():Editor.compressXml,a=document.createElement("tr"),(o=document.createElement("td")).style.whiteSpace="nowrap",o.style.fontSize="10pt",o.style.width="120px",mxUtils.write(o,mxResources.get("compressed")+":"),a.appendChild(o),(r=document.createElement("input")).setAttribute("type","checkbox"),u&&(r.setAttribute("checked","checked"),r.defaultChecked=!0),(o=document.createElement("td")).style.whiteSpace="nowrap",o.appendChild(r),a.appendChild(o),l.appendChild(a),this.init=function(){r.focus()},function(){null!=e.fileNode&&(e.fileNode.setAttribute("compressed",r.checked?"true":"false"),null!=d&&d.fileChanged()),e.hideDialog()}),u=mxUtils.button(mxResources.get("apply"),m);u.className="geBtn gePrimaryBtn",a=document.createElement("tr"),(o=document.createElement("td")).colSpan=2,o.style.paddingTop="20px",o.style.whiteSpace="nowrap",o.setAttribute("align","right");m=mxUtils.button(mxResources.get("cancel"),function(){e.hideDialog()});m.className="geBtn",e.editor.cancelFirst&&o.appendChild(m),o.appendChild(u),e.editor.cancelFirst||o.appendChild(m),a.appendChild(o),l.appendChild(a),t.appendChild(l),this.container=t};