var com,__extends=this&&this.__extends||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);function s(){this.constructor=t}t.prototype=null===e?Object.create(e):(s.prototype=e.prototype,new s)};!function(M){var t,e;function A(t){this.RESPONSE_END="</mxfile>",this.RESPONSE_DIAGRAM_START="",this.RESPONSE_DIAGRAM_END="</diagram>",this.RESPONSE_HEADER='<?xml version="1.0" encoding="UTF-8"?><mxfile>',this.vertexMap={},this.edgeShapeMap={},this.vertexShapeMap={},this.parentsMap={},this.layersMap={},this.debugPaths=!1,this.vsdxModel=null,this.editorUi=t,this.shapeIndexShift=0}t=M.mxgraph||(M.mxgraph={}),e=t.io||(t.io={}),A.vsdxPlaceholder_$LI$=function(){var t;return null==A.vsdxPlaceholder&&(t="dmlzaW8=",A.vsdxPlaceholder=window.atob?atob(t):Base64.decode(t,!0)),A.vsdxPlaceholder},A.parsererrorNS_$LI$=function(){return A.parsererrorNS=mxConstants.NS_XHTML},A.parseXml=function(t){try{var e=mxUtils.parseXml(t);return 0<e.getElementsByTagNameNS(A.parsererrorNS,"parsererror").length?null:e}catch(t){return null}},A.decodeUTF16LE=function(t){for(var e="",n=0;n<t.length;n+=2)e+=String.fromCharCode(t.charCodeAt(n)|t.charCodeAt(n+1)<<8);return e},A.prototype.scaleGraph=function(t,e){if(1!==e){var n,s=t.getModel();for(n in s.cells){var i=s.cells[n],r=s.getGeometry(i);if(null!=r&&(this.scaleRect(r,e),this.scaleRect(r.alternateBounds,e),s.isEdge(i))){this.scalePoint(r.sourcePoint,e),this.scalePoint(r.targetPoint,e),this.scalePoint(r.offset,e);var a=r.points;if(null!=a)for(var o=0;o<a.length;o++){var l=a[o];this.scalePoint(l,e)}}}}},A.incorrectXMLReqExp=[{regExp:/\&(?!amp;|lt;|gt;|quot;|#)/g,repl:"&amp;"}],A.prototype.decodeVsdx=function(t,l,e,n){function o(){if(m==x){new Date;try{s()}catch(t){console.log(t),null!=n?n(t):l("")}}}var u=this,h={},g={},s=function(){for(var t=A.vsdxPlaceholder+"/document.xml",e=h[t]||null,n=e.firstChild;null!=n&&1!=n.nodeType;)n=n.nextSibling;if(null==n||1!=n.nodeType)return null;u.importNodes(e,n,t,h),u.vsdxModel=new M.mxgraph.io.vsdx.mxVsdxModel(e,h,g);function i(t,e){var n=a[t].getValue(),s=o.createMxGraph();s.getModel().beginUpdate(),o.importPage(n,s,s.getDefaultParent(),!0),o.scaleGraph(s,n.getPageScale()/n.getDrawingScale()),s.getModel().endUpdate(),o.postImportPage(n,s,function(){o.sanitiseGraph(s),r.str=(r.str=(r.str=r.str.concat(u.RESPONSE_DIAGRAM_START)).concat(u.processPage(s,n))).concat(u.RESPONSE_DIAGRAM_END),t<a.length-1?i(t+1,e):e()})}var e=u.vsdxModel.getPages(),r={str:u.RESPONSE_HEADER,toString:function(){return this.str}},a=(null==(e=e).entries&&(e.entries=[]),e.entries),o=u;function s(){r.str=r.str.concat(u.RESPONSE_END);new Date;l&&l(r.str)}0<a.length?i(0,s):s()},x=(new Date,0),m=0;JSZip.loadAsync(t).then(function(t){0==Object.keys(t.files).length?null!=n&&n():(new Date,t.forEach(function(t,e){var s,n,i=e.name,r=i.toLowerCase(),a=r.length;r.indexOf(".xml")==a-4||r.indexOf(".rels")==a-5?(x++,e.async("string").then(function(t){if(0!==t.length){65279==t.charCodeAt(0)&&(t=t.substring(1));var e=A.parseXml(t);if(null==e)if(0===t.charCodeAt(1)&&0===t.charCodeAt(3)&&0===t.charCodeAt(5))e=A.parseXml(A.decodeUTF16LE(t));else{for(var n=0;n<A.incorrectXMLReqExp.length;n++)A.incorrectXMLReqExp[n].regExp.test(t)&&(t=t.replace(A.incorrectXMLReqExp[n].regExp,A.incorrectXMLReqExp[n].repl));e=A.parseXml(t)}null!=e&&(e.vsdxFileName=i,h[i]=e)}m++,o()})):0===r.indexOf(A.vsdxPlaceholder+"/media")&&(x++,a=(n=r).length-".emf".length,-1!==(n=n.indexOf(".emf",a))&&n===a?(s=function(){m++,o()},JSZip.support.blob&&window.EMF_CONVERT_URL?e.async("blob").then(function(t){var e=new FormData;e.append("img",t,r),e.append("inputformat","emf"),e.append("outputformat","png");var n=new XMLHttpRequest;n.open("POST",EMF_CONVERT_URL),n.responseType="blob",u.editorUi.addRemoteServiceSecurityCheck(n),n.onreadystatechange=mxUtils.bind(this,function(){if(4==n.readyState)if(200<=n.status&&n.status<=299)try{var e=new FileReader;e.readAsDataURL(n.response),e.onloadend=function(){var t=e.result.indexOf(",")+1;g[i]=e.result.substr(t),s()}}catch(t){console.log(t),s()}else s()}),n.send(e)}):s()):(a=(n=r).length-".bmp".length,-1!==(n=n.indexOf(".bmp",a))&&n===a?JSZip.support.uint8array&&e.async("uint8array").then(function(t){var e=new BmpDecoder(t),t=document.createElement("canvas");t.width=e.width,t.height=e.height,t.getContext("2d").putImageData(e.imageData,0,0);t=t.toDataURL("image/jpeg");g[i]=t.substr(23),m++,o()}):e.async("base64").then(function(t){g[i]=t,m++,o()})))}))},function(t){null!=n&&n(t)})},A.prototype.createMxGraph=function(){var t=new Graph;return t.setExtendParents(!1),t.setExtendParentsOnAdd(!1),t.setConstrainChildren(!1),t.setHtmlLabels(!0),t.getModel().maintainEdgeParent=!1,t},A.prototype.processPage=function(t,e){var n=(new mxCodec).encode(t.getModel());n.setAttribute("style","default-style2");t=mxUtils.getXml(n),n="";return null!=e&&(n+='<diagram name="'+(e=mxUtils.htmlEntities(e.getPageName())+(e.isBackground()?" (Background)":""))+'" id="'+e.replace(/\s/g,"_")+'">'),n+=Graph.compress(t)},A.prototype.scalePoint=function(t,e){return null!=t&&(t.x=t.x*e,t.y=t.y*e),t},A.prototype.scaleRect=function(t,e){return null!=t&&(t.x=t.x*e,t.y=t.y*e,t.height=t.height*e,t.width=t.width*e),t},A.prototype.importNodes=function(t,e,n,s){var i=n.lastIndexOf("/"),r=n,a=n;if(-1!==i){r=n.substring(0,i),a=n.substring(i+1,n.length),a=s[r+"/_rels/"+a+".rels"]||null;if(null!=a){for(var o=a.getElementsByTagName("Relationship"),l={},u=0;u<o.length;u++){var h=o.item(u),g=h.getAttribute("Id"),x=h.getAttribute("Target");l[g]=x}for(var m,p=e.getElementsByTagName("Rel"),u=0;u<p.length;u++){var c=p.item(u);if(null!=(x=r+"/"+(m=l,d=c.getAttribute("r:id"),m[d]||null))){var d=s[x]||null;if(null!=d){for(var y=c.parentNode,_=d.firstChild;null!=_&&1!=_.nodeType;)_=_.nextSibling;if(null!=_&&1==_.nodeType)for(var v,f=_.firstChild;null!=f;)null!=f&&1==f.nodeType&&(v=y.appendChild(t.importNode(f,!0)),this.importNodes(t,v,x,s)),f=f.nextSibling}}}}}},A.prototype.importPage=function(t,e,n,s){var i,r=t.getBackPage();null!=r&&(e.getModel().setValue(e.getDefaultParent(),t.getPageName()),i=new mxCell(r.getPageName()),e.addCell(i,e.getModel().getRoot(),0,null,null),this.importPage(r,e,e.getDefaultParent()));var a=t.getLayers();this.layersMap[0]=e.getDefaultParent();var o={},l=0,u=null,h=t.getShapes();try{for(var g=0;null!=h.entries&&g<h.entries.length;g++)null!=(m=h.entries[g].getValue().layerMember)&&(null==u?(o[m]=l,u=m):u!=m&&null==o[m]&&(l++,o[m]=l,u=m))}catch(t){console.log("VSDX Import: Failed to detect layers order")}for(g=0;g<a.length;g++){var x,m=a[g],p=null!=o[g]?o[g]:g;0==p?x=e.getDefaultParent():(x=new mxCell,e.addCell(x,e.model.root,p)),x.setVisible(1==m.Visible),1==m.Lock&&x.setStyle("locked=1;"),x.setValue(m.Name),this.layersMap[g]=x}for(var c,d,y=(null==(r=h).entries&&(r.entries=[]),c=r.entries,d=0,{next:function(){return d<c.length?c[d++]:null},hasNext:function(){return d<c.length}}),_=t.getPageDimensions().y,v=t.getId();y.hasNext();){var f=(A=y.next()).getValue(),S=this.layersMap[f.layerMember];this.addShape(e,f,S||n,v,_)}for(var C,I,t=t.getConnects(),L=(null==(t=t).entries&&(t.entries=[]),C=t.entries,I=0,{next:function(){return I<C.length?C[I++]:null},hasNext:function(){return I<C.length}});L.hasNext();){var A=L.next(),E=this.addConnectedEdge(e,A.getValue(),v,_);null!=E&&function(t,e){null==t.entries&&(t.entries=[]);for(var n=0;n<t.entries.length;n++)if(null!=t.entries[n].key.equals&&t.entries[n].key.equals(e)||t.entries[n].key===e)return t.entries.splice(n,1)[0]}(this.edgeShapeMap,E)}for(var M,T,N=(null==(t=this.edgeShapeMap).entries&&(t.entries=[]),M=t.entries,T=0,{next:function(){return T<M.length?M[T++]:null},hasNext:function(){return T<M.length}});N.hasNext();){var D=N.next();D.getKey().getPageNumber()===v&&this.addUnconnectedEdge(e,function(t,e){null==t.entries&&(t.entries=[]);for(var n=0;n<t.entries.length;n++)if(null!=t.entries[n].key.equals&&t.entries[n].key.equals(e)||t.entries[n].key===e)return t.entries[n].value;return null}(this.parentsMap,D.getKey()),D.getValue(),_)}return s||this.sanitiseGraph(e),_},A.prototype.postImportPage=function(i,t,e){try{for(var r=this,a=[],n=i.getShapes().entries||[],s=0;s<n.length;s++){var o=n[s].value||{};o.toBeCroppedImg&&a.push(o)}0<a.length?function t(e,n){function l(){e<a.length-1?t(e+1,n):n()}var s=a[e],u=s.toBeCroppedImg,h=function(t,e){null==t.entries&&(t.entries=[]);for(var n=0;n<t.entries.length;n++)if(null!=t.entries[n].key.equals&&t.entries[n].key.equals(e)||t.entries[n].key===e)return t.entries[n].value;return null}(r.vertexMap,new M.mxgraph.io.vsdx.ShapePageId(i.Id,s.Id)),g=new Image;g.onload=function(){var t=u.iData,e=u.iType;try{var n=g.width/u.imgWidth,s=g.height/u.imgHeight,i=-u.imgOffsetX*n,r=(u.imgHeight-u.height+u.imgOffsetY)*s,a=document.createElement("canvas");a.width=u.width*n,a.height=u.height*s;var o=a.getContext("2d");o.fillStyle="#FFFFFF",o.fillRect(0,0,a.width,a.height),o.drawImage(g,i,r,a.width,a.height,0,0,a.width,a.height),t=a.toDataURL("image/jpeg").substr(23),e="jpg"}catch(t){console.log(t)}h.style+=";image=data:image/"+e+","+t,l()},g.src="data:image/"+u.iType+";base64,"+u.iData,g.onerror=function(){h.style+=";image=data:image/"+u.iType+","+u.iData,l()}}(0,e):e()}catch(t){console.log(t),e()}},A.prototype.addShape=function(t,e,n,s,i){e.parentHeight=i;var r,a,o=M.mxgraph.io.vsdx.VsdxShape.getType(e.getShape());if(null!=o&&(r=o,a=M.mxgraph.io.vsdx.mxVsdxConstants.TYPE_SHAPE,(r&&r.equals?r.equals(a):r===a)||(r=o,a=M.mxgraph.io.vsdx.mxVsdxConstants.TYPE_GROUP,r&&r.equals?r.equals(a):r===a)||(o=o,l=M.mxgraph.io.vsdx.mxVsdxConstants.FOREIGN,o&&o.equals?o.equals(l):o===l))){var l=e.getId();if(e.isVertex()){var u=null,u=e.isGroup()?this.addGroup(t,e,n,s,i):this.addVertex(t,e,n,s,i);(function(t,e,n){null==t.entries&&(t.entries=[]);for(var s=0;s<t.entries.length;s++)if(null!=t.entries[s].key.equals&&t.entries[s].key.equals(e)||t.entries[s].key===e)return t.entries[s].value=n;t.entries.push({key:e,value:n,getKey:function(){return this.key},getValue:function(){return this.value}})})(this.vertexShapeMap,new M.mxgraph.io.vsdx.ShapePageId(s,l),e);i=e.getHyperlink();i.extLink?t.setLinkForCell(u,i.extLink):i.pageLink&&t.setLinkForCell(u,"data:page/id,"+i.pageLink);for(var h=e.getProperties(),g=0;g<h.length;g++)try{t.setAttributeForCell(u,h[g].key,h[g].val)}catch(t){console.log('Attribute: "',h[g].key,'" with value "',h[g].val,'" not allowed in HTML')}return u}e.setShapeIndex(t.getModel().getChildCount(n)),function(t,e,n){null==t.entries&&(t.entries=[]);for(var s=0;s<t.entries.length;s++)if(null!=t.entries[s].key.equals&&t.entries[s].key.equals(e)||t.entries[s].key===e)return t.entries[s].value=n;t.entries.push({key:e,value:n,getKey:function(){return this.key},getValue:function(){return this.value}})}(this.edgeShapeMap,new M.mxgraph.io.vsdx.ShapePageId(s,l),e),function(t,e,n){null==t.entries&&(t.entries=[]);for(var s=0;s<t.entries.length;s++)if(null!=t.entries[s].key.equals&&t.entries[s].key.equals(e)||t.entries[s].key===e)return t.entries[s].value=n;t.entries.push({key:e,value:n,getKey:function(){return this.key},getValue:function(){return this.value}})}(this.parentsMap,new M.mxgraph.io.vsdx.ShapePageId(s,l),n)}return null},A.prototype.addGroup=function(t,e,n,s,i){var r=e.getDimensions(),a=e.getMaster(),o=e.getStyleFromShape(),l=e.getGeomList();l.isNoFill()&&(o[mxConstants.STYLE_FILLCOLOR]="none",o[mxConstants.STYLE_GRADIENTCOLOR]="none"),l.isNoLine()&&(o[mxConstants.STYLE_STROKECOLOR]="none"),o.html="1",o[mxConstants.STYLE_WHITE_SPACE]="wrap";var u=M.mxgraph.io.vsdx.mxVsdxUtils.getStyleString(o,"="),h=null,g=e.getChildShapes(),l=null!=g&&(null==(x=g).entries&&(x.entries=[]),0<x.entries.length),o=e.isDisplacedLabel()||e.isRotatedLabel()||l,x=e.getOriginPoint(i,!0);h=o?t.insertVertex(n,null,null,Math.floor(Math.round(100*x.x)/100),Math.floor(Math.round(100*x.y)/100),Math.floor(Math.round(100*r.x)/100),Math.floor(Math.round(100*r.y)/100),u):(l=e.getTextLabel(),t.insertVertex(n,null,l,Math.floor(Math.round(100*x.x)/100),Math.floor(Math.round(100*x.y)/100),Math.floor(Math.round(100*r.x)/100),Math.floor(Math.round(100*r.y)/100),u));for(var m,p,c,d,y,_=(null==(g=g).entries&&(g.entries=[]),m=g.entries,p=0,{next:function(){return p<m.length?m[p++]:null},hasNext:function(){return p<m.length}});_.hasNext();){var v,f=_.next().getValue(),S=f.getId();f.isVertex()?(null!=(v=M.mxgraph.io.vsdx.VsdxShape.getType(f.getShape()))&&(d=v,y=M.mxgraph.io.vsdx.mxVsdxConstants.TYPE_SHAPE,(d&&d.equals?d.equals(y):d===y)||(y=v,c=M.mxgraph.io.vsdx.mxVsdxConstants.TYPE_GROUP,y&&y.equals?y.equals(c):y===c)||(c=v,v=M.mxgraph.io.vsdx.mxVsdxConstants.FOREIGN,c&&c.equals?c.equals(v):c===v))&&f.isVertex()&&(f.propagateRotation(e.getRotation()),f.isGroup()?this.addGroup(t,f,h,s,r.y):this.addVertex(t,f,h,s,r.y)),null==a&&function(t,e,n){null==t.entries&&(t.entries=[]);for(var s=0;s<t.entries.length;s++)if(null!=t.entries[s].key.equals&&t.entries[s].key.equals(e)||t.entries[s].key===e)return t.entries[s].value=n;t.entries.push({key:e,value:n,getKey:function(){return this.key},getValue:function(){return this.value}})}(this.vertexShapeMap,new M.mxgraph.io.vsdx.ShapePageId(s,S),f)):null==a?(function(t,e,n){null==t.entries&&(t.entries=[]);for(var s=0;s<t.entries.length;s++)if(null!=t.entries[s].key.equals&&t.entries[s].key.equals(e)||t.entries[s].key===e)return t.entries[s].value=n;t.entries.push({key:e,value:n,getKey:function(){return this.key},getValue:function(){return this.value}})}(this.edgeShapeMap,new M.mxgraph.io.vsdx.ShapePageId(s,S),f),function(t,e,n){null==t.entries&&(t.entries=[]);for(var s=0;s<t.entries.length;s++)if(null!=t.entries[s].key.equals&&t.entries[s].key.equals(e)||t.entries[s].key===e)return t.entries[s].value=n;t.entries.push({key:e,value:n,getKey:function(){return this.key},getValue:function(){return this.value}})}(this.parentsMap,new M.mxgraph.io.vsdx.ShapePageId(s,S),h)):this.addUnconnectedEdge(t,h,f,i)}o&&e.createLabelSubShape(t,h);var C=e.getRotation();if(0!==C)for(var o=h.getGeometry(),I=o.width/2,L=o.height/2,A=0;A<h.getChildCount();A++){var E=h.getChildAt(A);M.mxgraph.online.Utils.rotatedGeometry(E.getGeometry(),C,I,L)}return function(t,e,n){null==t.entries&&(t.entries=[]);for(var s=0;s<t.entries.length;s++)if(null!=t.entries[s].key.equals&&t.entries[s].key.equals(e)||t.entries[s].key===e)return t.entries[s].value=n;t.entries.push({key:e,value:n,getKey:function(){return this.key},getValue:function(){return this.value}})}(this.vertexMap,new M.mxgraph.io.vsdx.ShapePageId(s,e.getId()),h),h},A.rotatedEdgePoint=function(t,e,n,s){e=e*Math.PI/180;var i=Math.cos(e),r=Math.sin(e),a=t.x-n,o=t.y-s,e=o*i+a*r;t.x=Math.round(a*i-o*r+n),t.y=Math.round(e+s)},A.prototype.addVertex=function(t,e,n,s,i){var r="",a=e.isDisplacedLabel()||e.isRotatedLabel();a||(r=e.getTextLabel());var o=e.getDimensions(),l=e.getStyleFromShape();l.html="1";var u=l.hasOwnProperty(mxConstants.STYLE_SHAPE)||l.hasOwnProperty("stencil");l.hasOwnProperty(mxConstants.STYLE_FILLCOLOR)&&u||(l[mxConstants.STYLE_FILLCOLOR]="none"),u||(l[mxConstants.STYLE_STROKECOLOR]="none"),l.hasOwnProperty(mxConstants.STYLE_GRADIENTCOLOR)&&u||(l[mxConstants.STYLE_GRADIENTCOLOR]="none"),l[mxConstants.STYLE_WHITE_SPACE]="wrap";i=e.getOriginPoint(i,!0);if(u||null!=r){u=M.mxgraph.io.vsdx.mxVsdxUtils.getStyleString(l,"="),l=null,l=a?t.insertVertex(n,null,null,Math.floor(Math.round(100*i.x)/100),Math.floor(Math.round(100*i.y)/100),Math.floor(Math.round(100*o.x)/100),Math.floor(Math.round(100*o.y)/100),u):t.insertVertex(n,null,r,Math.floor(Math.round(100*i.x)/100),Math.floor(Math.round(100*i.y)/100),Math.floor(Math.round(100*o.x)/100),Math.floor(Math.round(100*o.y)/100),u);return function(t,e,n){null==t.entries&&(t.entries=[]);for(var s=0;s<t.entries.length;s++)if(null!=t.entries[s].key.equals&&t.entries[s].key.equals(e)||t.entries[s].key===e)return t.entries[s].value=n;t.entries.push({key:e,value:n,getKey:function(){return this.key},getValue:function(){return this.value}})}(this.vertexMap,new M.mxgraph.io.vsdx.ShapePageId(s,e.getId()),l),e.setLabelOffset(l,u),a&&e.createLabelSubShape(t,l),l}return null},A.calculateAbsolutePoint=function(t){for(var e=0,n=0;null!=t;){var s=t.geometry;null!=s&&(e+=s.x,n+=s.y),t=t.parent}return new mxPoint(e,n)},A.prototype.processEdgeGeo=function(t,e){try{for(var n=t.geomList.geomList[0].rows,s=0;s<n.length;s++)if(n[s]instanceof M.mxgraph.io.vsdx.geometry.ArcTo){e.style+="jumpStyle=arc;";break}for(s=0;s<n.length;s++)n[s],M.mxgraph.io.vsdx.geometry.NURBSTo}catch(t){}},A.prototype.addConnectedEdge=function(t,e,n,s){var i=e.getFromSheet(),r=new M.mxgraph.io.vsdx.ShapePageId(n,i),a=function(t,e){null==t.entries&&(t.entries=[]);for(var n=0;n<t.entries.length;n++)if(null!=t.entries[n].key.equals&&t.entries[n].key.equals(e)||t.entries[n].key===e)return t.entries[n].value;return null}(this.edgeShapeMap,r);if(null==a)return null;var o=function(t,e){null==t.entries&&(t.entries=[]);for(var n=0;n<t.entries.length;n++)if(null!=t.entries[n].key.equals&&t.entries[n].key.equals(e)||t.entries[n].key===e)return t.entries[n].value;return null}(this.parentsMap,new M.mxgraph.io.vsdx.ShapePageId(n,a.getId())),l=s;null==o||null!=(m=t.getModel().getGeometry(o))&&(l=m.height);var u=a.getStartXY(l),h=a.getEndXY(l),g=a.getRoutingPoints(l,u,a.getRotation());this.rotateChildEdge(t.getModel(),o,u,h,g);var x=null,i=e.getSourceToSheet(),s=null!=i?function(t,e){null==t.entries&&(t.entries=[]);for(var n=0;n<t.entries.length;n++)if(null!=t.entries[n].key.equals&&t.entries[n].key.equals(e)||t.entries[n].key===e)return t.entries[n].value;return null}(this.vertexMap,new M.mxgraph.io.vsdx.ShapePageId(n,i)):null,m=!0;null==s||0==s.geometry.width||0==s.geometry.height?s=t.insertVertex(o,null,null,Math.floor(Math.round(100*u.x)/100),Math.floor(Math.round(100*u.y)/100),0,0):s.style&&-1==s.style.indexOf(";rotation=")?(p=A.calculateAbsolutePoint(s),i=A.calculateAbsolutePoint(o),c=s.geometry,x=new mxPoint((i.x+u.x-p.x)/c.width,(i.y+u.y-p.y)/c.height)):m=!1;var p=null,c=e.getTargetToSheet(),e=null!=c?function(t,e){null==t.entries&&(t.entries=[]);for(var n=0;n<t.entries.length;n++)if(null!=t.entries[n].key.equals&&t.entries[n].key.equals(e)||t.entries[n].key===e)return t.entries[n].value;return null}(this.vertexMap,new M.mxgraph.io.vsdx.ShapePageId(n,c)):null,n=!0;null==e||0==e.geometry.width||0==e.geometry.height?e=t.insertVertex(o,null,null,Math.floor(Math.round(100*h.x)/100),Math.floor(Math.round(100*h.y)/100),0,0):e.style&&-1==e.style.indexOf(";rotation=")?(v=A.calculateAbsolutePoint(e),c=A.calculateAbsolutePoint(o),y=e.geometry,p=new mxPoint((c.x+h.x-v.x)/y.width,(c.y+h.y-v.y)/y.height)):n=!1;var d,y,_,h=a.getStyleFromEdgeShape(l),v=a.getRotation();0!==v?(d=t.insertEdge(o,null,null,s,e,M.mxgraph.io.vsdx.mxVsdxUtils.getStyleString(h,"=")),null!=(y=a.createLabelSubShape(t,d))&&(y.setStyle(y.getStyle()+";rotation="+(60<v&&v<240?(v+180)%360:v)),(_=y.getGeometry()).x=0,_.y=0,_.relative=!0,_.offset=new mxPoint(-_.width/2,-_.height/2))):(d=t.insertEdge(o,null,a.getTextLabel(),s,e,M.mxgraph.io.vsdx.mxVsdxUtils.getStyleString(h,"=")),_=a.getLblEdgeOffset(t.getView(),g),d.getGeometry().offset=_,null!=x&&t.setConnectionConstraint(d,s,!0,new mxConnectionConstraint(x,!1)),m&&g.shift(),null!=p&&t.setConnectionConstraint(d,e,!1,new mxConnectionConstraint(p,!1)),n&&g.pop());n=t.getModel().getGeometry(d);if(s.parent!=e.parent&&null!=o&&1!=o.id&&1==s.parent.id){var f=0,S=0,C=o;do{var I=C.geometry}while(null!=I&&(f+=I.x,S+=I.y),null!=(C=C.parent));d.parent=s.parent;for(var L=0;L<g.length;L++)g[L].x+=f,g[L].y+=S}return n.points=g,h.hasOwnProperty("curved")&&((h=h.curved||null)&&h.equals?h.equals("1"):"1"===h)&&(n=t.getModel().getGeometry(d),l=a.getControlPoints(l),n.points=l),this.processEdgeGeo(a,d),r},A.prototype.addUnconnectedEdge=function(t,e,n,s){var i=s;null==e||null!=(a=t.getModel().getGeometry(e))&&(i=a.height);var r,a,o,l=n.getStartXY(i),u=n.getEndXY(i),h=n.getStyleFromEdgeShape(i),g=n.getRoutingPoints(i,l,n.getRotation()),s=n.getRotation();0!==s?(r=0===n.getShapeIndex()?t.insertEdge(e,null,null,null,null,M.mxgraph.io.vsdx.mxVsdxUtils.getStyleString(h,"=")):(r=t.createEdge(e,null,null,null,null,M.mxgraph.io.vsdx.mxVsdxUtils.getStyleString(h,"=")),t.addEdge(r,e,null,null,n.getShapeIndex()+this.shapeIndexShift++)),null!=(a=n.createLabelSubShape(t,r))&&(a.setStyle(a.getStyle()+";rotation="+(60<s&&s<240?(s+180)%360:s)),(o=a.getGeometry()).x=0,o.y=0,o.relative=!0,o.offset=new mxPoint(-o.width/2,-o.height/2))):(r=0===n.getShapeIndex()?t.insertEdge(e,null,n.getTextLabel(),null,null,M.mxgraph.io.vsdx.mxVsdxUtils.getStyleString(h,"=")):(r=t.createEdge(e,null,n.getTextLabel(),null,null,M.mxgraph.io.vsdx.mxVsdxUtils.getStyleString(h,"=")),t.addEdge(r,e,null,null,n.getShapeIndex()+this.shapeIndexShift++)),o=n.getLblEdgeOffset(t.getView(),g),r.getGeometry().offset=o),this.rotateChildEdge(t.getModel(),e,l,u,g);var e=t.getModel().getGeometry(r);return g.pop(),g.shift(),e.points=g,e.setTerminalPoint(l,!0),e.setTerminalPoint(u,!1),h.hasOwnProperty("curved")&&((h=h.curved||null)&&h.equals?h.equals("1"):"1"===h)&&(e=t.getModel().getGeometry(r),i=n.getControlPoints(i),e.points=i),this.processEdgeGeo(n,r),r},A.prototype.rotateChildEdge=function(t,e,n,s,i){if(null!=e){var r=t.getGeometry(e),t=t.getStyle(e);if(null!=r&&null!=t){e=t.indexOf("rotation=");if(-1<e){var a=parseFloat(t.substring(e+9,t.indexOf(";",e))),o=r.width/2,l=r.height/2;A.rotatedEdgePoint(n,a,o,l),A.rotatedEdgePoint(s,a,o,l);for(var u=0;u<i.length;u++){var h=i[u];A.rotatedEdgePoint(h,a,o,l)}}}}},A.prototype.sanitiseGraph=function(t){var e=t.getModel().getRoot();this.sanitiseCell(t,e)},A.prototype.sanitiseCell=function(t,e){for(var n=t.getModel(),s=n.getChildCount(e),i=[],r=0;r<s;r++){var a=n.getChildAt(e,r);this.sanitiseCell(t,a)&&i.push(a)}for(var o=0;o<i.length;o++){var l=i[o];n.remove(l)}var u=e.geometry;null!=u&&(u.height<0&&(u.height=Math.abs(u.height),u.y-=u.height,e.style+=";flipV=1;"),u.width<0&&(u.width=Math.abs(u.width),u.x-=u.width,e.style+=";flipH=1;")),0<s&&(s=n.getChildCount(e));var h=new String(n.getValue(e)).toString(),u=n.getStyle(e);return!(0!==s||!n.isVertex(e)||null!=n.getValue(e)&&0!==h.length||null==u||-1==u.indexOf(mxConstants.STYLE_FILLCOLOR+"=none")||-1==u.indexOf(mxConstants.STYLE_STROKECOLOR+"=none")||-1!=u.indexOf("image="))},t=A,(e.mxVsdxCodec=t).__class="com.mxgraph.io.mxVsdxCodec"}(com=com||{}),function(S){var t,e,C;function n(t){var e=C.call(this)||this;return e.RESPONSE_END="",e.RESPONSE_DIAGRAM_START="",e.RESPONSE_DIAGRAM_END="",e.RESPONSE_HEADER="",e.editorUi=t,e}t=S.mxgraph||(S.mxgraph={}),e=t.io||(t.io={}),C=S.mxgraph.io.mxVsdxCodec,__extends(n,C),n.prototype.decodeVssx=function(t,r,e,a){var o=this,l={str:"<mxlibrary>[",toString:function(){return this.str}};this.decodeVsdx(t,function(t){l.str=l.str.concat(t);var e,n,s,c=o.vsdxModel.getMasterShapes(),d=(e=function(t){var e=[];null==t.entries&&(t.entries=[]);for(var n=0;n<t.entries.length;n++)e.push(t.entries[n].value);return e}(o.vsdxModel.getPages()),(n=0)<e.length?e[n++]:null);if(null!=c){for(var y={str:"",toString:function(){return this.str}},_=0===t.length?"":",",v=(s=c,Object.keys(s).map(function(t){return s[t]})),f=o,i=0;i<v.length;i++)!function(t){var e,n=v[t],s=f.createMxGraph(),i=1;null!=n.pageSheet&&(e=p=1,null!=(t=n.pageSheet.DrawingScale)&&(p=parseFloat(t.getAttribute("V"))||1),i=(e=null!=(t=n.pageSheet.PageScale)?parseFloat(t.getAttribute("V"))||1:e)/p);for(var r=!1,a=0;null!=n.firstLevelShapes&&a<n.firstLevelShapes.length;a++){var o=n.firstLevelShapes[a].getShape(),l=new S.mxgraph.io.vsdx.VsdxShape(d,o,!d.isEdge(o),c,null,f.vsdxModel),u=null;if(l.isVertex()){f.edgeShapeMap.entries=[],f.parentsMap.entries=[];for(var u=f.addShape(s,l,s.getDefaultParent(),0,1169),h=(null==(o=f.edgeShapeMap).entries&&(o.entries=[]),o.entries),g=0;g<h.length;g++){var x=h[g],m=function(t,e){null==t.entries&&(t.entries=[]);for(var n=0;n<t.entries.length;n++)if(null!=t.entries[n].key.equals&&t.entries[n].key.equals(e)||t.entries[n].key===e)return t.entries[n].value;return null}(f.parentsMap,x.getKey());f.addUnconnectedEdge(s,m,x.getValue(),1169)}}else u=f.addUnconnectedEdge(s,null,l,1169);r|=null!=u}if(r){f.scaleGraph(s,i);var p=f.normalizeGraph(s);if(f.sanitiseGraph(s),0===s.getModel().getChildCount(s.getDefaultParent()))return;y.str=(y.str=y.str.concat(_)).concat('{"xml":"');i=C.prototype.processPage.call(f,s,null);y.str=(y.str=(y.str=(y.str=(y.str=(y.str=y.str.concat(i)).concat('","w":')).concat(p.width)).concat(',"h":')).concat(p.height)).concat(',"title":');p=n.getName();null==p&&(p=""),p=mxUtils.htmlEntities(JSON.stringify(p)),y.str=(y.str=y.str.concat(p)).concat("}"),_=","}}(i);l.str=l.str.concat(y)}if(l.str=l.str.concat("]</mxlibrary>"),r)try{r(l.str)}catch(t){null!=a?a(t):r("")}},e)},n.prototype.normalizeGeo=function(t){var e=t.getGeometry();e.x=0,e.y=0;var n=e.sourcePoint;if(t.isEdge()&&null!=n){this.transPoint(e.targetPoint,n),this.transPoint(e.offset,n);var s=e.points;if(null!=s)for(var i=0;i<s.length;i++){var r=s[i];this.transPoint(r,n)}this.transPoint(n,n)}return e},n.prototype.normalizeGraph=function(t){var e,n,s,i;function r(t){null!=t&&(i=null==e?(e=t.x,n=t.y,s=t.x+(t.width||0),t.y+(t.height||0)):(e=Math.min(t.x,e),n=Math.min(t.y,n),s=Math.max(t.x+(t.width||0),s),Math.max(t.y+(t.height||0),i)))}for(l in t.model.cells)if(null!=(g=(h=t.model.cells[l]).geometry)&&1==h.parent.id)if(h.vertex)r(g);else{r(g.sourcePoint),r(g.targetPoint);for(var a=g.points,o=0;null!=a&&o<a.length;o++)r(a[o])}var l,u={x:e,y:n};for(l in t.model.cells){var h,g=(h=t.model.cells[l]).geometry;if(null!=g&&1==h.parent.id&&(g.x-=e,g.y-=n,h.isEdge())){this.transPoint(g.sourcePoint,u),this.transPoint(g.targetPoint,u),this.transPoint(g.offset,u);for(a=g.points,o=0;null!=a&&o<a.length;o++)this.transPoint(a[o],u)}}return{width:s-e,height:i-n}},n.prototype.transPoint=function(t,e){null!=t&&(t.x=t.x-e.x,t.y=t.y-e.y)},n.prototype.processPage=function(t,e){var n=t.getModel(),s={str:"",toString:function(){return this.str}},i="",r=this;for(u in n.cells){var a=n.cells[u];if(t.getDefaultParent()===n.getParent(a)){s.str=(s.str=s.str.concat(i)).concat('{"xml":"');var o=r.createMxGraph();if(o.addCell(a),r.sanitiseGraph(o),0===o.getModel().getChildCount(o.getDefaultParent()))return"continue";var l=r.normalizeGeo(a),o=C.prototype.processPage.call(r,o,null);s.str=(s.str=(s.str=(s.str=(s.str=(s.str=s.str.concat(o)).concat('","w":')).concat(l.width)).concat(',"h":')).concat(l.height)).concat(',"title":"');var u,o=n.getStyle(a),l="";null==o||0<=(a=o.indexOf(S.mxgraph.io.vsdx.mxVsdxConstants.VSDX_ID))&&(a+=S.mxgraph.io.vsdx.mxVsdxConstants.VSDX_ID.length+1,u=parseInt(o.substring(a,o.indexOf(";",a))),null!=(a=function(t,e){null==t.entries&&(t.entries=[]);for(var n=0;n<t.entries.length;n++)if(null!=t.entries[n].key.equals&&t.entries[n].key.equals(e)||t.entries[n].key===e)return t.entries[n].value;return null}(r.vertexShapeMap,new S.mxgraph.io.vsdx.ShapePageId(e.getId(),u)))&&(l=a.getName())),s.str=(s.str=s.str.concat(l)).concat('"}'),i=","}}return 0<s.str.length?this.RESPONSE_DIAGRAM_START=",":this.RESPONSE_DIAGRAM_START="",s.str},t=n,(e.mxVssxCodec=t).__class="com.mxgraph.io.mxVssxCodec"}(com=com||{}),function(t){var e;function n(t,e,n){this.x=null,this.y=null,this.a=null,this.b=null,this.c=null,this.d=null,this.formulaA=null,this.formulaE=null,this.index=0,this.index=t,this.x=e,this.y=n}e=t.mxgraph||(t.mxgraph={}),t=(e=(t=e.io||(e.io={})).vsdx||(t.vsdx={})).geometry||(e.geometry={}),n.prototype.getX=function(){return this.x},n.prototype.getY=function(){return this.y},n.prototype.getA=function(){return this.a},n.prototype.getB=function(){return this.b},n.prototype.getC=function(){return this.c},n.prototype.getD=function(){return this.d},n.prototype.getFormulaA=function(){return this.formulaA},n.prototype.getFormulaE=function(){return this.formulaE},n.prototype.getIndex=function(){return this.index},e=n,(t.Row=e).__class="com.mxgraph.io.vsdx.geometry.Row"}(com=com||{}),function(_){var t,e;function v(){}t=_.mxgraph||(_.mxgraph={}),e=(t=(e=t.io||(t.io={})).vsdx||(e.vsdx={})).geometry||(t.geometry={}),v.getIndex=function(t){try{return parseInt(t.getAttribute("IX"))||1}catch(t){return 1}},v.getDoubleVal=function(t){try{if(null!=t&&0!==t.length){var e=parseFloat(t);if(isFinite(e))return e}}catch(t){}return null},v.getRowObj=function(t,e){var n=t.getAttribute("T"),s=v.getIndex(t),i=t.getAttribute("Del");if(!((i=i)&&i.equals?i.equals("1"):"1"===i)){var i=null,r=null,a=null,o=null,l=null,u=null,h=null,g=null,x=null;null!=(i=s<=e.length?e[s-1]:i)&&(r=i.x,a=i.y,o=i.getA(),l=i.getB(),u=i.getC(),h=i.getD(),x=i.getFormulaA(),g=i.getFormulaE());for(var m=_.mxgraph.io.vsdx.mxVsdxUtils.getDirectChildElements(t),p=0;p<m.length;p++){var c=m[p],d=c.getAttribute("N"),y=c.getAttribute("V");switch(d){case"X":r=v.getDoubleVal(y);break;case"Y":a=v.getDoubleVal(y);break;case"A":o=v.getDoubleVal(y),x=c.getAttribute("V");break;case"B":l=v.getDoubleVal(y);break;case"C":u=v.getDoubleVal(y);break;case"D":h=v.getDoubleVal(y);break;case"E":g=y}}switch(n){case"MoveTo":return new _.mxgraph.io.vsdx.geometry.MoveTo(s,r,a);case"LineTo":return new _.mxgraph.io.vsdx.geometry.LineTo(s,r,a);case"ArcTo":return new _.mxgraph.io.vsdx.geometry.ArcTo(s,r,a,o);case"Ellipse":return new _.mxgraph.io.vsdx.geometry.Ellipse(s,r,a,o,l,u,h);case"EllipticalArcTo":return new _.mxgraph.io.vsdx.geometry.EllipticalArcTo(s,r,a,o,l,u,h);case"InfiniteLine":return new _.mxgraph.io.vsdx.geometry.InfiniteLine(s,r,a,o,l);case"NURBSTo":return new _.mxgraph.io.vsdx.geometry.NURBSTo(s,r,a,o,l,u,h,g);case"PolylineTo":return new _.mxgraph.io.vsdx.geometry.PolylineTo(s,r,a,x);case"RelCubBezTo":return new _.mxgraph.io.vsdx.geometry.RelCubBezTo(s,r,a,o,l,u,h);case"RelEllipticalArcTo":return new _.mxgraph.io.vsdx.geometry.RelEllipticalArcTo(s,r,a,o,l,u,h);case"RelLineTo":return new _.mxgraph.io.vsdx.geometry.RelLineTo(s,r,a);case"RelMoveTo":return new _.mxgraph.io.vsdx.geometry.RelMoveTo(s,r,a);case"RelQuadBezTo":return new _.mxgraph.io.vsdx.geometry.RelQuadBezTo(s,r,a,o,l);case"SplineKnot":return new _.mxgraph.io.vsdx.geometry.SplineKnot(s,r,a,o);case"SplineStart":return new _.mxgraph.io.vsdx.geometry.SplineStart(s,r,a,o,l,u,h)}}return new _.mxgraph.io.vsdx.geometry.DelRow(s)},t=v,(e.RowFactory=t).__class="com.mxgraph.io.vsdx.geometry.RowFactory"}(com=com||{}),function(x){var t,e;function n(){this.colorElementMap={},this.fontElementMap={}}t=x.mxgraph||(x.mxgraph={}),t=(e=t.io||(t.io={})).vsdx||(e.vsdx={}),n.__static_initialize=function(){n.__static_initialized||(n.__static_initialized=!0,n.__static_initializer_0())},n.defaultColors_$LI$=function(){return n.__static_initialize(),n.defaultColors=null==n.defaultColors?{}:n.defaultColors},n.__static_initializer_0=function(){n.defaultColors_$LI$()[0]="#000000",n.defaultColors_$LI$()[1]="#FFFFFF",n.defaultColors_$LI$()[2]="#FF0000",n.defaultColors_$LI$()[3]="#00FF00",n.defaultColors_$LI$()[4]="#0000FF",n.defaultColors_$LI$()[5]="#FFFF00",n.defaultColors_$LI$()[6]="#FF00FF",n.defaultColors_$LI$()[7]="#00FFFF",n.defaultColors_$LI$()[8]="#800000",n.defaultColors_$LI$()[9]="#008000",n.defaultColors_$LI$()[10]="#000080",n.defaultColors_$LI$()[11]="#808000",n.defaultColors_$LI$()[12]="#800080",n.defaultColors_$LI$()[13]="#008080",n.defaultColors_$LI$()[14]="#C0C0C0",n.defaultColors_$LI$()[15]="#E6E6E6",n.defaultColors_$LI$()[16]="#CDCDCD",n.defaultColors_$LI$()[17]="#B3B3B3",n.defaultColors_$LI$()[18]="#9A9A9A",n.defaultColors_$LI$()[19]="#808080",n.defaultColors_$LI$()[20]="#666666",n.defaultColors_$LI$()[21]="#4D4D4D",n.defaultColors_$LI$()[22]="#333333",n.defaultColors_$LI$()[23]="#1A1A1A"},n.prototype.initialise=function(t,e){if(null!=t){var n=t.getElementsByTagName(x.mxgraph.io.vsdx.mxVsdxConstants.COLORS);if(0<n.length)for(var s=n.item(0).getElementsByTagName(x.mxgraph.io.vsdx.mxVsdxConstants.COLOR_ENTRY),i=s.length,r=0;r<i;r++){var a=s.item(r),o=a.getAttribute(x.mxgraph.io.vsdx.mxVsdxConstants.INDEX),a=a.getAttribute(x.mxgraph.io.vsdx.mxVsdxConstants.RGB);this.colorElementMap[o]=a}t=t.getElementsByTagName(x.mxgraph.io.vsdx.mxVsdxConstants.FACE_NAMES);if(0<t.length)for(var l=t.item(0).getElementsByTagName(x.mxgraph.io.vsdx.mxVsdxConstants.FACE_NAME),u=l.length,r=0;r<u;r++){var h=l.item(r),g=h.getAttribute(x.mxgraph.io.vsdx.mxVsdxConstants.ID),h=h.getAttribute(x.mxgraph.io.vsdx.mxVsdxConstants.FONT_NAME);this.fontElementMap[g]=h}}},n.prototype.getColor=function(t){var e=this.colorElementMap[t]||null;return null==e&&null==(e=n.defaultColors_$LI$()[t]||null)?"":e},n.prototype.getFont=function(t){t=this.fontElementMap[t]||null;return null==t?"":t},(e=n).__static_initialized=!1,(t.mxPropertiesManager=e).__class="com.mxgraph.io.vsdx.mxPropertiesManager"}(com=com||{}),function(a){var t,e;function n(t){this.fromSheet=null,this.sourceToSheet=null,this.sourceToPart=-1,this.targetToSheet=null,this.targetToPart=-1,this.fromCell=null,this.endShape=null;var e=t.getAttribute(a.mxgraph.io.vsdx.mxVsdxConstants.FROM_SHEET);this.fromSheet=null!=e&&0!==e.length?parseFloat(e):-1;e=t.getAttribute(a.mxgraph.io.vsdx.mxVsdxConstants.FROM_CELL);this.addFromCell(t,e)}t=a.mxgraph||(a.mxgraph={}),t=(e=t.io||(t.io={})).vsdx||(e.vsdx={}),n.prototype.addFromCell=function(t,e){var n,s,i=t.getAttribute(a.mxgraph.io.vsdx.mxVsdxConstants.TO_SHEET),r=!0;null!=e&&(n=e,s=a.mxgraph.io.vsdx.mxVsdxConstants.BEGIN_X,n&&n.equals?n.equals(s):n===s)?(this.sourceToSheet=null!=i&&0!==i.length?parseFloat(i):-1,r=!0):null!=e&&(s=e,e=a.mxgraph.io.vsdx.mxVsdxConstants.END_X,s&&s.equals?s.equals(e):s===e)?(this.targetToSheet=null!=i&&0!==i.length?parseFloat(i):-1,r=!1):null==this.sourceToSheet?(this.sourceToSheet=null!=i&&0!==i.length?parseFloat(i):-1,r=!0):null==this.targetToSheet&&(this.targetToSheet=null!=i&&0!==i.length?parseFloat(i):-1,r=!1),this.findToPart(t,r)},n.prototype.findToPart=function(t,e){t=t.getAttribute(a.mxgraph.io.vsdx.mxVsdxConstants.TO_PART),t=null!=t&&0!==t.length?parseFloat(t):-1;e?this.sourceToPart=t:this.targetToPart=t},n.prototype.getFromSheet=function(){return this.fromSheet},n.prototype.getSourceToSheet=function(){return this.sourceToSheet},n.prototype.getTargetToSheet=function(){return this.targetToSheet},n.prototype.getSourceToPart=function(){return this.sourceToPart},n.prototype.getTargetToPart=function(){return this.targetToPart},n.prototype.addConnect=function(t){var e=(this.endShape=t).getAttribute(a.mxgraph.io.vsdx.mxVsdxConstants.FROM_CELL);this.addFromCell(t,e)},e=n,(t.mxVsdxConnect=e).__class="com.mxgraph.io.vsdx.mxVsdxConnect"}(com=com||{}),function(t){var e;function n(){}e=t.mxgraph||(t.mxgraph={}),e=(t=e.io||(e.io={})).vsdx||(t.vsdx={}),n.SET_VALUES_$LI$=function(){return n.SET_VALUES=null==n.SET_VALUES?["a","b"]:n.SET_VALUES},n.MY_SET_$LI$=function(){return n.MY_SET=null==n.MY_SET?n.SET_VALUES_$LI$().slice(0).slice(0):n.MY_SET},(t=n).ANGLE="Angle",t.ARC_TO="ArcTo",t.BACKGROUND="Background",t.BACK_PAGE="BackPage",t.BEGIN_ARROW="BeginArrow",t.BEGIN_ARROW_SIZE="BeginArrowSize",t.BEGIN_X="BeginX",t.BEGIN_Y="BeginY",t.BOTTOM_MARGIN="BottomMargin",t.BULLET="Bullet",t.CASE="Case",t.CHARACTER="Character",t.COLOR="Color",t.COLOR_ENTRY="ColorEntry",t.COLORS="Colors",t.COLOR_TRANS="ColorTrans",t.CONNECT="Connect",t.CONNECTS="Connects",t.CONNECTION="Connection",t.CONTROL="Control",t.DELETED="Del",t.DOCUMENT_SHEET="DocumentSheet",t.ELLIPSE="Ellipse",t.ELLIPTICAL_ARC_TO="EllipticalArcTo",t.END_ARROW="EndArrow",t.END_ARROW_SIZE="EndArrowSize",t.END_X="EndX",t.END_Y="EndY",t.FACE_NAME="FaceName",t.FACE_NAMES="FaceNames",t.FALSE="0",t.FILL="Fill",t.FILL_BKGND="FillBkgnd",t.FILL_BKGND_TRANS="FillBkgndTrans",t.FILL_FOREGND="FillForegnd",t.FILL_FOREGND_TRANS="FillForegndTrans",t.FILL_PATTERN="FillPattern",t.FILL_STYLE="FillStyle",t.FILL_GRADIENT_ENABLED="FillGradientEnabled",t.FLAGS="Flags",t.FLIP_X="FlipX",t.FLIP_Y="FlipY",t.FONT="Font",t.FONT_NAME="Name",t.FOREIGN="Foreign",t.FROM_CELL="FromCell",t.FROM_SHEET="FromSheet",t.GEOM="Geom",t.HEIGHT="Height",t.HORIZONTAL_ALIGN="HorzAlign",t.ID="ID",t.INDENT_FIRST="IndFirst",t.INDENT_LEFT="IndLeft",t.INDENT_RIGHT="IndRight",t.INDEX="IX",t.LEFT_MARGIN="LeftMargin",t.LETTER_SPACE="Letterspace",t.LINE="Line",t.LINE_COLOR="LineColor",t.LINE_COLOR_TRANS="LineColorTrans",t.LINE_PATTERN="LinePattern",t.LINE_STYLE="LineStyle",t.LINE_TO="LineTo",t.LINE_WEIGHT="LineWeight",t.LOC_PIN_X="LocPinX",t.LOC_PIN_Y="LocPinY",t.MASTER="Master",t.MASTER_SHAPE="MasterShape",t.MASTERS="Masters",t.MOVE_TO="MoveTo",t.NAME="Name",t.NAME_U="NameU",t.NO_LINE="NoLine",t.NURBS_TO="NURBSTo",t.PAGE="Page",t.PAGE_HEIGHT="PageHeight",t.PAGE_WIDTH="PageWidth",t.PAGES="Pages",t.PARAGRAPH="Paragraph",t.PIN_X="PinX",t.PIN_Y="PinY",t.POS="Pos",t.RGB="RGB",t.RIGHT_MARGIN="RightMargin",t.ROUNDING="Rounding",t.RTL_TEXT="RTLText",t.SIZE="Size",t.SHAPE="Shape",t.SHAPES="Shapes",t.SHAPE_SHDW_SHOW="ShapeShdwShow",t.SHDW_PATTERN="ShdwPattern",t.SPACE_AFTER="SpAfter",t.SPACE_BEFORE="SpBefore",t.SPACE_LINE="SpLine",t.STRIKETHRU="Strikethru",t.STYLE="Style",t.STYLE_SHEET="StyleSheet",t.STYLE_SHEETS="StyleSheets",t.TEXT="Text",t.TEXT_BKGND="TextBkgnd",t.TEXT_BLOCK="TextBlock",t.TEXT_STYLE="TextStyle",t.TO_PART="ToPart",t.TO_SHEET="ToSheet",t.TOP_MARGIN="TopMargin",t.TRUE="1",t.TXT_ANGLE="TxtAngle",t.TXT_HEIGHT="TxtHeight",t.TXT_LOC_PIN_X="TxtLocPinX",t.TXT_LOC_PIN_Y="TxtLocPinY",t.TXT_PIN_X="TxtPinX",t.TXT_PIN_Y="TxtPinY",t.TXT_WIDTH="TxtWidth",t.TYPE="Type",t.TYPE_GROUP="Group",t.TYPE_SHAPE="Shape",t.UNIQUE_ID="UniqueID",t.VERTICAL_ALIGN="VerticalAlign",t.WIDTH="Width",t.X_CON="XCon",t.X_DYN="XDyn",t.X="X",t.Y_CON="YCon",t.Y_DYN="YDyn",t.Y="Y",t.HIDE_TEXT="HideText",t.VSDX_ID="vsdxID",t.CONNECT_TO_PART_WHOLE_SHAPE=3,(e.mxVsdxConstants=t).__class="com.mxgraph.io.vsdx.mxVsdxConstants"}(com=com||{}),function(d){var t,e;function y(t,e){var n=this;if(this.noFill=!1,this.noLine=!1,this.noShow=!1,this.noSnap=!1,this.noQuickDrag=!1,((this.rows=null)!=t&&1==t.nodeType||null===t)&&(null!=e&&e instanceof Array||null===e)){Array.prototype.slice.call(arguments);this.index=0,this.noFill=!1,this.noLine=!1,this.noShow=!1,this.noSnap=!1,this.noQuickDrag=!1,this.rows=null,this.index=0,n.index=n.getIndex$org_w3c_dom_Element(t),null!=e&&n.index<e.length&&n.inheritGeo(e[n.index]),n.processGeoElem(t)}else{if((null==t||1!=t.nodeType)&&null!==t||void 0!==e)throw new Error("invalid overload");Array.prototype.slice.call(arguments);this.index=0,this.noFill=!1,this.noLine=!1,this.noShow=!1,this.noSnap=!1,this.noQuickDrag=!1,this.rows=null,this.index=0,n.index=n.getIndex$org_w3c_dom_Element(t),n.processGeoElem(t)}}function n(t){this.__parent=t}t=d.mxgraph||(d.mxgraph={}),t=(e=t.io||(t.io={})).vsdx||(e.vsdx={}),y.prototype.getIndex$org_w3c_dom_Element=function(t){try{return parseInt(t.getAttribute("IX"))||0}catch(t){return 0}},y.prototype.getIndex=function(t){if(null!=t&&1==t.nodeType||null===t)return this.getIndex$org_w3c_dom_Element(t);if(void 0===t)return this.getIndex$();throw new Error("invalid overload")},y.prototype.processGeoElem=function(t){var e=d.mxgraph.io.vsdx.mxVsdxUtils.getDirectChildNamedElements(t,"Cell"),n=d.mxgraph.io.vsdx.mxVsdxUtils.getDirectChildNamedElements(t,"Row");if(null==this.rows){this.rows=[];for(var s=0;s<n.length;s++)this.rows.push(null)}for(var i,r,a,o=0;o<e.length;o++){var l=e[o],u=l.getAttribute("N"),h=l.getAttribute("V");switch(u){case"NoFill":this.noFill=(a=h,"1".equals?"1".equals(a):"1"===a);break;case"NoLine":this.noLine=(r=h,"1".equals?"1".equals(r):"1"===r);break;case"NoShow":this.noShow=(r=h,"1".equals?"1".equals(r):"1"===r);break;case"NoSnap":this.noSnap=(i=h,"1".equals?"1".equals(i):"1"===i);break;case"NoQuickDrag":this.noQuickDrag=(i=h,"1".equals?"1".equals(i):"1"===i)}}for(var g,x=this.rows.length,m=!1,p=0;p<n.length;p++){var c=n[p],c=d.mxgraph.io.vsdx.geometry.RowFactory.getRowObj(c,this.rows);c.getIndex()>x?(this.rows.push(c),m=!0):this.rows[c.getIndex()-1]=c}m&&(t=this.rows,(g=new y.mxVsdxGeometry$0(this)).compare?t.sort(function(t,e){return g.compare(t,e)}):t.sort(g))},y.prototype.inheritGeo=function(t){var e;this.noFill=t.noFill,this.noLine=t.noLine,this.noShow=t.noShow,this.noSnap=t.noSnap,this.noQuickDrag=t.noQuickDrag,this.rows=[],e=this.rows,t=t.rows,e.push.apply(e,t)},y.prototype.getIndex$=function(){return this.index},y.prototype.isNoFill=function(){return this.noFill},y.prototype.isNoLine=function(){return this.noLine},y.prototype.isNoShow=function(){return this.noShow},y.prototype.isNoSnap=function(){return this.noSnap},y.prototype.isNoQuickDrag=function(){return this.noQuickDrag},y.prototype.getRows=function(){return this.rows},y.prototype.getPathXML=function(e,n){if(this.noShow)return"";for(var s={str:"",toString:function(){return this.str}},i=this,t=0;t<this.rows.length;t++)!function(t){t=i.rows[t];s.str=s.str.concat(null!=t?t.handle(e,n):"")}(t);return s.str},e=y,(t.mxVsdxGeometry=e).__class="com.mxgraph.io.vsdx.mxVsdxGeometry",t=e=t.mxVsdxGeometry||(t.mxVsdxGeometry={}),n.prototype.compare=function(t,e){return(null!=t?t.getIndex():0)-(null!=e?e.getIndex():0)},e=n,(t.mxVsdxGeometry$0=e).__interfaces=["java.util.Comparator"]}(com=com||{}),function(m){var t,e;function s(t){var e;this.geomList=[],this.parentGeomList=null,this.sortNeeded=!1,null!=t&&(this.parentGeomList=t.geomList,e=this.geomList,t=t.geomList,e.push.apply(e,t))}function n(t){this.__parent=t}t=m.mxgraph||(m.mxgraph={}),t=(e=t.io||(t.io={})).vsdx||(e.vsdx={}),s.prototype.addGeometry=function(t){t=new m.mxgraph.io.vsdx.mxVsdxGeometry(t,this.parentGeomList);t.getIndex()<this.geomList.length?this.geomList[t.getIndex()]=t:(this.geomList.push(t),this.sortNeeded=!0)},s.prototype.sort=function(){var t,n;this.sortNeeded&&(t=this.geomList,(n=new s.mxVsdxGeometryList$0(this)).compare?t.sort(function(t,e){return n.compare(t,e)}):t.sort(n),this.sortNeeded=!1)},s.prototype.isNoShow=function(){for(var t=0;t<this.geomList.length;t++)if(!this.geomList[t].isNoShow())return!1;return!0},s.prototype.isNoFill=function(){for(var t=0;t<this.geomList.length;t++){var e=this.geomList[t];if(!e.isNoShow()&&!e.isNoFill())return!1}return!0},s.prototype.isNoLine=function(){for(var t=0;t<this.geomList.length;t++){var e=this.geomList[t];if(!e.isNoShow()&&!e.isNoLine())return!1}return!0},s.prototype.hasGeom=function(){return!(0==this.geomList.length)},s.prototype.getGeoCount=function(){for(var t=0,e=0;e<this.geomList.length;e++)this.geomList[e].isNoShow()||t++;return t},s.prototype.rotatedPoint=function(t,e,n){var s=t.x*e-t.y*n,n=t.y*e+t.x*n;t.x=s,t.y=n},s.prototype.getRoutingPoints=function(t,e,n){this.sort();var s=[];s.push(e.clone());for(var i=0,r=0,a=0;a<this.geomList.length;a++){var o=this.geomList[a];if(!o.isNoShow())for(var l=o.getRows(),u=0;u<l.length;u++){var h,g,x=l[u];0==u&&null!=x&&x instanceof m.mxgraph.io.vsdx.geometry.MoveTo?(i=null!=x.x?x.x:0,r=null!=x.y?x.y:0):null!=x&&x instanceof m.mxgraph.io.vsdx.geometry.LineTo&&(h=null!=x.x?x.x:0,g=null!=x.y?x.y:0,x=new mxPoint(h,g),0!==n&&(n=(360-n)*Math.PI/180,this.rotatedPoint(x,Math.cos(n),Math.sin(n))),h=(x.x-i)*m.mxgraph.io.vsdx.mxVsdxUtils.conversionFactor_$LI$(),h+=e.x,g=(x.y-r)*m.mxgraph.io.vsdx.mxVsdxUtils.conversionFactor_$LI$()*-1,g+=e.y,h=Math.round(100*h)/100,g=Math.round(100*g)/100,x.x=h,x.y=g,s.push(x))}}return s},s.prototype.getShapeXML=function(t){var e=new mxPoint(0,0),n={str:'<shape strokewidth="inherit"><foreground>',toString:function(){return this.str}},s=n.str.length,i=this.processGeo(t,e,n,-1,!0);return i=this.processGeo(t,e,n,i,!1),n.str.length===s?"":(this.closePath(n,i),n.str=n.str.concat("</foreground></shape>"))},s.prototype.processGeo=function(n,s,i,r,a){var t=n.getRounding(),o="";0<t&&(o=' rounded="1" arcSize="'+t*m.mxgraph.io.vsdx.mxVsdxUtils.conversionFactor+'" ');for(var l=this,e=0;e<this.geomList.length;e++)!function(t){var e=l.geomList[t];if(a===e.isNoFill())return;t=e.getPathXML(s,n);0!==t.length&&(e=l.getGeoStyle(e),-1===r?i.str=i.str.concat("<path"+o+">"):r!==e&&(l.closePath(i,r),i.str=i.str.concat("<path"+o+">")),i.str=i.str.concat(t),r=e)}(e);return r},s.prototype.getGeoStyle=function(t){var e=0;return t.isNoLine()||t.isNoFill()?t.isNoFill()?t.isNoLine()||(e=3):e=2:e=1,e},s.prototype.closePath=function(t,e){t.str=t.str.concat("</path>"),1===e?t.str=t.str.concat("<fillstroke/>"):2===e?t.str=t.str.concat("<fill/>"):3===e&&(t.str=t.str.concat("<stroke/>"))},e=s,(t.mxVsdxGeometryList=e).__class="com.mxgraph.io.vsdx.mxVsdxGeometryList",t=e=t.mxVsdxGeometryList||(t.mxVsdxGeometryList={}),n.prototype.compare=function(t,e){return t.getIndex()-e.getIndex()},e=n,(t.mxVsdxGeometryList$0=e).__interfaces=["java.util.Comparator"]}(com=com||{}),function(g){var t,e;function n(t,e){this.Id=null,this.masterShape=null,this.childShapes={},this.master=null,this.master=t,this.Id=t.getAttribute(g.mxgraph.io.vsdx.mxVsdxConstants.ID)||"",this.processMasterShapes(e)}t=g.mxgraph||(g.mxgraph={}),t=(e=t.io||(t.io={})).vsdx||(e.vsdx={}),n.prototype.processMasterShapes=function(t){for(var e,n,s=this.master.firstChild;null!=s;){if(null!=s&&1==s.nodeType&&((o=s.nodeName)&&o.equals?o.equals("Rel"):"Rel"===o)){var i=t.getRelationship(s.getAttribute("r:id"),g.mxgraph.io.mxVsdxCodec.vsdxPlaceholder+"/masters/_rels/masters.xml.rels"),r=i.getAttribute("Target"),a=i.getAttribute("Type"),o=null;if(null!=(o=null!=a&&(i=void 0,i=(a=a).length-"master".length,-1!==(a=a.indexOf("master",i))&&a===i)?t.getXmlDoc(g.mxgraph.io.mxVsdxCodec.vsdxPlaceholder+"/masters/"+r):o))for(var l=o.firstChild;null!=l;){if(null!=l&&1==l.nodeType&&(e=l.nodeName,n="MasterContents",e&&e.equals?e.equals(n):e===n)){this.processMasterShape(l,t);break}l=l.nextSibling}}else if(1==s.nodeType&&"PageSheet"==s.nodeName){this.pageSheet={};for(var u=g.mxgraph.io.vsdx.mxVsdxUtils.getDirectChildNamedElements(s,"Cell"),h=0;h<u.length;h++)this.pageSheet[u[h].getAttribute("N")]=u[h]}s=s.nextSibling}},n.prototype.processMasterShape=function(t,e,n){n||(this.firstLevelShapes=[]);for(var s,i=t.firstChild;null!=i;){if(null!=i&&1==i.nodeType&&((s=i.nodeName)&&s.equals?s.equals("Shapes"):"Shapes"===s))for(var r,a,o,l=i.firstChild;null!=l;)null!=l&&1==l.nodeType&&((o=l.nodeName)&&o.equals?o.equals("Shape"):"Shape"===o)&&(a=(r=l).getAttribute("ID"),o=new g.mxgraph.io.vsdx.Shape(r,e),this.masterShape=null==this.masterShape?o:this.masterShape,this.childShapes[a]=o,n||this.firstLevelShapes.push(o),this.processMasterShape(r,e,!0)),l=l.nextSibling;else if(null!=i&&1==i.nodeType&&"Connects"==i.nodeName){this.connects={};for(var u,h=i.firstChild;null!=h;)null!=h&&1==h.nodeType&&"Connect"==h.nodeName&&(u=h,u=new g.mxgraph.io.vsdx.mxVsdxConnect(u),this.connects[u.getFromSheet()]=u),h=h.nextSibling}i=i.nextSibling}},n.prototype.getMasterShape=function(){return this.masterShape},n.prototype.getSubShape=function(t){return this.childShapes[t]||null},n.prototype.getNameU=function(){return this.master.getAttribute("NameU")||""},n.prototype.getName=function(){return this.master.getAttribute("Name")||""},n.prototype.getUniqueID=function(){var t="";return t=this.master.hasAttribute("UniqueID")?this.master.getAttribute("UniqueID"):t},n.prototype.getId=function(){return this.Id},n.prototype.getMasterElement=function(){return this.master},e=n,(t.mxVsdxMaster=e).__class="com.mxgraph.io.vsdx.mxVsdxMaster"}(com=com||{}),function(m){var t,e;function n(t,e,n){this.xmlDocs=null,this.media=null,this.pages=null,this.masters={},this.stylesheets={},this.themes={},this.rootElement=null,this.pm=null,this.xmlDocs=e,this.media=n;for(var s,i,r=t.firstChild;null!=r;){if(null!=r&&1==r.nodeType&&(s=r.tagName.toLowerCase(),i=m.mxgraph.io.mxVsdxCodec.vsdxPlaceholder+"document",s&&s.equals?s.equals(i):s===i)){this.rootElement=r;break}r=r.nextSibling}this.pm=new m.mxgraph.io.vsdx.mxPropertiesManager,this.pm.initialise(this.rootElement,this),this.initStylesheets(),this.initThemes(),this.initMasters(),this.initPages()}t=m.mxgraph||(m.mxgraph={}),t=(e=t.io||(t.io={})).vsdx||(e.vsdx={}),n.prototype.initThemes=function(){if(null!=this.xmlDocs)for(var t=!0,e=1;t;){var n=m.mxgraph.io.mxVsdxCodec.vsdxPlaceholder+"/theme/theme"+e+".xml",n=this.xmlDocs[n]||null;if(null!=n){for(var s=n.firstChild;null!=s;){if(null!=s&&1==s.nodeType&&(i=s.tagName,r="a:theme",i&&i.equals?i.equals(r):i===r)){i=new m.mxgraph.io.vsdx.mxVsdxTheme(s);i.getThemeIndex()<0&&i.processTheme();r=function(t,e){null==t.entries&&(t.entries=[]);for(var n=0;n<t.entries.length;n++)if(null!=t.entries[n].key.equals&&t.entries[n].key.equals(e)||t.entries[n].key===e)return t.entries[n].value;return null}(this.themes,i.getThemeIndex());null!=r&&r.isPure()||function(t,e,n){null==t.entries&&(t.entries=[]);for(var s=0;s<t.entries.length;s++)if(null!=t.entries[s].key.equals&&t.entries[s].key.equals(e)||t.entries[s].key===e)return t.entries[s].value=n;t.entries.push({key:e,value:n,getKey:function(){return this.key},getValue:function(){return this.value}})}(this.themes,i.getThemeIndex(),i);break}s=s.nextSibling}e++}else t=!1}var i,r},n.prototype.initStylesheets=function(){var t=this.rootElement.getElementsByTagName(m.mxgraph.io.vsdx.mxVsdxConstants.STYLE_SHEETS);if(0<t.length)for(var e=t.item(0).getElementsByTagName(m.mxgraph.io.vsdx.mxVsdxConstants.STYLE_SHEET),n=e.length,s=0;s<n;s++){var i=(u=e.item(s)).getAttribute(m.mxgraph.io.vsdx.mxVsdxConstants.ID),r=new m.mxgraph.io.vsdx.Style(u,this);this.stylesheets[i]=r}for(var a,o,l,u,t=(a=this.stylesheets,Object.keys(a).map(function(t){return a[t]})),h=(o=t,l=0,{next:function(){return l<o.length?o[l++]:null},hasNext:function(){return l<o.length}});h.hasNext();)(u=h.next()).stylesheetRefs(this)},n.prototype.initMasters=function(){if(null!=this.xmlDocs){var t=m.mxgraph.io.mxVsdxCodec.vsdxPlaceholder+"/masters/masters.xml",t=this.xmlDocs[t]||null;if(null!=t)for(var e=t.firstChild;null!=e;){if(null!=e&&1==e.nodeType&&(i=e.tagName,r=m.mxgraph.io.vsdx.mxVsdxConstants.MASTERS,i&&i.equals?i.equals(r):i===r)){for(var n=e.firstChild;null!=n;)null!=n&&1==n.nodeType&&((s=n.tagName)&&s.equals?s.equals("Master"):"Master"===s)&&(s=n,s=new m.mxgraph.io.vsdx.mxVsdxMaster(s,this),this.masters[s.getId()]=s),n=n.nextSibling;break}e=e.nextSibling}}var s,i,r},n.prototype.initPages=function(){if(null!=this.xmlDocs){var t=m.mxgraph.io.mxVsdxCodec.vsdxPlaceholder+"/pages/pages.xml",t=this.xmlDocs[t]||null;if(null!=t)for(var e=t.firstChild;null!=e;){if(null!=e&&1==e.nodeType&&(g=e.tagName,x=m.mxgraph.io.vsdx.mxVsdxConstants.PAGES,g&&g.equals?g.equals(x):g===x)){var n=e.getElementsByTagName(m.mxgraph.io.vsdx.mxVsdxConstants.PAGE);if(null!=n&&0<n.length){this.pages={};for(var s={},i=n.length,r=0;r<i;r++){var a=n.item(r);(u=this.createPage(a)).isBackground()&&function(t,e,n){null==t.entries&&(t.entries=[]);for(var s=0;s<t.entries.length;s++)if(null!=t.entries[s].key.equals&&t.entries[s].key.equals(e)||t.entries[s].key===e)return t.entries[s].value=n;t.entries.push({key:e,value:n,getKey:function(){return this.key},getValue:function(){return this.value}})}(s,u.getId(),u),function(t,e,n){null==t.entries&&(t.entries=[]);for(var s=0;s<t.entries.length;s++)if(null!=t.entries[s].key.equals&&t.entries[s].key.equals(e)||t.entries[s].key===e)return t.entries[s].value=n;t.entries.push({key:e,value:n,getKey:function(){return this.key},getValue:function(){return this.value}})}(this.pages,u.getId(),u)}for(var o=(null==(x=this.pages).entries&&(x.entries=[]),x.entries),l=0;l<o.length;l++){var u,h=(u=o[l].getValue()).getBackPageId();null!=h&&(h=function(t,e){null==t.entries&&(t.entries=[]);for(var n=0;n<t.entries.length;n++)if(null!=t.entries[n].key.equals&&t.entries[n].key.equals(e)||t.entries[n].key===e)return t.entries[n].value;return null}(s,h),u.setBackPage(h))}}break}e=e.nextSibling}}var g,x},n.prototype.getPages=function(){return this.pages},n.prototype.getThemes=function(){return this.themes},n.prototype.getRelationship=function(t,e){e=this.xmlDocs[e]||null;if(null==e||null==t||0===t.length)return null;for(var n,s=e.getElementsByTagName("Relationship"),i=0;i<s.length;i++){var r=s.item(i),a=r.getAttribute("Id");if(n=t,(a=a)&&a.equals?a.equals(n):a===n)return r}return null},n.prototype.getMaster=function(t){return this.masters[t]||null},n.prototype.createPage=function(t){return new m.mxgraph.io.vsdx.mxVsdxPage(t,this)},n.prototype.getPropertiesManager=function(){return this.pm},n.prototype.setPropertiesManager=function(t){this.pm=t},n.prototype.getMasterShapes=function(){return this.masters},n.prototype.setMasterShapes=function(t){this.masters=t},n.prototype.getStylesheet=function(t){return this.stylesheets[t]||null},n.prototype.getXmlDoc=function(t){return this.xmlDocs[t]||null},n.prototype.getMedia=function(t){return this.media[t]||null},e=n,(t.mxVsdxModel=e).__class="com.mxgraph.io.vsdx.mxVsdxModel"}(com=com||{}),function(d){var t,e;function n(t,e){this.Id=null,this.pageName=null,this.__isBackground=!1,this.backPageId=null,this.backPage=null,this.pageElement=null,this.pageSheet=null,this.model=null,this.shapes={},this.connects={},this.cellElements={},this.model=e,this.pageElement=t,this.layers=[];var n=t.getAttribute(d.mxgraph.io.vsdx.mxVsdxConstants.BACKGROUND);this.__isBackground=!(null==n||(n=n,s=d.mxgraph.io.vsdx.mxVsdxConstants.TRUE,n&&n.equals?!n.equals(s):n!==s));var s=t.getAttribute(d.mxgraph.io.vsdx.mxVsdxConstants.BACK_PAGE);null!=s&&0<s.length&&(this.backPageId=parseFloat(s)),this.Id=parseFloat(t.getAttribute(d.mxgraph.io.vsdx.mxVsdxConstants.ID)),this.pageName=t.getAttribute(d.mxgraph.io.vsdx.mxVsdxConstants.NAME)||"";s=d.mxgraph.io.vsdx.mxVsdxUtils.getDirectChildNamedElements(t,"PageSheet");if(0<s.length){for(var s=s[0],i=d.mxgraph.io.vsdx.mxVsdxUtils.getDirectChildNamedElements(s,"Cell"),r=0;r<i.length;r++){var a=i[r],o=a.getAttribute("N");this.cellElements[o]=a}for(var l=d.mxgraph.io.vsdx.mxVsdxUtils.getDirectChildNamedElements(s,"Section"),u=0;u<l.length;u++){var h=l[u];if("Layer"==(o=h.getAttribute("N")))for(var g=d.mxgraph.io.vsdx.mxVsdxUtils.getDirectChildNamedElements(h,"Row"),x=0;x<g.length;x++){for(var m=d.mxgraph.io.vsdx.mxVsdxUtils.getDirectChildNamedElements(g[x],"Cell"),p={},c=0;c<m.length;c++)p[m[c].getAttribute("N")]=m[c].getAttribute("V");this.layers[parseInt(g[x].getAttribute("IX"))]=p}}}this.parseNodes(t,e,"pages")}t=d.mxgraph||(d.mxgraph={}),t=(e=t.io||(t.io={})).vsdx||(e.vsdx={}),n.prototype.parseNodes=function(t,e,n){for(var s,i,r=t.firstChild;null!=r;){if(null!=r&&1==r.nodeType){var a=r,o=a.nodeName;if((i=o)&&i.equals?i.equals("Rel"):"Rel"===i)this.resolveRel(a,e,n);else if((s=o)&&s.equals?s.equals("Shapes"):"Shapes"===s)this.shapes=this.parseShapes(a,null,!1);else if(i="Connects",(s=o)&&s.equals?s.equals(i):s===i)for(var l,u,h,g=a.getElementsByTagName(d.mxgraph.io.vsdx.mxVsdxConstants.CONNECT),x=null!=g&&0<g.length?g.item(0):null;null!=x;)null!=x&&1==x.nodeType&&(l=x,null!=(h=null!=(h=(u=new d.mxgraph.io.vsdx.mxVsdxConnect(l)).getFromSheet())&&-1<h?function(t,e){null==t.entries&&(t.entries=[]);for(var n=0;n<t.entries.length;n++)if(null!=t.entries[n].key.equals&&t.entries[n].key.equals(e)||t.entries[n].key===e)return t.entries[n].value;return null}(this.connects,h):null)?h.addConnect(l):function(t,e,n){null==t.entries&&(t.entries=[]);for(var s=0;s<t.entries.length;s++)if(null!=t.entries[s].key.equals&&t.entries[s].key.equals(e)||t.entries[s].key===e)return t.entries[s].value=n;t.entries.push({key:e,value:n,getKey:function(){return this.key},getValue:function(){return this.value}})}(this.connects,u.getFromSheet(),u)),x=x.nextSibling;else g="PageSheet",((o=o)&&o.equals?o.equals(g):o===g)&&(this.pageSheet=a)}r=r.nextSibling}},n.prototype.resolveRel=function(t,e,n){var s,i=e.getRelationship(t.getAttribute("r:id"),d.mxgraph.io.mxVsdxCodec.vsdxPlaceholder+"/pages/_rels/"+n+".xml.rels"),r=i.getAttribute("Target"),t=i.getAttribute("Type");if(n=new String(t).toString(),i=n.length-"page".length,-1!==(n=n.indexOf("page",i))&&n===i){n=null;if(null!=(n=null!=t&&(t=(i=t).length-"page".length,-1!==(i=i.indexOf("page",t))&&i===t)?e.getXmlDoc(d.mxgraph.io.mxVsdxCodec.vsdxPlaceholder+"/pages/"+r):n))for(var a=n.firstChild;null!=a;){if(null!=a&&1==a.nodeType&&(s=a.tagName,o="PageContents",s&&s.equals?s.equals(o):s===o)){var o=r.indexOf(".");-1!==o&&this.parseNodes(a,e,r.substring(0,o));break}a=a.nextSibling}}},n.prototype.parseShapes=function(t,e,n){for(var s,i,r,a,o,l,u={},t=t.getElementsByTagName(d.mxgraph.io.vsdx.mxVsdxConstants.SHAPE),h=null!=t&&0<t.length?t.item(0):null;null!=h;)null!=h&&1==h.nodeType&&(s=h,null==(a=e)&&(null==(r=s.getAttribute(d.mxgraph.io.vsdx.mxVsdxConstants.MASTER))||((l=r)&&l.equals?l.equals(""):""===l)||(a=this.model.getMaster(r))),(i=this.isEdge(s))||null==a||(r=s.getAttribute(d.mxgraph.io.vsdx.mxVsdxConstants.MASTER_SHAPE),l=a.getMasterElement(),null==r||((o=r)&&o.equals?o.equals(""):""===o)||(l=null!=(o=a.getSubShape(r))?o.getShape():l),i=this.isEdge(l)),function(t,e,n){null==t.entries&&(t.entries=[]);for(var s=0;s<t.entries.length;s++)if(null!=t.entries[s].key.equals&&t.entries[s].key.equals(e)||t.entries[s].key===e)return t.entries[s].value=n;t.entries.push({key:e,value:n,getKey:function(){return this.key},getValue:function(){return this.value}})}(u,(a=this.createCell(s,!i,a)).getId(),a)),h=h.nextSibling;return u},n.prototype.createCell=function(t,e,n){return new d.mxgraph.io.vsdx.VsdxShape(this,t,e,this.model.getMasterShapes(),n,this.model)},n.prototype.isEdge=function(t){if(null!=t){t=t.childNodes;if(null!=t)for(var e=t.item(0);null!=e;){if(null!=e&&1==e.nodeType){var n=e;if((i=n.nodeName)&&i.equals?i.equals("Cell"):"Cell"===i){i=n.getAttribute("N");if(((n=i)&&n.equals?n.equals("BeginX"):"BeginX"===n)||((s=i)&&s.equals?s.equals("BeginY"):"BeginY"===s)||((s=i)&&s.equals?s.equals("EndY"):"EndY"===s)||((i=i)&&i.equals?i.equals("EndX"):"EndX"===i))return!0}}e=e.nextSibling}}var s,i;return!1},n.prototype.getPageDimensions=function(){var t=0,e=0,n=this.cellElements["PageHeight"]||null,s=this.cellElements["PageWidth"]||null;return null!=n&&(t=parseFloat(n.getAttribute("V"))*d.mxgraph.io.vsdx.mxVsdxUtils.conversionFactor_$LI$(),t=Math.round(100*t)/100),null!=s&&(e=parseFloat(s.getAttribute("V"))*d.mxgraph.io.vsdx.mxVsdxUtils.conversionFactor_$LI$(),e=Math.round(100*e)/100),new mxPoint(e,t)},n.prototype.getDrawingScale=function(){var t=this.cellElements["DrawingScale"]||null;return null!=t?parseFloat(t.getAttribute("V"))*d.mxgraph.io.vsdx.mxVsdxUtils.conversionFactor_$LI$():1},n.prototype.getPageScale=function(){var t=this.cellElements["PageScale"]||null;return null!=t?parseFloat(t.getAttribute("V"))*d.mxgraph.io.vsdx.mxVsdxUtils.conversionFactor_$LI$():1},n.prototype.getCellValue=function(t){t=this.cellElements[t]||null;return null!=t?t.getAttribute("V")||"":null},n.prototype.getCellIntValue=function(t,e){t=this.getCellValue(t);return null!=t?parseInt(t):e},n.prototype.getId=function(){return this.Id},n.prototype.getPageName=function(){return this.pageName},n.prototype.getShapes=function(){return this.shapes},n.prototype.getLayers=function(){return this.layers},n.prototype.getConnects=function(){return this.connects},n.prototype.isBackground=function(){return this.__isBackground},n.prototype.getBackPageId=function(){return this.backPageId},n.prototype.setBackPage=function(t){this.backPage=t},n.prototype.getBackPage=function(){return this.backPage},e=n,(t.mxVsdxPage=e).__class="com.mxgraph.io.vsdx.mxVsdxPage"}(com=com||{}),function(b){var t,e;function l(t){var s,i,r,a,o;this.themeIndex=-1,this.themeVariant=0,this.baseColors={},this.variantsColors=(s=function(t){if(0!=t.length){for(var e=[],n=0;n<t[0];n++)e.push(s(t.slice(1)));return e}})([4,7]),this.isMonotoneVariant=new Array(4),this.defaultClr=new b.mxgraph.io.vsdx.theme.Color(255,255,255),this.defaultLineClr=new b.mxgraph.io.vsdx.theme.Color(0,0,0),this.defaultLineStyle=new b.mxgraph.io.vsdx.theme.LineStyle,this.fillStyles=[],this.connFillStyles=[],this.lineStyles=[],this.connLineStyles=[],this.lineStylesExt=[],this.connLineStylesExt=[],this.connFontColors=[],this.connFontStyles=[],this.fontColors=[],this.fontStyles=[],this.variantEmbellishment=[0,0,0,0],this.variantFillIdx=(i=function(t){if(0==t.length)return 0;for(var e=[],n=0;n<t[0];n++)e.push(i(t.slice(1)));return e})([4,4]),this.variantLineIdx=(r=function(t){if(0==t.length)return 0;for(var e=[],n=0;n<t[0];n++)e.push(r(t.slice(1)));return e})([4,4]),this.variantEffectIdx=(a=function(t){if(0==t.length)return 0;for(var e=[],n=0;n<t[0];n++)e.push(a(t.slice(1)));return e})([4,4]),this.variantFontIdx=(o=function(t){if(0==t.length)return 0;for(var e=[],n=0;n<t[0];n++)e.push(o(t.slice(1)));return e})([4,4]),this.isProcessed=!1,this.__isPure=!0,this.theme=null,this.bkgndColor=null,this.name=null,this.theme=t,this.name=t.getAttribute("name")||"";var e,t=(e=l.themesIds_$LI$(),t=this.name,e[t]||null);null!=t&&(this.themeIndex=t)}t=b.mxgraph||(b.mxgraph={}),t=(e=t.io||(t.io={})).vsdx||(e.vsdx={}),l.__static_initialize=function(){l.__static_initialized||(l.__static_initialized=!0,l.__static_initializer_0(),l.__static_initializer_1())},l.themesIds_$LI$=function(){return l.__static_initialize(),l.themesIds=null==l.themesIds?{}:l.themesIds},l.__static_initializer_0=function(){l.themesIds_$LI$().Office=33,l.themesIds_$LI$().Linear=34,l.themesIds_$LI$().Zephyr=35,l.themesIds_$LI$().Integral=36,l.themesIds_$LI$().Simple=37,l.themesIds_$LI$().Whisp=38,l.themesIds_$LI$().Daybreak=39,l.themesIds_$LI$().Parallel=40,l.themesIds_$LI$().Sequence=41,l.themesIds_$LI$().Slice=42,l.themesIds_$LI$().Ion=43,l.themesIds_$LI$().Retrospect=44,l.themesIds_$LI$().Organic=45,l.themesIds_$LI$().Bubble=46,l.themesIds_$LI$().Clouds=47,l.themesIds_$LI$().Gemstone=48,l.themesIds_$LI$().Lines=49,l.themesIds_$LI$().Facet=50,l.themesIds_$LI$().Prominence=51,l.themesIds_$LI$().Smoke=52,l.themesIds_$LI$().Radiance=53,l.themesIds_$LI$().Shade=54,l.themesIds_$LI$().Pencil=55,l.themesIds_$LI$().Pen=56,l.themesIds_$LI$().Marker=57,l.themesIds_$LI$().Whiteboard=58},l.colorIds_$LI$=function(){return l.__static_initialize(),l.colorIds=null==l.colorIds?{}:l.colorIds},l.__static_initializer_1=function(){!function(t){null==t.entries&&(t.entries=[]);for(var e=0;e<t.entries.length;e++)if(null!=t.entries[e].key.equals&&t.entries[e].key.equals(0)||0===t.entries[e].key)return t.entries[e].value="dk1";t.entries.push({key:0,value:"dk1",getKey:function(){return this.key},getValue:function(){return this.value}})}(l.colorIds_$LI$()),function(t){null==t.entries&&(t.entries=[]);for(var e=0;e<t.entries.length;e++)if(null!=t.entries[e].key.equals&&t.entries[e].key.equals(1)||1===t.entries[e].key)return t.entries[e].value="lt1";t.entries.push({key:1,value:"lt1",getKey:function(){return this.key},getValue:function(){return this.value}})}(l.colorIds_$LI$()),function(t,e){null==t.entries&&(t.entries=[]);for(var n=0;n<t.entries.length;n++)if(null!=t.entries[n].key.equals&&t.entries[n].key.equals(2)||2===t.entries[n].key)return t.entries[n].value=e;t.entries.push({key:2,value:e,getKey:function(){return this.key},getValue:function(){return this.value}})}(l.colorIds_$LI$(),"accent1"),function(t,e){null==t.entries&&(t.entries=[]);for(var n=0;n<t.entries.length;n++)if(null!=t.entries[n].key.equals&&t.entries[n].key.equals(3)||3===t.entries[n].key)return t.entries[n].value=e;t.entries.push({key:3,value:e,getKey:function(){return this.key},getValue:function(){return this.value}})}(l.colorIds_$LI$(),"accent2"),function(t,e){null==t.entries&&(t.entries=[]);for(var n=0;n<t.entries.length;n++)if(null!=t.entries[n].key.equals&&t.entries[n].key.equals(4)||4===t.entries[n].key)return t.entries[n].value=e;t.entries.push({key:4,value:e,getKey:function(){return this.key},getValue:function(){return this.value}})}(l.colorIds_$LI$(),"accent3"),function(t,e){null==t.entries&&(t.entries=[]);for(var n=0;n<t.entries.length;n++)if(null!=t.entries[n].key.equals&&t.entries[n].key.equals(5)||5===t.entries[n].key)return t.entries[n].value=e;t.entries.push({key:5,value:e,getKey:function(){return this.key},getValue:function(){return this.value}})}(l.colorIds_$LI$(),"accent4"),function(t,e){null==t.entries&&(t.entries=[]);for(var n=0;n<t.entries.length;n++)if(null!=t.entries[n].key.equals&&t.entries[n].key.equals(6)||6===t.entries[n].key)return t.entries[n].value=e;t.entries.push({key:6,value:e,getKey:function(){return this.key},getValue:function(){return this.value}})}(l.colorIds_$LI$(),"accent5"),function(t,e){null==t.entries&&(t.entries=[]);for(var n=0;n<t.entries.length;n++)if(null!=t.entries[n].key.equals&&t.entries[n].key.equals(7)||7===t.entries[n].key)return t.entries[n].value=e;t.entries.push({key:7,value:e,getKey:function(){return this.key},getValue:function(){return this.value}})}(l.colorIds_$LI$(),"accent6")},l.prototype.getThemeIndex=function(){return this.themeIndex},l.prototype.setVariant=function(t){this.themeVariant=t},l.prototype.isPure=function(){return this.__isPure},l.prototype.processTheme=function(){if(!this.isProcessed){try{for(var t=this.theme.firstChild;null!=t;){if(null!=t&&1==t.nodeType&&(_=t.nodeName,v="a:themeElements",_&&_.equals?_.equals(v):_===v))for(var e,n,s=t.firstChild;null!=s;)null!=s&&1==s.nodeType&&(n=(e=s).nodeName,y="a:clrScheme",((d=n)&&d.equals?d.equals(y):d===y)?(p=this.name,c=e.getAttribute("name"),(p&&p.equals?p.equals(c):p===c)||(this.__isPure=!1),this.processColors(e)):(m="a:fontScheme",((x=n)&&x.equals?x.equals(m):x===m)?(h=this.name,g=e.getAttribute("name"),(h&&h.equals?h.equals(g):h===g)||(this.__isPure=!1),this.processFonts(e)):(u="a:fmtScheme",((l=n)&&l.equals?l.equals(u):l===u)?(a=this.name,o=e.getAttribute("name"),(a&&a.equals?a.equals(o):a===o)||(this.__isPure=!1),this.processFormats(e)):(r="a:extLst",((i=n)&&i.equals?i.equals(r):i===r)&&this.processExtras(e))))),s=s.nextSibling;t=t.nextSibling}}catch(t){console.error(t.message,t)}var i,r,a,o,l,u,h,g,x,m,p,c,d,y,_,v;this.isProcessed=!0}},l.prototype.processExtras=function(t){for(var e,n,s=b.mxgraph.io.vsdx.mxVsdxUtils.getDirectChildElements(t),i=0;i<s.length;i++){var r=s[i],a=b.mxgraph.io.vsdx.mxVsdxUtils.getDirectFirstChildElement(r);switch(a.nodeName){case"vt:fmtConnectorScheme":e=this.name,n=a.getAttribute("name"),(e&&e.equals?e.equals(n):e===n)||(this.__isPure=!1);for(var o=b.mxgraph.io.vsdx.mxVsdxUtils.getDirectChildElements(a),l=0;l<o.length;l++){var u=o[l];switch(u.nodeName){case"a:fillStyleLst":for(var h=b.mxgraph.io.vsdx.mxVsdxUtils.getDirectChildElements(u),g=0;g<h.length;g++){var x=h[g];this.connFillStyles.push(b.mxgraph.io.vsdx.theme.FillStyleFactory.getFillStyle(x))}break;case"a:lnStyleLst":for(var m=b.mxgraph.io.vsdx.mxVsdxUtils.getDirectChildElements(u),p=0;p<m.length;p++){var c=m[p];this.connLineStyles.push(new b.mxgraph.io.vsdx.theme.LineStyle(c))}}}break;case"vt:lineStyles":for(var d=b.mxgraph.io.vsdx.mxVsdxUtils.getDirectChildElements(a),y=0;y<d.length;y++){var _=d[y];switch(_.nodeName){case"vt:fmtConnectorSchemeLineStyles":for(var v=b.mxgraph.io.vsdx.mxVsdxUtils.getDirectChildElements(_),f=0;f<v.length;f++){var S=v[f];this.connLineStylesExt.push(new b.mxgraph.io.vsdx.theme.LineStyleExt(S))}break;case"vt:fmtSchemeLineStyles":for(var C=b.mxgraph.io.vsdx.mxVsdxUtils.getDirectChildElements(_),I=0;I<C.length;I++){var L=C[I];this.lineStylesExt.push(new b.mxgraph.io.vsdx.theme.LineStyleExt(L))}}}break;case"vt:fontStylesGroup":for(var A=b.mxgraph.io.vsdx.mxVsdxUtils.getDirectChildElements(a),E=0;E<A.length;E++){var M=A[E];switch(M.nodeName){case"vt:connectorFontStyles":this.fillFontStyles(M,this.connFontColors,this.connFontStyles);break;case"vt:fontStyles":this.fillFontStyles(M,this.fontColors,this.fontStyles)}}break;case"vt:variationStyleSchemeLst":for(var T=b.mxgraph.io.vsdx.mxVsdxUtils.getDirectChildElements(a),N=0,D=0;D<T.length;D++){var $=T[D];this.variantEmbellishment[N]=b.mxgraph.io.vsdx.mxVsdxUtils.getIntAttr$org_w3c_dom_Element$java_lang_String($,"embellishment");for(var V=b.mxgraph.io.vsdx.mxVsdxUtils.getDirectChildElements($),k=0,O=0;O<V.length;O++){var R=V[O];this.variantFillIdx[N][k]=b.mxgraph.io.vsdx.mxVsdxUtils.getIntAttr$org_w3c_dom_Element$java_lang_String(R,"fillIdx"),this.variantLineIdx[N][k]=b.mxgraph.io.vsdx.mxVsdxUtils.getIntAttr$org_w3c_dom_Element$java_lang_String(R,"lineIdx"),this.variantEffectIdx[N][k]=b.mxgraph.io.vsdx.mxVsdxUtils.getIntAttr$org_w3c_dom_Element$java_lang_String(R,"effectIdx"),this.variantFontIdx[N][k]=b.mxgraph.io.vsdx.mxVsdxUtils.getIntAttr$org_w3c_dom_Element$java_lang_String(R,"fontIdx"),k++}N++}}}},l.prototype.fillFontStyles=function(t,e,n){for(var s=b.mxgraph.io.vsdx.mxVsdxUtils.getDirectChildElements(t),i=0;i<s.length;i++){var r=s[i];n.push(b.mxgraph.io.vsdx.mxVsdxUtils.getIntAttr$org_w3c_dom_Element$java_lang_String(r,"style"));r=b.mxgraph.io.vsdx.mxVsdxUtils.getDirectFirstChildElement(r);null!=r&&e.push(b.mxgraph.io.vsdx.theme.OoxmlColorFactory.getOoxmlColor(b.mxgraph.io.vsdx.mxVsdxUtils.getDirectFirstChildElement(r)))}},l.prototype.processFormats=function(t){for(var e=b.mxgraph.io.vsdx.mxVsdxUtils.getDirectChildElements(t),n=0;n<e.length;n++){var s=e[n];switch(s.nodeName){case"a:fillStyleLst":for(var i=b.mxgraph.io.vsdx.mxVsdxUtils.getDirectChildElements(s),r=0;r<i.length;r++){var a=i[r];this.fillStyles.push(b.mxgraph.io.vsdx.theme.FillStyleFactory.getFillStyle(a))}break;case"a:lnStyleLst":for(var o=b.mxgraph.io.vsdx.mxVsdxUtils.getDirectChildElements(s),l=0;l<o.length;l++){var u=o[l];this.lineStyles.push(new b.mxgraph.io.vsdx.theme.LineStyle(u))}}}},l.prototype.processFonts=function(t){},l.prototype.processColors=function(t){for(var e,n,s,i,r=t.firstChild;null!=r;)null!=r&&1==r.nodeType&&(n=(s=r).nodeName,e=b.mxgraph.io.vsdx.mxVsdxUtils.getDirectChildElements(s),i="a:extLst",((s=n)&&s.equals?s.equals(i):s===i)?3===e.length&&(this.themeIndex<0&&this.extractThemeIndex(e[0]),this.addBkgndColor(e[1]),this.addVariantColors(e[2])):(n=n.substring(2),0<e.length&&this.addBasicColor(n,e[0]))),r=r.nextSibling},l.prototype.addVariantColors=function(t){t=b.mxgraph.io.vsdx.mxVsdxUtils.getDirectFirstChildElement(t);if(null!=t)for(var e=b.mxgraph.io.vsdx.mxVsdxUtils.getDirectChildElements(t),n=0,s=0;s<e.length;s++){var i=e[s];this.addVariantColorsSet(n++,i)}},l.prototype.addVariantColorsSet=function(t,e){var n=b.mxgraph.io.vsdx.mxVsdxUtils.getDirectChildElements(e);this.isMonotoneVariant[t]=e.hasAttribute("monotone");for(var s=0;s<n.length;s++){var i=n[s];switch(i.nodeName){case"vt:varColor1":this.variantsColors[t][0]=b.mxgraph.io.vsdx.theme.OoxmlColorFactory.getOoxmlColor(b.mxgraph.io.vsdx.mxVsdxUtils.getDirectFirstChildElement(i));break;case"vt:varColor2":this.variantsColors[t][1]=b.mxgraph.io.vsdx.theme.OoxmlColorFactory.getOoxmlColor(b.mxgraph.io.vsdx.mxVsdxUtils.getDirectFirstChildElement(i));break;case"vt:varColor3":this.variantsColors[t][2]=b.mxgraph.io.vsdx.theme.OoxmlColorFactory.getOoxmlColor(b.mxgraph.io.vsdx.mxVsdxUtils.getDirectFirstChildElement(i));break;case"vt:varColor4":this.variantsColors[t][3]=b.mxgraph.io.vsdx.theme.OoxmlColorFactory.getOoxmlColor(b.mxgraph.io.vsdx.mxVsdxUtils.getDirectFirstChildElement(i));break;case"vt:varColor5":this.variantsColors[t][4]=b.mxgraph.io.vsdx.theme.OoxmlColorFactory.getOoxmlColor(b.mxgraph.io.vsdx.mxVsdxUtils.getDirectFirstChildElement(i));break;case"vt:varColor6":this.variantsColors[t][5]=b.mxgraph.io.vsdx.theme.OoxmlColorFactory.getOoxmlColor(b.mxgraph.io.vsdx.mxVsdxUtils.getDirectFirstChildElement(i));break;case"vt:varColor7":this.variantsColors[t][6]=b.mxgraph.io.vsdx.theme.OoxmlColorFactory.getOoxmlColor(b.mxgraph.io.vsdx.mxVsdxUtils.getDirectFirstChildElement(i))}}},l.prototype.addBkgndColor=function(t){t=b.mxgraph.io.vsdx.mxVsdxUtils.getDirectFirstChildElement(t);null!=t&&(this.bkgndColor=b.mxgraph.io.vsdx.theme.OoxmlColorFactory.getOoxmlColor(b.mxgraph.io.vsdx.mxVsdxUtils.getDirectFirstChildElement(t)))},l.prototype.extractThemeIndex=function(t){t=b.mxgraph.io.vsdx.mxVsdxUtils.getDirectFirstChildElement(t);null!=t&&(this.themeIndex=parseInt(t.getAttribute("schemeEnum")))},l.prototype.addBasicColor=function(t,e){this.baseColors[t]=b.mxgraph.io.vsdx.theme.OoxmlColorFactory.getOoxmlColor(e)},l.prototype.getSchemeColor=function(t){this.processTheme();t=this.baseColors[t]||null;return null!=t?t.getColor$com_mxgraph_io_vsdx_mxVsdxTheme(this):this.defaultClr},l.prototype.getStyleColor=function(t){if(this.processTheme(),t<8){if(null!=(e=(e=this.baseColors,n=function(t,e){null==t.entries&&(t.entries=[]);for(var n=0;n<t.entries.length;n++)if(null!=t.entries[n].key.equals&&t.entries[n].key.equals(e)||t.entries[n].key===e)return t.entries[n].value;return null}(l.colorIds_$LI$(),t),e[n]||null)))return e.getColor$com_mxgraph_io_vsdx_mxVsdxTheme(this)}else if(8===t){if(null!=this.bkgndColor)return this.bkgndColor.getColor$com_mxgraph_io_vsdx_mxVsdxTheme(this)}else{var e=null,n=0;if(200<=t?n=t-200:100<=t&&(n=t-100),null!=(e=0<=n&&n<=6?this.variantsColors[this.themeVariant][n]:e))return e.getColor$com_mxgraph_io_vsdx_mxVsdxTheme(this)}return this.defaultClr},l.prototype.getFillGraientColor=function(t){return this.getFillColor$com_mxgraph_io_vsdx_theme_QuickStyleVals$boolean(t,!0)},l.prototype.getFillColor$com_mxgraph_io_vsdx_theme_QuickStyleVals=function(t){return this.getFillColor$com_mxgraph_io_vsdx_theme_QuickStyleVals$boolean(t,!1)},l.prototype.getFillColor$com_mxgraph_io_vsdx_theme_QuickStyleVals$boolean=function(t,e){this.processTheme();var n=t.getQuickStyleFillColor(),s=null;switch(t.getQuickStyleFillMatrix()){case 1:case 2:case 3:case 4:case 5:case 6:s=this.fillStyles[t.getQuickStyleFillMatrix()-1];break;case 100:case 101:case 102:case 103:this.isMonotoneVariant[this.themeVariant]&&(n=100);var i=t.getQuickStyleFillMatrix()-100,s=this.fillStyles[this.variantFillIdx[this.themeVariant][i]-1]}var r,a,o=null!=s?e?null!=s&&s instanceof b.mxgraph.io.vsdx.theme.GradFill?s.applyStyle(n,this).getGradientClr():null:s.applyStyle(n,this):e?null:this.getStyleColor(n),l=t.getQuickStyleVariation();return null!=o&&0<(8&l)&&(r=this.getStyleColor(8).toHsl(),e=(a=this.getLineColor$com_mxgraph_io_vsdx_theme_QuickStyleVals(t)).toHsl(),l=o.toHsl(),.1666<=Math.abs(r.getLum()-l.getLum())||(r.getLum()<=.7292?o=new b.mxgraph.io.vsdx.theme.Color(255,255,255):Math.abs(r.getLum()-e.getLum())>Math.abs(r.getLum()-l.getLum())&&(o=a))),o},l.prototype.getFillColor=function(t,e){if(!(null!=t&&t instanceof b.mxgraph.io.vsdx.theme.QuickStyleVals||null===t)||"boolean"!=typeof e&&null!==e){if((null!=t&&t instanceof b.mxgraph.io.vsdx.theme.QuickStyleVals||null===t)&&void 0===e)return this.getFillColor$com_mxgraph_io_vsdx_theme_QuickStyleVals(t);throw new Error("invalid overload")}return this.getFillColor$com_mxgraph_io_vsdx_theme_QuickStyleVals$boolean(t,e)},l.prototype.getLineStyle=function(t,e){this.processTheme();var n=null;switch(t){case 1:case 2:case 3:case 4:case 5:case 6:n=e[t-1];break;case 100:case 101:case 102:case 103:n=e===this.lineStyles?this.lineStyles[this.variantLineIdx[this.themeVariant][t-100]-1]:this.defaultLineStyle}return n},l.prototype.getLineStyleExt=function(t,e){this.processTheme();var n=null;switch(t){case 0:case 1:case 2:case 3:case 4:case 5:case 6:n=e[t]}return n},l.prototype.getLineColor$com_mxgraph_io_vsdx_theme_QuickStyleVals$java_util_ArrayList=function(t,e){this.processTheme();var n=t.getQuickStyleLineColor(),s=this.getLineStyle(t.getQuickStyleLineMatrix(),e);switch(t.getQuickStyleLineMatrix()){case 100:case 101:case 102:case 103:this.isMonotoneVariant[this.themeVariant]&&(n=100)}var i,r=null!=s?s.getLineColor(n,this):this.getStyleColor(n);return 0<(4&t.getQuickStyleVariation())&&(i=this.getStyleColor(8).toHsl(),s=(e=this.getFillColor$com_mxgraph_io_vsdx_theme_QuickStyleVals(t)).toHsl(),t=r.toHsl(),.1666<=Math.abs(i.getLum()-t.getLum())||(i.getLum()<=.7292?r=new b.mxgraph.io.vsdx.theme.Color(255,255,255):Math.abs(i.getLum()-s.getLum())>Math.abs(i.getLum()-t.getLum())&&(r=e))),r},l.prototype.getLineColor=function(t,e){if((null!=t&&t instanceof b.mxgraph.io.vsdx.theme.QuickStyleVals||null===t)&&(null!=e&&e instanceof Array||null===e))return this.getLineColor$com_mxgraph_io_vsdx_theme_QuickStyleVals$java_util_ArrayList(t,e);if((null!=t&&t instanceof b.mxgraph.io.vsdx.theme.QuickStyleVals||null===t)&&void 0===e)return this.getLineColor$com_mxgraph_io_vsdx_theme_QuickStyleVals(t);throw new Error("invalid overload")},l.prototype.getLineColor$com_mxgraph_io_vsdx_theme_QuickStyleVals=function(t){return this.getLineColor$com_mxgraph_io_vsdx_theme_QuickStyleVals$java_util_ArrayList(t,this.lineStyles)},l.prototype.getConnLineColor=function(t){return this.getLineColor$com_mxgraph_io_vsdx_theme_QuickStyleVals$java_util_ArrayList(t,this.connLineStyles)},l.prototype.getDefaultLineClr=function(){return this.defaultLineClr},l.prototype.isLineDashed$com_mxgraph_io_vsdx_theme_QuickStyleVals$java_util_ArrayList$java_util_ArrayList=function(t,e,n){e=this.getLineStyleExt(t.getQuickStyleLineMatrix(),e);if(null!=e)return e.isDashed();n=this.getLineStyle(t.getQuickStyleLineMatrix(),n);return null!=n&&n.isDashed()},l.prototype.isLineDashed=function(t,e,n){if((null!=t&&t instanceof b.mxgraph.io.vsdx.theme.QuickStyleVals||null===t)&&(null!=e&&e instanceof Array||null===e)&&(null!=n&&n instanceof Array||null===n))return this.isLineDashed$com_mxgraph_io_vsdx_theme_QuickStyleVals$java_util_ArrayList$java_util_ArrayList(t,e,n);if((null!=t&&t instanceof b.mxgraph.io.vsdx.theme.QuickStyleVals||null===t)&&void 0===e&&void 0===n)return this.isLineDashed$com_mxgraph_io_vsdx_theme_QuickStyleVals(t);throw new Error("invalid overload")},l.prototype.isLineDashed$com_mxgraph_io_vsdx_theme_QuickStyleVals=function(t){return this.isLineDashed$com_mxgraph_io_vsdx_theme_QuickStyleVals$java_util_ArrayList$java_util_ArrayList(t,this.lineStylesExt,this.lineStyles)},l.prototype.isConnLineDashed=function(t){return this.isLineDashed$com_mxgraph_io_vsdx_theme_QuickStyleVals$java_util_ArrayList$java_util_ArrayList(t,this.connLineStylesExt,this.connLineStyles)},l.prototype.getLineDashPattern$com_mxgraph_io_vsdx_theme_QuickStyleVals$java_util_ArrayList$java_util_ArrayList=function(t,e,n){e=this.getLineStyleExt(t.getQuickStyleLineMatrix(),e);if(null!=e)return e.getLineDashPattern();n=this.getLineStyle(t.getQuickStyleLineMatrix(),n);return null!=n?n.getLineDashPattern():null},l.prototype.getLineDashPattern=function(t,e,n){if((null!=t&&t instanceof b.mxgraph.io.vsdx.theme.QuickStyleVals||null===t)&&(null!=e&&e instanceof Array||null===e)&&(null!=n&&n instanceof Array||null===n))return this.getLineDashPattern$com_mxgraph_io_vsdx_theme_QuickStyleVals$java_util_ArrayList$java_util_ArrayList(t,e,n);if((null!=t&&t instanceof b.mxgraph.io.vsdx.theme.QuickStyleVals||null===t)&&void 0===e&&void 0===n)return this.getLineDashPattern$com_mxgraph_io_vsdx_theme_QuickStyleVals(t);throw new Error("invalid overload")},l.prototype.getLineDashPattern$com_mxgraph_io_vsdx_theme_QuickStyleVals=function(t){return this.getLineDashPattern$com_mxgraph_io_vsdx_theme_QuickStyleVals$java_util_ArrayList$java_util_ArrayList(t,this.lineStylesExt,this.lineStyles)},l.prototype.getConnLineDashPattern=function(t){return this.getLineDashPattern$com_mxgraph_io_vsdx_theme_QuickStyleVals$java_util_ArrayList$java_util_ArrayList(t,this.connLineStylesExt,this.connLineStyles)},l.prototype.getArrowSize=function(t,e,n,s){n=this.getLineStyleExt(t.getQuickStyleLineMatrix(),n);if(null!=n)return e?n.getStartSize():n.getEndSize();s=this.getLineStyle(t.getQuickStyleLineMatrix(),s);return null!=s?e?s.getStartSize():s.getEndSize():4},l.prototype.getStartSize=function(t){return this.getArrowSize(t,!0,this.lineStylesExt,this.lineStyles)},l.prototype.getConnStartSize=function(t){return this.getArrowSize(t,!0,this.connLineStylesExt,this.connLineStyles)},l.prototype.getEndSize=function(t){return this.getArrowSize(t,!1,this.lineStylesExt,this.lineStyles)},l.prototype.getConnEndSize=function(t){return this.getArrowSize(t,!1,this.connLineStylesExt,this.connLineStyles)},l.prototype.getFontColor$com_mxgraph_io_vsdx_theme_QuickStyleVals$java_util_ArrayList=function(t,e){this.processTheme();var n=t.getQuickStyleFontColor(),s=null;switch(t.getQuickStyleFontMatrix()){case 1:case 2:case 3:case 4:case 5:case 6:s=e[t.getQuickStyleFontMatrix()-1];break;case 100:case 101:case 102:case 103:this.isMonotoneVariant[this.themeVariant]&&(n=100);var i=t.getQuickStyleFontMatrix()-100,s=e!==this.fontColors?this.baseColors.dk1||null:e[this.variantFontIdx[this.themeVariant][i]-1]}var r,a,o,l,u,h,g=null!=s?s.getColor$int$com_mxgraph_io_vsdx_mxVsdxTheme(n,this):this.getStyleColor(n);return 0<(2&t.getQuickStyleVariation())&&(r=this.getStyleColor(8).toHsl(),h=g.toHsl(),u=(a=this.getFillColor$com_mxgraph_io_vsdx_theme_QuickStyleVals(t)).toHsl(),l=(o=this.getLineColor$com_mxgraph_io_vsdx_theme_QuickStyleVals(t)).toHsl(),.1666<=Math.abs(r.getLum()-h.getLum())||(r.getLum()<=.7292?g=new b.mxgraph.io.vsdx.theme.Color(255,255,255):(l=Math.abs(r.getLum()-l.getLum()),u=Math.abs(r.getLum()-u.getLum()),h=Math.abs(r.getLum()-h.getLum()),(h=Math.max(l,u,h))==l?g=o:h==u&&(g=a)))),g},l.prototype.getFontColor=function(t,e){if((null!=t&&t instanceof b.mxgraph.io.vsdx.theme.QuickStyleVals||null===t)&&(null!=e&&e instanceof Array||null===e))return this.getFontColor$com_mxgraph_io_vsdx_theme_QuickStyleVals$java_util_ArrayList(t,e);if((null!=t&&t instanceof b.mxgraph.io.vsdx.theme.QuickStyleVals||null===t)&&void 0===e)return this.getFontColor$com_mxgraph_io_vsdx_theme_QuickStyleVals(t);throw new Error("invalid overload")},l.prototype.getFontColor$com_mxgraph_io_vsdx_theme_QuickStyleVals=function(t){return this.getFontColor$com_mxgraph_io_vsdx_theme_QuickStyleVals$java_util_ArrayList(t,this.fontColors)},l.prototype.getConnFontColor=function(t){return this.getFontColor$com_mxgraph_io_vsdx_theme_QuickStyleVals$java_util_ArrayList(t,this.connFontColors)},l.prototype.getArrowType=function(t,e,n,s){n=this.getLineStyleExt(t.getQuickStyleLineMatrix(),n);if(null!=n)return e?n.getStart():n.getEnd();s=this.getLineStyle(t.getQuickStyleLineMatrix(),s);return null!=s?e?s.getStart():s.getEnd():0},l.prototype.getEdgeMarker=function(t,e){return this.getArrowType(e,t,this.lineStylesExt,this.lineStyles)},l.prototype.getConnEdgeMarker=function(t,e){return this.getArrowType(e,t,this.connLineStylesExt,this.connLineStyles)},l.prototype.getLineWidth$com_mxgraph_io_vsdx_theme_QuickStyleVals$java_util_ArrayList=function(t,e){e=this.getLineStyle(t.getQuickStyleLineMatrix(),e);return null!=e?e.getLineWidth():0},l.prototype.getLineWidth=function(t,e){if((null!=t&&t instanceof b.mxgraph.io.vsdx.theme.QuickStyleVals||null===t)&&(null!=e&&e instanceof Array||null===e))return this.getLineWidth$com_mxgraph_io_vsdx_theme_QuickStyleVals$java_util_ArrayList(t,e);if((null!=t&&t instanceof b.mxgraph.io.vsdx.theme.QuickStyleVals||null===t)&&void 0===e)return this.getLineWidth$com_mxgraph_io_vsdx_theme_QuickStyleVals(t);throw new Error("invalid overload")},l.prototype.getLineWidth$com_mxgraph_io_vsdx_theme_QuickStyleVals=function(t){return this.getLineWidth$com_mxgraph_io_vsdx_theme_QuickStyleVals$java_util_ArrayList(t,this.lineStyles)},l.prototype.getConnLineWidth=function(t){return this.getLineWidth$com_mxgraph_io_vsdx_theme_QuickStyleVals$java_util_ArrayList(t,this.connLineStyles)},(e=l).__static_initialized=!1,(t.mxVsdxTheme=e).__class="com.mxgraph.io.vsdx.mxVsdxTheme"}(com=com||{}),function(s){var t,e;function n(){}t=s.mxgraph||(s.mxgraph={}),t=(e=t.io||(t.io={})).vsdx||(e.vsdx={}),n.conversionFactor_$LI$=function(){return n.conversionFactor=null==n.conversionFactor?n.screenCoordinatesPerCm*n.CENTIMETERS_PER_INCHES:n.conversionFactor},n.getDirectChildNamedElements=function(t,e){for(var n,s,i=[],r=t.firstChild;null!=r;r=r.nextSibling)null!=r&&1==r.nodeType&&(n=e,s=r.nodeName,n&&n.equals?n.equals(s):n===s)&&i.push(r);return i},n.getDirectChildElements=function(t){for(var e=[],n=t.firstChild;null!=n;n=n.nextSibling)null!=n&&1==n.nodeType&&e.push(n);return e},n.getDirectFirstChildElement=function(t){for(var e=t.firstChild;null!=e;e=e.nextSibling)if(null!=e&&1==e.nodeType)return e;return null},n.getIntAttr$org_w3c_dom_Element$java_lang_String$int=function(t,e,n){try{var s=t.getAttribute(e);if(null!=s)return parseInt(s)}catch(t){}return n},n.getIntAttr=function(t,e,n){if((null==t||1!=t.nodeType)&&null!==t||"string"!=typeof e&&null!==e||"number"!=typeof n&&null!==n){if((null==t||1!=t.nodeType)&&null!==t||"string"!=typeof e&&null!==e||void 0!==n)throw new Error("invalid overload");return s.mxgraph.io.vsdx.mxVsdxUtils.getIntAttr$org_w3c_dom_Element$java_lang_String(t,e)}return s.mxgraph.io.vsdx.mxVsdxUtils.getIntAttr$org_w3c_dom_Element$java_lang_String$int(t,e,n)},n.getIntAttr$org_w3c_dom_Element$java_lang_String=function(t,e){return n.getIntAttr$org_w3c_dom_Element$java_lang_String$int(t,e,0)},n.getStyleString=function(t,e){for(var n,s,i,r,a,o,l,u="",h=(i=t,n=Object.keys(i).map(function(t){return i[t]}),s=0,{next:function(){return s<n.length?n[s++]:null},hasNext:function(){return s<n.length}}),g=(r=Object.keys(t),a=0,{next:function(){return a<r.length?r[a++]:null},hasNext:function(){return a<r.length}});g.hasNext();){var x=g.next(),m=h.next();if(o=x,l=mxConstants.STYLE_SHAPE,!(o&&o.equals?o.equals(l):o===l)||(o=void 0,"image"!==function(t,e){return t[e]?t[e]:null}(t,x).substr(o=void 0===o?0:o,"image".length)&&(l="rounded=",o=void 0,function(t,e){return t[e]?t[e]:null}(t,x).substr(o=void 0===o?0:o,l.length)!==l)))try{u=u+x+e}catch(t){console.error("mxVsdxUtils.getStyleString,"+t+",style.length="+u.length+",key.length="+x.length+",asig.length="+e.length)}u=u+m+";"}return u},n.surroundByTags=function(t,e){return"<"+e+">"+t+"</"+e+">"},n.htmlEntities=function(t){return t.replace(new RegExp("&","g"),"&amp;").replace(new RegExp('"',"g"),"&quot;").replace(new RegExp("'","g"),"&prime;").replace(new RegExp("<","g"),"&lt;").replace(new RegExp(">","g"),"&gt;")},n.toInitialCapital=function(t){for(var e=t.split(" "),n="",s=0;s<e.length;s++){var i=(r=e[s]).substring(0,1),r=r.substring(1);n+=(i=i.toUpperCase())+r}return n.substring(0,n.length)},n.toSmallCaps=function(t,e){var n,s,i,r="";if(i=r,(s=e)&&s.equals?s.equals(i):s===i)r=t;else for(var a=t.split(""),o=0;o<a.length;o++){var l,u=a[o];(null==(n=u).charCodeAt?n:n.charCodeAt(0))>=(null==(n="a").charCodeAt?n:n.charCodeAt(0))&&(null==(l=u).charCodeAt?l:l.charCodeAt(0))<=(null==(l="z").charCodeAt?l:l.charCodeAt(0))?(l=(l=new String(u).toString()).toUpperCase(),r+='<font style="font-size:'+parseFloat(e)/1.28+'px">'+l+"</font>"):r+=u}return r},n.getStyleMap=function(t,e){for(var n={},s=t.split(";"),i=0;i<s.length;i++){var r=s[i],a=r.indexOf(e),o=r.substring(0,a),a=r.substring(a+1);n[o]=a}return n},n.isInsideTriangle=function(t,e,n,s,i,r,a,o){function l(t,e,n,s,i,r){return(t-i)*(s-r)-(n-i)*(e-r)}var u=l(t,e,n,s,i,r),r=l(t,e,i,r,a,o),s=l(t,e,a,o,n,s);return!((u<0||r<0||s<0)&&(0<u||0<r||0<s))},(e=n).screenCoordinatesPerCm=40,e.CENTIMETERS_PER_INCHES=2.54,(t.mxVsdxUtils=e).__class="com.mxgraph.io.vsdx.mxVsdxUtils"}(com=com||{}),function(t){var e;function n(t,e,n,s){this.values=null,this.charIndices=null,this.fields=null,this.paraIndex=null,this.values=[],this.values.push(t),this.charIndices=[],this.charIndices.push(e),this.fields=[],this.fields.push(s),this.paraIndex=n}e=t.mxgraph||(t.mxgraph={}),e=(t=e.io||(e.io={})).vsdx||(t.vsdx={}),n.prototype.addText=function(t,e,n){this.values.push(t),this.charIndices.push(e),this.fields.push(n)},n.prototype.getParagraphIndex=function(){return this.paraIndex},n.prototype.getValue=function(t){return this.values[t]},n.prototype.numValues=function(){return this.values.length},n.prototype.getChar=function(t){return this.charIndices[t]},n.prototype.getField=function(t){return this.fields[t]},t=n,(e.Paragraph=t).__class="com.mxgraph.io.vsdx.Paragraph"}(com=com||{}),function(m){var t,e;function n(t){this.elem=null,this.elem=t}t=m.mxgraph||(m.mxgraph={}),t=(e=t.io||(t.io={})).vsdx||(e.vsdx={}),n.prototype.getIndexedCell=function(t,e){for(var n,s,i,r,a=m.mxgraph.io.vsdx.mxVsdxUtils.getDirectChildNamedElements(this.elem,"Row"),o=0;o<a.length;o++){var l=a[o],u=l.getAttribute("IX");if(r=t,((i=u)&&i.equals?i.equals(r):i===r)||null==t)for(var h=m.mxgraph.io.vsdx.mxVsdxUtils.getDirectChildNamedElements(l,"Cell"),g=0;g<h.length;g++){var x=h[g],u=x.getAttribute("N");if(s=e,(n=u)&&n.equals?n.equals(s):n===s)return x}}return null},e=n,(t.Section=e).__class="com.mxgraph.io.vsdx.Section"}(com=com||{}),function(t){var e;function n(t,e){this.pageNumber=0,this.Id=0,this.pageNumber=t,this.Id=e}e=t.mxgraph||(t.mxgraph={}),e=(t=e.io||(e.io={})).vsdx||(t.vsdx={}),n.prototype.getId=function(){return this.Id},n.prototype.getPageNumber=function(){return this.pageNumber},n.prototype.equals=function(t){return null!=t&&this.constructor===t.constructor&&(this.pageNumber===t.pageNumber&&this.Id===t.Id)},n.prototype.hashCode=function(){return 1e5*this.pageNumber+this.Id},t=n,(e.ShapePageId=t).__class="com.mxgraph.io.vsdx.ShapePageId"}(com=com||{}),function(u){var t,e;function n(t,e,n){this.red=0,this.green=0,this.blue=0,this.gradientClr=null,this.red=t,this.green=e,this.blue=n}t=u.mxgraph||(u.mxgraph={}),e=(t=(e=t.io||(t.io={})).vsdx||(e.vsdx={})).theme||(t.theme={}),n.NONE_$LI$=function(){return n.NONE=null==n.NONE?new n(-1,-1,-1):n.NONE},n.prototype.getRed=function(){return this.red},n.prototype.setRed=function(t){this.red=t},n.prototype.getGreen=function(){return this.green},n.prototype.setGreen=function(t){this.green=t},n.prototype.getBlue=function(){return this.blue},n.prototype.setBlue=function(t){this.blue=t},n.prototype.toHsl=function(){var t,e,n,s=this.getRed()/255,i=this.getGreen()/255,r=this.getBlue()/255,a=Math.max(s,Math.max(i,r)),o=Math.min(s,Math.min(i,r)),l=(a+o)/2;return a===o?n=e=0:(t=a-o,e=.5<l?t/(2-a-o):t/(a+o),n=a===s?(i-r)/t+(i<r?6:0):a===i?(r-s)/t+2:(s-i)/t+4,n/=6),new u.mxgraph.io.vsdx.theme.HSLColor(n,e,l)},n.prototype.toHsv=function(){var t,e=this.getRed()/255,n=this.getGreen()/255,s=this.getBlue()/255,i=Math.max(e,Math.max(n,s)),r=Math.min(e,Math.min(n,s)),a=i-r;return i===r?t=0:(t=i===e?(n-s)/a+(n<s?6:0):i===n?(s-e)/a+2:(e-n)/a+4,t/=6),new u.mxgraph.io.vsdx.theme.HSVColor(t,0===i?0:a/i,i)},n.decodeColorHex=function(t){t=parseInt(t,16);return new n(t>>16&255,t>>8&255,255&t)},n.prototype.toHexStr=function(){var t=1==(t=this.red.toString(16)).length?"0"+t:t,e=1==(e=this.green.toString(16)).length?"0"+e:e,n=this.blue.toString(16);return"#"+t+e+(n=1==n.length?"0"+n:n)},n.prototype.getGradientClr=function(){return this.gradientClr},n.prototype.setGradientClr=function(t){this.gradientClr=t},t=n,(e.Color=t).__class="com.mxgraph.io.vsdx.theme.Color"}(com=com||{}),function(n){var t,e;function s(){}t=n.mxgraph||(n.mxgraph={}),e=(t=(e=t.io||(t.io={})).vsdx||(e.vsdx={})).theme||(t.theme={}),s.getFillStyle=function(t){var e=null;switch(t.nodeName){case"a:solidFill":e=new n.mxgraph.io.vsdx.theme.SolidFillStyle(n.mxgraph.io.vsdx.theme.OoxmlColorFactory.getOoxmlColor(n.mxgraph.io.vsdx.mxVsdxUtils.getDirectFirstChildElement(t)));break;case"a:noFill":e=new n.mxgraph.io.vsdx.theme.NoFillStyle;break;case"a:gradFill":e=new n.mxgraph.io.vsdx.theme.GradFill(t)}return e},t=s,(e.FillStyleFactory=t).__class="com.mxgraph.io.vsdx.theme.FillStyleFactory"}(com=com||{}),function(e){var t,n;function s(t){this.color1=null,this.color2=null;var t=e.mxgraph.io.vsdx.mxVsdxUtils.getDirectChildNamedElements(t,"a:gsLst");0<t.length&&(2<=(t=e.mxgraph.io.vsdx.mxVsdxUtils.getDirectChildElements(t[0])).length&&(this.color2=e.mxgraph.io.vsdx.theme.OoxmlColorFactory.getOoxmlColor(e.mxgraph.io.vsdx.mxVsdxUtils.getDirectFirstChildElement(t[0])),this.color1=e.mxgraph.io.vsdx.theme.OoxmlColorFactory.getOoxmlColor(e.mxgraph.io.vsdx.mxVsdxUtils.getDirectFirstChildElement(t[t.length-1])))),null==this.color1&&(this.color1=this.color2=new e.mxgraph.io.vsdx.theme.SrgbClr("FFFFFF"))}t=e.mxgraph||(e.mxgraph={}),n=(t=(n=t.io||(t.io={})).vsdx||(n.vsdx={})).theme||(t.theme={}),s.prototype.applyStyle=function(t,e){var n=this.color1.getColor$int$com_mxgraph_io_vsdx_mxVsdxTheme(t,e);return n.setGradientClr(this.color2.getColor$int$com_mxgraph_io_vsdx_mxVsdxTheme(t,e)),n},t=s,(n.GradFill=t).__class="com.mxgraph.io.vsdx.theme.GradFill",t.__interfaces=["com.mxgraph.io.vsdx.theme.FillStyle"]}(com=com||{}),function(a){var t,e;function n(t,e,n){this.hue=0,this.sat=0,this.lum=0,this.hue=t,this.sat=e,this.lum=n}t=a.mxgraph||(a.mxgraph={}),e=(t=(e=t.io||(t.io={})).vsdx||(e.vsdx={})).theme||(t.theme={}),n.prototype.getHue=function(){return this.hue},n.prototype.setHue=function(t){this.hue=t},n.prototype.getSat=function(){return this.sat},n.prototype.setSat=function(t){this.sat=t},n.prototype.getLum=function(){return this.lum},n.prototype.setLum=function(t){this.lum=t},n.prototype.hue2rgb=function(t,e,n){return n<0&&(n+=1),1<n&&--n,n<1/6?t+6*(e-t)*n:n<.5?e:n<2/3?t+(e-t)*(2/3-n)*6:t},n.prototype.toRgb=function(){var t,e,n,s=this.hue,i=this.sat,r=this.lum;return 0===i?t=e=n=r:(t=this.hue2rgb(i=2*r-(r=r<.5?r*(1+i):r+i-r*i),r,s+1/3),e=this.hue2rgb(i,r,s),n=this.hue2rgb(i,r,s-1/3)),new a.mxgraph.io.vsdx.theme.Color(255*t|0,255*e|0,255*n|0)},n.prototype.clamp01=function(t){return Math.min(1,Math.max(0,t))},n.prototype.tint=function(t){return this.lum*=1+t/100,this.lum=this.clamp01(this.lum),this},n.prototype.shade=function(t){return this.lum*=t/100,this.lum=this.clamp01(this.lum),this},n.prototype.satMod=function(t){return this.sat*=t/100,this.sat=this.clamp01(this.sat),this},n.prototype.lumMod=function(t){return this.lum*=t/100,this.lum=this.clamp01(this.lum),this},t=n,(e.HSLColor=t).__class="com.mxgraph.io.vsdx.theme.HSLColor"}(com=com||{}),function(a){var t,e;function n(t,e,n){this.h=0,this.s=0,this.v=0,this.h=t,this.s=e,this.v=n}t=a.mxgraph||(a.mxgraph={}),e=(t=(e=t.io||(t.io={})).vsdx||(e.vsdx={})).theme||(t.theme={}),n.prototype.toRgb=function(){var t=6*this.h,e=this.s,n=(this.v,Math.floor(t)),s=t-n,i=this.v*(1-e),r=this.v*(1-s*e),t=this.v*(1-(1-s)*e),s=(0|n)%6,e=[this.v,r,i,i,t,this.v],n=[t,this.v,this.v,r,i,i],r=[i,i,t,this.v,this.v,r];return new a.mxgraph.io.vsdx.theme.Color(255*e[s]|0,255*n[s]|0,255*r[s]|0)},n.prototype.clamp01=function(t){return Math.min(1,Math.max(0,t))},n.prototype.tint=function(t){return this.v*=1+t/100,this.v=this.clamp01(this.v),this},n.prototype.shade=function(t){return this.v*=t/100,this.v=this.clamp01(this.v),this},n.prototype.satMod=function(t){return this.s*=t/100,this.s=this.clamp01(this.s),this},n.prototype.lumMod=function(t){return this.v*=t/100,this.v=this.clamp01(this.v),this},n.prototype.hueMod=function(t){return this.h*=t/100,this.h=this.clamp01(this.h),this},t=n,(e.HSVColor=t).__class="com.mxgraph.io.vsdx.theme.HSVColor"}(com=com||{}),function(g){var t,e;function x(u){var h=this;if(this.isLineDashed=!1,this.lineDashPattern=[],this.isRoundJoin=!1,this.isBevelJoin=!1,this.isMiterJoin=!1,null!=u&&1==u.nodeType||null===u){Array.prototype.slice.call(arguments);this.lineWidth=0,this.lineCap=null,this.lineComp=null,this.fillStyle=null,this.headEndType=null,this.headEndWidth=0,this.headEndLen=0,this.tailEndType=null,this.tailEndWidth=0,this.tailEndLen=0,this.isLineDashed=!1,this.lineDashPattern=[],this.isRoundJoin=!1,this.isBevelJoin=!1,this.isMiterJoin=!1,this.lineWidth=0,this.lineCap=null,this.lineComp=null,this.fillStyle=null,this.headEndType=null,this.headEndWidth=0,this.headEndLen=0,this.tailEndType=null,this.tailEndWidth=0,this.tailEndLen=0,function(){h.lineWidth=g.mxgraph.io.vsdx.mxVsdxUtils.getIntAttr$org_w3c_dom_Element$java_lang_String(u,"w");var t=u.getAttribute("cap");if(null!=t)switch(t){case"rnd":h.lineCap=x.LineCapType.ROUND;break;case"sq":h.lineCap=x.LineCapType.SQUARE;break;case"flat":h.lineCap=x.LineCapType.FLAT}t=u.getAttribute("cmpd");if(null!=t)switch(t){case"sng":h.lineComp=x.CompoundLineType.SINGLE;break;case"dbl":h.lineComp=x.CompoundLineType.DOUBLE;break;case"thickThin":h.lineComp=x.CompoundLineType.THICK_THIN_DOUBLE;break;case"thinThick":h.lineComp=x.CompoundLineType.THIN_THICK_DOUBLE;break;case"tri":h.lineComp=x.CompoundLineType.THIN_THICK_THIN_TRIPLE}for(var e=g.mxgraph.io.vsdx.mxVsdxUtils.getDirectChildElements(u),n=0;n<e.length;n++){var s=e[n];switch(s.nodeName){case"a:noFill":case"a:solidFill":case"a:gradFill":case"a:pattFill":h.fillStyle=g.mxgraph.io.vsdx.theme.FillStyleFactory.getFillStyle(s);break;case"a:prstDash":var i=s.getAttribute("val");switch(h.isLineDashed=!0,i){case"solid":h.isLineDashed=!1;break;case"sysDot":case"dot":h.lineDashPattern.push(1),h.lineDashPattern.push(4);break;case"sysDash":case"dash":break;case"lgDash":h.lineDashPattern.push(12),h.lineDashPattern.push(4);break;case"sysDashDot":case"dashDot":h.lineDashPattern.push(8),h.lineDashPattern.push(4),h.lineDashPattern.push(1),h.lineDashPattern.push(4);break;case"lgDashDot":h.lineDashPattern.push(12),h.lineDashPattern.push(4),h.lineDashPattern.push(1),h.lineDashPattern.push(4);break;case"sysDashDotDot":case"lgDashDotDot":h.lineDashPattern.push(12),h.lineDashPattern.push(4),h.lineDashPattern.push(1),h.lineDashPattern.push(4),h.lineDashPattern.push(1),h.lineDashPattern.push(4)}break;case"a:custDash":h.isLineDashed=!0;for(var r=g.mxgraph.io.vsdx.mxVsdxUtils.getDirectChildNamedElements(s,"a:ds"),a=0;a<r.length;a++){var o=r[a],l=g.mxgraph.io.vsdx.mxVsdxUtils.getIntAttr$org_w3c_dom_Element$java_lang_String(o,"d"),o=g.mxgraph.io.vsdx.mxVsdxUtils.getIntAttr$org_w3c_dom_Element$java_lang_String(o,"sp");h.lineDashPattern.push(l/1e4),h.lineDashPattern.push(o/1e4)}break;case"a:round":h.isRoundJoin=!0;break;case"a:bevel":h.isBevelJoin=!0;break;case"a:miter":g.mxgraph.io.vsdx.mxVsdxUtils.getIntAttr$org_w3c_dom_Element$java_lang_String(s,"lim");h.isMiterJoin=!0;break;case"a:headEnd":h.headEndType=h.getLineEndType(s),h.headEndWidth=g.mxgraph.io.vsdx.mxVsdxUtils.getIntAttr$org_w3c_dom_Element$java_lang_String(s,"w"),h.headEndLen=g.mxgraph.io.vsdx.mxVsdxUtils.getIntAttr$org_w3c_dom_Element$java_lang_String(s,"len");break;case"a:tailEnd":h.tailEndType=h.getLineEndType(s),h.tailEndWidth=g.mxgraph.io.vsdx.mxVsdxUtils.getIntAttr$org_w3c_dom_Element$java_lang_String(s,"w"),h.tailEndLen=g.mxgraph.io.vsdx.mxVsdxUtils.getIntAttr$org_w3c_dom_Element$java_lang_String(s,"len")}}}()}else{if(void 0!==u)throw new Error("invalid overload");Array.prototype.slice.call(arguments);this.lineWidth=0,this.lineCap=null,this.lineComp=null,this.fillStyle=null,this.headEndType=null,this.headEndWidth=0,this.headEndLen=0,this.tailEndType=null,this.tailEndWidth=0,this.tailEndLen=0,this.isLineDashed=!1,this.lineDashPattern=[],this.isRoundJoin=!1,this.isBevelJoin=!1,this.isMiterJoin=!1,this.lineWidth=0,this.lineCap=null,this.lineComp=null,this.fillStyle=null,this.headEndType=null,this.headEndWidth=0,this.headEndLen=0,this.tailEndType=null,this.tailEndWidth=0,this.tailEndLen=0}}t=g.mxgraph||(g.mxgraph={}),e=(t=(e=t.io||(t.io={})).vsdx||(e.vsdx={})).theme||(t.theme={}),x.prototype.getLineEndType=function(t){var e=null;switch(t.getAttribute("type")){case"none":e=x.LineEndType.NONE;break;case"triangle":e=x.LineEndType.TRIANGLE;break;case"stealth":e=x.LineEndType.STEALTH;break;case"diamond":e=x.LineEndType.DIAMOND;break;case"oval":e=x.LineEndType.OVAL;break;case"arrow":e=x.LineEndType.ARROW}return e},x.prototype.getLineColor=function(t,e){return null!=this.fillStyle?this.fillStyle.applyStyle(t,e):e.getDefaultLineClr()},x.prototype.isDashed=function(){return this.isLineDashed},x.prototype.getLineDashPattern=function(){return this.lineDashPattern},x.prototype.getStartSize=function(){return 4},x.prototype.getEndSize=function(){return 4},x.prototype.getStart=function(){return 0},x.prototype.getEnd=function(){return 0},x.prototype.getLineWidth=function(){return this.lineWidth},t=x,(e.LineStyle=t).__class="com.mxgraph.io.vsdx.theme.LineStyle",(t=(e=t=e.LineStyle||(e.LineStyle={})).LineCapType||(e.LineCapType={}))[t.ROUND=0]="ROUND",t[t.SQUARE=1]="SQUARE",t[t.FLAT=2]="FLAT",(t=e.CompoundLineType||(e.CompoundLineType={}))[t.SINGLE=0]="SINGLE",t[t.DOUBLE=1]="DOUBLE",t[t.THICK_THIN_DOUBLE=2]="THICK_THIN_DOUBLE",t[t.THIN_THICK_DOUBLE=3]="THIN_THICK_DOUBLE",t[t.THIN_THICK_THIN_TRIPLE=4]="THIN_THICK_THIN_TRIPLE",(e=e.LineEndType||(e.LineEndType={}))[e.NONE=0]="NONE",e[e.TRIANGLE=1]="TRIANGLE",e[e.STEALTH=2]="STEALTH",e[e.DIAMOND=3]="DIAMOND",e[e.OVAL=4]="OVAL",e[e.ARROW=5]="ARROW"}(com=com||{}),function(e){var t,n;function s(t){this.rndg=0,this.start=0,this.startSize=0,this.end=0,this.endSize=0,this.pattern=0,this.lineDashPattern=null;t=e.mxgraph.io.vsdx.mxVsdxUtils.getDirectFirstChildElement(t);this.rndg=e.mxgraph.io.vsdx.mxVsdxUtils.getIntAttr$org_w3c_dom_Element$java_lang_String(t,"rndg"),this.start=e.mxgraph.io.vsdx.mxVsdxUtils.getIntAttr$org_w3c_dom_Element$java_lang_String(t,"start"),this.startSize=e.mxgraph.io.vsdx.mxVsdxUtils.getIntAttr$org_w3c_dom_Element$java_lang_String(t,"startSize"),this.end=e.mxgraph.io.vsdx.mxVsdxUtils.getIntAttr$org_w3c_dom_Element$java_lang_String(t,"end"),this.endSize=e.mxgraph.io.vsdx.mxVsdxUtils.getIntAttr$org_w3c_dom_Element$java_lang_String(t,"endSize"),this.pattern=e.mxgraph.io.vsdx.mxVsdxUtils.getIntAttr$org_w3c_dom_Element$java_lang_String(t,"pattern"),this.lineDashPattern=e.mxgraph.io.vsdx.Style.getLineDashPattern(this.pattern)}t=e.mxgraph||(e.mxgraph={}),n=(t=(n=t.io||(t.io={})).vsdx||(n.vsdx={})).theme||(t.theme={}),s.prototype.getRndg=function(){return this.rndg},s.prototype.getStart=function(){return this.start},s.prototype.getStartSize=function(){return this.startSize},s.prototype.getEnd=function(){return this.end},s.prototype.getEndSize=function(){return this.endSize},s.prototype.isDashed=function(){return 1<this.pattern},s.prototype.getLineDashPattern=function(){return this.lineDashPattern},t=s,(n.LineStyleExt=t).__class="com.mxgraph.io.vsdx.theme.LineStyleExt"}(com=com||{}),function(n){var t,e;function s(){}t=n.mxgraph||(n.mxgraph={}),e=(t=(e=t.io||(t.io={})).vsdx||(e.vsdx={})).theme||(t.theme={}),s.prototype.applyStyle=function(t,e){return n.mxgraph.io.vsdx.theme.Color.NONE_$LI$()},t=s,(e.NoFillStyle=t).__class="com.mxgraph.io.vsdx.theme.NoFillStyle",t.__interfaces=["com.mxgraph.io.vsdx.theme.FillStyle"]}(com=com||{}),function(n){var t,e;function s(){this.tint=0,this.shade=0,this.comp=0,this.inv=0,this.gray=0,this.alpha=0,this.alphaOff=0,this.alphaMod=0,this.hue=0,this.hueOff=0,this.hueMod=0,this.sat=0,this.satOff=0,this.satMod=0,this.lum=0,this.lumOff=0,this.lumMod=0,this.red=0,this.redOff=0,this.redMod=0,this.green=0,this.greenOff=0,this.greenMod=0,this.blue=0,this.blueOff=0,this.blueMod=0,this.gamma=0,this.invGamma=0,this.isDynamic=!1,this.isInitialized=!1,this.hasEffects=!1,this.color=null}t=n.mxgraph||(n.mxgraph={}),e=(t=(e=t.io||(t.io={})).vsdx||(e.vsdx={})).theme||(t.theme={}),s.prototype.calcColor=function(t,e){var n;this.hasEffects&&(n=this.color.toHsv(),0!==this.tint&&n.tint(this.tint),0!==this.shade&&n.shade(this.shade),0!==this.satMod&&n.satMod(this.satMod),0!==this.lumMod&&n.lumMod(this.lumMod),0!==this.hueMod&&n.hueMod(this.hueMod),this.color=n.toRgb())},s.prototype.getColor$int$com_mxgraph_io_vsdx_mxVsdxTheme=function(t,e){return!this.isDynamic&&this.isInitialized||(this.calcColor(t,e),this.isInitialized=!0),this.color},s.prototype.getColor=function(t,e){if("number"!=typeof t&&null!==t||!(null!=e&&e instanceof n.mxgraph.io.vsdx.mxVsdxTheme||null===e)){if((null!=t&&t instanceof n.mxgraph.io.vsdx.mxVsdxTheme||null===t)&&void 0===e)return this.getColor$com_mxgraph_io_vsdx_mxVsdxTheme(t);throw new Error("invalid overload")}return this.getColor$int$com_mxgraph_io_vsdx_mxVsdxTheme(t,e)},s.prototype.getColor$com_mxgraph_io_vsdx_mxVsdxTheme=function(t){return this.getColor$int$com_mxgraph_io_vsdx_mxVsdxTheme(-1,t)},s.prototype.setTint=function(t){this.tint=t,this.hasEffects=!0},s.prototype.setShade=function(t){this.shade=t,this.hasEffects=!0},s.prototype.setComp=function(t){this.comp=t,this.hasEffects=!0},s.prototype.setInv=function(t){this.inv=t,this.hasEffects=!0},s.prototype.setGray=function(t){this.gray=t,this.hasEffects=!0},s.prototype.setAlpha=function(t){this.alpha=t,this.hasEffects=!0},s.prototype.setAlphaOff=function(t){this.alphaOff=t,this.hasEffects=!0},s.prototype.setAlphaMod=function(t){this.alphaMod=t,this.hasEffects=!0},s.prototype.setHue=function(t){this.hue=t,this.hasEffects=!0},s.prototype.setHueOff=function(t){this.hueOff=t,this.hasEffects=!0},s.prototype.setHueMod=function(t){this.hueMod=t,this.hasEffects=!0},s.prototype.setSat=function(t){this.sat=t,this.hasEffects=!0},s.prototype.setSatOff=function(t){this.satOff=t,this.hasEffects=!0},s.prototype.setSatMod=function(t){this.satMod=t,this.hasEffects=!0},s.prototype.setLum=function(t){this.lum=t,this.hasEffects=!0},s.prototype.setLumOff=function(t){this.lumOff=t,this.hasEffects=!0},s.prototype.setLumMod=function(t){this.lumMod=t,this.hasEffects=!0},s.prototype.setRed=function(t){this.red=t,this.hasEffects=!0},s.prototype.setRedOff=function(t){this.redOff=t,this.hasEffects=!0},s.prototype.setRedMod=function(t){this.redMod=t,this.hasEffects=!0},s.prototype.setGreen=function(t){this.green=t,this.hasEffects=!0},s.prototype.setGreenOff=function(t){this.greenOff=t,this.hasEffects=!0},s.prototype.setGreenMod=function(t){this.greenMod=t,this.hasEffects=!0},s.prototype.setBlue=function(t){this.blue=t,this.hasEffects=!0},s.prototype.setBlueOff=function(t){this.blueOff=t,this.hasEffects=!0},s.prototype.setBlueMod=function(t){this.blueMod=t,this.hasEffects=!0},s.prototype.setGamma=function(t){this.gamma=t,this.hasEffects=!0},s.prototype.setInvGamma=function(t){this.invGamma=t,this.hasEffects=!0},t=s,(e.OoxmlColor=t).__class="com.mxgraph.io.vsdx.theme.OoxmlColor"}(com=com||{}),function(a){var t,e;function n(){}t=a.mxgraph||(a.mxgraph={}),e=(t=(e=t.io||(t.io={})).vsdx||(e.vsdx={})).theme||(t.theme={}),n.getOoxmlColor=function(t){var e=null;switch(t.nodeName){case"a:scrgbClr":e=new a.mxgraph.io.vsdx.theme.ScrgbClr(parseInt(t.getAttribute("r")),parseInt(t.getAttribute("g")),parseInt(t.getAttribute("b")));break;case"a:srgbClr":e=new a.mxgraph.io.vsdx.theme.SrgbClr(t.getAttribute("val"));break;case"a:hslClr":e=new a.mxgraph.io.vsdx.theme.HslClr(parseInt(t.getAttribute("hue")),parseInt(t.getAttribute("sat")),parseInt(t.getAttribute("lum")));break;case"a:sysClr":e=new a.mxgraph.io.vsdx.theme.SysClr(t.getAttribute("val"),t.getAttribute("lastClr"));break;case"a:schemeClr":e=new a.mxgraph.io.vsdx.theme.SchemeClr(t.getAttribute("val"));break;case"a:prstClr":e=new a.mxgraph.io.vsdx.theme.SrgbClr(t.getAttribute("val"))}for(var n=a.mxgraph.io.vsdx.mxVsdxUtils.getDirectChildElements(t),s=0;s<n.length;s++){var i=n[s],r=parseInt(i.getAttribute("val"))/1e3|0;switch(i.nodeName){case"a:tint":e.setTint(r);break;case"a:shade":e.setShade(r);break;case"a:satMod":e.setSatMod(r);break;case"a:lumMod":e.setLumMod(r);break;case"a:hueMod":e.setHueMod(r)}}return e},t=n,(e.OoxmlColorFactory=t).__class="com.mxgraph.io.vsdx.theme.OoxmlColorFactory"}(com=com||{}),function(t){var e;function n(t,e,n,s,i,r,a,o,l,u){this.quickStyleEffectsMatrix=0,this.quickStyleFillColor=0,this.quickStyleFillMatrix=0,this.quickStyleFontColor=0,this.quickStyleFontMatrix=0,this.quickStyleLineColor=0,this.quickStyleLineMatrix=0,this.quickStyleShadowColor=0,this.quickStyleType=0,this.quickStyleVariation=0,this.quickStyleEffectsMatrix=t,this.quickStyleFillColor=e,this.quickStyleFillMatrix=n,this.quickStyleFontColor=s,this.quickStyleFontMatrix=i,this.quickStyleLineColor=r,this.quickStyleLineMatrix=a,this.quickStyleShadowColor=o,this.quickStyleType=l,this.quickStyleVariation=u}e=t.mxgraph||(t.mxgraph={}),t=(e=(t=e.io||(e.io={})).vsdx||(t.vsdx={})).theme||(e.theme={}),n.prototype.getQuickStyleEffectsMatrix=function(){return this.quickStyleEffectsMatrix},n.prototype.getQuickStyleFillColor=function(){return this.quickStyleFillColor},n.prototype.getQuickStyleFillMatrix=function(){return this.quickStyleFillMatrix},n.prototype.getQuickStyleFontColor=function(){return this.quickStyleFontColor},n.prototype.getQuickStyleFontMatrix=function(){return this.quickStyleFontMatrix},n.prototype.getQuickStyleLineColor=function(){return this.quickStyleLineColor},n.prototype.getQuickStyleLineMatrix=function(){return this.quickStyleLineMatrix},n.prototype.getQuickStyleShadowColor=function(){return this.quickStyleShadowColor},n.prototype.getQuickStyleType=function(){return this.quickStyleType},n.prototype.getQuickStyleVariation=function(){return this.quickStyleVariation},n.prototype.setQuickStyleEffectsMatrix=function(t){this.quickStyleEffectsMatrix=t},n.prototype.setQuickStyleFillColor=function(t){this.quickStyleFillColor=t},n.prototype.setQuickStyleFillMatrix=function(t){this.quickStyleFillMatrix=t},n.prototype.setQuickStyleFontColor=function(t){this.quickStyleFontColor=t},n.prototype.setQuickStyleFontMatrix=function(t){this.quickStyleFontMatrix=t},n.prototype.setQuickStyleLineColor=function(t){this.quickStyleLineColor=t},n.prototype.setQuickStyleLineMatrix=function(t){this.quickStyleLineMatrix=t},n.prototype.setQuickStyleShadowColor=function(t){this.quickStyleShadowColor=t},n.prototype.setQuickStyleType=function(t){this.quickStyleType=t},n.prototype.setQuickStyleVariation=function(t){this.quickStyleVariation=t},e=n,(t.QuickStyleVals=e).__class="com.mxgraph.io.vsdx.theme.QuickStyleVals"}(com=com||{}),function(t){var e;function n(t){this.color=null,this.color=t}e=t.mxgraph||(t.mxgraph={}),t=(e=(t=e.io||(e.io={})).vsdx||(t.vsdx={})).theme||(e.theme={}),n.prototype.applyStyle=function(t,e){return this.color.getColor$int$com_mxgraph_io_vsdx_mxVsdxTheme(t,e)},e=n,(t.SolidFillStyle=e).__class="com.mxgraph.io.vsdx.theme.SolidFillStyle",e.__interfaces=["com.mxgraph.io.vsdx.theme.FillStyle"]}(com=com||{}),function(t){var e;function n(){}e=t.mxgraph||(t.mxgraph={}),t=e.online||(e.online={}),n.MAX_AREA_$LI$=function(){return n.MAX_AREA=null==n.MAX_AREA?1e8:n.MAX_AREA},(e=n).MAX_REQUEST_SIZE=52428800,e.IMAGE_DOMAIN="http://img.diagramly.com/",(t.Constants=e).__class="com.mxgraph.online.Constants"}(com=com||{}),function(t){var e;function n(){}e=t.mxgraph||(t.mxgraph={}),t=e.online||(e.online={}),n.getRotatedPoint=function(t,e,n,s){var i=t.x-s.x,t=t.y-s.y;return new mxPoint(i*e-t*n+s.x,t*e+i*n+s.y)},n.rotatedGeometry=function(t,e,n,s){e=e*Math.PI/180;var i=Math.cos(e),r=Math.sin(e),a=t.getCenterX()-n,o=t.getCenterY()-s,e=o*i+a*r;t.x=Math.round(a*i-o*r+n-t.width/2),t.y=Math.round(e+s-t.height/2)},(e=n).CHARSET_FOR_URL_ENCODING="ISO-8859-1",(t.Utils=e).__class="com.mxgraph.online.Utils"}(com=com||{}),function(h){var t,e,i;function n(t,e,n,s){n=i.call(this,t,e,n)||this;return n.a=s,n}t=h.mxgraph||(h.mxgraph={}),e=(t=(e=t.io||(t.io={})).vsdx||(e.vsdx={})).geometry||(t.geometry={}),i=h.mxgraph.io.vsdx.geometry.Row,__extends(n,i),n.prototype.handle=function(t,e){if(null==this.x||null==this.y||null==this.a)return"";var n=e.getHeight(),s=e.getWidth(),i=Math.floor(Math.round(e.getLastX()*s)/100),r=Math.floor(Math.round(e.getLastY()*n)/100),a=this.x*h.mxgraph.io.vsdx.mxVsdxUtils.conversionFactor_$LI$(),o=n-(o=this.y*h.mxgraph.io.vsdx.mxVsdxUtils.conversionFactor_$LI$()),l=this.a*h.mxgraph.io.vsdx.mxVsdxUtils.conversionFactor_$LI$(),u=Math.abs(a-i),i=Math.abs(o-r),u=r=.5*l+(u*u+i*i)/(8*l),i=Math.abs(r),r=100*r/s,u=100*u/n,a=100*a/s;o=100*o/n,r=Math.round(100*r)/100,u=Math.round(100*u)/100,a=Math.round(100*a)/100,o=Math.round(100*o)/100,l=Math.round(100*l)/100,r=Math.abs(r),u=Math.abs(u);n=l<0?"1":"0",l=i<Math.abs(l)?"1":"0";return e.setLastX(a),e.setLastY(o),'<arc rx="'+new String(r).toString()+'" ry="'+new String(u).toString()+'" x="'+new String(a).toString()+'" y="'+new String(o).toString()+'" x-axis-rotation="0" large-arc-flag="'+l+'" sweep-flag="'+n+'"/>'},t=n,(e.ArcTo=t).__class="com.mxgraph.io.vsdx.geometry.ArcTo"}(com=com||{}),function(t){var e,n,s;function i(t){return s.call(this,t,null,null)||this}e=t.mxgraph||(t.mxgraph={}),n=(e=(n=e.io||(e.io={})).vsdx||(n.vsdx={})).geometry||(e.geometry={}),s=t.mxgraph.io.vsdx.geometry.Row,__extends(i,s),i.prototype.handle=function(t,e){return""},e=i,(n.DelRow=e).__class="com.mxgraph.io.vsdx.geometry.DelRow"}(com=com||{}),function(u){var t,e,o;function n(t,e,n,s,i,r,a){n=o.call(this,t,e,n)||this;return n.a=s,n.b=i,n.c=r,n.d=a,n}t=u.mxgraph||(u.mxgraph={}),e=(t=(e=t.io||(t.io={})).vsdx||(e.vsdx={})).geometry||(t.geometry={}),o=u.mxgraph.io.vsdx.geometry.Row,__extends(n,o),n.prototype.handle=function(t,e){if(null==this.x||null==this.y||null==this.a||null==this.b||null==this.c||null==this.d)return"";var n=e.getHeight(),s=e.getWidth(),i=this.x*u.mxgraph.io.vsdx.mxVsdxUtils.conversionFactor_$LI$(),r=n-(r=this.y*u.mxgraph.io.vsdx.mxVsdxUtils.conversionFactor_$LI$()),a=this.a*u.mxgraph.io.vsdx.mxVsdxUtils.conversionFactor_$LI$(),o=n-(o=this.b*u.mxgraph.io.vsdx.mxVsdxUtils.conversionFactor_$LI$()),l=this.c*u.mxgraph.io.vsdx.mxVsdxUtils.conversionFactor_$LI$(),e=n-(e=this.d*u.mxgraph.io.vsdx.mxVsdxUtils.conversionFactor_$LI$()),a=Math.abs(a-i),o=Math.abs(o-r),o=Math.sqrt(a*a+o*o),l=Math.abs(l-i),e=Math.abs(e-r),i=100*i/s,r=100*r/n,s=100*o/s/2,e=100*Math.sqrt(l*l+e*e)/n/2,e=Math.round(100*e)/100,s=Math.round(100*s)/100,n=Math.round(100*(i-2*s))/100,i=Math.round(100*(i+2*s))/100,r=Math.round(100*r)/100;return'<move x="'+new String(n).toString()+'" y="'+new String(r).toString()+'"/><arc rx="'+new String(s).toString()+'" ry="'+new String(e).toString()+'" x="'+new String(i).toString()+'" y="'+new String(r).toString()+'" x-axis-rotation="0" large-arc-flag="1" sweep-flag="0"/><arc rx="'+new String(s).toString()+'" ry="'+new String(e).toString()+'" x="'+new String(n).toString()+'" y="'+new String(r).toString()+'" x-axis-rotation="0" large-arc-flag="1" sweep-flag="0"/>'},t=n,(e.Ellipse=t).__class="com.mxgraph.io.vsdx.geometry.Ellipse"}(com=com||{}),function(L){var t,e,o;function n(t,e,n,s,i,r,a){n=o.call(this,t,e,n)||this;return n.a=s,n.b=i,n.c=r,n.d=a,n}t=L.mxgraph||(L.mxgraph={}),e=(t=(e=t.io||(t.io={})).vsdx||(e.vsdx={})).geometry||(t.geometry={}),o=L.mxgraph.io.vsdx.geometry.Row,__extends(n,o),n.prototype.handle=function(t,e){if(null==this.x||null==this.y||null==this.a||null==this.b||null==this.c||null==this.d)return"";var n=e.getHeight(),s=e.getWidth(),i=this.x*L.mxgraph.io.vsdx.mxVsdxUtils.conversionFactor_$LI$(),r=n-(r=this.y*L.mxgraph.io.vsdx.mxVsdxUtils.conversionFactor_$LI$()),a=this.a*L.mxgraph.io.vsdx.mxVsdxUtils.conversionFactor_$LI$(),o=this.b*L.mxgraph.io.vsdx.mxVsdxUtils.conversionFactor_$LI$(),l=this.c,u=this.d,i=100*i/s;r=100*r/n;var h=e.getLastX()*s/100,g=e.getLastY()*n/100,x=i*s/100,m=r*n/100,p=a,c=n-o,d=-l,y=Math.sqrt(h*h+g*g)*Math.cos(Math.atan2(g,h)-d),_=Math.sqrt(h*h+g*g)*Math.sin(Math.atan2(g,h)-d),v=Math.sqrt(x*x+m*m)*Math.cos(Math.atan2(m,x)-d),f=Math.sqrt(x*x+m*m)*Math.sin(Math.atan2(m,x)-d),S=Math.sqrt(p*p+c*c)*Math.cos(Math.atan2(c,p)-d),C=Math.sqrt(p*p+c*c)*Math.sin(Math.atan2(c,p)-d),I=((y-v)*(y+v)*(f-C)-(v-S)*(v+S)*(_-f)+u*u*(_-f)*(f-C)*(_-C))/(2*((y-v)*(f-C)-(v-S)*(_-f))),a=((y-v)*(v-S)*(y-S)/(u*u)+(v-S)*(_-f)*(_+f)-(y-v)*(f-C)*(f+C))/(2*((v-S)*(_-f)-(y-v)*(f-C))),o=(Math.sqrt(I*I+a*a),Math.cos(Math.atan2(a,I)+d),Math.sqrt(I*I+a*a),Math.sin(Math.atan2(a,I)+d),y-I),l=_-a,u=(l=Math.sqrt(o*o+l*l*u*u))/u,d=180*d/Math.PI,l=100*l/s,u=100*u/n;i=Math.round(100*i)/100,r=Math.round(100*r)/100,l=Math.round(100*l)/100,u=Math.round(100*u)/100;d=Math.round(100*d)/100,p=0<(x-h)*(c-g)-(m-g)*(p-h)?"0":"1",h="0";return L.mxgraph.io.vsdx.mxVsdxUtils.isInsideTriangle(I,a,y,_,v,f,S,C)&&(h="1"),e.setLastX(i),e.setLastY(r),'<arc rx="'+new String(l).toString()+'" ry="'+new String(u).toString()+'" x="'+new String(i).toString()+'" y="'+new String(r).toString()+'" x-axis-rotation="'+new String(d).toString()+'" large-arc-flag="'+h+'" sweep-flag="'+p+'"/>'},n.prototype.isReflexAngle=function(t,e,n,s,i,r,a,o){n-=t,s-=e,i-=t,r-=e,i=a-t,o-=e,e=t=0;var n=180*(Math.atan2(s,n)-Math.atan2(e,t))/Math.PI,i=180*(Math.atan2(r,i)-Math.atan2(e,t))/Math.PI,t=180*(Math.atan2(o,a)-Math.atan2(e,t))/Math.PI;return 180<(n=(n-t)%360)?n-=360:n<-180&&(n+=360),180<(i=(i-t)%360)?i-=360:i<-180&&(i+=360),(0<n&&i<0||n<0&&0<i)&&180<Math.abs(n-i)},t=n,(e.EllipticalArcTo=t).__class="com.mxgraph.io.vsdx.geometry.EllipticalArcTo"}(com=com||{}),function(t){var e,n,r;function s(t,e,n,s,i){n=r.call(this,t,e,n)||this;return n.a=s,n.b=i,n}e=t.mxgraph||(t.mxgraph={}),n=(e=(n=e.io||(e.io={})).vsdx||(n.vsdx={})).geometry||(e.geometry={}),r=t.mxgraph.io.vsdx.geometry.Row,__extends(s,r),s.prototype.handle=function(t,e){return""},e=s,(n.InfiniteLine=e).__class="com.mxgraph.io.vsdx.geometry.InfiniteLine"}(com=com||{}),function(a){var t,e,s;function n(t,e,n){return s.call(this,t,e,n)||this}t=a.mxgraph||(a.mxgraph={}),e=(t=(e=t.io||(t.io={})).vsdx||(e.vsdx={})).geometry||(t.geometry={}),s=a.mxgraph.io.vsdx.geometry.Row,__extends(n,s),n.prototype.handle=function(t,e){var n=t.x,s=t.y,i=e.getHeight(),r=e.getWidth();return null!=this.x&&null!=this.y&&(n=this.x*a.mxgraph.io.vsdx.mxVsdxUtils.conversionFactor_$LI$(),s=this.y*a.mxgraph.io.vsdx.mxVsdxUtils.conversionFactor_$LI$()),n=100*n/r,s=100-(s=100*s/i),n=Math.round(100*n)/100,s=Math.round(100*s)/100,t.x=n,t.y=s,e.setLastX(n),e.setLastY(s),'<line x="'+new String(n).toString()+'" y="'+new String(s).toString()+'"/>'},t=n,(e.LineTo=t).__class="com.mxgraph.io.vsdx.geometry.LineTo"}(com=com||{}),function(a){var t,e,s;function n(t,e,n){return s.call(this,t,e,n)||this}t=a.mxgraph||(a.mxgraph={}),e=(t=(e=t.io||(t.io={})).vsdx||(e.vsdx={})).geometry||(t.geometry={}),s=a.mxgraph.io.vsdx.geometry.Row,__extends(n,s),n.prototype.handle=function(t,e){var n=t.x,s=t.y,i=e.getHeight(),r=e.getWidth();return null!=this.x&&null!=this.y&&(n=this.x*a.mxgraph.io.vsdx.mxVsdxUtils.conversionFactor_$LI$(),s=this.y*a.mxgraph.io.vsdx.mxVsdxUtils.conversionFactor_$LI$()),n=100*n/r,s=100-(s=100*s/i),n=Math.round(100*n)/100,s=Math.round(100*s)/100,t.x=n,t.y=s,e.setLastX(n),e.setLastY(s),e.setLastMoveX(n),e.setLastMoveY(s),'<move x="'+new String(n).toString()+'" y="'+new String(s).toString()+'"/>'},t=n,(e.MoveTo=t).__class="com.mxgraph.io.vsdx.geometry.MoveTo"}(com=com||{}),function(y){var t,e,l;function _(t,e,n,s,i,r,a,o){n=l.call(this,t,e,n)||this;return n.a=s,n.b=i,n.c=r,n.d=a,n.formulaE=o,n}function n(t,e,n,s){this.__parent=t,this.nurbsValues=[];for(var i=e.split(/\s*,\s*/).slice(0),r=0;r<i.length;r++)3<r&&r%4==0?this.nurbsValues.push(100*parseFloat(i[r])):3<r&&r%4==1?this.nurbsValues.push(100-100*parseFloat(i[r])):this.nurbsValues.push(parseFloat(i[r]))}t=y.mxgraph||(y.mxgraph={}),e=(t=(e=t.io||(t.io={})).vsdx||(e.vsdx={})).geometry||(t.geometry={}),l=y.mxgraph.io.vsdx.geometry.Row,__extends(_,l),_.prototype.handle=function(t,e){if(null!=this.x&&null!=this.y&&null!=this.formulaE){var n=e.getHeight(),s=e.getWidth(),i=this.x*y.mxgraph.io.vsdx.mxVsdxUtils.conversionFactor_$LI$(),r=this.y*y.mxgraph.io.vsdx.mxVsdxUtils.conversionFactor_$LI$(),a=(a=this.formulaE.split("NURBS(").join("")).split(")").join(""),o=new _.Nurbs(this,a,s,n);if(2<=o.getSize()){var l=o.getX(0),u=o.getY(0),h=o.getX(1),a=o.getY(1),i=100*i/s;if(r=100-(r=100*r/n),i=Math.round(100*i)/100,r=Math.round(100*r)/100,l=Math.round(100*l)/100,u=Math.round(100*u)/100,h=Math.round(100*h)/100,a=Math.round(100*a)/100,e.setLastX(i),e.setLastY(r),3===o.getDegree()&&o.isOrderedByThree(this.getA())){for(var g=[],x=[],m=[],p=o.getSize(),c=0;c<p-1;c+=3)g.push(new mxPoint(o.getX(c),o.getY(c))),x.push(new mxPoint(o.getX(c+1),o.getY(c+1))),c<p-2?m.push(new mxPoint(o.getX(c+2),o.getY(c+2))):m.push(new mxPoint(i,r));for(var d="",c=0;c<g.length;c++)d+='<curve x1="'+g[c].x+'" y1="'+g[c].y+'" x2="'+x[c].x+'" y2="'+x[c].y+'" x3="'+m[c].x+'" y3="'+m[c].y+'"/>\n';return d}return'<curve x1="'+new String(l).toString()+'" y1="'+new String(u).toString()+'" x2="'+new String(h).toString()+'" y2="'+new String(a).toString()+'" x3="'+new String(i).toString()+'" y3="'+new String(r).toString()+'"/>'}}return""},t=_,(e.NURBSTo=t).__class="com.mxgraph.io.vsdx.geometry.NURBSTo",e=t=e.NURBSTo||(e.NURBSTo={}),n.prototype.isOrderedByThree=function(t){for(var e=0;e+2<this.getSize();e+=3){var n=Math.round(100*this.getKnot(e))/100,s=Math.round(100*this.getKnot(e+1))/100,i=Math.round(100*this.getKnot(e+2))/100;if(n!=s||n!=i||s!=i)return!1}var r=Math.round(10*this.getKnot(this.getSize()-2))/10,a=Math.round(10*this.getKnot(this.getSize()-1))/10,t=Math.round(10*t)/10;return r==a&&r==t&&a==t},n.prototype.getSize=function(){return(this.nurbsValues.length/4|0)-1},n.prototype.getKnotLast=function(){return this.nurbsValues[0]},n.prototype.getDegree=function(){return this.nurbsValues[1]},n.prototype.getXType=function(){return this.nurbsValues[2]},n.prototype.getYType=function(){return this.nurbsValues[3]},n.prototype.getX=function(t){return this.nurbsValues[4*(t+1)]},n.prototype.getY=function(t){return this.nurbsValues[4*(t+1)+1]},n.prototype.getKnot=function(t){return this.nurbsValues[4*(t+1)+2]},n.prototype.getWeight=function(t){return this.nurbsValues[4*(t+1)+3]},t=n,(e.Nurbs=t).__class="com.mxgraph.io.vsdx.geometry.NURBSTo.Nurbs"}(com=com||{}),function(m){var t,e,i;function n(t,e,n,s){n=i.call(this,t,e,n)||this;return n.formulaA=s,n}t=m.mxgraph||(m.mxgraph={}),e=(t=(e=t.io||(t.io={})).vsdx||(e.vsdx={})).geometry||(t.geometry={}),i=m.mxgraph.io.vsdx.geometry.Row,__extends(n,i),n.prototype.handle=function(t,e){var n,s="";if(null!=this.x&&null!=this.y&&null!=this.formulaA){var i,r=e.getHeight(),a=e.getWidth(),o=100*(o=this.x*m.mxgraph.io.vsdx.mxVsdxUtils.conversionFactor_$LI$())/a;i=100-(i=100*(i=this.y*m.mxgraph.io.vsdx.mxVsdxUtils.conversionFactor_$LI$())/r),o=Math.round(100*o)/100,i=Math.round(100*i)/100;var l=this.formulaA.replace(new RegExp("\\s","g"),"").toLowerCase().replace(new RegExp("polyline\\(","g"),"").replace(new RegExp("\\)","g"),"");if((n=l)&&n.equals?n.equals("inh"):"inh"===n)throw Object.defineProperty(new Error,"__classes",{configurable:!0,value:["java.lang.Throwable","java.lang.Object","java.lang.RuntimeException","java.lang.IllegalArgumentException","java.lang.Exception"]});for(var u=l.split(",").slice(0).slice(0),h=parseFloat(u.splice(0,1)),g=(parseFloat(u.splice(0,1)),0),x=0;0<u.length;)g=parseFloat(u.splice(0,1))*m.mxgraph.io.vsdx.mxVsdxUtils.conversionFactor_$LI$(),x=parseFloat(u.splice(0,1))*m.mxgraph.io.vsdx.mxVsdxUtils.conversionFactor_$LI$(),1===h&&(g=100*g/a),x=100-(x=1===h?100*x/r:x),g=Math.round(100*g)/100,x=Math.round(100*x)/100,e.setLastX(g),e.setLastY(x),s+='<line x="'+new String(g).toString()+'" y="'+new String(x).toString()+'"/>';s+='<line x="'+new String(o).toString()+'" y="'+new String(i).toString()+'"/>',e.getLastMoveX()===o&&e.getLastMoveY()===i&&(s+="<close/>")}return s},t=n,(e.PolylineTo=t).__class="com.mxgraph.io.vsdx.geometry.PolylineTo"}(com=com||{}),function(t){var e,n,o;function s(t,e,n,s,i,r,a){n=o.call(this,t,e,n)||this;return n.a=s,n.b=i,n.c=r,n.d=a,n}e=t.mxgraph||(t.mxgraph={}),n=(e=(n=e.io||(e.io={})).vsdx||(n.vsdx={})).geometry||(e.geometry={}),o=t.mxgraph.io.vsdx.geometry.Row,__extends(s,o),s.prototype.handle=function(t,e){if(null==this.x||null==this.y||null==this.a||null==this.b||null==this.c||null==this.d)return"";var n=100*this.x,s=100-100*this.y,i=100*this.a,r=100-100*this.b,a=100*this.c,o=100-100*this.d,n=Math.round(100*n)/100,s=Math.round(100*s)/100,i=Math.round(100*i)/100,r=Math.round(100*r)/100,a=Math.round(100*a)/100,o=Math.round(100*o)/100;return e.setLastX(n),e.setLastY(s),'<curve x1="'+new String(i).toString()+'" y1="'+new String(r).toString()+'" x2="'+new String(a).toString()+'" y2="'+new String(o).toString()+'" x3="'+new String(n).toString()+'" y3="'+new String(s).toString()+'"/>'},e=s,(n.RelCubBezTo=e).__class="com.mxgraph.io.vsdx.geometry.RelCubBezTo"}(com=com||{}),function(t){var e,n,s;function i(t,e,n){return s.call(this,t,e,n)||this}e=t.mxgraph||(t.mxgraph={}),n=(e=(n=e.io||(e.io={})).vsdx||(n.vsdx={})).geometry||(e.geometry={}),s=t.mxgraph.io.vsdx.geometry.Row,__extends(i,s),i.prototype.handle=function(t,e){var n=t.x,s=t.y;return null!=this.x&&null!=this.y&&(n=100*this.x,s=100-100*this.y),n=Math.round(100*n)/100,s=Math.round(100*s)/100,t.x=n,t.y=s,e.setLastX(n),e.setLastY(s),'<line x="'+new String(n).toString()+'" y="'+new String(s).toString()+'"/>'},e=i,(n.RelLineTo=e).__class="com.mxgraph.io.vsdx.geometry.RelLineTo"}(com=com||{}),function(t){var e,n,s;function i(t,e,n){return s.call(this,t,e,n)||this}e=t.mxgraph||(t.mxgraph={}),n=(e=(n=e.io||(e.io={})).vsdx||(n.vsdx={})).geometry||(e.geometry={}),s=t.mxgraph.io.vsdx.geometry.Row,__extends(i,s),i.prototype.handle=function(t,e){var n=t.x,s=t.y;return null!=this.x&&null!=this.y&&(n=100*this.x,s=100-100*this.y),n=Math.round(100*n)/100,s=Math.round(100*s)/100,t.x=n,t.y=s,e.setLastX(n),e.setLastY(s),e.setLastMoveX(n),e.setLastMoveY(s),'<move x="'+new String(n).toString()+'" y="'+new String(s).toString()+'"/>'},e=i,(n.RelMoveTo=e).__class="com.mxgraph.io.vsdx.geometry.RelMoveTo"}(com=com||{}),function(t){var e,n,r;function s(t,e,n,s,i){n=r.call(this,t,e,n)||this;return n.a=s,n.b=i,n}e=t.mxgraph||(t.mxgraph={}),n=(e=(n=e.io||(e.io={})).vsdx||(n.vsdx={})).geometry||(e.geometry={}),r=t.mxgraph.io.vsdx.geometry.Row,__extends(s,r),s.prototype.handle=function(t,e){if(null==this.x||null==this.y||null==this.a||null==this.b)return"";var n=100*this.x,s=100-100*this.y,i=100*this.a,r=100-100*this.b,n=Math.round(100*n)/100,s=Math.round(100*s)/100,i=Math.round(100*i)/100,r=Math.round(100*r)/100;return e.setLastX(n),e.setLastY(s),'<quad x1="'+new String(i).toString()+'" y1="'+new String(r).toString()+'" x2="'+new String(n).toString()+'" y2="'+new String(s).toString()+'"/>'},e=s,(n.RelQuadBezTo=e).__class="com.mxgraph.io.vsdx.geometry.RelQuadBezTo"}(com=com||{}),function(r){var t,e,i;function n(t,e,n,s){n=i.call(this,t,e,n)||this;return n.a=s,n}t=r.mxgraph||(r.mxgraph={}),e=(t=(e=t.io||(t.io={})).vsdx||(e.vsdx={})).geometry||(t.geometry={}),i=r.mxgraph.io.vsdx.geometry.Row,__extends(n,i),n.prototype.handle=function(t,e){var n,s,i;return null!=this.x&&null!=this.y&&null!=this.a&&(i=this.x*r.mxgraph.io.vsdx.mxVsdxUtils.conversionFactor_$LI$(),s=this.y*r.mxgraph.io.vsdx.mxVsdxUtils.conversionFactor_$LI$(),n=this.a,s=100-s,i=Math.round(100*i)/100,s=Math.round(100*s)/100,n=Math.round(100*n)/100,e.setLastX(i),e.setLastY(s)),""},t=n,(e.SplineKnot=t).__class="com.mxgraph.io.vsdx.geometry.SplineKnot"}(com=com||{}),function(r){var t,e,o;function n(t,e,n,s,i,r,a){n=o.call(this,t,e,n)||this;return n.a=s,n.b=i,n.c=r,n.d=a,n}t=r.mxgraph||(r.mxgraph={}),e=(t=(e=t.io||(t.io={})).vsdx||(e.vsdx={})).geometry||(t.geometry={}),o=r.mxgraph.io.vsdx.geometry.Row,__extends(n,o),n.prototype.handle=function(t,e){if(null==this.x||null==this.y||null==this.a||null==this.b||null==this.c||null==this.d)return"";e.getHeight(),e.getWidth();var n=this.x*r.mxgraph.io.vsdx.mxVsdxUtils.conversionFactor_$LI$(),s=this.y*r.mxgraph.io.vsdx.mxVsdxUtils.conversionFactor_$LI$(),i=this.c;this.d;e.setLastKnot(i=i);s=100-s,n=Math.round(100*n)/100;s=Math.round(100*s)/100;i=Math.round(100*i)/100;e.getLastX(),e.getLastY();return e.setLastX(n),e.setLastY(s),"<curve "},t=n,(e.SplineStart=t).__class="com.mxgraph.io.vsdx.geometry.SplineStart"}(com=com||{}),function(p){var t,e;function c(t,e){this.cellElements={},this.sections={},this.styleParents={},this.shape=null,this.Id=null,this.pm=null,this.style=null,this.shape=t,this.pm=e.getPropertiesManager();t=t.getAttribute(p.mxgraph.io.vsdx.mxVsdxConstants.ID);try{this.Id=null!=t&&0!==t.length?parseFloat(t):-1}catch(t){this.Id=-1}this.cacheCells(e),this.stylesheetRefs(e)}t=p.mxgraph||(p.mxgraph={}),t=(e=t.io||(t.io={})).vsdx||(e.vsdx={}),c.__static_initialize=function(){c.__static_initialized||(c.__static_initialized=!0,c.__static_initializer_0(),c.__static_initializer_1())},c.styleTypes_$LI$=function(){return c.__static_initialize(),c.styleTypes=null==c.styleTypes?{}:c.styleTypes},c.__static_initializer_0=function(){c.styleTypes_$LI$()[p.mxgraph.io.vsdx.mxVsdxConstants.FILL]=p.mxgraph.io.vsdx.mxVsdxConstants.FILL_STYLE,c.styleTypes_$LI$()[p.mxgraph.io.vsdx.mxVsdxConstants.FILL_BKGND]=p.mxgraph.io.vsdx.mxVsdxConstants.FILL_STYLE,c.styleTypes_$LI$()[p.mxgraph.io.vsdx.mxVsdxConstants.FILL_BKGND_TRANS]=p.mxgraph.io.vsdx.mxVsdxConstants.FILL_STYLE,c.styleTypes_$LI$()[p.mxgraph.io.vsdx.mxVsdxConstants.FILL_FOREGND]=p.mxgraph.io.vsdx.mxVsdxConstants.FILL_STYLE,c.styleTypes_$LI$()[p.mxgraph.io.vsdx.mxVsdxConstants.FILL_FOREGND_TRANS]=p.mxgraph.io.vsdx.mxVsdxConstants.FILL_STYLE,c.styleTypes_$LI$()[p.mxgraph.io.vsdx.mxVsdxConstants.FILL_PATTERN]=p.mxgraph.io.vsdx.mxVsdxConstants.FILL_STYLE,c.styleTypes_$LI$()[p.mxgraph.io.vsdx.mxVsdxConstants.SHDW_PATTERN]=p.mxgraph.io.vsdx.mxVsdxConstants.FILL_STYLE,c.styleTypes_$LI$()[p.mxgraph.io.vsdx.mxVsdxConstants.FILL_STYLE]=p.mxgraph.io.vsdx.mxVsdxConstants.FILL_STYLE,c.styleTypes_$LI$().QuickStyleFillColor=p.mxgraph.io.vsdx.mxVsdxConstants.FILL_STYLE,c.styleTypes_$LI$().QuickStyleFillMatrix=p.mxgraph.io.vsdx.mxVsdxConstants.FILL_STYLE,c.styleTypes_$LI$()[p.mxgraph.io.vsdx.mxVsdxConstants.BEGIN_ARROW]=p.mxgraph.io.vsdx.mxVsdxConstants.LINE_STYLE,c.styleTypes_$LI$()[p.mxgraph.io.vsdx.mxVsdxConstants.END_ARROW]=p.mxgraph.io.vsdx.mxVsdxConstants.LINE_STYLE,c.styleTypes_$LI$()[p.mxgraph.io.vsdx.mxVsdxConstants.LINE_PATTERN]=p.mxgraph.io.vsdx.mxVsdxConstants.LINE_STYLE,c.styleTypes_$LI$()[p.mxgraph.io.vsdx.mxVsdxConstants.LINE_COLOR]=p.mxgraph.io.vsdx.mxVsdxConstants.LINE_STYLE,c.styleTypes_$LI$()[p.mxgraph.io.vsdx.mxVsdxConstants.LINE_COLOR_TRANS]=p.mxgraph.io.vsdx.mxVsdxConstants.LINE_STYLE,c.styleTypes_$LI$()[p.mxgraph.io.vsdx.mxVsdxConstants.LINE_WEIGHT]=p.mxgraph.io.vsdx.mxVsdxConstants.LINE_STYLE,c.styleTypes_$LI$().QuickStyleLineColor=p.mxgraph.io.vsdx.mxVsdxConstants.LINE_STYLE,c.styleTypes_$LI$().QuickStyleLineMatrix=p.mxgraph.io.vsdx.mxVsdxConstants.LINE_STYLE,c.styleTypes_$LI$()[p.mxgraph.io.vsdx.mxVsdxConstants.BEGIN_ARROW_SIZE]=p.mxgraph.io.vsdx.mxVsdxConstants.LINE_STYLE,c.styleTypes_$LI$()[p.mxgraph.io.vsdx.mxVsdxConstants.END_ARROW_SIZE]=p.mxgraph.io.vsdx.mxVsdxConstants.LINE_STYLE,c.styleTypes_$LI$()[p.mxgraph.io.vsdx.mxVsdxConstants.TEXT_BKGND]=p.mxgraph.io.vsdx.mxVsdxConstants.TEXT_STYLE,c.styleTypes_$LI$()[p.mxgraph.io.vsdx.mxVsdxConstants.BOTTOM_MARGIN]=p.mxgraph.io.vsdx.mxVsdxConstants.TEXT_STYLE,c.styleTypes_$LI$()[p.mxgraph.io.vsdx.mxVsdxConstants.LEFT_MARGIN]=p.mxgraph.io.vsdx.mxVsdxConstants.TEXT_STYLE,c.styleTypes_$LI$()[p.mxgraph.io.vsdx.mxVsdxConstants.RIGHT_MARGIN]=p.mxgraph.io.vsdx.mxVsdxConstants.TEXT_STYLE,c.styleTypes_$LI$()[p.mxgraph.io.vsdx.mxVsdxConstants.TOP_MARGIN]=p.mxgraph.io.vsdx.mxVsdxConstants.TEXT_STYLE,c.styleTypes_$LI$()[p.mxgraph.io.vsdx.mxVsdxConstants.PARAGRAPH]=p.mxgraph.io.vsdx.mxVsdxConstants.TEXT_STYLE,c.styleTypes_$LI$()[p.mxgraph.io.vsdx.mxVsdxConstants.CHARACTER]=p.mxgraph.io.vsdx.mxVsdxConstants.TEXT_STYLE,c.styleTypes_$LI$().QuickStyleFontColor=p.mxgraph.io.vsdx.mxVsdxConstants.TEXT_STYLE,c.styleTypes_$LI$().QuickStyleFontMatrix=p.mxgraph.io.vsdx.mxVsdxConstants.TEXT_STYLE},c.prototype.getTheme=function(){return null},c.prototype.getQuickStyleVals=function(){return null},c.prototype.isVertex=function(){return!1},c.prototype.styleDebug=function(t){c.vsdxStyleDebug&&console.info(t)},c.prototype.stylesheetRefs=function(t){this.styleParents[p.mxgraph.io.vsdx.mxVsdxConstants.FILL_STYLE]=t.getStylesheet(this.shape.getAttribute(p.mxgraph.io.vsdx.mxVsdxConstants.FILL_STYLE)),this.styleParents[p.mxgraph.io.vsdx.mxVsdxConstants.LINE_STYLE]=t.getStylesheet(this.shape.getAttribute(p.mxgraph.io.vsdx.mxVsdxConstants.LINE_STYLE)),this.styleParents[p.mxgraph.io.vsdx.mxVsdxConstants.TEXT_STYLE]=t.getStylesheet(this.shape.getAttribute(p.mxgraph.io.vsdx.mxVsdxConstants.TEXT_STYLE));t=t.getStylesheet("0");this.style=t},c.prototype.cacheCells=function(t){if(null!=this.shape){var e=this.shape.childNodes;if(null!=e)for(var n=e.item(0);null!=n;)null!=n&&1==n.nodeType&&this.parseShapeElem(n,t),n=n.nextSibling}},c.prototype.parseShapeElem=function(t,e){var n,s=t.nodeName;((n=s)&&n.equals?n.equals("Cell"):"Cell"===n)?this.cellElements[t.getAttribute("N")]=t:(n="Section",((s=s)&&s.equals?s.equals(n):s===n)&&this.parseSection(t))},c.prototype.parseSection=function(t){var e=new p.mxgraph.io.vsdx.Section(t);this.sections[t.getAttribute("N")]=e},c.prototype.hasProperty=function(t,e){return this.cellElements.hasOwnProperty(e)},c.prototype.getValue=function(t,e){return null!=t?t.getAttribute("V")||"":e},c.prototype.getValueAsDouble=function(t,e){if(null!=t){var n=t.getAttribute("V");if(null!=n){if((a=n)&&a.equals?a.equals("Themed"):"Themed"===a)return 0;try{var s=parseFloat(n),i=t.getAttribute("U");return((r=i)&&r.equals?r.equals("PT"):"PT"===r)&&(s*=p.mxgraph.io.vsdx.mxVsdxUtils.conversionFactor_$LI$()),Math.round(100*s)/100}catch(t){console.error(t.message,t)}}}var r,a;return e},c.prototype.getScreenNumericalValue$org_w3c_dom_Element$double=function(t,e){if(null!=t){t=t.getAttribute("V");if(null!=t)try{var n=parseFloat(t);return this.getScreenNumericalValue$double(n)}catch(t){console.error(t.message,t)}}return e},c.prototype.getScreenNumericalValue=function(t,e){if((null==t||1!=t.nodeType)&&null!==t||"number"!=typeof e&&null!==e){if("number"!=typeof t&&null!==t||void 0!==e)throw new Error("invalid overload");return this.getScreenNumericalValue$double(t)}return this.getScreenNumericalValue$org_w3c_dom_Element$double(t,e)},c.prototype.getScreenNumericalValue$double=function(t){return t*p.mxgraph.io.vsdx.mxVsdxUtils.conversionFactor_$LI$()},c.prototype.getAttribute=function(t,e,n){t=this.cellElements[t]||null;return n=null!=t?t.getAttribute(e)||"":n},c.prototype.getChildValues=function(t,e){for(var n,s,i,r,a={},o=t.firstChild;null!=o;)null!=o&&1==o.nodeType&&(r=(n=o).nodeName,i=s=null,i=((r=r)&&r.equals?r.equals("Cell"):"Cell"===r)?(s=n.getAttribute("N")||"",n.getAttribute("V")||""):(s=n.nodeName,n.textContent),null==e||null!=(r=e[s]||null)&&(i=n.getAttribute(r)||""),a[s]=i),o=o.nextSibling;return a},c.prototype.getCellElement$java_lang_String$java_lang_String$java_lang_String=function(t,e,n){var s,i=this.sections[n]||null,r=null,a=!1;if(null!=(r=null!=i?i.getIndexedCell(e,t):r)){var o=r.getAttribute("F"),l=r.getAttribute("V");if(null!=o&&null!=l)if(((i=o)&&i.equals?i.equals("Inh"):"Inh"===i)&&((s=l)&&s.equals?s.equals("Themed"):"Themed"===s))a=!0;else if(s="THEMEVAL()",((o=o)&&o.equals?o.equals(s):o===s)&&((u=l)&&u.equals?u.equals("Themed"):"Themed"===u)&&null!=this.style){if(l=p.mxgraph.io.vsdx.mxVsdxConstants.COLOR,u=t,l&&l.equals?l.equals(u):l===u)return r;var u=this.style.getCellElement$java_lang_String$java_lang_String$java_lang_String(t,e,n);if(null!=u)return u}}if(null==r||a){a=c.styleTypes_$LI$()[n]||null,a=this.styleParents[a]||null;if(null!=a){n=a.getCellElement$java_lang_String$java_lang_String$java_lang_String(t,e,n);if(null!=n)return n}}return r},c.prototype.getCellElement=function(t,e,n){if("string"!=typeof t&&null!==t||"string"!=typeof e&&null!==e||"string"!=typeof n&&null!==n){if("string"!=typeof t&&null!==t||void 0!==e||void 0!==n)throw new Error("invalid overload");return this.getCellElement$java_lang_String(t)}return this.getCellElement$java_lang_String$java_lang_String$java_lang_String(t,e,n)},c.prototype.getCellElement$java_lang_String=function(t){var e,n,s,i,r,a,o,l,u=this.cellElements[t]||null,h=!1;if(null!=u){var g=u.getAttribute("F"),x=u.getAttribute("V");if(null!=g&&null!=x)if(((l=g)&&l.equals?l.equals("Inh"):"Inh"===l)&&((l=x)&&l.equals?l.equals("Themed"):"Themed"===l))h=!0;else if(-1!=g.indexOf("THEMEVAL()")&&((o=x)&&o.equals?o.equals("Themed"):"Themed"===o)&&null!=this.style){if(x=t,((o="FillForegnd").equals?o.equals(x):o===x)||(x=p.mxgraph.io.vsdx.mxVsdxConstants.LINE_COLOR,a=t,x&&x.equals?x.equals(a):x===a)||(a=p.mxgraph.io.vsdx.mxVsdxConstants.LINE_PATTERN,r=t,a&&a.equals?a.equals(r):a===r)||(r=p.mxgraph.io.vsdx.mxVsdxConstants.BEGIN_ARROW_SIZE,i=t,r&&r.equals?r.equals(i):r===i)||(i=p.mxgraph.io.vsdx.mxVsdxConstants.END_ARROW_SIZE,s=t,i&&i.equals?i.equals(s):i===s)||(s=p.mxgraph.io.vsdx.mxVsdxConstants.BEGIN_ARROW,n=t,s&&s.equals?s.equals(n):s===n)||(n=p.mxgraph.io.vsdx.mxVsdxConstants.END_ARROW,e=t,n&&n.equals?n.equals(e):n===e)||(e=p.mxgraph.io.vsdx.mxVsdxConstants.LINE_WEIGHT,m=t,e&&e.equals?e.equals(m):e===m))return u;var m=this.style.getCellElement$java_lang_String(t);if(null!=m)return m}}if(null==u||h){h=c.styleTypes_$LI$()[t]||null,h=this.styleParents[h]||null;if(null!=h){t=h.getCellElement$java_lang_String(t);if(null!=t)return t}}return u},c.prototype.getStrokeColor=function(){var t,e,n="";return((e=this.getValue(this.getCellElement$java_lang_String(p.mxgraph.io.vsdx.mxVsdxConstants.LINE_PATTERN),"1"))&&e.equals?e.equals("0"):"0"===e)?n="none":(n=this.getColor(this.getCellElement$java_lang_String(p.mxgraph.io.vsdx.mxVsdxConstants.LINE_COLOR)),t=n,((e="Themed").equals?e.equals(t):e===t)&&(n=null!=(t=this.getTheme())?(this.isVertex()?t.getLineColor$com_mxgraph_io_vsdx_theme_QuickStyleVals(this.getQuickStyleVals()):t.getConnLineColor(this.getQuickStyleVals())).toHexStr():"")),n},c.prototype.getFillColor=function(){var t=this.getValue(this.getCellElement$java_lang_String(p.mxgraph.io.vsdx.mxVsdxConstants.FILL_GRADIENT_ENABLED),"0");if(s=t,"1".equals?"1".equals(s):"1"===s){var e=this.sections["FillGradient"]||null;if(null!=e)if(null!=(n=this.getColor(e.getIndexedCell("0","GradientStopColor")))&&0!==n.length)return n}var n,s,t=this.getColor(this.getCellElement$java_lang_String(p.mxgraph.io.vsdx.mxVsdxConstants.FILL_FOREGND));s=t,((e="Themed").equals?e.equals(s):e===s)&&(t=null!=(i=this.getTheme())?(n=i.getFillColor$com_mxgraph_io_vsdx_theme_QuickStyleVals(this.getQuickStyleVals())).toHexStr():"#FFFFFF");var i=this.getValue(this.getCellElement$java_lang_String(p.mxgraph.io.vsdx.mxVsdxConstants.FILL_PATTERN),"0");return null!=i&&((i=i)&&i.equals?i.equals("0"):"0"===i)?"none":t},c.prototype.getColor=function(t){var e,n,s=this.getValue(t,"");return n=s,s=((t="Themed").equals?!t.equals(n):t!==n)&&"#"!==s.substr(e=void 0===e?0:e,"#".length)?this.pm.getColor(s):s},c.prototype.getTextBkgndColor=function(t){var e,t=this.getValue(t,"");return"#"!==t.substr(e=void 0===e?0:e,"#".length)?((e=t)&&e.equals?e.equals("0"):"0"===e)||((e=t)&&e.equals?e.equals("255"):"255"===e)||0===t.length?"none":this.pm.getColor(new String(parseInt(t)-1).toString()):t},c.prototype.getLineWeight=function(){return this.getScreenNumericalValue$org_w3c_dom_Element$double(this.getCellElement$java_lang_String(p.mxgraph.io.vsdx.mxVsdxConstants.LINE_WEIGHT),0)},c.prototype.getStrokeTransparency=function(){return this.getValueAsDouble(this.getCellElement$java_lang_String(p.mxgraph.io.vsdx.mxVsdxConstants.LINE_COLOR_TRANS),0)},c.prototype.getNameU=function(){return this.shape.getAttribute(p.mxgraph.io.vsdx.mxVsdxConstants.NAME_U)||""},c.prototype.getName=function(){return this.shape.getAttribute(p.mxgraph.io.vsdx.mxVsdxConstants.NAME)||""},c.prototype.getUniqueID=function(){return this.shape.getAttribute(p.mxgraph.io.vsdx.mxVsdxConstants.UNIQUE_ID)||""},c.prototype.getId=function(){return this.Id},c.prototype.getTextColor=function(t){var e,n=this.getCellElement$java_lang_String$java_lang_String$java_lang_String(p.mxgraph.io.vsdx.mxVsdxConstants.COLOR,t,p.mxgraph.io.vsdx.mxVsdxConstants.CHARACTER),s=this.getValue(n,"#000000");return t=s,((n="Themed").equals?n.equals(t):n===t)?(t=this.getTheme(),s=null!=t?(this.isVertex()?t.getFontColor$com_mxgraph_io_vsdx_theme_QuickStyleVals(this.getQuickStyleVals()):t.getConnFontColor(this.getQuickStyleVals())).toHexStr():"#000000"):"#"!==s.substr(e=void 0===e?0:e,"#".length)&&(s=this.pm.getColor(s)),s},c.prototype.getTextTopMargin=function(){return this.getScreenNumericalValue$org_w3c_dom_Element$double(this.getCellElement$java_lang_String(p.mxgraph.io.vsdx.mxVsdxConstants.TOP_MARGIN),0)},c.prototype.getTextBottomMargin=function(){return this.getScreenNumericalValue$org_w3c_dom_Element$double(this.getCellElement$java_lang_String(p.mxgraph.io.vsdx.mxVsdxConstants.BOTTOM_MARGIN),0)},c.prototype.getTextLeftMargin=function(){return this.getScreenNumericalValue$org_w3c_dom_Element$double(this.getCellElement$java_lang_String(p.mxgraph.io.vsdx.mxVsdxConstants.LEFT_MARGIN),0)},c.prototype.getTextRightMargin=function(){return this.getScreenNumericalValue$org_w3c_dom_Element$double(this.getCellElement$java_lang_String(p.mxgraph.io.vsdx.mxVsdxConstants.RIGHT_MARGIN),0)},c.prototype.getTextStyle=function(t){t=this.getCellElement$java_lang_String$java_lang_String$java_lang_String(p.mxgraph.io.vsdx.mxVsdxConstants.STYLE,t,p.mxgraph.io.vsdx.mxVsdxConstants.CHARACTER);return this.getValue(t,"")},c.prototype.getTextFont=function(t){t=this.getCellElement$java_lang_String$java_lang_String$java_lang_String(p.mxgraph.io.vsdx.mxVsdxConstants.FONT,t,p.mxgraph.io.vsdx.mxVsdxConstants.CHARACTER);return this.getValue(t,"")},c.prototype.getTextPos=function(t){t=this.getCellElement$java_lang_String$java_lang_String$java_lang_String(p.mxgraph.io.vsdx.mxVsdxConstants.POS,t,p.mxgraph.io.vsdx.mxVsdxConstants.CHARACTER);return this.getValue(t,"")},c.prototype.getTextStrike=function(t){var t=this.getCellElement$java_lang_String$java_lang_String$java_lang_String(p.mxgraph.io.vsdx.mxVsdxConstants.STRIKETHRU,t,p.mxgraph.io.vsdx.mxVsdxConstants.CHARACTER);return(t=this.getValue(t,""))&&t.equals?t.equals("1"):"1"===t},c.prototype.getTextCase=function(t){t=this.getCellElement$java_lang_String$java_lang_String$java_lang_String(p.mxgraph.io.vsdx.mxVsdxConstants.CASE,t,p.mxgraph.io.vsdx.mxVsdxConstants.CHARACTER);return this.getValue(t,"")},c.prototype.getHorizontalAlign=function(t,e){var n="center",t=this.getCellElement$java_lang_String$java_lang_String$java_lang_String(p.mxgraph.io.vsdx.mxVsdxConstants.HORIZONTAL_ALIGN,t,p.mxgraph.io.vsdx.mxVsdxConstants.PARAGRAPH);switch(this.getValue(t,"")){case"0":n=e?"left":mxConstants.ALIGN_LEFT;break;case"2":n=e?"right":mxConstants.ALIGN_RIGHT;break;case"3":case"4":n=e?"justify":mxConstants.ALIGN_CENTER;break;default:n=e?"center":mxConstants.ALIGN_CENTER}return n},c.prototype.getIndentFirst=function(t){t=this.getCellElement$java_lang_String$java_lang_String$java_lang_String(p.mxgraph.io.vsdx.mxVsdxConstants.INDENT_FIRST,t,p.mxgraph.io.vsdx.mxVsdxConstants.PARAGRAPH);return new String(this.getScreenNumericalValue$org_w3c_dom_Element$double(t,0)).toString()},c.prototype.getIndentLeft=function(t){t=this.getCellElement$java_lang_String$java_lang_String$java_lang_String(p.mxgraph.io.vsdx.mxVsdxConstants.INDENT_LEFT,t,p.mxgraph.io.vsdx.mxVsdxConstants.PARAGRAPH);return new String(0|Math.round(this.getScreenNumericalValue$org_w3c_dom_Element$double(t,0))).toString()},c.prototype.getIndentRight=function(t){t=this.getCellElement$java_lang_String$java_lang_String$java_lang_String(p.mxgraph.io.vsdx.mxVsdxConstants.INDENT_RIGHT,t,p.mxgraph.io.vsdx.mxVsdxConstants.PARAGRAPH);return new String(0|Math.round(this.getScreenNumericalValue$org_w3c_dom_Element$double(t,0))).toString()},c.prototype.getSpBefore=function(t){t=this.getCellElement$java_lang_String$java_lang_String$java_lang_String(p.mxgraph.io.vsdx.mxVsdxConstants.SPACE_BEFORE,t,p.mxgraph.io.vsdx.mxVsdxConstants.PARAGRAPH);return new String(0|Math.round(this.getScreenNumericalValue$org_w3c_dom_Element$double(t,0))).toString()},c.prototype.getSpAfter=function(t){t=this.getCellElement$java_lang_String$java_lang_String$java_lang_String(p.mxgraph.io.vsdx.mxVsdxConstants.SPACE_AFTER,t,p.mxgraph.io.vsdx.mxVsdxConstants.PARAGRAPH);return new String(0|Math.round(this.getScreenNumericalValue$org_w3c_dom_Element$double(t,0))).toString()},c.prototype.getSpLine=function(t){var e=this.getCellElement$java_lang_String$java_lang_String$java_lang_String(p.mxgraph.io.vsdx.mxVsdxConstants.SPACE_LINE,t,p.mxgraph.io.vsdx.mxVsdxConstants.PARAGRAPH),t=this.getValue(e,"");return((e=t)&&e.equals?e.equals(""):""===e)?0:parseFloat(t)},c.prototype.getFlags=function(t){t=this.getCellElement$java_lang_String$java_lang_String$java_lang_String(p.mxgraph.io.vsdx.mxVsdxConstants.FLAGS,t,p.mxgraph.io.vsdx.mxVsdxConstants.PARAGRAPH);return this.getValue(t,"0")},c.prototype.getLetterSpace=function(t){t=this.getCellElement$java_lang_String$java_lang_String$java_lang_String(p.mxgraph.io.vsdx.mxVsdxConstants.LETTER_SPACE,t,p.mxgraph.io.vsdx.mxVsdxConstants.PARAGRAPH);return new String(this.getScreenNumericalValue$org_w3c_dom_Element$double(t,0)).toString()},c.prototype.getBullet=function(t){t=this.getCellElement$java_lang_String$java_lang_String$java_lang_String(p.mxgraph.io.vsdx.mxVsdxConstants.BULLET,t,p.mxgraph.io.vsdx.mxVsdxConstants.PARAGRAPH);return this.getValue(t,"0")},c.prototype.getShape=function(){return this.shape},c.prototype.setShape=function(t){this.shape=t},c.lineDashPatterns_$LI$=function(){return c.__static_initialize(),c.lineDashPatterns=null==c.lineDashPatterns?[]:c.lineDashPatterns},c.__static_initializer_1=function(){c.lineDashPatterns_$LI$().push([]),c.lineDashPatterns_$LI$().push([]),c.lineDashPatterns_$LI$().push([]);var t=[];t.push(c.DOT),t.push(c.SPACE),c.lineDashPatterns_$LI$().push(t),(t=[]).push(c.DASH),t.push(c.SPACE),t.push(c.DOT),t.push(c.SPACE),c.lineDashPatterns_$LI$().push(t),(t=[]).push(c.DASH),t.push(c.SPACE),t.push(c.DOT),t.push(c.SPACE),t.push(c.DOT),t.push(c.SPACE),c.lineDashPatterns_$LI$().push(t),(t=[]).push(c.DASH),t.push(c.SPACE),t.push(c.DASH),t.push(c.SPACE),t.push(c.DOT),t.push(c.SPACE),c.lineDashPatterns_$LI$().push(t),(t=[]).push(c.LONG_DASH),t.push(c.SPACE),t.push(c.SHORT_DASH),t.push(c.SPACE),c.lineDashPatterns_$LI$().push(t),(t=[]).push(c.LONG_DASH),t.push(c.SPACE),t.push(c.SHORT_DASH),t.push(c.SPACE),t.push(c.SHORT_DASH),t.push(c.SPACE),c.lineDashPatterns_$LI$().push(t),(t=[]).push(c.SHORT_DASH),t.push(c.SHORT_SPACE),c.lineDashPatterns_$LI$().push(t),(t=[]).push(c.DOT),t.push(c.SHORT_SPACE),c.lineDashPatterns_$LI$().push(t),(t=[]).push(c.SHORT_DASH),t.push(c.SHORT_SPACE),t.push(c.DOT),t.push(c.SHORT_SPACE),c.lineDashPatterns_$LI$().push(t),(t=[]).push(c.SHORT_DASH),t.push(c.SHORT_SPACE),t.push(c.DOT),t.push(c.SHORT_SPACE),t.push(c.DOT),t.push(c.SHORT_SPACE),c.lineDashPatterns_$LI$().push(t),(t=[]).push(c.SHORT_DASH),t.push(c.SHORT_SPACE),t.push(c.SHORT_DASH),t.push(c.SHORT_SPACE),t.push(c.DOT),t.push(c.SHORT_SPACE),c.lineDashPatterns_$LI$().push(t),(t=[]).push(c.DASH),t.push(c.SHORT_SPACE),t.push(c.SHORT_DASH),t.push(c.SHORT_SPACE),c.lineDashPatterns_$LI$().push(t),(t=[]).push(c.DASH),t.push(c.SHORT_SPACE),t.push(c.SHORT_DASH),t.push(c.SHORT_SPACE),t.push(c.SHORT_DASH),t.push(c.SHORT_SPACE),c.lineDashPatterns_$LI$().push(t),(t=[]).push(c.LONG_DASH),t.push(c.LONG_SPACE),c.lineDashPatterns_$LI$().push(t),(t=[]).push(c.DOT),t.push(c.LONG_SPACE),c.lineDashPatterns_$LI$().push(t),(t=[]).push(c.LONG_DASH),t.push(c.LONG_SPACE),t.push(c.DOT),t.push(c.LONG_SPACE),c.lineDashPatterns_$LI$().push(t),(t=[]).push(c.LONG_DASH),t.push(c.LONG_SPACE),t.push(c.DOT),t.push(c.LONG_SPACE),t.push(c.DOT),t.push(c.LONG_SPACE),c.lineDashPatterns_$LI$().push(t),(t=[]).push(c.LONG_DASH),t.push(c.LONG_SPACE),t.push(c.LONG_DASH),t.push(c.LONG_SPACE),t.push(c.DOT),t.push(c.LONG_SPACE),c.lineDashPatterns_$LI$().push(t),(t=[]).push(c.XLONG_DASH),t.push(c.LONG_SPACE),t.push(c.DASH),t.push(c.LONG_SPACE),c.lineDashPatterns_$LI$().push(t),(t=[]).push(c.XLONG_DASH),t.push(c.LONG_SPACE),t.push(c.DASH),t.push(c.LONG_SPACE),t.push(c.DASH),t.push(c.LONG_SPACE),c.lineDashPatterns_$LI$().push(t),(t=[]).push(c.XSHORT_DASH),t.push(c.SHORT_SPACE),c.lineDashPatterns_$LI$().push(t)},c.getLineDashPattern=function(t){return 0<=t&&t<=23?c.lineDashPatterns_$LI$()[t]:c.lineDashPatterns_$LI$()[0]},(e=c).__static_initialized=!1,e.vsdxStyleDebug=!1,e.SPACE=4,e.SHORT_SPACE=2,e.LONG_SPACE=6,e.DOT=1,e.DASH=8,e.LONG_DASH=12,e.SHORT_DASH=4,e.XLONG_DASH=20,e.XSHORT_DASH=2,(t.Style=e).__class="com.mxgraph.io.vsdx.Style"}(com=com||{}),function(i){var t,e,r;function n(t,e,n){var s=r.call(this)||this;return s.__com_mxgraph_io_vsdx_theme_HslClr_hue=0,s.__com_mxgraph_io_vsdx_theme_HslClr_sat=0,s.__com_mxgraph_io_vsdx_theme_HslClr_lum=0,s.__com_mxgraph_io_vsdx_theme_HslClr_hue=t/360,s.__com_mxgraph_io_vsdx_theme_HslClr_sat=e/100,s.__com_mxgraph_io_vsdx_theme_HslClr_lum=n/100,s.color=new i.mxgraph.io.vsdx.theme.HSLColor(t,e,n).toRgb(),s}t=i.mxgraph||(i.mxgraph={}),e=(t=(e=t.io||(t.io={})).vsdx||(e.vsdx={})).theme||(t.theme={}),r=i.mxgraph.io.vsdx.theme.OoxmlColor,__extends(n,r),t=n,(e.HslClr=t).__class="com.mxgraph.io.vsdx.theme.HslClr"}(com=com||{}),function(n){var t,e,s;function i(t){var e=s.call(this)||this;return e.val=null,e.val=t,e.color=new n.mxgraph.io.vsdx.theme.Color(255,255,255),e}t=n.mxgraph||(n.mxgraph={}),e=(t=(e=t.io||(t.io={})).vsdx||(e.vsdx={})).theme||(t.theme={}),s=n.mxgraph.io.vsdx.theme.OoxmlColor,__extends(i,s),t=i,(e.PrstClr=t).__class="com.mxgraph.io.vsdx.theme.PrstClr"}(com=com||{}),function(t){var e,n,i;function s(t){var e=i.call(this)||this;return e.val=null,e.isDynamic=!0,e.val=t,e}e=t.mxgraph||(t.mxgraph={}),n=(e=(n=e.io||(e.io={})).vsdx||(n.vsdx={})).theme||(e.theme={}),i=t.mxgraph.io.vsdx.theme.OoxmlColor,__extends(s,i),s.prototype.calcColor=function(t,e){var n,s;n="phClr",s=this.val,(n.equals?n.equals(s):n===s)?this.color=e.getStyleColor(t):(this.color=e.getSchemeColor(this.val),this.isDynamic=!1),i.prototype.calcColor.call(this,t,e)},e=s,(n.SchemeClr=e).__class="com.mxgraph.io.vsdx.theme.SchemeClr"}(com=com||{}),function(i){var t,e,r;function n(t,e,n){var s=r.call(this)||this;return s.r=0,s.g=0,s.b=0,s.r=t,s.g=e,s.b=n,s.color=new i.mxgraph.io.vsdx.theme.Color(t,e,n),s}t=i.mxgraph||(i.mxgraph={}),e=(t=(e=t.io||(t.io={})).vsdx||(e.vsdx={})).theme||(t.theme={}),r=i.mxgraph.io.vsdx.theme.OoxmlColor,__extends(n,r),t=n,(e.ScrgbClr=t).__class="com.mxgraph.io.vsdx.theme.ScrgbClr"}(com=com||{}),function(n){var t,e,s;function i(t){var e=s.call(this)||this;return e.hexVal=null,e.hexVal=t,e.color=n.mxgraph.io.vsdx.theme.Color.decodeColorHex(t),e}t=n.mxgraph||(n.mxgraph={}),e=(t=(e=t.io||(t.io={})).vsdx||(e.vsdx={})).theme||(t.theme={}),s=n.mxgraph.io.vsdx.theme.OoxmlColor,__extends(i,s),t=i,(e.SrgbClr=t).__class="com.mxgraph.io.vsdx.theme.SrgbClr"}(com=com||{}),function(s){var t,e,i;function n(t,e){var n=i.call(this)||this;n.val=null,n.lastClr=null,n.val=t;e=n.lastClr=e;return n.color=s.mxgraph.io.vsdx.theme.Color.decodeColorHex(e=null==e?"windowText"===t?"000000":"FFFFFF":e),n}t=s.mxgraph||(s.mxgraph={}),e=(t=(e=t.io||(t.io={})).vsdx||(e.vsdx={})).theme||(t.theme={}),i=s.mxgraph.io.vsdx.theme.OoxmlColor,__extends(n,i),t=n,(e.SysClr=t).__class="com.mxgraph.io.vsdx.theme.SysClr"}(com=com||{}),function(i){var t,e,o;function n(t,e,n,s,i,r,a){return o.call(this,t,e,n,s,i,r,a)||this}t=i.mxgraph||(i.mxgraph={}),e=(t=(e=t.io||(t.io={})).vsdx||(e.vsdx={})).geometry||(t.geometry={}),o=i.mxgraph.io.vsdx.geometry.EllipticalArcTo,__extends(n,o),n.prototype.handle=function(t,e){var n,s;return null!=this.x&&null!=this.y&&null!=this.a&&null!=this.b&&null!=this.c&&null!=this.d&&(n=e.getHeight()/i.mxgraph.io.vsdx.mxVsdxUtils.conversionFactor_$LI$(),s=e.getWidth()/i.mxgraph.io.vsdx.mxVsdxUtils.conversionFactor_$LI$(),this.x*=s,this.y*=n,this.a*=s,this.b*=n),o.prototype.handle.call(this,t,e)},t=n,(e.RelEllipticalArcTo=t).__class="com.mxgraph.io.vsdx.geometry.RelEllipticalArcTo"}(com=com||{}),function(d){var t,e,y;function _(t,e){var n=this;return n.text=null,n.fields=null,n.geom=null,n.imageData=null,n.theme=null,n.quickStyleVals=null,(n=y.call(this,t,e)||this).paragraphs=null,n.styleMap={},n.width=0,n.height=0,n.rotation=0,n.lastX=0,n.lastY=0,n.lastMoveX=0,n.lastMoveY=0,n.lastKnot=-1,n.geomList=null,n.geomListProcessed=!1,n.themeVariant=0,n.cp="0",n.pp="0",n.tp="0",n.fld="0",n.width=n.getScreenNumericalValue$org_w3c_dom_Element$double((t=n.cellElements,e=d.mxgraph.io.vsdx.mxVsdxConstants.WIDTH,t[e]||null),0),n.height=n.getScreenNumericalValue$org_w3c_dom_Element$double((t=n.cellElements,e=d.mxgraph.io.vsdx.mxVsdxConstants.HEIGHT,t[e]||null),0),n}t=d.mxgraph||(d.mxgraph={}),t=(e=t.io||(t.io={})).vsdx||(e.vsdx={}),y=d.mxgraph.io.vsdx.Style,__extends(_,y),_.UNICODE_LINE_SEP_$LI$=function(){return null==_.UNICODE_LINE_SEP&&(_.ERROR_IMAGE="PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+DQo8IS0tIENyZWF0ZWQgd2l0aCBJbmtzY2FwZSAoaHR0cDovL3d3dy5pbmtzY2FwZS5vcmcvKSAtLT4NCjxzdmcNCiAgIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyINCiAgIHhtbG5zOmNjPSJodHRwOi8vY3JlYXRpdmVjb21tb25zLm9yZy9ucyMiDQogICB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiDQogICB4bWxuczpzdmc9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIg0KICAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIg0KICAgeG1sbnM6c29kaXBvZGk9Imh0dHA6Ly9zb2RpcG9kaS5zb3VyY2Vmb3JnZS5uZXQvRFREL3NvZGlwb2RpLTAuZHRkIg0KICAgeG1sbnM6aW5rc2NhcGU9Imh0dHA6Ly93d3cuaW5rc2NhcGUub3JnL25hbWVzcGFjZXMvaW5rc2NhcGUiDQogICB3aWR0aD0iMjUwIg0KICAgaGVpZ2h0PSIyNTAiDQogICBpZD0ic3ZnMzMxOSINCiAgIHNvZGlwb2RpOnZlcnNpb249IjAuMzIiDQogICBpbmtzY2FwZTp2ZXJzaW9uPSIwLjQ2Ig0KICAgdmVyc2lvbj0iMS4wIg0KICAgc29kaXBvZGk6ZG9jbmFtZT0ibm9waG90b19pLnN2ZyINCiAgIGlua3NjYXBlOm91dHB1dF9leHRlbnNpb249Im9yZy5pbmtzY2FwZS5vdXRwdXQuc3ZnLmlua3NjYXBlIj4NCiAgPGRlZnMNCiAgICAgaWQ9ImRlZnMzMzIxIj4NCiAgICA8aW5rc2NhcGU6cGVyc3BlY3RpdmUNCiAgICAgICBzb2RpcG9kaTp0eXBlPSJpbmtzY2FwZTpwZXJzcDNkIg0KICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiA1MjYuMTgxMDkgOiAxIg0KICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCINCiAgICAgICBpbmtzY2FwZTp2cF96PSI3NDQuMDk0NDggOiA1MjYuMTgxMDkgOiAxIg0KICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSIzNzIuMDQ3MjQgOiAzNTAuNzg3MzkgOiAxIg0KICAgICAgIGlkPSJwZXJzcGVjdGl2ZTMzMjciIC8+DQogICAgPGlua3NjYXBlOnBlcnNwZWN0aXZlDQogICAgICAgaWQ9InBlcnNwZWN0aXZlMzM0MiINCiAgICAgICBpbmtzY2FwZTpwZXJzcDNkLW9yaWdpbj0iMzcyLjA0NzI0IDogMzUwLjc4NzM5IDogMSINCiAgICAgICBpbmtzY2FwZTp2cF96PSI3NDQuMDk0NDggOiA1MjYuMTgxMDkgOiAxIg0KICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCINCiAgICAgICBpbmtzY2FwZTp2cF94PSIwIDogNTI2LjE4MTA5IDogMSINCiAgICAgICBzb2RpcG9kaTp0eXBlPSJpbmtzY2FwZTpwZXJzcDNkIiAvPg0KICA8L2RlZnM+DQogIDxzb2RpcG9kaTpuYW1lZHZpZXcNCiAgICAgaWQ9ImJhc2UiDQogICAgIHBhZ2Vjb2xvcj0iI2ZmZmZmZiINCiAgICAgYm9yZGVyY29sb3I9IiM2NjY2NjYiDQogICAgIGJvcmRlcm9wYWNpdHk9IjEuMCINCiAgICAgaW5rc2NhcGU6cGFnZW9wYWNpdHk9IjAuMCINCiAgICAgaW5rc2NhcGU6cGFnZXNoYWRvdz0iMiINCiAgICAgaW5rc2NhcGU6em9vbT0iMi4yNDI5NDI3Ig0KICAgICBpbmtzY2FwZTpjeD0iMTIxLjk3NjQ4Ig0KICAgICBpbmtzY2FwZTpjeT0iMTIyLjQ0MTk4Ig0KICAgICBpbmtzY2FwZTpkb2N1bWVudC11bml0cz0icHgiDQogICAgIGlua3NjYXBlOmN1cnJlbnQtbGF5ZXI9ImxheWVyMSINCiAgICAgc2hvd2dyaWQ9ImZhbHNlIg0KICAgICBpbmtzY2FwZTp3aW5kb3ctd2lkdGg9IjE2NjQiDQogICAgIGlua3NjYXBlOndpbmRvdy1oZWlnaHQ9Ijg0NCINCiAgICAgaW5rc2NhcGU6d2luZG93LXg9Ii0zIg0KICAgICBpbmtzY2FwZTp3aW5kb3cteT0iLTE4IiAvPg0KICA8bWV0YWRhdGENCiAgICAgaWQ9Im1ldGFkYXRhMzMyNCI+DQogICAgPHJkZjpSREY+DQogICAgICA8Y2M6V29yaw0KICAgICAgICAgcmRmOmFib3V0PSIiPg0KICAgICAgICA8ZGM6Zm9ybWF0PmltYWdlL3N2Zyt4bWw8L2RjOmZvcm1hdD4NCiAgICAgICAgPGRjOnR5cGUNCiAgICAgICAgICAgcmRmOnJlc291cmNlPSJodHRwOi8vcHVybC5vcmcvZGMvZGNtaXR5cGUvU3RpbGxJbWFnZSIgLz4NCiAgICAgICAgPGRjOnRpdGxlPkZvdG9ncmFmaWVydmVyYm90PC9kYzp0aXRsZT4NCiAgICAgICAgPGRjOmRhdGU+MjAwOC0wNi0yOTwvZGM6ZGF0ZT4NCiAgICAgICAgPGRjOmNyZWF0b3I+DQogICAgICAgICAgPGNjOkFnZW50Pg0KICAgICAgICAgICAgPGRjOnRpdGxlPlRvcnJzdGVuIFNrb21wPC9kYzp0aXRsZT4NCiAgICAgICAgICA8L2NjOkFnZW50Pg0KICAgICAgICA8L2RjOmNyZWF0b3I+DQogICAgICAgIDxkYzpyaWdodHM+DQogICAgICAgICAgPGNjOkFnZW50Pg0KICAgICAgICAgICAgPGRjOnRpdGxlPlRvcnN0ZW4gU2tvbXA8L2RjOnRpdGxlPg0KICAgICAgICAgIDwvY2M6QWdlbnQ+DQogICAgICAgIDwvZGM6cmlnaHRzPg0KICAgICAgICA8ZGM6cHVibGlzaGVyPg0KICAgICAgICAgIDxjYzpBZ2VudD4NCiAgICAgICAgICAgIDxkYzp0aXRsZT5Ub3JzdGVuIFNrb21wPC9kYzp0aXRsZT4NCiAgICAgICAgICA8L2NjOkFnZW50Pg0KICAgICAgICA8L2RjOnB1Ymxpc2hlcj4NCiAgICAgICAgPGRjOmxhbmd1YWdlPmRlX0RFPC9kYzpsYW5ndWFnZT4NCiAgICAgICAgPGRjOnN1YmplY3Q+DQogICAgICAgICAgPHJkZjpCYWc+DQogICAgICAgICAgICA8cmRmOmxpPlBpa3RvZ3JhbW07IEZvdG9ncmFmaWVydmVyYm90PC9yZGY6bGk+DQogICAgICAgICAgPC9yZGY6QmFnPg0KICAgICAgICA8L2RjOnN1YmplY3Q+DQogICAgICAgIDxkYzpkZXNjcmlwdGlvbj5Gb3RvZ3JhZmllcnZlcmJvdCBhbHMgUGlrdG9ncmFtbSA8L2RjOmRlc2NyaXB0aW9uPg0KICAgICAgICA8Y2M6bGljZW5zZQ0KICAgICAgICAgICByZGY6cmVzb3VyY2U9Imh0dHA6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL3B1YmxpY2RvbWFpbi8iIC8+DQogICAgICA8L2NjOldvcms+DQogICAgICA8Y2M6TGljZW5zZQ0KICAgICAgICAgcmRmOmFib3V0PSJodHRwOi8vY3JlYXRpdmVjb21tb25zLm9yZy9saWNlbnNlcy9wdWJsaWNkb21haW4vIj4NCiAgICAgICAgPGNjOnBlcm1pdHMNCiAgICAgICAgICAgcmRmOnJlc291cmNlPSJodHRwOi8vY3JlYXRpdmVjb21tb25zLm9yZy9ucyNSZXByb2R1Y3Rpb24iIC8+DQogICAgICAgIDxjYzpwZXJtaXRzDQogICAgICAgICAgIHJkZjpyZXNvdXJjZT0iaHR0cDovL2NyZWF0aXZlY29tbW9ucy5vcmcvbnMjRGlzdHJpYnV0aW9uIiAvPg0KICAgICAgICA8Y2M6cGVybWl0cw0KICAgICAgICAgICByZGY6cmVzb3VyY2U9Imh0dHA6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL25zI0Rlcml2YXRpdmVXb3JrcyIgLz4NCiAgICAgIDwvY2M6TGljZW5zZT4NCiAgICA8L3JkZjpSREY+DQogIDwvbWV0YWRhdGE+DQogIDxnDQogICAgIGlua3NjYXBlOmxhYmVsPSJFYmVuZSAxIg0KICAgICBpbmtzY2FwZTpncm91cG1vZGU9ImxheWVyIg0KICAgICBpZD0ibGF5ZXIxIj4NCiAgICA8cGF0aA0KICAgICAgIHN0eWxlPSJmaWxsOiMwMDAwMDA7ZmlsbC1vcGFjaXR5OjEiDQogICAgICAgZD0iTSAxNjQuNTMxMjUgNjIuNjg3NSBDIDE2Mi43OTExNSA2Mi42ODc1MDEgMTYxLjM3NSA2NC4wNzI0MTYgMTYxLjM3NSA2NS44MTI1IEwgMTYxLjM3NSA2OC43NSBMIDM4LjM3NSA2OC43NSBDIDM1LjA5MjI5OCA2OC43NDk5OTkgMzIuNDY4NzUgNzEuMzczNTQ4IDMyLjQ2ODc1IDc0LjY1NjI1IEwgMzIuNDY4NzUgMTgxLjM3NSBDIDMyLjQ2ODc1IDE4NC42NTc3IDM1LjA5MjMwNyAxODcuMzEyNTEgMzguMzc1IDE4Ny4zMTI1IEwgMjExLjYyNSAxODcuMzEyNSBDIDIxNC45MDc2OSAxODcuMzEyNSAyMTcuNTMxMjcgMTg0LjY1NzcgMjE3LjUzMTI1IDE4MS4zNzUgTCAyMTcuNTMxMjUgNzQuNjU2MjUgQyAyMTcuNTMxMjUgNzEuMzczNTUxIDIxNC45MDc2OCA2OC43NSAyMTEuNjI1IDY4Ljc1IEwgMjAyLjA2MjUgNjguNzUgTCAyMDIuMDYyNSA2NS44MTI1IEMgMjAyLjA2MjUgNjQuMDcyNDEgMjAwLjY0NjM1IDYyLjY4NzUgMTk4LjkwNjI1IDYyLjY4NzUgTCAxNjQuNTMxMjUgNjIuNjg3NSB6IE0gNDYuODEyNSA3OCBMIDg4LjY1NjI1IDc4IEMgOTAuMzk2MzQyIDc4IDkxLjgxMjUgNzkuMzg0OTA3IDkxLjgxMjUgODEuMTI1IEwgOTEuODEyNSA5Ni4zMTI1IEMgOTEuODEyNSA5OC4wNTI1OTIgOTAuMzk2MzQzIDk5LjQzNzUgODguNjU2MjUgOTkuNDM3NSBMIDQ2LjgxMjUgOTkuNDM3NSBDIDQ1LjA3MjQwOCA5OS40Mzc1IDQzLjY4NzUgOTguMDUyNTkzIDQzLjY4NzUgOTYuMzEyNSBMIDQzLjY4NzUgODEuMTI1IEMgNDMuNjg3NSA3OS4zODQ5MDggNDUuMDcyNDA3IDc4IDQ2LjgxMjUgNzggeiBNIDE0NiA4OC4yMTg3NSBDIDE2Ny43MzQ3NSA4OC4yMTg3NTMgMTg1LjM3NSAxMDYuMTUwNzEgMTg1LjM3NSAxMjguMjUgQyAxODUuMzc0OTkgMTUwLjM0OTI4IDE2Ny43MzQ3NCAxNjguMjgxMjUgMTQ2IDE2OC4yODEyNSBDIDEyNC4yNjUyNyAxNjguMjgxMjYgMTA2LjYyNSAxNTAuMzQ5MjkgMTA2LjYyNSAxMjguMjUgQyAxMDYuNjI1IDEwNi4xNTA3MSAxMjQuMjY1MjYgODguMjE4NzUgMTQ2IDg4LjIxODc1IHogTSAxNDYgOTEuNzE4NzUgQyAxMjYuMTY1NTcgOTEuNzE4NzUgMTEwLjA2MjUgMTA4LjA4Mjg5IDExMC4wNjI1IDEyOC4yNSBDIDExMC4wNjI1IDE0OC40MTcxMSAxMjYuMTY1NTcgMTY0Ljc4MTI2IDE0NiAxNjQuNzgxMjUgQyAxNjUuODM0NDMgMTY0Ljc4MTI1IDE4MS45Mzc1IDE0OC40MTcxIDE4MS45Mzc1IDEyOC4yNSBDIDE4MS45Mzc1IDEwOC4wODI4OSAxNjUuODM0NDMgOTEuNzE4NzUgMTQ2IDkxLjcxODc1IHogTSAxNDYgOTYuNTkzNzUgQyAxNjMuMTc3NjggOTYuNTkzNzUyIDE3Ny4xMjUgMTEwLjc4NDIgMTc3LjEyNSAxMjguMjUgQyAxNzcuMTI0OTkgMTQ1LjcxNTggMTYzLjE3NzY5IDE1OS44NzUgMTQ2IDE1OS44NzUgQyAxMjguODIyMzEgMTU5Ljg3NSAxMTQuODc1IDE0NS43MTU4IDExNC44NzUgMTI4LjI1IEMgMTE0Ljg3NSAxMTAuNzg0MTkgMTI4LjgyMjMxIDk2LjU5Mzc1IDE0NiA5Ni41OTM3NSB6IE0gMTc2LjUgMTcyLjcxODc1IEwgMjA2LjE4NzUgMTcyLjcxODc1IEMgMjA3LjQyMTM4IDE3Mi43MTg3NSAyMDguNDA2MjUgMTczLjEyNzgzIDIwOC40MDYyNSAxNzMuNjI1IEwgMjA4LjQwNjI1IDE3Ny45Njg3NSBDIDIwOC40MDYyNSAxNzguNDY1OTIgMjA3LjQyMTM4IDE3OC44NDM3NSAyMDYuMTg3NSAxNzguODQzNzUgTCAxNzYuNSAxNzguODQzNzUgQyAxNzUuMjY2MTEgMTc4Ljg0Mzc1IDE3NC4yODEyNSAxNzguNDY1OTIgMTc0LjI4MTI1IDE3Ny45Njg3NSBMIDE3NC4yODEyNSAxNzMuNjI1IEMgMTc0LjI4MTI1IDE3My4xMjc4MyAxNzUuMjY2MTIgMTcyLjcxODc1IDE3Ni41IDE3Mi43MTg3NSB6ICINCiAgICAgICBpZD0icmVjdDMyMDkiIC8+DQogICAgPHBhdGgNCiAgICAgICBzdHlsZT0iZmlsbDojYzQyNjFkO2ZpbGwtb3BhY2l0eToxIg0KICAgICAgIGQ9Ik0gMjAgMCBDIDE4LjU1OTkzOCAwIDE3LjE2NDc0NyAwLjE1MDk4NjY2IDE1LjgxMjUgMC40Mzc1IEMgMTUuMjEwMjkxIDAuNTY1MTk1NzggMTQuNjExOTEzIDAuNzI2MjExMjYgMTQuMDMxMjUgMC45MDYyNSBDIDEzLjU1NDc3MyAxLjA1Mzk4NTIgMTMuMDg1MzQ5IDEuMjI0ODUzNiAxMi42MjUgMS40MDYyNSBDIDEyLjMyODc2NiAxLjUyMzA3MzkgMTIuMDM5MDMzIDEuNjUwOTE4MiAxMS43NSAxLjc4MTI1IEMgMTEuMzQ3Mjc4IDEuOTYyMzU5OCAxMC45NTA0MDYgMi4xMzc0MTY1IDEwLjU2MjUgMi4zNDM3NSBDIDEwLjUyMTU1NSAyLjM2NTU2ODggMTAuNDc4MjczIDIuMzg0MTU1NSAxMC40Mzc1IDIuNDA2MjUgQyAxMC40MTY5MzQgMi40MTczNzU0IDEwLjM5NTUyMiAyLjQyNjMwNDkgMTAuMzc1IDIuNDM3NSBDIDkuODMyNjg2MSAyLjczMzM0NDYgOS4zMjI2NDQ4IDMuMDYzMjQ1MiA4LjgxMjUgMy40MDYyNSBDIDguMjgzMTIyMSAzLjc2MjE4NjUgNy43NzI3NzI4IDQuMTU4OTIwOSA3LjI4MTI1IDQuNTYyNSBDIDcuMjc1MDU1IDQuNTY3NTg2NiA3LjI1NjE4ODggNC41NTc0MDYxIDcuMjUgNC41NjI1IEMgNy4yMzg1NDc5IDQuNTcxOTQzNCA3LjIzMDE4MDYgNC41ODQyODE2IDcuMjE4NzUgNC41OTM3NSBDIDcuMTA0NzM1MiA0LjY4ODAxNTkgNi45ODY4NTA3IDQuNzc4MjY4NyA2Ljg3NSA0Ljg3NSBDIDYuNTE1NzAyMSA1LjE4NjQyNjQgNi4xNzk3OTA5IDUuNTA3NzA5MSA1Ljg0Mzc1IDUuODQzNzUgQyA1LjQwNDQwMjUgNi4yODE4MDc4IDQuOTkwNzQ0OSA2Ljc0MTM1NTQgNC41OTM3NSA3LjIxODc1IEMgNC41NzkwMDg2IDcuMjM2NTQ2MiA0LjU3NzE4MDYgNy4yNjM0MDE1IDQuNTYyNSA3LjI4MTI1IEMgMy43Njc0ODk4IDguMjQzOTE4MSAzLjA0MjI3MjEgOS4yNzE4NzA1IDIuNDM3NSAxMC4zNzUgQyAyLjQyNjIyMzIgMTAuMzk1NjM1IDIuNDE3NDU2MSAxMC40MTY4MiAyLjQwNjI1IDEwLjQzNzUgQyAyLjEwODM5MDggMTAuOTg1MzQ4IDEuODQwMjIzMyAxMS41NDcyMTQgMS41OTM3NSAxMi4xMjUgQyAxLjU3NTU4NjUgMTIuMTY3NjY1IDEuNTQ5MTI1NSAxMi4yMDcxODIgMS41MzEyNSAxMi4yNSBDIDEuMjg3NzEzMSAxMi44MzI0MzMgMS4wOTQ2NzU0IDEzLjQyMTgyMiAwLjkwNjI1IDE0LjAzMTI1IEMgMC43Mjk2MzAxNCAxNC42MDI0OTUgMC41NjMwOTYzNCAxNS4xODg4MjggMC40Mzc1IDE1Ljc4MTI1IEMgMC4xNDY5MTQwNCAxNy4xNDI1NzggLTQuMzkwNjEzM2UtMTggMTguNTQ5NDY2IDAgMjAgTCAwIDIzMCBDIDAgMjQxLjA4IDguOTIgMjUwIDIwIDI1MCBMIDIzMCAyNTAgQyAyMzEuNDQwMDYgMjUwIDIzMi44MzUyNSAyNDkuODQ5MDEgMjM0LjE4NzUgMjQ5LjU2MjUgQyAyMzQuNzg5MDMgMjQ5LjQzNDk3IDIzNS4zODg2NiAyNDkuMjczODEgMjM1Ljk2ODc1IDI0OS4wOTM3NSBDIDIzNi40NDQ3NiAyNDguOTQ2IDIzNi45MTUwNSAyNDguNzc1MjYgMjM3LjM3NSAyNDguNTkzNzUgQyAyMzcuNjcxMjMgMjQ4LjQ3NjkzIDIzNy45NjA5NyAyNDguMzQ5MDggMjM4LjI1IDI0OC4yMTg3NSBDIDIzOC4yNzk4MSAyNDguMjA1MzEgMjM4LjMxNDAyIDI0OC4yMDEwOSAyMzguMzQzNzUgMjQ4LjE4NzUgQyAyMzguNzU4MzYgMjQ3Ljk5ODMgMjM5LjE2Mzc0IDI0Ny44MDk4MSAyMzkuNTYyNSAyNDcuNTkzNzUgQyAyMzkuNTgzMTggMjQ3LjU4MjU0IDIzOS42MDQzNiAyNDcuNTczNzggMjM5LjYyNSAyNDcuNTYyNSBDIDI0MC4xNjkyNSAyNDcuMjY1MTIgMjQwLjY3NTU4IDI0Ni45Mzg3MyAyNDEuMTg3NSAyNDYuNTkzNzUgQyAyNDEuNjY4NzggMjQ2LjI2OTQxIDI0Mi4xNDM1OSAyNDUuOTI2MzkgMjQyLjU5Mzc1IDI0NS41NjI1IEMgMjQyLjY0NDc0IDI0NS41MjEyOCAyNDIuNjk5NDMgMjQ1LjQ3OTIxIDI0Mi43NSAyNDUuNDM3NSBDIDI0Mi44NzY1MSAyNDUuMzMzMTggMjQzLjAwMTE1IDI0NS4yMzIzNSAyNDMuMTI1IDI0NS4xMjUgQyAyNDMuNDgyNjUgMjQ0LjgxNTM4IDI0My44MjE1NSAyNDQuNDkwMTkgMjQ0LjE1NjI1IDI0NC4xNTYyNSBDIDI0NC40OTIyOSAyNDMuODIwMjEgMjQ0LjgxMzU3IDI0My40ODQzIDI0NS4xMjUgMjQzLjEyNSBDIDI0NS4yMzE2NyAyNDMuMDAyMzQgMjQ1LjMzMzgxIDI0Mi44NzUyNyAyNDUuNDM3NSAyNDIuNzUgQyAyNDUuNDQyNzYgMjQyLjc0MzYyIDI0NS40MzIyNSAyNDIuNzI1MTMgMjQ1LjQzNzUgMjQyLjcxODc1IEMgMjQ1Ljg0MjQ5IDI0Mi4yMjgzIDI0Ni4yMzY0IDI0MS43MTU3NiAyNDYuNTkzNzUgMjQxLjE4NzUgQyAyNDYuOTM4MTIgMjQwLjY3ODQzIDI0Ny4yNjUzNiAyNDAuMTY2MjIgMjQ3LjU2MjUgMjM5LjYyNSBDIDI0Ny41NzM2MyAyMzkuNjA0NzIgMjQ3LjU4MjY4IDIzOS41ODI4MiAyNDcuNTkzNzUgMjM5LjU2MjUgQyAyNDcuODkxOTcgMjM5LjAxNDggMjQ4LjE1OTMxIDIzOC40NTIzOSAyNDguNDA2MjUgMjM3Ljg3NSBDIDI0OC40MTU1NCAyMzcuODUzMjggMjQ4LjQyODI5IDIzNy44MzQyNiAyNDguNDM3NSAyMzcuODEyNSBDIDI0OC40NDY0NCAyMzcuNzkxMjkgMjQ4LjQ1OTg4IDIzNy43NzEyNSAyNDguNDY4NzUgMjM3Ljc1IEMgMjQ4LjcwOTkyIDIzNy4xNzQ3NiAyNDguOTA2MjggMjM2LjU3MDA4IDI0OS4wOTM3NSAyMzUuOTY4NzUgQyAyNDkuMjczNzUgMjM1LjM5MTM3IDI0OS40MzQ2OCAyMzQuODE3NTQgMjQ5LjU2MjUgMjM0LjIxODc1IEMgMjQ5Ljg1MzA5IDIzMi44NTc0MiAyNTAgMjMxLjQ1MDUzIDI1MCAyMzAgTCAyNTAgMjAgQyAyNTAgOC45MiAyNDEuMDggLTMuMzUzNzk4N2UtMTcgMjMwIDAgTCAyMCAwIHogTSAzNC43ODEyNSAxOS40MDYyNSBMIDIyNS40Njg3NSAxOS40MDYyNSBDIDIyOC4zMDk0NiAxOS40MDYyNSAyMzAuNTkzNzUgMjEuNjkwNTQ0IDIzMC41OTM3NSAyNC41MzEyNSBMIDIzMC41OTM3NSAyMTUuMjUgTCAzNC43ODEyNSAxOS40MDYyNSB6IE0gMTkuNDA2MjUgMzQuNzUgTCAyMTUuMjE4NzUgMjMwLjU5Mzc1IEwgMjQuNTMxMjUgMjMwLjU5Mzc1IEMgMjEuNjkwNTQ0IDIzMC41OTM3NiAxOS40MDYyNSAyMjguMzA5NDYgMTkuNDA2MjUgMjI1LjQ2ODc1IEwgMTkuNDA2MjUgMzQuNzUgeiAiDQogICAgICAgaWQ9InBhdGgzMTk2IiAvPg0KICA8L2c+DQo8L3N2Zz4NCg==",_.UNICODE_LINE_SEP=String.fromCharCode(8232)),_.UNICODE_LINE_SEP},_.prototype.setThemeAndVariant=function(t,e){this.theme=t,this.themeVariant=e},_.prototype.getTheme=function(){return null!=this.theme&&this.theme.setVariant(this.themeVariant),this.theme},_.prototype.getQuickStyleVals=function(){return this.quickStyleVals},_.prototype.processGeomList=function(t){if(!this.geomListProcessed){if(this.geomList=new d.mxgraph.io.vsdx.mxVsdxGeometryList(t),null!=this.geom)for(var e=0;e<this.geom.length;e++){var n=this.geom[e];this.geomList.addGeometry(n)}this.geomListProcessed=!0}},_.prototype.parseShapeElem=function(t,o){y.prototype.parseShapeElem.call(this,t,o);var e,n,s=t.nodeName;if(n="ForeignData",(e=s)&&e.equals?e.equals(n):e===n){function i(t,e){for(var n=t.firstChild;null!=n;){if(1==n.nodeType){var s=n;if("rel"==s.nodeName.toLowerCase()){var i=s.getAttribute("r:id");if(null!=i&&0!==i.length){var r=e.lastIndexOf("/"),a="",s="";try{a=e.substring(0,r),s=e.substring(r,e.length)}catch(t){return}a=o.getRelationship(i,a+"/_rels"+s+".rels");if(null==a)return;s=a.getAttribute("Target")||"",a=a.getAttribute("Type"),r=s.lastIndexOf("/");try{s=s.substring(r+1,s.length)}catch(t){return}return{type:a,target:s}}}}n=n.nextSibling}}var r=t.ownerDocument.vsdxFileName,a=t.getAttribute("ForeignType"),l=t.getAttribute("CompressionType")||"",u=null;if((e=a)&&e.equals?e.equals("Bitmap"):"Bitmap"===e)l=l.toLowerCase();else if(n="MetaFile",(e=a)&&e.equals?e.equals(n):e===n)l="png";else if(e="Enhanced Metafile",((n=a)&&n.equals?n.equals(e):n===e)||(n="EnhMetaFile",(e=a)&&e.equals?e.equals(n):e===n))l="png";else{if("Object"!=a)return;if(0<(u=i(t,r)).type.indexOf("/oleObject")){var h=o.getRelationship("rId1","visio/embeddings/_rels/"+u.target+".rels");if(null==h)return;var g=h.getAttribute("Target"),h=h.getAttribute("Type");try{var x=g.lastIndexOf("/");g=g.substring(x+1,g.length)}catch(t){return}l="png",u={type:h,target:g}}}var m,h=(u=null==u?i(t,r):u).type,g=u.target;null!=h&&(m=(h=h).length-"image".length,-1!==(h=h.indexOf("image",m))&&h===m)&&(this.imageData={},(m=o.getMedia(d.mxgraph.io.mxVsdxCodec.vsdxPlaceholder+"/media/"+g))?(this.imageData.iData=m,m=g.toLowerCase(),g=m.length-".bmp".length,-1!==(m=m.indexOf(".bmp",g))&&m===g&&(l="jpg"),this.imageData.iType=l):(this.imageData.iData=_.ERROR_IMAGE,this.imageData.iType="svg+xml"))}else l=s,s=d.mxgraph.io.vsdx.mxVsdxConstants.TEXT,(l&&l.equals?l.equals(s):l===s)&&(this.text=t)},_.prototype.parseSection=function(t){var e,n,s=t.getAttribute("N");if(n="Geometry",(e=s)&&e.equals?e.equals(n):e===n)null==this.geom&&(this.geom=[]),this.geom.push(t);else if((n=s)&&n.equals?n.equals("Field"):"Field"===n)for(var i=d.mxgraph.io.vsdx.mxVsdxUtils.getDirectChildNamedElements(t,"Row"),r=0;r<i.length;r++){var a=i[r],o=a.getAttribute("IX")||"";if(0!==o.length){null==this.fields&&(this.fields={});var l=a.getAttribute("Del");if(l=l,"1".equals?"1".equals(l):"1"===l){this.fields[o]="";continue}for(var u=d.mxgraph.io.vsdx.mxVsdxUtils.getDirectChildNamedElements(a,"Cell"),h="",g="",x=0;x<u.length;x++){var m=u[x],s=m.getAttribute("N"),p=m.getAttribute("V")||m.textContent||"";switch(s){case"Value":h=p;break;case"Format":g=p;break;case"Calendar":0;break;case"Type":0}}if(0!==h.length){try{var c=isNaN(h)?new Date(h):new Date(_.VSDX_START_TIME+Math.floor(24*parseFloat(h)*60*60*1e3)),g="c"==g?c.getHours()+c.getMinutes()+c.getSeconds()+c.getMilliseconds()==0?"m/d/yyyy":"m/d/yyyy h:MM:ss tt":"ddddd"==g?"m/d/yyyy":"dddddd"==g?"dddd, mmmm dd, yyyy":"C"==g?"dddd, mmmm dd, yyyy h:MM:ss tt":"T"==g?"h:MM:ss tt":g.replace(/am\/pm/g,"tt").replace(/m/g,"@").replace(/M/g,"m").replace(/@/g,"M"),h=Graph.prototype.formatDate(c,"UTC:"+g.replace(new RegExp("\\{|\\}","g"),""))}catch(t){}this.fields[o]=h}}}else y.prototype.parseSection.call(this,t)},_.prototype.parseGeom=function(){return this.hasGeomList()?this.geomList.getShapeXML(this):""},_.prototype.getText=function(){return null!=this.text?this.text.textContent:null},_.prototype.getTextChildren=function(){return null!=this.text?this.text.childNodes:null},_.prototype.getWidth=function(){return 0===this.width&&0<this.height?1:this.width},_.prototype.getHeight=function(){return 0===this.height&&0<this.width?1:this.height},_.prototype.getRotation=function(){return this.rotation},_.prototype.getStyleMap=function(){return this.styleMap},_.prototype.hasGeom=function(){return!(null==this.geom||0==this.geom.length)},_.prototype.hasGeomList=function(){return null!=this.geomList&&this.geomList.hasGeom()},_.prototype.getPPList=function(t){var e=null;return""==t||"0"!=(t=this.getBullet(t))&&(e='<ul style="margin: 0;list-style-type: '+("4"==t?"square":"disc")+'">'),e},_.prototype.getTextParagraphFormated=function(t){var e="",n={};return n.align=this.getHorizontalAlign(this.pp,!0),n["margin-left"]=this.getIndentLeft(this.pp),n["margin-right"]=this.getIndentRight(this.pp),n["margin-top"]=this.getSpBefore(this.pp)+"px",n["margin-bottom"]=this.getSpAfter(this.pp)+"px",n["text-indent"]=this.getIndentFirst(this.pp),n.valign=this.getAlignVertical(),n.direction=this.getTextDirection(this.pp),e+=this.insertAttributes(t,n)},_.prototype.getTextCharFormated=function(t){var e,n,s="",i="color:"+this.getTextColor(this.cp)+";",r="font-size:"+parseFloat(this.getTextSize(this.cp))+"px;",a="font-family:"+this.getTextFont(this.cp)+";",o="direction:"+this.getRtlText(this.cp)+";",l="letter-spacing:"+parseFloat(this.getLetterSpace(this.cp))/.71+"px;",u="line-height:"+this.getSpcLine(this.pp),h=";opacity:"+this.getTextOpacity(this.cp),g=this.getTextPos(this.cp),x=this.getTextCase(this.cp);return((e=x)&&e.equals?e.equals("1"):"1"===e)?t=t.toUpperCase():((n=x)&&n.equals?n.equals("2"):"2"===n)&&(t=d.mxgraph.io.vsdx.mxVsdxUtils.toInitialCapital(t)),((n=g)&&n.equals?n.equals("1"):"1"===n)?t=d.mxgraph.io.vsdx.mxVsdxUtils.surroundByTags(t,"sup"):((g=g)&&g.equals?g.equals("2"):"2"===g)&&(t=d.mxgraph.io.vsdx.mxVsdxUtils.surroundByTags(t,"sub")),t=this.isBold(this.cp)?d.mxgraph.io.vsdx.mxVsdxUtils.surroundByTags(t,"b"):t,t=this.isItalic(this.cp)?d.mxgraph.io.vsdx.mxVsdxUtils.surroundByTags(t,"i"):t,t=this.isUnderline(this.cp)?d.mxgraph.io.vsdx.mxVsdxUtils.surroundByTags(t,"u"):t,t=this.getTextStrike(this.cp)?d.mxgraph.io.vsdx.mxVsdxUtils.surroundByTags(t,"s"):t,s+='<font style="'+r+a+i+o+l+u+h+'">'+(t=this.isSmallCaps(this.cp)?d.mxgraph.io.vsdx.mxVsdxUtils.toSmallCaps(t,this.getTextSize(this.cp)):t)+"</font>"},_.prototype.getTextDirection=function(t){var e=this.getFlags(t);return((t=e)&&t.equals?t.equals("0"):"0"===t)?e="ltr":((t=e)&&t.equals?t.equals("1"):"1"===t)&&(e="rtl"),e},_.prototype.getSpcLine=function(t){var e=!1,t=this.getSpLine(t);return 0<t?t*=d.mxgraph.io.vsdx.mxVsdxUtils.conversionFactor_$LI$():e=(t=0===t?100:100*Math.abs(t),!0),t=new String(t).toString(),t+=e?"%":"px"},_.prototype.getSpcBefore=function(t){return this.getSpBefore(t)},_.prototype.insertAttributes=function(t,e){if(-1==t.indexOf(">"))return t;var n=t.indexOf(">"),s=t.substring(n);return t.substring(0,n)+(' style="'+d.mxgraph.io.vsdx.mxVsdxUtils.getStyleString(e,":")+'"')+s},_.prototype.getRtlText=function(t){var e=this.getCellElement$java_lang_String$java_lang_String$java_lang_String(d.mxgraph.io.vsdx.mxVsdxConstants.RTL_TEXT,t,d.mxgraph.io.vsdx.mxVsdxConstants.PARAGRAPH),t=this.getValue(e,"ltr");return((e=t)&&e.equals?e.equals("0"):"0"===e)?t="ltr":((e=t)&&e.equals?e.equals("1"):"1"===e)&&(t="rtl"),t},_.prototype.isBold=function(t){var e=!1,n=this.getTextStyle(t);return e=((t=n)&&t.equals?!t.equals(""):""!==t)&&((t=n.toLowerCase())&&t.equals?!t.equals("themed"):"themed"!==t)?1==(1&parseInt(n)):e},_.prototype.isItalic=function(t){var e=!1,n=this.getTextStyle(t);return e=((t=n)&&t.equals?!t.equals(""):""!==t)&&((t=n.toLowerCase())&&t.equals?!t.equals("themed"):"themed"!==t)?2==(2&parseInt(n)):e},_.prototype.isUnderline=function(t){var e=!1,n=this.getTextStyle(t);return e=((t=n)&&t.equals?!t.equals(""):""!==t)&&((t=n.toLowerCase())&&t.equals?!t.equals("themed"):"themed"!==t)?4==(4&parseInt(n)):e},_.prototype.isSmallCaps=function(t){var e=!1,n=this.getTextStyle(t);return e=((t=n)&&t.equals?!t.equals(""):""!==t)&&((t=n.toLowerCase())&&t.equals?!t.equals("themed"):"themed"!==t)?8==(8&parseInt(n)):e},_.prototype.getTextOpacity=function(t){var e=this.getCellElement$java_lang_String$java_lang_String$java_lang_String(d.mxgraph.io.vsdx.mxVsdxConstants.COLOR_TRANS,t,d.mxgraph.io.vsdx.mxVsdxConstants.CHARACTER),t=this.getValue(e,"0"),e="1";return null!=t&&0!==t.length&&(t=1-parseFloat(t),e=new String(t).toString()),e},_.prototype.getTextSize=function(t){t=this.getCellElement$java_lang_String$java_lang_String$java_lang_String(d.mxgraph.io.vsdx.mxVsdxConstants.SIZE,t,d.mxgraph.io.vsdx.mxVsdxConstants.CHARACTER),t=this.getScreenNumericalValue$org_w3c_dom_Element$double(t,12);return""+Math.floor(Math.round(100*t)/100)},_.prototype.getAlignVertical=function(){var t=mxConstants.ALIGN_MIDDLE,e=parseInt(this.getValue(this.getCellElement$java_lang_String(d.mxgraph.io.vsdx.mxVsdxConstants.VERTICAL_ALIGN),"1"));return 0===e?t=mxConstants.ALIGN_TOP:2===e&&(t=mxConstants.ALIGN_BOTTOM),t},_.prototype.getGeomList=function(){return this.geomList},_.prototype.getLastX=function(){return this.lastX},_.prototype.getLastY=function(){return this.lastY},_.prototype.getLastMoveX=function(){return this.lastMoveX},_.prototype.getLastMoveY=function(){return this.lastMoveY},_.prototype.getLastKnot=function(){return this.lastKnot},_.prototype.setLastX=function(t){this.lastX=t},_.prototype.setLastY=function(t){this.lastY=t},_.prototype.setLastMoveX=function(t){this.lastMoveX=t},_.prototype.setLastMoveY=function(t){this.lastMoveY=t},_.prototype.setLastKnot=function(t){this.lastKnot=t},(e=_).VSDX_START_TIME=new Date("1899-12-30T00:00:00Z").getTime(),(t.Shape=e).__class="com.mxgraph.io.vsdx.Shape"}(com=com||{}),function(T){var t,r,c;function d(t,e,n,s,i,r){var a=this;a.masterShape=null,a.master=null,a.parentHeight=0,(a=c.call(this,e,r)||this).htmlLabels=!0,(a.rootShape=a).shapeName=null,a.shapeIndex=0,a.vertex=!0,a.childShapes={};var o=a.getMasterId(),l=a.getShapeMasterId();a.master=null!=o?s[o]||null:i,null!=a.master&&(a.masterShape=null==o&&null!=l?a.master.getSubShape(l):a.master.getMasterShape());o=a.getNameU(),l=o.lastIndexOf(".");-1!==l&&(o=o.substring(0,l)),a.shapeName=o;e=e.getElementsByTagName(T.mxgraph.io.vsdx.mxVsdxConstants.SHAPES);null!=e&&0<e.length&&(u=e.item(0),a.childShapes=t.parseShapes(u,a.master,!1));var u=a.calcRotation();a.rotation=100*u/100,a.rotation=a.rotation%360;u=t.getCellIntValue("ThemeIndex",-100);-100===u&&(u=parseInt(a.getValue(a.getCellElement$java_lang_String("ThemeIndex"),"0")));var h=function(t,e){null==t.entries&&(t.entries=[]);for(var n=0;n<t.entries.length;n++)if(null!=t.entries[n].key.equals&&t.entries[n].key.equals(e)||t.entries[n].key===e)return t.entries[n].value;return null}(r.getThemes(),u),g=t.getCellIntValue("VariationColorIndex",0);a.setThemeAndVariant(h,g);for(var x=(null==(t=a.childShapes).entries&&(t.entries=[]),t.entries),m=0;m<x.length;m++){var p=x[m].getValue();p.setRootShape(a),null==p.theme&&p.setThemeAndVariant(h,g)}return a.quickStyleVals=new T.mxgraph.io.vsdx.theme.QuickStyleVals(parseInt(a.getValue(a.getCellElement$java_lang_String("QuickStyleEffectsMatrix"),"0")),parseInt(a.getValue(a.getCellElement$java_lang_String("QuickStyleFillColor"),"1")),parseInt(a.getValue(a.getCellElement$java_lang_String("QuickStyleFillMatrix"),"0")),parseInt(a.getValue(a.getCellElement$java_lang_String("QuickStyleFontColor"),"1")),parseInt(a.getValue(a.getCellElement$java_lang_String("QuickStyleFontMatrix"),"0")),parseInt(a.getValue(a.getCellElement$java_lang_String("QuickStyleLineColor"),"1")),parseInt(a.getValue(a.getCellElement$java_lang_String("QuickStyleLineMatrix"),"0")),parseInt(a.getValue(a.getCellElement$java_lang_String("QuickStyleShadowColor"),"1")),parseInt(a.getValue(a.getCellElement$java_lang_String("QuickStyleType"),"0")),parseInt(a.getValue(a.getCellElement$java_lang_String("QuickStyleVariation"),"0"))),null!=a.masterShape?(a.masterShape.processGeomList(null),a.processGeomList(a.masterShape.getGeomList()),0===a.width&&(a.width=a.getScreenNumericalValue$org_w3c_dom_Element$double(a.getCellElement$java_lang_String(T.mxgraph.io.vsdx.mxVsdxConstants.WIDTH),0)),0===a.height&&(a.height=a.getScreenNumericalValue$org_w3c_dom_Element$double(a.getCellElement$java_lang_String(T.mxgraph.io.vsdx.mxVsdxConstants.HEIGHT),0))):a.processGeomList(null),a.vertex=n||null!=a.childShapes&&(null==(n=a.childShapes).entries&&(n.entries=[]),!(0==n.entries.length))||null!=a.geomList&&(!a.geomList.isNoFill()||1<a.geomList.getGeoCount()),a.layerMember=a.getValue(a.getCellElement$java_lang_String("LayerMember")),a.layerMember&&0==a.layerMember.indexOf("0;")&&(a.layerMember=a.layerMember.substr(2)),a}t=(t=T.mxgraph||(T.mxgraph={})).io||(t.io={}),r=t.vsdx||(t.vsdx={}),c=T.mxgraph.io.vsdx.Shape,__extends(d,c),d.__static_initialize=function(){d.__static_initialized||(d.__static_initialized=!0,d.__static_initializer_0())},d.OFFSET_ARRAY_$LI$=function(){return d.__static_initialize(),d.OFFSET_ARRAY=null==d.OFFSET_ARRAY?["Organizational unit","Domain 3D"].slice(0).slice(0):d.OFFSET_ARRAY},d.arrowSizes_$LI$=function(){return d.__static_initialize(),d.arrowSizes=null==d.arrowSizes?[2,3,5,7,9,22,45]:d.arrowSizes},d.arrowTypes_$LI$=function(){return d.__static_initialize(),d.arrowTypes},d.__static_initializer_0=function(){d.arrowTypes={},function(t,e){null==t.entries&&(t.entries=[]);for(var n=0;n<t.entries.length;n++)if(null!=t.entries[n].key.equals&&t.entries[n].key.equals(0)||0===t.entries[n].key)return t.entries[n].value=e;t.entries.push({key:0,value:e,getKey:function(){return this.key},getValue:function(){return this.value}})}(d.arrowTypes_$LI$(),mxConstants.NONE),function(t,e){null==t.entries&&(t.entries=[]);for(var n=0;n<t.entries.length;n++)if(null!=t.entries[n].key.equals&&t.entries[n].key.equals(1)||1===t.entries[n].key)return t.entries[n].value=e;t.entries.push({key:1,value:e,getKey:function(){return this.key},getValue:function(){return this.value}})}(d.arrowTypes_$LI$(),mxConstants.ARROW_OPEN),function(t,e){null==t.entries&&(t.entries=[]);for(var n=0;n<t.entries.length;n++)if(null!=t.entries[n].key.equals&&t.entries[n].key.equals(2)||2===t.entries[n].key)return t.entries[n].value=e;t.entries.push({key:2,value:e,getKey:function(){return this.key},getValue:function(){return this.value}})}(d.arrowTypes_$LI$(),"blockThin"),function(t,e){null==t.entries&&(t.entries=[]);for(var n=0;n<t.entries.length;n++)if(null!=t.entries[n].key.equals&&t.entries[n].key.equals(3)||3===t.entries[n].key)return t.entries[n].value=e;t.entries.push({key:3,value:e,getKey:function(){return this.key},getValue:function(){return this.value}})}(d.arrowTypes_$LI$(),mxConstants.ARROW_OPEN),function(t,e){null==t.entries&&(t.entries=[]);for(var n=0;n<t.entries.length;n++)if(null!=t.entries[n].key.equals&&t.entries[n].key.equals(4)||4===t.entries[n].key)return t.entries[n].value=e;t.entries.push({key:4,value:e,getKey:function(){return this.key},getValue:function(){return this.value}})}(d.arrowTypes_$LI$(),mxConstants.ARROW_BLOCK),function(t,e){null==t.entries&&(t.entries=[]);for(var n=0;n<t.entries.length;n++)if(null!=t.entries[n].key.equals&&t.entries[n].key.equals(5)||5===t.entries[n].key)return t.entries[n].value=e;t.entries.push({key:5,value:e,getKey:function(){return this.key},getValue:function(){return this.value}})}(d.arrowTypes_$LI$(),mxConstants.ARROW_CLASSIC),function(t,e){null==t.entries&&(t.entries=[]);for(var n=0;n<t.entries.length;n++)if(null!=t.entries[n].key.equals&&t.entries[n].key.equals(10)||10===t.entries[n].key)return t.entries[n].value=e;t.entries.push({key:10,value:e,getKey:function(){return this.key},getValue:function(){return this.value}})}(d.arrowTypes_$LI$(),mxConstants.ARROW_OVAL),function(t,e){null==t.entries&&(t.entries=[]);for(var n=0;n<t.entries.length;n++)if(null!=t.entries[n].key.equals&&t.entries[n].key.equals(13)||13===t.entries[n].key)return t.entries[n].value=e;t.entries.push({key:13,value:e,getKey:function(){return this.key},getValue:function(){return this.value}})}(d.arrowTypes_$LI$(),mxConstants.ARROW_BLOCK),function(t,e){null==t.entries&&(t.entries=[]);for(var n=0;n<t.entries.length;n++)if(null!=t.entries[n].key.equals&&t.entries[n].key.equals(14)||14===t.entries[n].key)return t.entries[n].value=e;t.entries.push({key:14,value:e,getKey:function(){return this.key},getValue:function(){return this.value}})}(d.arrowTypes_$LI$(),d.ARROW_NO_FILL_MARKER+mxConstants.ARROW_BLOCK),function(t,e){null==t.entries&&(t.entries=[]);for(var n=0;n<t.entries.length;n++)if(null!=t.entries[n].key.equals&&t.entries[n].key.equals(17)||17===t.entries[n].key)return t.entries[n].value=e;t.entries.push({key:17,value:e,getKey:function(){return this.key},getValue:function(){return this.value}})}(d.arrowTypes_$LI$(),d.ARROW_NO_FILL_MARKER+mxConstants.ARROW_CLASSIC),function(t,e){null==t.entries&&(t.entries=[]);for(var n=0;n<t.entries.length;n++)if(null!=t.entries[n].key.equals&&t.entries[n].key.equals(20)||20===t.entries[n].key)return t.entries[n].value=e;t.entries.push({key:20,value:e,getKey:function(){return this.key},getValue:function(){return this.value}})}(d.arrowTypes_$LI$(),d.ARROW_NO_FILL_MARKER+mxConstants.ARROW_OVAL),function(t,e){null==t.entries&&(t.entries=[]);for(var n=0;n<t.entries.length;n++)if(null!=t.entries[n].key.equals&&t.entries[n].key.equals(22)||22===t.entries[n].key)return t.entries[n].value=e;t.entries.push({key:22,value:e,getKey:function(){return this.key},getValue:function(){return this.value}})}(d.arrowTypes_$LI$(),d.ARROW_NO_FILL_MARKER+"diamond"),function(t){null==t.entries&&(t.entries=[]);for(var e=0;e<t.entries.length;e++)if(null!=t.entries[e].key.equals&&t.entries[e].key.equals(23)||23===t.entries[e].key)return t.entries[e].value="dash";t.entries.push({key:23,value:"dash",getKey:function(){return this.key},getValue:function(){return this.value}})}(d.arrowTypes_$LI$()),function(t){null==t.entries&&(t.entries=[]);for(var e=0;e<t.entries.length;e++)if(null!=t.entries[e].key.equals&&t.entries[e].key.equals(24)||24===t.entries[e].key)return t.entries[e].value="ERone";t.entries.push({key:24,value:"ERone",getKey:function(){return this.key},getValue:function(){return this.value}})}(d.arrowTypes_$LI$()),function(t,e){null==t.entries&&(t.entries=[]);for(var n=0;n<t.entries.length;n++)if(null!=t.entries[n].key.equals&&t.entries[n].key.equals(25)||25===t.entries[n].key)return t.entries[n].value=e;t.entries.push({key:25,value:e,getKey:function(){return this.key},getValue:function(){return this.value}})}(d.arrowTypes_$LI$(),"ERmandOne"),function(t){null==t.entries&&(t.entries=[]);for(var e=0;e<t.entries.length;e++)if(null!=t.entries[e].key.equals&&t.entries[e].key.equals(27)||27===t.entries[e].key)return t.entries[e].value="ERmany";t.entries.push({key:27,value:"ERmany",getKey:function(){return this.key},getValue:function(){return this.value}})}(d.arrowTypes_$LI$()),function(t,e){null==t.entries&&(t.entries=[]);for(var n=0;n<t.entries.length;n++)if(null!=t.entries[n].key.equals&&t.entries[n].key.equals(28)||28===t.entries[n].key)return t.entries[n].value=e;t.entries.push({key:28,value:e,getKey:function(){return this.key},getValue:function(){return this.value}})}(d.arrowTypes_$LI$(),"ERoneToMany"),function(t,e){null==t.entries&&(t.entries=[]);for(var n=0;n<t.entries.length;n++)if(null!=t.entries[n].key.equals&&t.entries[n].key.equals(29)||29===t.entries[n].key)return t.entries[n].value=e;t.entries.push({key:29,value:e,getKey:function(){return this.key},getValue:function(){return this.value}})}(d.arrowTypes_$LI$(),"ERzeroToMany"),function(t,e){null==t.entries&&(t.entries=[]);for(var n=0;n<t.entries.length;n++)if(null!=t.entries[n].key.equals&&t.entries[n].key.equals(30)||30===t.entries[n].key)return t.entries[n].value=e;t.entries.push({key:30,value:e,getKey:function(){return this.key},getValue:function(){return this.value}})}(d.arrowTypes_$LI$(),"ERzeroToOne"),function(t,e){null==t.entries&&(t.entries=[]);for(var n=0;n<t.entries.length;n++)if(null!=t.entries[n].key.equals&&t.entries[n].key.equals(6)||6===t.entries[n].key)return t.entries[n].value=e;t.entries.push({key:6,value:e,getKey:function(){return this.key},getValue:function(){return this.value}})}(d.arrowTypes_$LI$(),mxConstants.ARROW_BLOCK),function(t,e){null==t.entries&&(t.entries=[]);for(var n=0;n<t.entries.length;n++)if(null!=t.entries[n].key.equals&&t.entries[n].key.equals(7)||7===t.entries[n].key)return t.entries[n].value=e;t.entries.push({key:7,value:e,getKey:function(){return this.key},getValue:function(){return this.value}})}(d.arrowTypes_$LI$(),mxConstants.ARROW_OPEN),function(t,e){null==t.entries&&(t.entries=[]);for(var n=0;n<t.entries.length;n++)if(null!=t.entries[n].key.equals&&t.entries[n].key.equals(8)||8===t.entries[n].key)return t.entries[n].value=e;t.entries.push({key:8,value:e,getKey:function(){return this.key},getValue:function(){return this.value}})}(d.arrowTypes_$LI$(),mxConstants.ARROW_CLASSIC),function(t,e){null==t.entries&&(t.entries=[]);for(var n=0;n<t.entries.length;n++)if(null!=t.entries[n].key.equals&&t.entries[n].key.equals(9)||9===t.entries[n].key)return t.entries[n].value=e;t.entries.push({key:9,value:e,getKey:function(){return this.key},getValue:function(){return this.value}})}(d.arrowTypes_$LI$(),"openAsync"),function(t,e){null==t.entries&&(t.entries=[]);for(var n=0;n<t.entries.length;n++)if(null!=t.entries[n].key.equals&&t.entries[n].key.equals(11)||11===t.entries[n].key)return t.entries[n].value=e;t.entries.push({key:11,value:e,getKey:function(){return this.key},getValue:function(){return this.value}})}(d.arrowTypes_$LI$(),"diamond"),function(t,e){null==t.entries&&(t.entries=[]);for(var n=0;n<t.entries.length;n++)if(null!=t.entries[n].key.equals&&t.entries[n].key.equals(12)||12===t.entries[n].key)return t.entries[n].value=e;t.entries.push({key:12,value:e,getKey:function(){return this.key},getValue:function(){return this.value}})}(d.arrowTypes_$LI$(),mxConstants.ARROW_OPEN),function(t,e){null==t.entries&&(t.entries=[]);for(var n=0;n<t.entries.length;n++)if(null!=t.entries[n].key.equals&&t.entries[n].key.equals(15)||15===t.entries[n].key)return t.entries[n].value=e;t.entries.push({key:15,value:e,getKey:function(){return this.key},getValue:function(){return this.value}})}(d.arrowTypes_$LI$(),d.ARROW_NO_FILL_MARKER+mxConstants.ARROW_BLOCK),function(t,e){null==t.entries&&(t.entries=[]);for(var n=0;n<t.entries.length;n++)if(null!=t.entries[n].key.equals&&t.entries[n].key.equals(16)||16===t.entries[n].key)return t.entries[n].value=e;t.entries.push({key:16,value:e,getKey:function(){return this.key},getValue:function(){return this.value}})}(d.arrowTypes_$LI$(),d.ARROW_NO_FILL_MARKER+mxConstants.ARROW_BLOCK),function(t,e){null==t.entries&&(t.entries=[]);for(var n=0;n<t.entries.length;n++)if(null!=t.entries[n].key.equals&&t.entries[n].key.equals(18)||18===t.entries[n].key)return t.entries[n].value=e;t.entries.push({key:18,value:e,getKey:function(){return this.key},getValue:function(){return this.value}})}(d.arrowTypes_$LI$(),d.ARROW_NO_FILL_MARKER+mxConstants.ARROW_BLOCK),function(t,e){null==t.entries&&(t.entries=[]);for(var n=0;n<t.entries.length;n++)if(null!=t.entries[n].key.equals&&t.entries[n].key.equals(19)||19===t.entries[n].key)return t.entries[n].value=e;t.entries.push({key:19,value:e,getKey:function(){return this.key},getValue:function(){return this.value}})}(d.arrowTypes_$LI$(),d.ARROW_NO_FILL_MARKER+mxConstants.ARROW_CLASSIC),function(t,e){null==t.entries&&(t.entries=[]);for(var n=0;n<t.entries.length;n++)if(null!=t.entries[n].key.equals&&t.entries[n].key.equals(21)||21===t.entries[n].key)return t.entries[n].value=e;t.entries.push({key:21,value:e,getKey:function(){return this.key},getValue:function(){return this.value}})}(d.arrowTypes_$LI$(),d.ARROW_NO_FILL_MARKER+"diamond"),function(t,e){null==t.entries&&(t.entries=[]);for(var n=0;n<t.entries.length;n++)if(null!=t.entries[n].key.equals&&t.entries[n].key.equals(26)||26===t.entries[n].key)return t.entries[n].value=e;t.entries.push({key:26,value:e,getKey:function(){return this.key},getValue:function(){return this.value}})}(d.arrowTypes_$LI$(),"ERmandOne"),function(t,e){null==t.entries&&(t.entries=[]);for(var n=0;n<t.entries.length;n++)if(null!=t.entries[n].key.equals&&t.entries[n].key.equals(31)||31===t.entries[n].key)return t.entries[n].value=e;t.entries.push({key:31,value:e,getKey:function(){return this.key},getValue:function(){return this.value}})}(d.arrowTypes_$LI$(),d.ARROW_NO_FILL_MARKER+mxConstants.ARROW_OVAL),function(t,e){null==t.entries&&(t.entries=[]);for(var n=0;n<t.entries.length;n++)if(null!=t.entries[n].key.equals&&t.entries[n].key.equals(32)||32===t.entries[n].key)return t.entries[n].value=e;t.entries.push({key:32,value:e,getKey:function(){return this.key},getValue:function(){return this.value}})}(d.arrowTypes_$LI$(),d.ARROW_NO_FILL_MARKER+mxConstants.ARROW_OVAL),function(t,e){null==t.entries&&(t.entries=[]);for(var n=0;n<t.entries.length;n++)if(null!=t.entries[n].key.equals&&t.entries[n].key.equals(33)||33===t.entries[n].key)return t.entries[n].value=e;t.entries.push({key:33,value:e,getKey:function(){return this.key},getValue:function(){return this.value}})}(d.arrowTypes_$LI$(),d.ARROW_NO_FILL_MARKER+mxConstants.ARROW_OVAL),function(t,e){null==t.entries&&(t.entries=[]);for(var n=0;n<t.entries.length;n++)if(null!=t.entries[n].key.equals&&t.entries[n].key.equals(34)||34===t.entries[n].key)return t.entries[n].value=e;t.entries.push({key:34,value:e,getKey:function(){return this.key},getValue:function(){return this.value}})}(d.arrowTypes_$LI$(),d.ARROW_NO_FILL_MARKER+mxConstants.ARROW_OVAL),function(t,e){null==t.entries&&(t.entries=[]);for(var n=0;n<t.entries.length;n++)if(null!=t.entries[n].key.equals&&t.entries[n].key.equals(35)||35===t.entries[n].key)return t.entries[n].value=e;t.entries.push({key:35,value:e,getKey:function(){return this.key},getValue:function(){return this.value}})}(d.arrowTypes_$LI$(),mxConstants.ARROW_OVAL),function(t,e){null==t.entries&&(t.entries=[]);for(var n=0;n<t.entries.length;n++)if(null!=t.entries[n].key.equals&&t.entries[n].key.equals(36)||36===t.entries[n].key)return t.entries[n].value=e;t.entries.push({key:36,value:e,getKey:function(){return this.key},getValue:function(){return this.value}})}(d.arrowTypes_$LI$(),mxConstants.ARROW_OVAL),function(t,e){null==t.entries&&(t.entries=[]);for(var n=0;n<t.entries.length;n++)if(null!=t.entries[n].key.equals&&t.entries[n].key.equals(37)||37===t.entries[n].key)return t.entries[n].value=e;t.entries.push({key:37,value:e,getKey:function(){return this.key},getValue:function(){return this.value}})}(d.arrowTypes_$LI$(),mxConstants.ARROW_OVAL),function(t,e){null==t.entries&&(t.entries=[]);for(var n=0;n<t.entries.length;n++)if(null!=t.entries[n].key.equals&&t.entries[n].key.equals(38)||38===t.entries[n].key)return t.entries[n].value=e;t.entries.push({key:38,value:e,getKey:function(){return this.key},getValue:function(){return this.value}})}(d.arrowTypes_$LI$(),mxConstants.ARROW_OVAL),function(t,e){null==t.entries&&(t.entries=[]);for(var n=0;n<t.entries.length;n++)if(null!=t.entries[n].key.equals&&t.entries[n].key.equals(39)||39===t.entries[n].key)return t.entries[n].value=e;t.entries.push({key:39,value:e,getKey:function(){return this.key},getValue:function(){return this.value}})}(d.arrowTypes_$LI$(),mxConstants.ARROW_BLOCK),function(t,e){null==t.entries&&(t.entries=[]);for(var n=0;n<t.entries.length;n++)if(null!=t.entries[n].key.equals&&t.entries[n].key.equals(40)||40===t.entries[n].key)return t.entries[n].value=e;t.entries.push({key:40,value:e,getKey:function(){return this.key},getValue:function(){return this.value}})}(d.arrowTypes_$LI$(),d.ARROW_NO_FILL_MARKER+mxConstants.ARROW_BLOCK),function(t,e){null==t.entries&&(t.entries=[]);for(var n=0;n<t.entries.length;n++)if(null!=t.entries[n].key.equals&&t.entries[n].key.equals(41)||41===t.entries[n].key)return t.entries[n].value=e;t.entries.push({key:41,value:e,getKey:function(){return this.key},getValue:function(){return this.value}})}(d.arrowTypes_$LI$(),d.ARROW_NO_FILL_MARKER+mxConstants.ARROW_OVAL),function(t,e){null==t.entries&&(t.entries=[]);for(var n=0;n<t.entries.length;n++)if(null!=t.entries[n].key.equals&&t.entries[n].key.equals(42)||42===t.entries[n].key)return t.entries[n].value=e;t.entries.push({key:42,value:e,getKey:function(){return this.key},getValue:function(){return this.value}})}(d.arrowTypes_$LI$(),mxConstants.ARROW_OVAL),function(t,e){null==t.entries&&(t.entries=[]);for(var n=0;n<t.entries.length;n++)if(null!=t.entries[n].key.equals&&t.entries[n].key.equals(43)||43===t.entries[n].key)return t.entries[n].value=e;t.entries.push({key:43,value:e,getKey:function(){return this.key},getValue:function(){return this.value}})}(d.arrowTypes_$LI$(),mxConstants.ARROW_OPEN),function(t,e){null==t.entries&&(t.entries=[]);for(var n=0;n<t.entries.length;n++)if(null!=t.entries[n].key.equals&&t.entries[n].key.equals(44)||44===t.entries[n].key)return t.entries[n].value=e;t.entries.push({key:44,value:e,getKey:function(){return this.key},getValue:function(){return this.value}})}(d.arrowTypes_$LI$(),mxConstants.ARROW_OPEN),function(t,e){null==t.entries&&(t.entries=[]);for(var n=0;n<t.entries.length;n++)if(null!=t.entries[n].key.equals&&t.entries[n].key.equals(45)||45===t.entries[n].key)return t.entries[n].value=e;t.entries.push({key:45,value:e,getKey:function(){return this.key},getValue:function(){return this.value}})}(d.arrowTypes_$LI$(),mxConstants.ARROW_OPEN)},d.__com_mxgraph_io_vsdx_VsdxShape_LOGGER_$LI$=function(){return d.__static_initialize(),d.__com_mxgraph_io_vsdx_VsdxShape_LOGGER=null==d.__com_mxgraph_io_vsdx_VsdxShape_LOGGER?{}:d.__com_mxgraph_io_vsdx_VsdxShape_LOGGER},d.prototype.getShapeNode=function(t){var e=this.cellElements[t]||null;return null==e&&null!=this.masterShape?this.masterShape.getCellElement$java_lang_String(t):e},d.prototype.getTextLabel=function(){var t=this.getValue(this.getCellElement$java_lang_String(T.mxgraph.io.vsdx.mxVsdxConstants.HIDE_TEXT),"0");if(t=t,"1".equals?"1".equals(t):"1"===t)return null;t=this.getTextChildren();if(null==t&&null!=this.masterShape&&(t=this.masterShape.getTextChildren()),this.htmlLabels)return null!=t?(this.styleMap[mxConstants.STYLE_VERTICAL_ALIGN]=this.getAlignVertical(),this.styleMap[mxConstants.STYLE_ALIGN]=this.getHorizontalAlign("0",!1),this.getHtmlTextContent(t)):null;t=this.getText();return null==t&&null!=this.masterShape?this.masterShape.getText():t},d.prototype.getIndex=function(t){t=t.getAttribute("IX")||"";return 0===t.length?"0":t},d.prototype.initLabels=function(t){this.paragraphs={};for(var e=null,n=null,s=null,i=0;i<t.length;i++){var r=t.item(i);switch(r.nodeName){case"cp":var a=r,e=this.getIndex(a);break;case"tp":a=r;this.getIndex(a);break;case"pp":a=r,n=this.getIndex(a);break;case"fld":a=r,s=this.getIndex(a);break;case"#text":var o=r.textContent,l=this.paragraphs[n]||null;null==l?(l=new T.mxgraph.io.vsdx.Paragraph(o,e,n,s),this.paragraphs[n]=l):l.addText(o,e,s)}}},d.prototype.createHybridLabel=function(t){var e=this.paragraphs[t]||null;this.styleMap[mxConstants.STYLE_ALIGN]=this.getHorizontalAlign(t,!1),this.styleMap[mxConstants.STYLE_SPACING_LEFT]=this.getIndentLeft(t),this.styleMap[mxConstants.STYLE_SPACING_RIGHT]=this.getIndentRight(t),this.styleMap[mxConstants.STYLE_SPACING_TOP]=this.getSpBefore(t),this.styleMap[mxConstants.STYLE_SPACING_BOTTOM]=this.getSpAfter(t),this.styleMap[mxConstants.STYLE_VERTICAL_ALIGN]=this.getAlignVertical(),this.styleMap.fontColor=this.getTextColor(t),this.styleMap.fontSize=this.getTextSize(t),this.styleMap.fontFamily=this.getTextFont(t);var n=this.isBold(t)?mxConstants.FONT_BOLD:0;n|=this.isItalic(t)?mxConstants.FONT_ITALIC:0,n|=this.isUnderline(t)?mxConstants.FONT_UNDERLINE:0,this.styleMap.fontStyle=new String(n).toString();for(var s=e.numValues(),i=null,r=0;r<s;r++){var a,o=e.getValue(r);0!==o.length||null==this.fields||null!=(a=e.getField(r))&&null==(o=this.fields[a]||null)&&null!=this.masterShape&&null!=this.masterShape.fields&&(o=this.masterShape.fields[a]||null),null!=o&&(i=null==i?o:i+o)}return i},d.prototype.getHtmlTextContent=function(t){var e,n,s,i="",r=!0,a=!1,o=!1;function l(t){var e;return t=T.mxgraph.io.vsdx.mxVsdxUtils.htmlEntities(t),o&&(t="<li>"+t,o=!1),t=a?((e=t.split("\n"))[e.length-1]||(e.pop(),o=!0),e.join("</li><li>")):t.replace(new RegExp("\n","g"),"<br/>").replace(new RegExp(T.mxgraph.io.vsdx.Shape.UNICODE_LINE_SEP,"g"),"<br/>"),this.getTextCharFormated(t)}if(null!=t&&0<t.length)for(var u=0;u<t.length;u++){var h,g,x=t.item(u);((s=x.nodeName)&&s.equals?s.equals("cp"):"cp"===s)?this.cp=this.getIndex(x):((s=x.nodeName)&&s.equals?s.equals("tp"):"tp"===s)?this.tp=this.getIndex(x):((s=x.nodeName)&&s.equals?s.equals("pp"):"pp"===s)?(this.pp=this.getIndex(x),a&&(i+="</li></ul>"),r?r=!1:i+="</p>",i+=this.getTextParagraphFormated("<p>"),h=this.getPPList(this.pp),o=a=null!=h,i+=a?h:""):((h=x.nodeName)&&h.equals?h.equals("fld"):"fld"===h)?(this.fld=this.getIndex(x),(g=null)!=this.fields&&(h=this.fields,n=this.fld,g=h[n]||null),null==g&&null!=this.masterShape&&null!=this.masterShape.fields&&(n=this.masterShape.fields,e=this.fld,g=n[e]||null),null!=g&&(i+=l.call(this,g))):((e=x.nodeName)&&e.equals?e.equals("#text"):"#text"===e)&&(g=x.textContent,i+=l.call(this,g))}return a&&(i+="</li></ul>"),T.mxgraph.io.vsdx.mxVsdxUtils.surroundByTags(i+=r?"":"</p>","div"),i},d.prototype.isConnectorBigNameU=function(t){return v="60 degree single",t.substr(f=void 0===f?0:f,v.length)===v||(y="45 degree single",t.substr(_=void 0===_?0:_,y.length)===y)||(y="45 degree double",t.substr(d=void 0===d?0:d,y.length)===y)||(p="60 degree double",t.substr(c=void 0===c?0:c,p.length)===p)||(p="45 degree  tail",t.substr(m=void 0===m?0:m,p.length)===p)||(g="60 degree  tail",t.substr(x=void 0===x?0:x,g.length)===g)||(g="45 degree tail",t.substr(h=void 0===h?0:h,g.length)===g)||(l="60 degree tail",t.substr(u=void 0===u?0:u,l.length)===l)||(l="Flexi-arrow 2",t.substr(o=void 0===o?0:o,l.length)===l)||(r="Flexi-arrow 1",t.substr(a=void 0===a?0:a,r.length)===r)||(r="Flexi-arrow 3",t.substr(i=void 0===i?0:i,r.length)===r)||(n="Double flexi-arrow",t.substr(s=void 0===s?0:s,n.length)===n)||(n="Fancy arrow",t.substr(e=void 0===e?0:e,n.length)===n);var e,n,s,i,r,a,o,l,u,h,g,x,m,p,c,d,y,_,v,f},d.prototype.isVertex=function(){return this.vertex},d.prototype.getOriginPoint=function(t,e){var n=this.getPinX(),s=this.getPinY(),i=this.getLocPinY(),r=this.getLocPinX(),a=this.getScreenNumericalValue$org_w3c_dom_Element$double(this.getShapeNode(T.mxgraph.io.vsdx.mxVsdxConstants.WIDTH),0),o=this.getScreenNumericalValue$org_w3c_dom_Element$double(this.getShapeNode(T.mxgraph.io.vsdx.mxVsdxConstants.HEIGHT),0),n=n-r,s=t-(s+(o-i));if(!e||i===o/2&&r===a/2||0===this.rotation)return new mxPoint(n,s);a=a/2-r,r=i-o/2,i=Math.cos((360-this.rotation)*Math.PI/180),o=Math.sin((360-this.rotation)*Math.PI/180);return new mxPoint(n+a-(a*i-r*o),a*o+r*i+s-r)},d.prototype.getDimensions=function(){var t=this.getScreenNumericalValue$org_w3c_dom_Element$double(this.getShapeNode(T.mxgraph.io.vsdx.mxVsdxConstants.WIDTH),0),e=this.getScreenNumericalValue$org_w3c_dom_Element$double(this.getShapeNode(T.mxgraph.io.vsdx.mxVsdxConstants.HEIGHT),0);return new mxPoint(0===t&&0<e?1:t,0===e&&0<t?1:e)},d.prototype.getPinX=function(){return this.getScreenNumericalValue$org_w3c_dom_Element$double(this.getShapeNode(T.mxgraph.io.vsdx.mxVsdxConstants.PIN_X),0)},d.prototype.getPinY=function(){return this.getScreenNumericalValue$org_w3c_dom_Element$double(this.getShapeNode(T.mxgraph.io.vsdx.mxVsdxConstants.PIN_Y),0)},d.prototype.getLocPinX=function(){return this.getScreenNumericalValue$org_w3c_dom_Element$double(this.getShapeNode(T.mxgraph.io.vsdx.mxVsdxConstants.LOC_PIN_X),0)},d.prototype.getLocPinY=function(){return this.getScreenNumericalValue$org_w3c_dom_Element$double(this.getShapeNode(T.mxgraph.io.vsdx.mxVsdxConstants.LOC_PIN_Y),0)},d.prototype.getOpacity=function(t){var e=100;return this.isGroup()&&(e=0),e=100-100*(e=this.getValueAsDouble(this.getCellElement$java_lang_String(t),0)),e=Math.max(e,0),e=Math.min(e,100)},d.prototype.getGradient=function(){var t=this.getValue(this.getCellElement$java_lang_String(T.mxgraph.io.vsdx.mxVsdxConstants.FILL_GRADIENT_ENABLED),"0");if(t=t,"1".equals?"1".equals(t):"1"===t){t=this.sections["FillGradient"]||null;if(null!=t){var e=T.mxgraph.io.vsdx.mxVsdxUtils.getDirectChildNamedElements(t.elem,"Row"),n=this.getColor(t.getIndexedCell(e[e.length-1].getAttribute("IX"),"GradientStopColor"));if(null!=n&&0!==n.length)return n}}var e="",n=this.getValue(this.getCellElement$java_lang_String(T.mxgraph.io.vsdx.mxVsdxConstants.FILL_PATTERN),"0");return 25<=parseInt(n)?e=this.getColor(this.getCellElement$java_lang_String(T.mxgraph.io.vsdx.mxVsdxConstants.FILL_BKGND)):null==(n=this.getTheme())||null!=(n=n.getFillGraientColor(this.getQuickStyleVals()))&&(e=n.toHexStr()),e},d.prototype.getGradientDirection=function(){var t,e="",n=this.getValue(this.getCellElement$java_lang_String(T.mxgraph.io.vsdx.mxVsdxConstants.FILL_PATTERN),"0");return((t=n)&&t.equals?t.equals("25"):"25"===t)?e=mxConstants.DIRECTION_EAST:((t=n)&&t.equals?t.equals("27"):"27"===t)?e=mxConstants.DIRECTION_WEST:((t=n)&&t.equals?t.equals("28"):"28"===t)?e=mxConstants.DIRECTION_SOUTH:((n=n)&&n.equals?n.equals("30"):"30"===n)&&(e=mxConstants.DIRECTION_NORTH),e},d.prototype.calcRotation=function(){var t=180*(t=parseFloat(this.getValue(this.getCellElement$java_lang_String(T.mxgraph.io.vsdx.mxVsdxConstants.ANGLE),"0")))/Math.PI;return 360-(t=100*(t%=360)/100)},d.prototype.propagateRotation=function(t){this.rotation+=t,this.rotation%=360,this.rotation=100*this.rotation/100},d.prototype.getTopSpacing=function(){return 100*(this.getTextTopMargin()/2-2.8)/100},d.prototype.getBottomSpacing=function(){return 100*(this.getTextBottomMargin()/2-2.8)/100},d.prototype.getLeftSpacing=function(){return 100*(this.getTextLeftMargin()/2-2.8)/100},d.prototype.getRightSpacing=function(){return 100*(this.getTextRightMargin()/2-2.8)/100},d.prototype.getLabelRotation=function(){var t=!0,e=this.calcRotation(),n=180*(n=parseFloat(this.getValue(this.getCellElement$java_lang_String(T.mxgraph.io.vsdx.mxVsdxConstants.TXT_ANGLE),"0")))/Math.PI;return n-=e,t=!(Math.abs(n)<45||270<Math.abs(n))?!1:t},d.prototype.getHyperlink=function(){var t=this.getCellElement$java_lang_String$java_lang_String$java_lang_String("Address",null,"Hyperlink"),e=this.getValue(t,""),t=this.getCellElement$java_lang_String$java_lang_String$java_lang_String("SubAddress",null,"Hyperlink");return{extLink:e,pageLink:this.getValue(t,"")}},d.prototype.getProperties=function(){var t=[];if(this.sections&&this.sections.Property)for(var e=T.mxgraph.io.vsdx.mxVsdxUtils.getDirectChildNamedElements(this.sections.Property.elem,"Row"),n=0;n<e.length;n++)for(var s=e[n],i=s.getAttribute("N"),r=T.mxgraph.io.vsdx.mxVsdxUtils.getDirectChildElements(s),a=0;a<r.length;a++){var o=r[a];if("Value"==o.getAttribute("N")){t.push({key:i,val:o.getAttribute("V")});break}}return t},d.prototype.getStyleFromShape=function(){this.styleMap[T.mxgraph.io.vsdx.mxVsdxConstants.VSDX_ID]=this.getId().toString(),this.rotation=Math.round(this.rotation),0!==this.rotation&&(this.styleMap[mxConstants.STYLE_ROTATION]=""+this.rotation);var t=this.getFillColor();((n=t)&&n.equals?n.equals(""):""===n)?this.styleMap[mxConstants.STYLE_FILLCOLOR]="none":this.styleMap[mxConstants.STYLE_FILLCOLOR]=t;var e=this.getId();this.styleDebug("ID = "+e+" , Fill Color = "+t);var n=this.getGradient();((t=n)&&t.equals?t.equals(""):""===t)?this.styleMap[mxConstants.STYLE_GRADIENTCOLOR]="none":(this.styleMap[mxConstants.STYLE_GRADIENTCOLOR]=n,s=this.getGradientDirection(),((t=s)&&t.equals?t.equals(""):""===t)||(n=s,t=mxConstants.DIRECTION_SOUTH,n&&n.equals?n.equals(t):n===t)||(this.styleMap[mxConstants.STYLE_GRADIENT_DIRECTION]=s));var s=this.getOpacity(T.mxgraph.io.vsdx.mxVsdxConstants.FILL_FOREGND_TRANS);s<100&&(this.styleMap[mxConstants.STYLE_FILL_OPACITY]=""+s),(s=this.getOpacity(T.mxgraph.io.vsdx.mxVsdxConstants.LINE_COLOR_TRANS))<100&&(this.styleMap[mxConstants.STYLE_STROKE_OPACITY]=""+s);var i,r=this.getForm();for(i in r.hasOwnProperty(mxConstants.STYLE_SHAPE)&&"image;"===function(t,e){return t[e]?t[e]:null}(r,mxConstants.STYLE_SHAPE).substr(a=void 0===a?0:a,"image;".length)&&(this.styleMap[mxConstants.STYLE_WHITE_SPACE]="wrap"),r)this.styleMap[i]=r[i];this.isDashed()&&(this.styleMap[mxConstants.STYLE_DASHED]="1",null!=(o=this.getDashPattern())&&(this.styleMap[mxConstants.STYLE_DASH_PATTERN]=o));var a=this.getStrokeColor(),o=this.getStrokeTransparency();this.styleDebug("ID = "+e+" , Color = "+a+" , stroke transparency = "+o),((e=a)&&e.equals?e.equals(""):""===e)||1===o||(this.styleMap[mxConstants.STYLE_STROKECOLOR]=a);o=0|Math.round(this.getLineWidth());1!=o&&(this.styleMap[mxConstants.STYLE_STROKEWIDTH]=""+o),this.isShadow()&&(this.styleMap[mxConstants.STYLE_SHADOW]=T.mxgraph.io.vsdx.mxVsdxConstants.TRUE);a=0|Math.round(this.getTopSpacing());0!=a&&(this.styleMap[mxConstants.STYLE_SPACING_TOP]=""+a);o=0|Math.round(this.getBottomSpacing());0!=o&&(this.styleMap[mxConstants.STYLE_SPACING_BOTTOM]=""+o);a=0|Math.round(this.getLeftSpacing());0!=a&&(this.styleMap[mxConstants.STYLE_SPACING_LEFT]=""+a);o=0|Math.round(this.getRightSpacing());0!=o&&(this.styleMap[mxConstants.STYLE_SPACING_RIGHT]=""+o);a=this.getDirection(r);a!==mxConstants.DIRECTION_EAST&&(this.styleMap[mxConstants.STYLE_DIRECTION]=a);var o=this.getValue(this.getCellElement$java_lang_String(T.mxgraph.io.vsdx.mxVsdxConstants.FLIP_X),"0"),a=this.getValue(this.getCellElement$java_lang_String(T.mxgraph.io.vsdx.mxVsdxConstants.FLIP_Y),"0");return o=o,("1".equals?"1".equals(o):"1"===o)&&(this.styleMap[mxConstants.STYLE_FLIPH]="1"),a=a,("1".equals?"1".equals(a):"1"===a)&&(this.styleMap[mxConstants.STYLE_FLIPV]="1"),this.resolveCommonStyles(),this.styleMap},d.prototype.getDashPattern=function(){var t,e=null,n=this.getValue(this.getCellElement$java_lang_String(T.mxgraph.io.vsdx.mxVsdxConstants.LINE_PATTERN),"0");if(((t=n)&&t.equals?t.equals("Themed"):"Themed"===t)?null!=(t=this.getTheme())&&(e=this.isVertex()?t.getLineDashPattern$com_mxgraph_io_vsdx_theme_QuickStyleVals(this.getQuickStyleVals()):t.getConnLineDashPattern(this.getQuickStyleVals())):e=r.Style.getLineDashPattern(parseInt(n)),null==e||0==e.length)return null;for(var s={str:"",toString:function(){return this.str}},i=0;i<e.length;i++)!function(t){t=e[t];s.str=s.str.concat(t.toFixed(2)+" ")}(i);return s.str.trim()},d.prototype.isDashed=function(){var t,e=this.getValue(this.getCellElement$java_lang_String(T.mxgraph.io.vsdx.mxVsdxConstants.LINE_PATTERN),"0");if((t=e)&&t.equals?t.equals("Themed"):"Themed"===t){var n=this.getTheme();if(null!=n)return this.isVertex()?n.isLineDashed$com_mxgraph_io_vsdx_theme_QuickStyleVals(this.getQuickStyleVals()):n.isConnLineDashed(this.getQuickStyleVals())}else if(((n=e)&&n.equals?!n.equals("0"):"0"!==n)&&((e=e)&&e.equals?!e.equals("1"):"1"!==e))return!0;return!1},d.prototype.getLineWidth=function(){var t,e,n=this.getValue(this.getCellElement$java_lang_String(T.mxgraph.io.vsdx.mxVsdxConstants.LINE_WEIGHT),"1"),s=1;try{((e=n)&&e.equals?e.equals("Themed"):"Themed"===e)?null!=(t=this.getTheme())&&(s=(this.isVertex()?t.getLineWidth$com_mxgraph_io_vsdx_theme_QuickStyleVals(this.getQuickStyleVals()):t.getConnLineWidth(this.getQuickStyleVals()))/1e4):(s=parseFloat(n),s=this.getScreenNumericalValue$double(s))}catch(t){}return s<1&&(s*=2),s},d.prototype.getStartArrowSize=function(){var t,e=this.getValue(this.getCellElement$java_lang_String(T.mxgraph.io.vsdx.mxVsdxConstants.BEGIN_ARROW_SIZE),"4");try{var n,s=4;return((t=e)&&t.equals?t.equals("Themed"):"Themed"===t)?null!=(n=this.getTheme())&&(s=this.isVertex()?n.getStartSize(this.getQuickStyleVals()):n.getConnStartSize(this.getQuickStyleVals())):s=parseFloat(e),d.arrowSizes_$LI$()[s]}catch(t){}return 4},d.prototype.getFinalArrowSize=function(){var t,e=this.getValue(this.getCellElement$java_lang_String(T.mxgraph.io.vsdx.mxVsdxConstants.END_ARROW_SIZE),"4");try{var n,s=4;return((t=e)&&t.equals?t.equals("Themed"):"Themed"===t)?null!=(n=this.getTheme())&&(s=this.isVertex()?n.getEndSize(this.getQuickStyleVals()):n.getConnEndSize(this.getQuickStyleVals())):s=parseFloat(e),d.arrowSizes_$LI$()[s]}catch(t){}return 4},d.prototype.getRounding=function(){var t,e,n=this.getValue(this.getCellElement$java_lang_String(T.mxgraph.io.vsdx.mxVsdxConstants.ROUNDING),"0");return e=n,((t="Themed").equals?t.equals(e):t===e)&&(n="0"),parseFloat(n)},d.prototype.isShadow=function(){var t,e=this.getValue(this.getCellElement$java_lang_String(T.mxgraph.io.vsdx.mxVsdxConstants.SHDW_PATTERN),"0");return((t=e)&&t.equals?!t.equals("Themed"):"Themed"!==t)&&((e=e)&&e.equals?!e.equals("0"):"0"!==e)},d.prototype.getEdgeStyle$java_util_Map=function(t){var e={},n=(n=t,t=mxConstants.STYLE_SHAPE,n[t]||null);return t="mxgraph.lean_mapping.electronic_info_flow_edge",((n=n)&&n.equals?n.equals(t):n===t)?e[mxConstants.STYLE_EDGE]=mxConstants.NONE:e[mxConstants.STYLE_EDGE]=mxConstants.EDGESTYLE_ELBOW,e},d.prototype.getEdgeStyle=function(t){if(null!=t&&t instanceof Object||null===t)return this.getEdgeStyle$java_util_Map(t);if(void 0===t)return this.getEdgeStyle$();throw new Error("invalid overload")},d.prototype.getMasterId=function(){return this.shape.hasAttribute(T.mxgraph.io.vsdx.mxVsdxConstants.MASTER)?this.shape.getAttribute(T.mxgraph.io.vsdx.mxVsdxConstants.MASTER):null},d.prototype.getShapeMasterId=function(){return this.shape.hasAttribute(T.mxgraph.io.vsdx.mxVsdxConstants.MASTER_SHAPE)?this.shape.getAttribute(T.mxgraph.io.vsdx.mxVsdxConstants.MASTER_SHAPE):null},d.prototype.isGroup=function(){return(t=this.shape.getAttribute("Type"))&&t.equals?t.equals("Group"):"Group"===t;var t},d.getType=function(t){return t.getAttribute("Type")},d.prototype.getMaster=function(){return this.master},d.prototype.getNameU=function(){var t,e=this.shape.getAttribute(T.mxgraph.io.vsdx.mxVsdxConstants.NAME_U)||"";return e=(null==e||((t=e)&&t.equals?t.equals(""):""===t))&&null!=this.masterShape?this.masterShape.getNameU():e},d.prototype.getName=function(){var t,e=this.shape.getAttribute(T.mxgraph.io.vsdx.mxVsdxConstants.NAME);return e=(null==e||((t=e)&&t.equals?t.equals(""):""===t))&&null!=this.masterShape?this.masterShape.getName():e},d.prototype.getMasterName=function(){return this.shapeName},d.prototype.setLabelOffset=function(t,e){var n,s,i,r,a,o,l,u,h="",g="";if(this.shape.hasAttribute(T.mxgraph.io.vsdx.mxVsdxConstants.NAME_U)&&(h=this.shape.getAttribute(T.mxgraph.io.vsdx.mxVsdxConstants.NAME_U)),null!=this.getMaster()&&null!=this.getMaster().getMasterElement()&&this.getMaster().getMasterElement().hasAttribute(T.mxgraph.io.vsdx.mxVsdxConstants.NAME_U)&&(g=this.getMaster().getMasterElement().getAttribute(T.mxgraph.io.vsdx.mxVsdxConstants.NAME_U)),l="Organizational unit",h.substr(u=void 0===u?0:u,l.length)===l||(l="Organizational unit",g.substr(o=void 0===o?0:o,l.length)===l)){var x,m=null,p="0.0",c=null,d="-0.4";null!=(x=this.shape.getElementsByTagName(T.mxgraph.io.vsdx.mxVsdxConstants.CONTROL).item(0))&&(p=(m=x.getElementsByTagName(T.mxgraph.io.vsdx.mxVsdxConstants.X).item(0)).hasAttribute("F")?m.getAttribute("F"):m.textContent,d=(c=x.getElementsByTagName(T.mxgraph.io.vsdx.mxVsdxConstants.Y).item(0)).hasAttribute("F")?c.getAttribute("F"):c.textContent);var y=t.getGeometry();p=(p=p.split("Width/2+").join("")).split("DL").join(""),d=d.split("Height*").join(""),((A=p)&&A.equals?A.equals("Inh"):"Inh"===A)&&(p="0.0"),-1!=(d=((E=d)&&E.equals?E.equals("Inh"):"Inh"===E)?"-0.4":d).indexOf("txtHeight")&&(d="-0.4");for(var _=e.split(";"),v="",f=0;f<_.length;f++){var S=(S=_[f]).trim();r="tabHeight=",a=void 0,S.substr(a=void 0===a?0:a,r.length)===r&&(v=S.split("tabHeight=").join(""))}((M=v)&&M.equals?M.equals(""):""===M)&&(v="20");var C=parseFloat(v),I=parseFloat(p),L=parseFloat(d),A=y.height,E=.1*y.width+100*I,M=A-A*L-C/2,y=new mxPoint(E,M);t.getGeometry().offset=y}else C="Domain 3D",h.substr(i=void 0===i?0:i,C.length)!==C&&(C="Domain 3D",g.substr(s=void 0===s?0:s,C.length)!==C)||(p="0.0",d="-0.4",(c=m=null)!=(x=this.shape.getElementsByTagName(T.mxgraph.io.vsdx.mxVsdxConstants.CONTROL).item(0))&&(p=(m=x.getElementsByTagName(T.mxgraph.io.vsdx.mxVsdxConstants.X).item(0)).getAttribute("F")||"",d=(c=x.getElementsByTagName(T.mxgraph.io.vsdx.mxVsdxConstants.Y).item(0)).getAttribute("F")||""),x=t.getGeometry(),p=(p=p.split("Width/2+").join("")).split("DL").join(""),d=d.split("Height*").join(""),(((c=p)&&c.equals?c.equals("Inh"):"Inh"===c)||((n=p)&&n.equals?n.equals(""):""===n))&&(p="0.0"),-1!=(d=((n=d)&&n.equals?n.equals("Inh"):"Inh"===n)||((n=d)&&n.equals?n.equals(""):""===n)?"-0.4":d).indexOf("txtHeight")&&(d="-0.4"),I=parseFloat(p),L=parseFloat(d),A=x.height,E=.1*x.width+100*I,M=A-A*L,y=new mxPoint(E,M),t.getGeometry().offset=y)},d.prototype.getForm=function(){var t,e,n,s={};if(!this.isVertex())return this.getEdgeStyle();try{var i=d.getType(this.getShape());if(this.styleDebug("shape type = "+i),null!=this.imageData||(e=T.mxgraph.io.vsdx.mxVsdxConstants.FOREIGN,n=i,(e&&e.equals?e.equals(n):e===n)&&null!=this.masterShape&&null!=this.masterShape.imageData)){var r=(null!=this.imageData?this:this.masterShape).imageData;s.shape="image",s.aspect="fixed";var a=r.iType||null,o=r.iData||null,l=parseFloat(this.getValue(this.getCellElement$java_lang_String("ImgOffsetX"),"0")),u=parseFloat(this.getValue(this.getCellElement$java_lang_String("ImgOffsetY"),"0")),h=parseFloat(this.getValue(this.getCellElement$java_lang_String("ImgWidth"),"0")),g=parseFloat(this.getValue(this.getCellElement$java_lang_String("ImgHeight"),"0")),x=parseFloat(this.getValue(this.getCellElement$java_lang_String("Width"),"0")),m=parseFloat(this.getValue(this.getCellElement$java_lang_String("Height"),"0"));return 0!=l||0!=u?this.toBeCroppedImg={imgOffsetX:l,imgOffsetY:u,imgWidth:h,imgHeight:g,width:x,height:m,iType:a,iData:o}:s.image="data:image/"+a+","+o,s}var p=this.parseGeom();if((t=p)&&t.equals?t.equals(""):""===t)return this.styleDebug("No geom found"),s;var c=Graph.compress(p);s[mxConstants.STYLE_SHAPE]="stencil("+c+")"}catch(t){console.error(t.message,t)}return s},d.prototype.isOff_page_reference=function(){var t,e,n=this.getNameU();return e="Off-page reference",!(((t=n)&&t.equals?!t.equals(e):t!==e)&&(e="Lined/Shaded process",(n=n)&&n.equals?!n.equals(e):n!==e))},d.prototype.isExternal_process=function(){return t=this.shapeName,e="External process",t&&t.equals?t.equals(e):t===e;var t,e},d.prototype.getDirection=function(t){var e,n,s=mxResources.get("mxOffset"+this.shapeName);return null==s||((n=s)&&n.equals?n.equals("0"):"0"===n)||((e=s)&&e.equals?e.equals(""):""===e)?mxConstants.DIRECTION_EAST:((e=s)&&e.equals?e.equals("1"):"1"===e)?mxConstants.DIRECTION_SOUTH:((e=s)&&e.equals?e.equals("2"):"2"===e)?mxConstants.DIRECTION_WEST:((s=s)&&s.equals?s.equals("3"):"3"===s)?mxConstants.DIRECTION_NORTH:mxConstants.DIRECTION_EAST},d.prototype.isSubproces=function(){return(t=this.shapeName)&&t.equals?t.equals("Subproces"):"Subproces"===t;var t},d.prototype.getEdgeStyle$=function(){var t={edgeStyle:"none"};return t},d.prototype.getChildShapes=function(){return this.childShapes},d.prototype.setChildShapes=function(t){this.childShapes=t},d.prototype.isDisplacedLabel=function(){var t,e,n,s,i,r,a,o,l,u,h=this.getAttribute(T.mxgraph.io.vsdx.mxVsdxConstants.TXT_PIN_X,"F",""),g=this.getAttribute(T.mxgraph.io.vsdx.mxVsdxConstants.TXT_PIN_Y,"F",""),x=this.getAttribute(T.mxgraph.io.vsdx.mxVsdxConstants.TXT_WIDTH,"F",""),m=this.getAttribute(T.mxgraph.io.vsdx.mxVsdxConstants.TXT_HEIGHT,"F","");return null!=this.masterShape&&(""!==h&&((t=h.toLowerCase())&&t.equals?!t.equals("inh"):"inh"!==t)||(h=this.masterShape.getAttribute(T.mxgraph.io.vsdx.mxVsdxConstants.TXT_PIN_X,"F","")),""!==g&&((t=g.toLowerCase())&&t.equals?!t.equals("inh"):"inh"!==t)||(g=this.masterShape.getAttribute(T.mxgraph.io.vsdx.mxVsdxConstants.TXT_PIN_Y,"F","")),""!==x&&((u=x.toLowerCase())&&u.equals?!u.equals("inh"):"inh"!==u)||(x=this.masterShape.getAttribute(T.mxgraph.io.vsdx.mxVsdxConstants.TXT_WIDTH,"F","")),""!==m&&((l=m.toLowerCase())&&l.equals?!l.equals("inh"):"inh"!==l)||(m=this.masterShape.getAttribute(T.mxgraph.io.vsdx.mxVsdxConstants.TXT_HEIGHT,"F",""))),!(((u=h.toLowerCase())&&u.equals?u.equals("width*0.5"):"width*0.5"===u)&&(l=g.toLowerCase(),u="height*0.5",l&&l.equals?l.equals(u):l===u)&&((o=x.toLowerCase())&&o.equals?o.equals("width*1"):"width*1"===o)&&((o=m.toLowerCase())&&o.equals?o.equals("height*1"):"height*1"===o))&&("width*"===h.toLowerCase().substr(a=void 0===a?0:a,"width*".length)&&"height*"===g.toLowerCase().substr(r=void 0===r?0:r,"height*".length)&&"width*"===x.toLowerCase().substr(i=void 0===i?0:i,"width*".length)&&"height*"===m.toLowerCase().substr(s=void 0===s?0:s,"height*".length)||(s="controls.row_",h.toLowerCase().substr(n=void 0===n?0:n,s.length)===s||(s="controls.row_",g.toLowerCase().substr(e=void 0===e?0:e,s.length)===s)))},d.prototype.isVerticalLabel=function(){var t=this.getAttribute("TextDirection","V","");return"1"==(t=!t&&null!=this.masterShape?this.masterShape.getAttribute("TextDirection","V",""):t)},d.prototype.isRotatedLabel=function(){if(this.isVerticalLabel())return!0;var t,e=this.getAttribute(T.mxgraph.io.vsdx.mxVsdxConstants.TXT_ANGLE,"V","");return null!=this.masterShape&&((t=e)&&t.equals?t.equals(""):""===t)&&(e=this.masterShape.getAttribute(T.mxgraph.io.vsdx.mxVsdxConstants.TXT_ANGLE,"V","")),!(((t=e)&&t.equals?t.equals("0"):"0"===t)||((t=e)&&t.equals?t.equals("0.0"):"0.0"===t)||((e=e)&&e.equals?e.equals(""):""===e))},d.prototype.setRootShape=function(t){this.rootShape=t},d.prototype.getRootShape=function(){return this.rootShape},d.prototype.getStartXY=function(t){var e=Math.floor(Math.round(100*this.getScreenNumericalValue$org_w3c_dom_Element$double(this.getCellElement$java_lang_String(T.mxgraph.io.vsdx.mxVsdxConstants.BEGIN_X),0))/100),t=Math.floor(Math.round(100*(t-this.getScreenNumericalValue$org_w3c_dom_Element$double(this.getCellElement$java_lang_String(T.mxgraph.io.vsdx.mxVsdxConstants.BEGIN_Y),0)))/100);return new mxPoint(e,t)},d.prototype.getEndXY=function(t){var e=Math.floor(Math.round(100*this.getScreenNumericalValue$org_w3c_dom_Element$double(this.getCellElement$java_lang_String(T.mxgraph.io.vsdx.mxVsdxConstants.END_X),0))/100),t=Math.floor(Math.round(100*(t-this.getScreenNumericalValue$org_w3c_dom_Element$double(this.getCellElement$java_lang_String(T.mxgraph.io.vsdx.mxVsdxConstants.END_Y),0)))/100);return new mxPoint(e,t)},d.prototype.getRoutingPoints=function(t,e,n){return null!=this.geomList?this.geomList.getRoutingPoints(t,e,n):null},d.prototype.getControlPoints=function(t){var e=this.getStartXY(t),n=this.getEndXY(t),s=[];if(null!=this.shape){var t=this.shape.getElementsByTagName(T.mxgraph.io.vsdx.mxVsdxConstants.GEOM);if(0<t.length){t=t.item(0).getElementsByTagName(T.mxgraph.io.vsdx.mxVsdxConstants.NURBS_TO).item(0).getElementsByTagName("E").item(0);if(null==t)return null;for(var t=t.getAttribute("F")||"",i=(t=(t=(t=(t=t.replace(new RegExp("NURBS\\(","g"),"")).replace(new RegExp("\\)","g"),"")).replace(new RegExp(",","g")," ")).replace(new RegExp("\\s\\s","g")," ")).split(" "),r=function(t){for(var e=[];0<t--;)e.push(0);return e}(i.length),a=0;a<i.length;a++)r[a]=parseFloat(i[a]);for(a=2;a+4<i.length;a+=4){var o=new mxPoint,l=r[a+2],u=r[a+3],h=Math.abs(n.x-e.x),h=Math.min(100,h),l=e.x+h*l;o.x=Math.floor(Math.round(100*l)/100),o.y=Math.floor(Math.round(100*(e.y-100*u))/100),s.push(o)}return s}}return null},d.prototype.getStyleFromEdgeShape=function(t){this.styleMap[T.mxgraph.io.vsdx.mxVsdxConstants.VSDX_ID]=this.getId().toString();var e=this.getForm();if(null!=e&&!((r=e)&&r.equals?r.equals(""):""===r))for(var n in e)this.styleMap[n]=e[n];this.isDashed()&&(this.styleMap[mxConstants.STYLE_DASHED]="1",null!=(s=this.getDashPattern())&&(this.styleMap[mxConstants.STYLE_DASH_PATTERN]=s));var s,i,r=this.getEdgeMarker(!0);null!=r&&(s=r,o=d.ARROW_NO_FILL_MARKER,s.substr(i=void 0===i?0:i,o.length)===o&&(r=r.substring(d.ARROW_NO_FILL_MARKER.length),this.styleMap[mxConstants.STYLE_STARTFILL]="0"),this.styleMap[mxConstants.STYLE_STARTARROW]=r);var a,o=this.getEdgeMarker(!1);null!=o&&(r=o,l=d.ARROW_NO_FILL_MARKER,r.substr(a=void 0===a?0:a,l.length)===l&&(o=o.substring(d.ARROW_NO_FILL_MARKER.length),this.styleMap[mxConstants.STYLE_ENDFILL]="0"),this.styleMap[mxConstants.STYLE_ENDARROW]=o);var l=0|Math.round(this.getStartArrowSize());6!=l&&(this.styleMap[mxConstants.STYLE_STARTSIZE]=""+l);o=0|Math.round(this.getFinalArrowSize());6!=o&&(this.styleMap[mxConstants.STYLE_ENDSIZE]=""+o);l=0|Math.round(this.getLineWidth());1!=l&&(this.styleMap[mxConstants.STYLE_STROKEWIDTH]=""+l);var o=this.getStrokeColor();((l=o)&&l.equals?l.equals(""):""===l)||(this.styleMap[mxConstants.STYLE_STROKECOLOR]=o),this.isShadow()&&(this.styleMap[mxConstants.STYLE_SHADOW]=T.mxgraph.io.vsdx.mxVsdxConstants.TRUE),this.isConnectorBigNameU(this.getNameU())&&(this.styleMap[mxConstants.STYLE_SHAPE]=mxConstants.SHAPE_ARROW,u=this.getFillColor(),((o=u)&&o.equals?o.equals(""):""===o)||(this.styleMap[mxConstants.STYLE_FILLCOLOR]=u));var u=0|Math.round(this.getTopSpacing());this.styleMap[mxConstants.STYLE_SPACING_TOP]=""+u;u=0|Math.round(this.getBottomSpacing());this.styleMap[mxConstants.STYLE_SPACING_BOTTOM]=""+u;u=0|Math.round(this.getLeftSpacing());this.styleMap[mxConstants.STYLE_SPACING_LEFT]=""+u;u=0|Math.round(this.getRightSpacing());this.styleMap[mxConstants.STYLE_SPACING_RIGHT]=""+u;u=this.getAlignVertical();return this.styleMap[mxConstants.STYLE_VERTICAL_ALIGN]=u,this.styleMap.html="1",this.resolveCommonStyles(),this.styleMap},d.prototype.resolveCommonStyles=function(){var t,e=this.getTextBkgndColor(this.getCellElement$java_lang_String(T.mxgraph.io.vsdx.mxVsdxConstants.TEXT_BKGND));return((t=e)&&t.equals?t.equals(""):""===t)||"1"==this.getValue(this.getCellElement$java_lang_String("TextBkgndTrans"),"0")||(this.styleMap[mxConstants.STYLE_LABEL_BACKGROUNDCOLOR]=e),this.styleMap[mxConstants.STYLE_ROUNDED]=0<this.getRounding()?T.mxgraph.io.vsdx.mxVsdxConstants.TRUE:T.mxgraph.io.vsdx.mxVsdxConstants.FALSE,this.styleMap},d.prototype.getEdgeMarker=function(t){var e,n,s=this.getValue(this.getCellElement$java_lang_String(t?T.mxgraph.io.vsdx.mxVsdxConstants.BEGIN_ARROW:T.mxgraph.io.vsdx.mxVsdxConstants.END_ARROW),"0"),i=0;try{((n=s)&&n.equals?n.equals("Themed"):"Themed"===n)?null!=(e=this.getTheme())&&(i=this.isVertex()?e.getEdgeMarker(t,this.getQuickStyleVals()):e.getConnEdgeMarker(t,this.getQuickStyleVals())):i=parseInt(s)}catch(t){}s=function(t,e){null==t.entries&&(t.entries=[]);for(var n=0;n<t.entries.length;n++)if(null!=t.entries[n].key.equals&&t.entries[n].key.equals(e)||t.entries[n].key===e)return t.entries[n].value;return null}(d.arrowTypes_$LI$(),i);return s=0<i&&null==s?function(t){null==t.entries&&(t.entries=[]);for(var e=0;e<t.entries.length;e++)if(null!=t.entries[e].key.equals&&t.entries[e].key.equals(1)||1===t.entries[e].key)return t.entries[e].value;return null}(d.arrowTypes_$LI$()):s},d.prototype.getCellElement$java_lang_String=function(t){var e=c.prototype.getCellElement$java_lang_String.call(this,t);return null==e&&null!=this.masterShape?this.masterShape.getCellElement$java_lang_String(t):e},d.prototype.getCellElement$java_lang_String$java_lang_String$java_lang_String=function(t,e,n){var s=c.prototype.getCellElement$java_lang_String$java_lang_String$java_lang_String.call(this,t,e,n);return null==s&&null!=this.masterShape?this.masterShape.getCellElement$java_lang_String$java_lang_String$java_lang_String(t,e,n):s},d.prototype.getCellElement=function(t,e,n){if("string"!=typeof t&&null!==t||"string"!=typeof e&&null!==e||"string"!=typeof n&&null!==n){if("string"!=typeof t&&null!==t||void 0!==e||void 0!==n)throw new Error("invalid overload");return this.getCellElement$java_lang_String(t)}return this.getCellElement$java_lang_String$java_lang_String$java_lang_String(t,e,n)},d.prototype.createLabelSubShape=function(t,e){var n=this.getScreenNumericalValue$org_w3c_dom_Element$double(this.getShapeNode(T.mxgraph.io.vsdx.mxVsdxConstants.TXT_WIDTH),this.getWidth()),s=this.getScreenNumericalValue$org_w3c_dom_Element$double(this.getShapeNode(T.mxgraph.io.vsdx.mxVsdxConstants.TXT_HEIGHT),this.getHeight()),i=this.getScreenNumericalValue$org_w3c_dom_Element$double(this.getShapeNode(T.mxgraph.io.vsdx.mxVsdxConstants.TXT_LOC_PIN_X),n/2),r=this.getScreenNumericalValue$org_w3c_dom_Element$double(this.getShapeNode(T.mxgraph.io.vsdx.mxVsdxConstants.TXT_LOC_PIN_Y),s/2),a=this.getScreenNumericalValue$org_w3c_dom_Element$double(this.getShapeNode(T.mxgraph.io.vsdx.mxVsdxConstants.TXT_PIN_X),i),o=this.getScreenNumericalValue$org_w3c_dom_Element$double(this.getShapeNode(T.mxgraph.io.vsdx.mxVsdxConstants.TXT_PIN_Y),r),l=this.getValueAsDouble(this.getShapeNode(T.mxgraph.io.vsdx.mxVsdxConstants.TXT_ANGLE),0),u=this.getTextLabel();if(null==u||0===u.length)return null;var h=mxUtils.clone(this.getStyleMap())||{};h[mxConstants.STYLE_FILLCOLOR]=mxConstants.NONE,h[mxConstants.STYLE_STROKECOLOR]=mxConstants.NONE,h[mxConstants.STYLE_GRADIENTCOLOR]=mxConstants.NONE,h.hasOwnProperty("align")||(h.align="center"),h.hasOwnProperty("verticalAlign")||(h.verticalAlign="middle"),h.hasOwnProperty("whiteSpace")||(h.whiteSpace="wrap"),delete h.shape,delete h.image,this.isVerticalLabel()&&(l+=Math.PI+.01,h.horizontal="0");var g=this.getRotation();0!==l&&(x=360-180*l/Math.PI,0!=(x=Math.round((x+g)%360*100)/100)&&(h.rotation=""+x));var x="text;"+T.mxgraph.io.vsdx.mxVsdxUtils.getStyleString(h,"="),h=e.getGeometry().height-(o+s-r),o=a-i;return 0<g&&(r=new mxGeometry(o,h,n,s),i=(a=e.getGeometry()).width/2,a=a.height/2,T.mxgraph.online.Utils.rotatedGeometry(r,g,i,a),o=r.x,h=r.y),t.insertVertex(e,null,u,Math.round(100*o)/100,Math.round(100*h)/100,Math.round(100*n)/100,Math.round(100*s)/100,x+";html=1;")},d.prototype.getLblEdgeOffset=function(t,e){if(null!=e&&1<e.length){var n=new mxCellState;n.absolutePoints=e,t.updateEdgeBounds(n);var s=t.getPoint(n),i=e[0],r=e[e.length-1],a=this.getScreenNumericalValue$org_w3c_dom_Element$double(this.getShapeNode(T.mxgraph.io.vsdx.mxVsdxConstants.TXT_WIDTH),this.getWidth()),o=this.getScreenNumericalValue$org_w3c_dom_Element$double(this.getShapeNode(T.mxgraph.io.vsdx.mxVsdxConstants.TXT_HEIGHT),this.getHeight()),l=this.getScreenNumericalValue$org_w3c_dom_Element$double(this.getShapeNode(T.mxgraph.io.vsdx.mxVsdxConstants.TXT_LOC_PIN_X),0),t=this.getScreenNumericalValue$org_w3c_dom_Element$double(this.getShapeNode(T.mxgraph.io.vsdx.mxVsdxConstants.TXT_LOC_PIN_Y),0),n=this.getScreenNumericalValue$org_w3c_dom_Element$double(this.getShapeNode(T.mxgraph.io.vsdx.mxVsdxConstants.TXT_PIN_X),0),e=this.getScreenNumericalValue$org_w3c_dom_Element$double(this.getShapeNode(T.mxgraph.io.vsdx.mxVsdxConstants.TXT_PIN_Y),0),o=(this.getHeight()-(i.y-r.y))/2+i.y-s.y-(e-t+o/2),s=n-l+a/2+(i.x-s.x);return 1e11<Math.abs(s)?null:new mxPoint(Math.floor(Math.round(100*s)/100),Math.floor(Math.round(100*o)/100))}return null},d.prototype.getShapeIndex=function(){return this.shapeIndex},d.prototype.setShapeIndex=function(t){this.shapeIndex=t},(t=d).__static_initialized=!1,t.ARROW_NO_FILL_MARKER="0",t.maxDp=2,t.USE_SHAPE_MATCH=!1,t.stencilTemplate='<shape h="htemplate" w="wtemplate" aspect="variable" strokewidth="inherit"><connections></connections><background></background><foreground></foreground></shape>',(r.VsdxShape=t).__class="com.mxgraph.io.vsdx.VsdxShape"}(com=com||{}),function(e){var t,n;function _(){}t=e.mxgraph||(e.mxgraph={}),n=t.online||(t.online={}),_.__static_initialize=function(){_.__static_initialized||(_.__static_initialized=!0,_.__static_initializer_0())},_.CA_$LI$=function(){return _.__static_initialize(),_.CA=null==_.CA?"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split(""):_.CA},_.IA_$LI$=function(){return _.__static_initialize(),_.IA=null==_.IA?function(t){for(var e=[];0<t--;)e.push(0);return e}(256):_.IA},_.__static_initializer_0=function(){!function(t){for(var e=0;e<t.length;e++)t[e]=-1}(_.IA_$LI$());for(var t=0,e=_.CA_$LI$().length;t<e;t++)_.IA_$LI$()[_.CA_$LI$()[t].charCodeAt(0)]=t;_.IA_$LI$()["=".charCodeAt(0)]=0},_.encodeToChar=function(t,e,n){var s=null!=t?t.length-e:0;if(0==s)return new Array(0);for(var i=3*(s/3|0),r=1+((s-1)/3|0)<<2,a=r+(n?((r-1)/76|0)<<1:0),o=new Array(a),l=e,u=0,h=0;l<i+e;){var g=(255&t[l++])<<16|(255&t[l++])<<8|255&t[l++];o[u++]=_.CA_$LI$()[g>>>18&63],o[u++]=_.CA_$LI$()[g>>>12&63],o[u++]=_.CA_$LI$()[g>>>6&63],o[u++]=_.CA_$LI$()[63&g],n&&19==++h&&u<a-2&&(o[u++]="\r",o[u++]="\n",h=0)}r=s-i;return 0<r&&(g=(255&t[i+e])<<10|(2==r?(255&t[s+e-1])<<2:0),o[a-4]=_.CA_$LI$()[g>>12],o[a-3]=_.CA_$LI$()[g>>>6&63],o[a-2]=2==r?_.CA_$LI$()[63&g]:"=",o[a-1]="="),o},_.decode$char_A=function(t){var e=null!=t?t.length:0;if(0===e)return[];for(var n=0,s=0;s<e;s++)_.IA_$LI$()[t[s].charCodeAt(0)]<0&&n++;if((e-n)%4!=0)return null;for(var i,r=0,s=e;1<s&&_.IA_$LI$()[t[--s].charCodeAt(0)]<=0;)(null==(i=t[s]).charCodeAt?i:i.charCodeAt(0))=="=".charCodeAt(0)&&r++;for(var a=(6*(e-n)>>3)-r,o=function(t){for(var e=[];0<t--;)e.push(0);return e}(a),l=0,u=0;u<a;){for(var s=0,h=0;h<4;h++){var g=_.IA_$LI$()[t[l++].charCodeAt(0)];0<=g?s|=g<<18-6*h:h--}o[u++]=s>>16|0,u<a&&(o[u++]=s>>8|0,u<a&&(o[u++]=0|s))}return o},_.decode=function(t){if(null!=t&&t instanceof Array&&(0==t.length||null==t[0]||"string"==typeof t[0])||null===t)return e.mxgraph.online.mxBase64.decode$char_A(t);if(null!=t&&t instanceof Array&&(0==t.length||null==t[0]||"number"==typeof t[0])||null===t)return e.mxgraph.online.mxBase64.decode$byte_A(t);if("string"==typeof t||null===t)return e.mxgraph.online.mxBase64.decode$java_lang_String(t);throw new Error("invalid overload")},_.decodeFast$char_A=function(t){var e=t.length;if(0===e)return[];for(var n=0,s=e-1;n<s&&_.IA_$LI$()[t[n].charCodeAt(0)]<0;)n++;for(;0<s&&_.IA_$LI$()[t[s].charCodeAt(0)]<0;)s--;for(var i,r=(null==(i=t[s]).charCodeAt?i:i.charCodeAt(0))=="=".charCodeAt(0)?(null==(a=t[s-1]).charCodeAt?a:a.charCodeAt(0))=="=".charCodeAt(0)?2:1:0,a=s-n+1,o=76<e?((null==(e=t[76]).charCodeAt?e:e.charCodeAt(0))=="\r".charCodeAt(0)?a/78|0:0)<<1:0,l=(6*(a-o)>>3)-r,u=function(t){for(var e=[];0<t--;)e.push(0);return e}(l),h=0,g=0,x=3*(l/3|0);h<x;){var m=_.IA_$LI$()[t[n++].charCodeAt(0)]<<18|_.IA_$LI$()[t[n++].charCodeAt(0)]<<12|_.IA_$LI$()[t[n++].charCodeAt(0)]<<6|_.IA_$LI$()[t[n++].charCodeAt(0)];u[h++]=m>>16|0,u[h++]=m>>8|0,u[h++]=0|m,0<o&&19==++g&&(n+=2,g=0)}if(h<l){for(var m=0,p=0;n<=s-r;p++)m|=_.IA_$LI$()[t[n++].charCodeAt(0)]<<18-6*p;for(var c=16;h<l;c-=8)u[h++]=m>>c|0}return u},_.decodeFast=function(t){if(null!=t&&t instanceof Array&&(0==t.length||null==t[0]||"string"==typeof t[0])||null===t)return e.mxgraph.online.mxBase64.decodeFast$char_A(t);if(null!=t&&t instanceof Array&&(0==t.length||null==t[0]||"number"==typeof t[0])||null===t)return e.mxgraph.online.mxBase64.decodeFast$byte_A(t);if("string"==typeof t||null===t)return e.mxgraph.online.mxBase64.decodeFast$java_lang_String(t);throw new Error("invalid overload")},_.encodeToByte=function(t,e){var n=null!=t?t.length:0;if(0===n)return[];for(var s=3*(n/3|0),i=1+((n-1)/3|0)<<2,r=i+(e?((i-1)/76|0)<<1:0),a=function(t){for(var e=[];0<t--;)e.push(0);return e}(r),o=0,l=0,u=0;o<s;){var h=(255&t[o++])<<16|(255&t[o++])<<8|255&t[o++];a[l++]=_.CA_$LI$()[h>>>18&63].charCodeAt(0),a[l++]=_.CA_$LI$()[h>>>12&63].charCodeAt(0),a[l++]=_.CA_$LI$()[h>>>6&63].charCodeAt(0),a[l++]=_.CA_$LI$()[63&h].charCodeAt(0),e&&19==++u&&l<r-2&&(a[l++]="\r".charCodeAt(0),a[l++]="\n".charCodeAt(0),u=0)}i=n-s;return 0<i&&(h=(255&t[s])<<10|(2==i?(255&t[n-1])<<2:0),a[r-4]=_.CA_$LI$()[h>>12].charCodeAt(0),a[r-3]=_.CA_$LI$()[h>>>6&63].charCodeAt(0),a[r-2]=(2==i?_.CA_$LI$()[63&h]:"=").charCodeAt(0),a[r-1]="=".charCodeAt(0)),a},_.decode$byte_A=function(t){for(var e=t.length,n=0,s=0;s<e;s++)_.IA_$LI$()[255&t[s]]<0&&n++;if((e-n)%4!=0)return null;for(var i=0,s=e;1<s&&_.IA_$LI$()[255&t[--s]]<=0;)t[s]=="=".charCodeAt(0)&&i++;for(var r=(6*(e-n)>>3)-i,a=function(t){for(var e=[];0<t--;)e.push(0);return e}(r),o=0,l=0;l<r;){for(var s=0,u=0;u<4;u++){var h=_.IA_$LI$()[255&t[o++]];0<=h?s|=h<<18-6*u:u--}a[l++]=s>>16|0,l<r&&(a[l++]=s>>8|0,l<r&&(a[l++]=0|s))}return a},_.decodeFast$byte_A=function(t){var e=t.length;if(0===e)return[];for(var n=0,s=e-1;n<s&&_.IA_$LI$()[255&t[n]]<0;)n++;for(;0<s&&_.IA_$LI$()[255&t[s]]<0;)s--;for(var i=t[s]=="=".charCodeAt(0)?t[s-1]=="=".charCodeAt(0)?2:1:0,r=s-n+1,a=76<e?(t[76]=="\r".charCodeAt(0)?r/78|0:0)<<1:0,o=(6*(r-a)>>3)-i,l=function(t){for(var e=[];0<t--;)e.push(0);return e}(o),u=0,h=0,g=3*(o/3|0);u<g;){var x=_.IA_$LI$()[t[n++]]<<18|_.IA_$LI$()[t[n++]]<<12|_.IA_$LI$()[t[n++]]<<6|_.IA_$LI$()[t[n++]];l[u++]=x>>16|0,l[u++]=x>>8|0,l[u++]=0|x,0<a&&19==++h&&(n+=2,h=0)}if(u<o){for(var x=0,m=0;n<=s-i;m++)x|=_.IA_$LI$()[t[n++]]<<18-6*m;for(var p=16;u<o;p-=8)l[u++]=x>>p|0}return l},_.encodeToString=function(t,e,n){return _.encodeToChar(t,e,n).join("")},_.decode$java_lang_String=function(t){var e=null!=t?t.length:0;if(0===e)return[];for(var n=0,s=0;s<e;s++)_.IA_$LI$()[t.charAt(s).charCodeAt(0)]<0&&n++;if((e-n)%4!=0)return null;for(var i,r=0,s=e;1<s&&_.IA_$LI$()[t.charAt(--s).charCodeAt(0)]<=0;)(null==(i=t.charAt(s)).charCodeAt?i:i.charCodeAt(0))=="=".charCodeAt(0)&&r++;for(var a=(6*(e-n)>>3)-r,o=function(t){for(var e=[];0<t--;)e.push(0);return e}(a),l=0,u=0;u<a;){for(var s=0,h=0;h<4;h++){var g=_.IA_$LI$()[t.charAt(l++).charCodeAt(0)];0<=g?s|=g<<18-6*h:h--}o[u++]=s>>16|0,u<a&&(o[u++]=s>>8|0,u<a&&(o[u++]=0|s))}return o},_.decodeFast$java_lang_String=function(t){var e=t.length;if(0===e)return[];for(var n,s,i=0,r=e-1;i<r&&_.IA_$LI$()[255&(null==(n=t.charAt(i)).charCodeAt?n:n.charCodeAt(0))]<0;)i++;for(;0<r&&_.IA_$LI$()[255&(null==(s=t.charAt(r)).charCodeAt?s:s.charCodeAt(0))]<0;)r--;for(var a,o=(null==(a=t.charAt(r)).charCodeAt?a:a.charCodeAt(0))=="=".charCodeAt(0)?(null==(l=t.charAt(r-1)).charCodeAt?l:l.charCodeAt(0))=="=".charCodeAt(0)?2:1:0,l=r-i+1,u=76<e?((null==(e=t.charAt(76)).charCodeAt?e:e.charCodeAt(0))=="\r".charCodeAt(0)?l/78|0:0)<<1:0,h=(6*(l-u)>>3)-o,g=function(t){for(var e=[];0<t--;)e.push(0);return e}(h),x=0,m=0,p=3*(h/3|0);x<p;){var c=_.IA_$LI$()[t.charAt(i++).charCodeAt(0)]<<18|_.IA_$LI$()[t.charAt(i++).charCodeAt(0)]<<12|_.IA_$LI$()[t.charAt(i++).charCodeAt(0)]<<6|_.IA_$LI$()[t.charAt(i++).charCodeAt(0)];g[x++]=c>>16|0,g[x++]=c>>8|0,g[x++]=0|c,0<u&&19==++m&&(i+=2,m=0)}if(x<h){for(var c=0,d=0;i<=r-o;d++)c|=_.IA_$LI$()[t.charAt(i++).charCodeAt(0)]<<18-6*d;for(var y=16;x<h;y-=8)g[x++]=c>>y|0}return g},(t=_).__static_initialized=!1,(n.mxBase64=t).__class="com.mxgraph.online.mxBase64"}(com=com||{}),com.mxgraph.online.mxBase64.IA_$LI$(),com.mxgraph.online.mxBase64.CA_$LI$(),com.mxgraph.online.mxBase64.__static_initialize(),com.mxgraph.io.vsdx.VsdxShape.__com_mxgraph_io_vsdx_VsdxShape_LOGGER_$LI$(),com.mxgraph.io.vsdx.VsdxShape.arrowTypes_$LI$(),com.mxgraph.io.vsdx.VsdxShape.arrowSizes_$LI$(),com.mxgraph.io.vsdx.VsdxShape.OFFSET_ARRAY_$LI$(),com.mxgraph.io.vsdx.VsdxShape.__static_initialize(),com.mxgraph.io.vsdx.Shape.UNICODE_LINE_SEP_$LI$(),com.mxgraph.io.vsdx.Style.lineDashPatterns_$LI$(),com.mxgraph.io.vsdx.Style.styleTypes_$LI$(),com.mxgraph.io.vsdx.Style.__static_initialize(),com.mxgraph.online.Constants.MAX_AREA_$LI$(),com.mxgraph.io.vsdx.theme.Color.NONE_$LI$(),com.mxgraph.io.vsdx.mxVsdxUtils.conversionFactor_$LI$(),com.mxgraph.io.vsdx.mxVsdxTheme.colorIds_$LI$(),com.mxgraph.io.vsdx.mxVsdxTheme.themesIds_$LI$(),com.mxgraph.io.vsdx.mxVsdxTheme.__static_initialize(),com.mxgraph.io.vsdx.mxVsdxConstants.MY_SET_$LI$(),com.mxgraph.io.vsdx.mxVsdxConstants.SET_VALUES_$LI$(),com.mxgraph.io.vsdx.mxPropertiesManager.defaultColors_$LI$(),com.mxgraph.io.vsdx.mxPropertiesManager.__static_initialize(),com.mxgraph.io.mxVsdxCodec.vsdxPlaceholder_$LI$(),com.mxgraph.io.mxVsdxCodec.parsererrorNS_$LI$(),EditorUi.prototype.doImportVisio=function(t,e,n,s){null!=(s=s||t.name)&&/(\.vs(x|sx?))($|\?)/i.test(s)?new com.mxgraph.io.mxVssxCodec(this).decodeVssx(t,e,null,n):new com.mxgraph.io.mxVsdxCodec(this).decodeVsdx(t,e,null,n)};