var kityIDer="";function showFormula(){$("#graphWindow").window("open"),initializeKityGraph(),setTimeout(function(){window.kfe.execCommand("render","\\placeholder"),window.kfe.execCommand("focus")},500)}function setlatex(e){try{window.kfe.execCommand("render",e||"\\placeholder"),window.kfe.execCommand("focus")}catch(e){}}function insertGraph(){kfe.execCommand("get.image.data",function(e){var i=showeditorid(),t=getCurrentEditor(i),o=window.kfe.execCommand("get.source");kityIDer&&document.getElementById(kityIDer)?o.indexOf("placeholder")<0&&($("#"+kityIDer).attr("src",e.img),$("#"+kityIDer).attr("data-latex",o)):o.indexOf("placeholder")<0&&(kityIDer=(new Date).getTime(),i=t.getHtml(),i+='<img id="'+kityIDer+'" class="kfformula" onclick="javascript:editGraph(this);" style="vertical-align: middle;" src="'+e.img+'" data-latex="'+o+'" />',t.setHtml(i)),$("#graphWindow").window("close")})}function editGraph(e){window.kfe.execCommand("render",e||"\\placeholder")}function initializeKityGraph(){$("#tips").html('<div id="loading"><img src="../../../WebPaper/common/images/loading.gif" alt="loading" /><p>loading...</p></div>'),kityIDer="",kf.EditorFactory.create($("#kfEditorContainer")[0],{render:{fontsize:24},resource:{path:"../../../WebPaper/common/js/javascript/kityformula/resource/"}}).ready(function(e){$("#tips").remove(),this.execCommand("render","\\placeholder"),this.execCommand("focus"),window.kfe=this,$("#graphWindow .kf-editor-canvas-container svg").click(function(){$("#kfEditorContainer .kf-editor-input-box").blur(),$("#kfEditorContainer .kf-editor-input-box").focus()}),$(".kf-editor-toolbar").click(function(){$("#kfEditorContainer .kf-editor-input-box").focus()}),$("#kfEditorContainer .kf-editor-input-box").blur(function(){$(this).focus()}),$(".kf-editor-ui-box").blur(function(){$(this).parent().show()})})}